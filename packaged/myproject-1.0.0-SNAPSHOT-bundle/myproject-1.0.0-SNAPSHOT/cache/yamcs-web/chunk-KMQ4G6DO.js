import{a as vi}from"./chunk-CS6YXD3A.js";import{a as hi}from"./chunk-NFMEVCL3.js";import{Aa as B,B as Dt,Bc as Gt,Bf as X,Bg as ct,Ca as g,Cb as se,Cc as ge,Cg as di,D as Bt,Dg as ke,Ea as d,Eg as ui,F as _,Fa as ce,Fb as $t,Fc as _e,Fg as fi,Fh as x,G as b,Ga as W,Gb as me,Gh as bi,Ha as Lt,Hb as Ne,Hh as Ci,Ia as te,Ib as Ue,If as ri,Ja as N,Jb as H,Je as Ge,K as Mt,Ka as U,Kb as Nt,Ke as He,Kf as E,Lc as Ht,Lf as li,Me as Qe,Na as P,Ne as Xt,Ng as st,O as jt,Oa as $e,Pa as T,Pc as be,Pe as Kt,Ra as l,Rc as Ce,Sa as M,T as Fe,Ta as j,Tc as Qt,Te as Jt,Uc as ze,Ue as Zt,Uf as ci,V as c,Ve as ei,We as qe,Xa as It,Xe as ti,Y as p,Ya as Rt,Ye as Xe,Yf as si,Za as ie,Ze as Ke,Zg as gi,_ as h,_b as Ut,_e as Je,aa as Tt,af as Ze,bb as u,bf as et,bg as he,ca as Et,cb as C,cg as mi,da as k,db as L,df as tt,ef as ii,f as Y,gc as zt,gf as ni,gh as _i,hc as Yt,hf as it,hh as xe,ib as At,jf as nt,ka as w,kf as ot,lf as at,m as St,ma as D,mg as ve,n as wt,na as ae,ne as R,nh as mt,oa as re,oc as pe,oe as A,og as rt,pa as le,pe as Ye,qa as m,qc as de,qe as V,ra as a,re as F,sa as o,sb as G,sc as Q,se as $,ta as f,tc as ue,te as q,ua as Ot,ue as qt,va as Pt,ve as We,wg as pi,xa as y,xb as Vt,xc as Wt,ya as S,yb as Ft,yc as fe,yf as oi,yg as lt,zf as ai}from"./chunk-OXOWQRWE.js";var yi=[[["app-storage-toolbar"]],[["ya-detail-pane"]],"*"],Si=["app-storage-toolbar","ya-detail-pane","*"],ye=class ye{constructor(){this.noscroll=!1}};ye.\u0275fac=function(e){return new(e||ye)},ye.\u0275cmp=h({type:ye,selectors:[["app-storage-page"]],inputs:{noscroll:"noscroll"},ngContentSelectors:Si,decls:4,vars:2,consts:[[1,"page-content"]],template:function(e,i){e&1&&(ce(yi),W(0),Ot(1,"div",0),W(2,1),W(3,2),Pt()),e&2&&(c(),$e("overflow",i.noscroll?"hidden":"auto"))},dependencies:[x],styles:[".page-content[_ngcontent-%COMP%]{position:absolute;inset:49px 0 0;overflow:auto;font:400 12px/20px Roboto,sans-serif}"],changeDetection:0});var K=ye;var xt=new Dt("APP_STORAGE_TOOLBAR"),ne=class ne extends zt{constructor(){super(...arguments);this._closestToolbar=Bt(xt,{optional:!0})}};ne.\u0275fac=(()=>{let e;return function(r){return(e||(e=jt(ne)))(r||ne)}})(),ne.\u0275dir=Tt({type:ne,selectors:[["","app-storage-toolbar-label",""]],features:[Et]});var J=ne;var wi=["*"];function Di(n,t){}function Bi(n,t){if(n&1&&k(0,Di,0,0,"ng-template",1),n&2){let e=d();m("cdkPortalOutlet",e.templateLabel)}}function Mi(n,t){if(n&1&&l(0),n&2){let e=d();j(" ",e.textLabel()," ")}}var oe=class oe{constructor(){this.textLabel=At(void 0,{alias:"label"})}get templateLabel(){return this._templateLabel}set templateLabel(t){t&&t._closestToolbar===this&&(this._templateLabel=t)}};oe.\u0275fac=function(e){return new(e||oe)},oe.\u0275cmp=h({type:oe,selectors:[["app-storage-toolbar"]],contentQueries:function(e,i,r){if(e&1&&Lt(r,J,5),e&2){let s;N(s=U())&&(i.templateLabel=s.first)}},hostAttrs:[1,"app-storage-toolbar"],inputs:{textLabel:[1,"label","textLabel"]},features:[It([{provide:xt,useExisting:oe}])],ngContentSelectors:wi,decls:5,vars:1,consts:[[1,"app-storage-toolbar-label"],[3,"cdkPortalOutlet"],[1,"app-storage-toolbar-content"]],template:function(e,i){e&1&&(ce(),a(0,"div",0),w(1,Bi,1,1,null,1)(2,Mi,1,1),o(),a(3,"div",2),W(4),o()),e&2&&(c(),D(i.templateLabel?1:2))},dependencies:[Yt,x],styles:["[_nghost-%COMP%]{display:flex;align-items:center;min-height:48px;font-weight:400;border-bottom:1px solid rgba(0,0,0,.1);background-color:var(--y-background-color);box-sizing:content-box;padding:0 16px 0 24px;font:400 20px/28px Roboto,sans-serif;letter-spacing:.25px}.app-storage-toolbar-label[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:48px}.app-storage-toolbar-content[_ngcontent-%COMP%]{display:inline-flex;align-items:center;column-gap:8px}"],changeDetection:0});var Z=oe;var Se=class Se{constructor(t,e,i,r,s){this.dialogRef=t;this.data=r;this.messageService=s;this.storageClient=i.createStorageClient(),this.form=e.group({name:["",de.required]})}save(){this.storageClient.createBucket({name:this.form.value.name}).then(()=>this.dialogRef.close(!0)).catch(t=>{this.dialogRef.close(!1),this.messageService.showError(t)})}};Se.\u0275fac=function(e){return new(e||Se)(p(R),p(be),p(E),p(A),p(at))},Se.\u0275cmp=h({type:Se,selectors:[["app-create-bucket-dialog"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Bucket name"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,i){e&1&&(a(0,"h2",0),l(1,"Create bucket"),o(),a(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),f(5,"input",3),o()()(),a(6,"mat-dialog-actions",4)(7,"ya-button",5),l(8,"CANCEL"),o(),a(9,"ya-button",6),g("click",function(){return i.save()}),l(10,"SAVE"),o()()),e&2&&(c(3),m("formGroup",i.form),c(6),m("disabled",!i.form.valid))},dependencies:[x,fe,pe,Q,ue,ge,_e,V,F,q,$,X,he],encapsulation:2});var pt=Se;var Oi=n=>[n];function Pi(n,t){if(n&1){let e=B();a(0,"ya-page-button",27),g("clicked",function(){_(e);let r=d();return b(r.createBucket())}),l(1,"Create bucket"),o()}}function Li(n,t){if(n&1){let e=B();a(0,"ya-page-button",28),g("clicked",function(){_(e);let r=d();return b(r.deleteSelectedBuckets())}),l(1," Delete "),o()}if(n&2){let e=d();m("disabled",!e.selection.hasValue())}}function Ii(n,t){if(n&1){let e=B();a(0,"th",29),g("click",function(r){return _(e),P(2).toggle(),b(r.stopPropagation())}),f(1,"ya-table-checkbox",30,0),o()}if(n&2){let e=d();c(),m("dataSource",e.dataSource)("selection",e.selection)}}function Ri(n,t){if(n&1){let e=B();a(0,"td",31),g("click",function(r){return _(e),P(2).toggle(),b(r.stopPropagation())}),f(1,"ya-table-checkbox",32,0),o()}if(n&2){let e=t.$implicit,i=d();c(),m("dataSource",i.dataSource)("selection",i.selection)("item",e)}}function Ai(n,t){n&1&&(a(0,"th",33),l(1,"Bucket"),o())}function Vi(n,t){if(n&1){let e=B();a(0,"td",34)(1,"mat-icon",35),l(2," shopping_basket "),o(),a(3,"a",36),g("click",function(r){return _(e),b(r.stopPropagation())}),l(4),o()()}if(n&2){let e=t.$implicit;c(3),m("routerLink",ie(2,Oi,e.name)),c(),M(e.name)}}function Fi(n,t){n&1&&(a(0,"th",33),l(1,"Created"),o())}function $i(n,t){if(n&1&&(a(0,"td",34),l(1),u(2,"datetime"),u(3,"nvl"),o()),n&2){let e=t.$implicit;c(),M(L(3,3,C(2,1,e.created),"-"))}}function Ni(n,t){n&1&&(a(0,"th",37),l(1,"Used"),o())}function Ui(n,t){if(n&1&&(a(0,"td",38),l(1),u(2,"formatBytes"),u(3,"nvl"),o()),n&2){let e=t.$implicit;c(),j(" ",L(3,3,C(2,1,e.size),"-")," ")}}function zi(n,t){n&1&&(a(0,"th",37),l(1," Available "),o())}function Yi(n,t){if(n&1&&(a(0,"td",38),l(1),u(2,"formatBytes"),u(3,"nvl"),o()),n&2){let e=t.$implicit,i=d();c(),j(" ",L(3,3,C(2,1,i.zeroOrMore(e.maxSize-e.size)),"-")," ")}}function Wi(n,t){n&1&&(a(0,"th",39),l(1,"Capacity"),o())}function Gi(n,t){if(n&1&&(a(0,"td",34),f(1,"ya-progress",40),o()),n&2){let e=t.$implicit;c(),m("value",e.size)("total",e.maxSize)}}function Hi(n,t){n&1&&(a(0,"th",37),l(1,"Objects"),o())}function Qi(n,t){if(n&1&&(a(0,"td",38),l(1),u(2,"number"),u(3,"nvl"),o()),n&2){let e=t.$implicit;c(),j(" ",L(3,3,C(2,1,e.numObjects),"-")," ")}}function qi(n,t){n&1&&(a(0,"th",37),l(1," Avail. objects "),o())}function Xi(n,t){if(n&1&&(a(0,"td",38),l(1),u(2,"number"),u(3,"nvl"),o()),n&2){let e=t.$implicit,i=d();c(),j(" ",L(3,3,C(2,1,i.zeroOrMore(e.maxObjects-e.numObjects)),"-")," ")}}function Ki(n,t){n&1&&(a(0,"th",39),l(1,"%objects"),o())}function Ji(n,t){if(n&1&&(a(0,"td",34),f(1,"ya-progress",40),o()),n&2){let e=t.$implicit;c(),m("value",e.numObjects)("total",e.maxObjects)}}function Zi(n,t){n&1&&(a(0,"th",39),l(1,"Location"),o())}function en(n,t){if(n&1&&(a(0,"td",34),l(1),o()),n&2){let e=t.$implicit;c(),j(" ",e.location.description," ")}}function tn(n,t){n&1&&f(0,"th",41)}function nn(n,t){if(n&1){let e=B();a(0,"ya-more")(1,"button",42),g("click",function(){_(e);let r=d().$implicit,s=d();return b(s.deleteBucket(r))}),l(2,"Delete bucket"),o()()}}function on(n,t){if(n&1&&(a(0,"td",34),w(1,nn,3,0,"ya-more"),o()),n&2){let e=d();c(),D(e.mayManageBuckets()?1:-1)}}function an(n,t){n&1&&f(0,"tr",43)}function rn(n,t){if(n&1){let e=B();a(0,"tr",44),g("click",function(){let r=_(e).$implicit,s=d();return b(s.toggleOne(r))}),o()}if(n&2){let e=t.$implicit,i=d();T("selected",i.selection.isSelected(e))}}var De=class De{constructor(t,e,i,r,s,v,ee){this.yamcs=t;this.dialog=e;this.router=i;this.route=r;this.messageService=s;this.authService=v;this.filterControl=new Wt;this.displayedColumns=Mt(["name","created","size","avail","capacity","numObjects","availObjects","pctObjects","location","actions"]);this.dataSource=new ot;this.selection=new We(!0,[]);ee.setTitle("Buckets"),this.storageClient=this.yamcs.createStorageClient(),this.initializeOptions(),this.refreshView(),this.mayManageBuckets()&&this.displayedColumns.set(["select",...this.displayedColumns()])}ngAfterViewInit(){this.dataSource.sort=this.sort}initializeOptions(){let t=this.route.snapshot.queryParamMap;t.has("filter")&&(this.filterControl.setValue(t.get("filter")),this.dataSource.filter=t.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase();for(let i of this.selection.selected)this.dataSource.filteredData.indexOf(i)===-1&&this.selection.deselect(i)})}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createBucket(){this.dialog.open(pt,{width:"400px"}).afterClosed().subscribe(e=>{e&&this.refreshView()})}zeroOrMore(t){return Math.max(0,t)}mayManageBuckets(){return this.authService.getUser().hasSystemPrivilege("ManageAnyBucket")}deleteSelectedBuckets(){if(confirm("Are you sure you want to delete the selected buckets?")){let t=[];for(let e of this.selection.selected){let i=this.storageClient.deleteBucket(e.name);t.push(i)}Promise.all(t).then(()=>{this.selection.clear(),this.refreshView()})}}deleteBucket(t){confirm(`Are you sure you want to delete the bucket ${t.name}?`)&&this.storageClient.deleteBucket(t.name).then(()=>{this.selection.clear(),this.refreshView()}).catch(e=>this.messageService.showError(e))}selectNext(){let t=this.dataSource.filteredData,e=0;if(this.selection.hasValue()){let i=this.selection.selected[this.selection.selected.length-1];t.indexOf(i)!==-1&&(e=Math.min(t.indexOf(i)+1,t.length-1))}this.selection.clear(),this.selection.select(t[e])}selectPrevious(){let t=this.dataSource.filteredData,e=0;if(this.selection.hasValue()){let i=this.selection.selected[0];t.indexOf(i)!==-1&&(e=Math.max(t.indexOf(i)-1,0))}this.selection.clear(),this.selection.select(t[e])}applySelection(){if(this.selection.hasValue()&&this.selection.selected.length===1){let t=this.selection.selected[0];this.router.navigate(["/buckets",t.name])}}refreshView(){this.updateURL(),this.storageClient.getBuckets().then(t=>{this.dataSource.data=t}).catch(t=>this.messageService.showError(t))}updateURL(){let t=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:t||null},queryParamsHandling:"merge"})}};De.\u0275fac=function(e){return new(e||De)(p(E),p(Ye),p(Ue),p(me),p(at),p(li),p(se))},De.\u0275cmp=h({type:De,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&te(qe,7),e&2){let r;N(r=U())&&(i.sort=r.first)}},decls:43,vars:6,consts:[["cb",""],["label","Storage"],["icon","add_box"],["icon","delete",3,"disabled"],["placeholder","Filter buckets",3,"onArrowDown","onArrowUp","onEnter","formControl"],["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",3,"click",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","created"],["matColumnDef","size"],["mat-header-cell","","mat-sort-header","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","avail"],["matColumnDef","capacity"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","numObjects"],["matColumnDef","availObjects"],["matColumnDef","pctObjects"],["matColumnDef","location"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["icon","add_box",3,"clicked"],["icon","delete",3,"clicked","disabled"],["mat-header-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink"],["mat-header-cell","","mat-sort-header","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["mat-header-cell",""],[3,"value","total"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){e&1&&(a(0,"app-storage-page")(1,"app-storage-toolbar",1),w(2,Pi,2,0,"ya-page-button",2),w(3,Li,2,1,"ya-page-button",3),o(),a(4,"ya-panel")(5,"ya-filter-bar")(6,"ya-search-filter",4),g("onArrowDown",function(){return i.selectNext()})("onArrowUp",function(){return i.selectPrevious()})("onEnter",function(){return i.applySelection()}),o()(),a(7,"table",5),y(8,6),k(9,Ii,3,2,"th",7)(10,Ri,3,3,"td",8),S(),y(11,9),k(12,Ai,2,0,"th",10)(13,Vi,5,4,"td",11),S(),y(14,12),k(15,Fi,2,0,"th",10)(16,$i,4,6,"td",11),S(),y(17,13),k(18,Ni,2,0,"th",14)(19,Ui,4,6,"td",15),S(),y(20,16),k(21,zi,2,0,"th",14)(22,Yi,4,6,"td",15),S(),y(23,17),k(24,Wi,2,0,"th",18)(25,Gi,2,2,"td",11),S(),y(26,19),k(27,Hi,2,0,"th",14)(28,Qi,4,6,"td",15),S(),y(29,20),k(30,qi,2,0,"th",14)(31,Xi,4,6,"td",15),S(),y(32,21),k(33,Ki,2,0,"th",18)(34,Ji,2,2,"td",11),S(),y(35,22),k(36,Zi,2,0,"th",18)(37,en,2,1,"td",11),S(),y(38,23),k(39,tn,1,0,"th",24)(40,on,2,1,"td",11),S(),k(41,an,1,0,"tr",25)(42,rn,1,2,"tr",26),o()()()),e&2&&(c(2),D(i.mayManageBuckets()?2:-1),c(),D(i.mayManageBuckets()?3:-1),c(3),m("formControl",i.filterControl),c(),m("dataSource",i.dataSource),c(34),m("matHeaderRowDef",i.displayedColumns()),c(),m("matRowDefColumns",i.displayedColumns()))},dependencies:[Z,K,x,Q,Gt,H,Ge,He,Qe,Ce,ze,qe,ti,Xe,Je,ii,Ze,Ke,ni,et,tt,it,nt,mi,lt,rt,ke,ui,fi,st,Ft,ve,xe,mt],encapsulation:2,changeDetection:0});var dt=De;var ln=["*"],cn=n=>["/storage/buckets",n,"objects"],sn=n=>["/storage/buckets",n,"properties"],Be=class Be{constructor(t){this.yamcs=t}};Be.\u0275fac=function(e){return new(e||Be)(p(E))},Be.\u0275cmp=h({type:Be,selectors:[["app-bucket-page-tabs"]],inputs:{bucket:"bucket"},ngContentSelectors:ln,decls:9,vars:10,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["routerLinkActive","",3,"routerLink"],["actions",""]],template:function(e,i){if(e&1&&(ce(),a(0,"ya-page-tabs")(1,"a",2,0),l(3," Objects "),o(),a(4,"a",2,1),l(6," Properties "),o(),y(7,3),W(8),S(),o()),e&2){let r=P(2),s=P(5);c(),T("active",r.isActive),m("routerLink",ie(6,cn,i.bucket)),c(3),T("active",s.isActive),m("routerLink",ie(8,sn,i.bucket))}},dependencies:[x,H,Nt,di],styles:[".mat-mdc-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0});var Me=Be;var je=class je{constructor(t,e,i,r){this.dialogRef=t;this.data=r;this.storageClient=i.createStorageClient(),this.form=e.group({name:["",de.required]})}save(){let{path:t,bucket:e}=this.data;t.startsWith("/")&&(t=t.substring(1));let i=this.form.value.name,r=t?`${t}/${i}/`:`${i}/`;this.storageClient.uploadObject(e,r,new Blob).then(()=>this.dialogRef.close(!0))}};je.\u0275fac=function(e){return new(e||je)(p(R),p(be),p(E),p(A))},je.\u0275cmp=h({type:je,selectors:[["app-create-bucket-folder-dialog"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Folder name"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,i){e&1&&(a(0,"h2",0),l(1,"Create folder"),o(),a(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),f(5,"input",3),o()()(),a(6,"mat-dialog-actions",4)(7,"ya-button",5),l(8,"CANCEL"),o(),a(9,"ya-button",6),g("click",function(){return i.save()}),l(10,"CREATE"),o()()),e&2&&(c(3),m("formGroup",i.form),c(6),m("disabled",!i.form.valid))},dependencies:[x,fe,pe,Q,ue,Ht,ge,_e,V,F,q,$,X,he],encapsulation:2,changeDetection:0});var ft=je;var Te=class Te{constructor(t,e,i,r){this.dialogRef=t;this.data=r;this.storageClient=i.createStorageClient();let s=ri.getFilename(this.data.name);this.filenameForm=e.group({name:[s,[de.required]]})}async rename(){let t,e=this.data.name.lastIndexOf("/");e!==-1&&(t=this.data.name.substring(0,e+1));let r=await(await this.storageClient.getObject(this.data.bucket,this.data.name)).blob(),s=(t||"")+this.filenameForm.get("name").value;await this.storageClient.uploadObject(this.data.bucket,s,r),await this.storageClient.deleteObject(this.data.bucket,this.data.name),this.dialogRef.close(s)}};Te.\u0275fac=function(e){return new(e||Te)(p(R),p(be),p(E),p(A))},Te.\u0275cmp=h({type:Te,selectors:[["app-rename-object-dialog"]],decls:12,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Name"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,i){if(e&1){let r=B();a(0,"h2",1),l(1,"Rename file"),o(),a(2,"mat-dialog-content")(3,"form",2)(4,"ya-field",3),f(5,"input",4,0),o()()(),a(7,"mat-dialog-actions",5)(8,"ya-button",6),l(9,"CANCEL"),o(),a(10,"ya-button",7),g("click",function(){return _(r),b(i.rename())}),l(11," RENAME "),o()()}if(e&2){let r;c(3),m("formGroup",i.filenameForm),c(),T("invalid",(r=i.filenameForm.get("name"))==null?null:r.invalid),c(6),m("disabled",!i.filenameForm.valid)}},dependencies:[x,fe,pe,Q,ue,ge,_e,V,F,q,$,X,he],encapsulation:2});var gt=Te;var mn=["tableWrapper"];function pn(n,t){n&1&&l(0," Finished ")}function dn(n,t){if(n&1&&(a(0,"mat-icon",8),l(1," error "),o(),l(2," Failed ")),n&2){let e=d().$implicit;m("matTooltip",e.err)}}function un(n,t){n&1&&f(0,"ya-dots")}function fn(n,t){if(n&1&&(a(0,"tr")(1,"td"),l(2),o(),a(3,"td",7),w(4,pn,1,0),w(5,dn,3,1),w(6,un,1,0,"ya-dots"),o()()),n&2){let e=t.$implicit;T("failed",e.err),c(2),M(e.filename),c(2),D(e.complete&&!e.err?4:-1),c(),D(e.complete&&e.err?5:-1),c(),D(e.complete?-1:6)}}var Ee=class Ee{constructor(t,e){this.data=e;this.uploads$=e.uploads$.pipe(wt(500))}};Ee.\u0275fac=function(e){return new(e||Ee)(p(R),p(A))},Ee.\u0275cmp=h({type:Ee,selectors:[["app-upload-progress-dialog"]],viewQuery:function(e,i){if(e&1&&te(mn,7),e&2){let r;N(r=U())&&(i.tableWrapper=r.first)}},decls:13,vars:2,consts:[["tableWrapper",""],["mat-dialog-title",""],[2,"float","right"],["mat-icon-button","","mat-dialog-close",""],[1,"table-wrapper"],[2,"font-size","small","width","100%"],[3,"failed"],[2,"width","100px","text-align","center"],[1,"icon14",2,"vertical-align","middle",3,"matTooltip"]],template:function(e,i){e&1&&(a(0,"h3",1)(1,"div",2)(2,"button",3)(3,"mat-icon"),l(4,"close"),o()()(),l(5,` Uploads
`),o(),a(6,"mat-dialog-content")(7,"div",4,0)(9,"table",5),re(10,fn,7,6,"tr",6,ae),u(12,"async"),o()()()),e&2&&(c(10),le(C(12,0,i.uploads$)))},dependencies:[x,Ut,V,F,$,Ce,Qt,ci,G],styles:["tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:red}h3.mat-mdc-dialog-title[_ngcontent-%COMP%]{background-color:#24292e;color:#fff;margin:0;padding-left:5px;font-size:16px;line-height:40px}table[_ngcontent-%COMP%]{border-collapse:collapse}.table-wrapper[_ngcontent-%COMP%]{height:150px;overflow-y:scroll;overflow-x:hidden;padding:5px}"],changeDetection:0});var _t=Ee;function gn(n,t){if(n&1&&(a(0,"tr")(1,"td"),l(2),o(),a(3,"td"),l(4),o()()),n&2){let e=t.$implicit;c(2),M(e.key),c(2),M(e.value??"-")}}var Oe=class Oe{constructor(t,e){this.dialogRef=t;this.data=e}};Oe.\u0275fac=function(e){return new(e||Oe)(p(R),p(A))},Oe.\u0275cmp=h({type:Oe,selectors:[["app-view-object-metadata-dialog"]],decls:15,vars:2,consts:[["mat-dialog-title",""],["yaDataTable","",1,"expand"],["width","1"],["align","end"],["mat-dialog-close",""]],template:function(e,i){e&1&&(a(0,"h2",0),l(1,"Object Metadata"),o(),a(2,"mat-dialog-content")(3,"table",1)(4,"tr")(5,"th",2),l(6,"Key"),o(),a(7,"th"),l(8,"Value"),o()(),re(9,gn,5,2,"tr",null,ae),u(11,"keyvalue"),o()(),a(12,"mat-dialog-actions",3)(13,"ya-button",4),l(14,"CLOSE"),o()()),e&2&&(c(9),le(C(11,0,i.data.metadata)))},dependencies:[x,gi,V,F,q,$,X,Vt],encapsulation:2});var bt=Oe;var _n=["droparea"],bn=["uploader"],Cn=()=>["/storage/buckets"],hn=n=>["/storage/buckets",n,"objects"];function vn(n,t){if(n&1&&(f(0,"ya-page-icon-button",19),l(1)),n&2){let e=d();c(),j(" ",e.name," ")}}function kn(n,t){if(n&1&&f(0,"img",14),n&2){let e=d();m("src",e.selection.selected[0].objectUrl,Fe)}}function xn(n,t){n&1&&(a(0,"div",15)(1,"mat-icon"),l(2,"arrow_back"),o(),a(3,"p"),l(4,"Select an image to make it appear here"),o()())}function yn(n,t){if(n&1&&f(0,"ya-breadcrumb",21),n&2){let e=t.$implicit;m("link",e.route)("label",e.name)}}function Sn(n,t){if(n&1&&(a(0,"div",17)(1,"ya-breadcrumb-trail"),f(2,"ya-breadcrumb",20)(3,"ya-breadcrumb",21),re(4,yn,1,2,"ya-breadcrumb",21,ae),o()()),n&2){let e=d();c(2),m("link",Rt(3,Cn)),c(),m("link",ie(4,hn,e.name))("label",e.name),c(),le(t)}}function wn(n,t){if(n&1){let e=B();a(0,"th",35),g("click",function(r){return _(e),P(2).toggle(),b(r.stopPropagation())}),f(1,"ya-table-checkbox",36,2),o()}if(n&2){let e=d(2);c(),m("dataSource",e.dataSource)("selection",e.selection)}}function Dn(n,t){if(n&1){let e=B();a(0,"td",37),g("click",function(r){return _(e),P(2).toggle(),b(r.stopPropagation())}),f(1,"ya-table-checkbox",38,2),o()}if(n&2){let e=t.$implicit,i=d(2);c(),m("dataSource",i.dataSource)("selection",i.selection)("item",e)}}function Bn(n,t){n&1&&(a(0,"th",39),l(1,"Name"),o())}function Mn(n,t){if(n&1){let e=B();a(0,"mat-icon",41),l(1," folder "),o(),a(2,"a",42),g("click",function(r){return _(e),b(r.stopPropagation())}),l(3),u(4,"filename"),o()}if(n&2){let e=d().$implicit,i=d(2);c(2),m("routerLink","/storage/buckets/"+i.name+"/objects/"+e.name),c(),j(" ",C(4,2,e.name)," ")}}function jn(n,t){if(n&1){let e=B();a(0,"mat-icon",41),l(1," description "),o(),a(2,"a",43),g("click",function(r){return _(e),b(r.stopPropagation())}),l(3),u(4,"filename"),o()}if(n&2){let e=d().$implicit;c(2),m("href",e.objectUrl,Fe),c(),j(" ",C(4,2,e.name)," ")}}function Tn(n,t){if(n&1&&(a(0,"td",40),w(1,Mn,5,4)(2,jn,5,4),o()),n&2){let e=t.$implicit;c(),D(e.folder?1:2)}}function En(n,t){n&1&&(a(0,"th",39),l(1,"Date modified"),o())}function On(n,t){if(n&1&&(a(0,"td",40),l(1),u(2,"datetime"),o()),n&2){let e=t.$implicit;c(),j(" ",C(2,1,e.modified)||"-"," ")}}function Pn(n,t){n&1&&(a(0,"th",39),l(1,"Size"),o())}function Ln(n,t){if(n&1&&(a(0,"td",40),l(1),u(2,"formatBytes"),o()),n&2){let e=t.$implicit;c(),j(" ",C(2,1,e.size)||"-"," ")}}function In(n,t){n&1&&f(0,"th",44)}function Rn(n,t){if(n&1){let e=B();a(0,"ya-more")(1,"button",45),g("click",function(){_(e);let r=d().$implicit,s=d(2);return b(s.renameFile(r))}),l(2,"Rename"),o(),a(3,"a",46),l(4,"Download"),o(),f(5,"mat-divider"),a(6,"button",47),g("click",function(){_(e);let r=d().$implicit,s=d(2);return b(s.openViewMetadataDialog(r))}),l(7," View metadata "),o(),f(8,"mat-divider"),a(9,"button",45),g("click",function(){_(e);let r=d().$implicit,s=d(2);return b(s.deleteFile(r))}),l(10,"Delete"),o()()}if(n&2){let e=d().$implicit;c(3),m("href",e.objectUrl,Fe),c(3),m("disabled",!e.metadata)}}function An(n,t){if(n&1&&(a(0,"td",40),w(1,Rn,11,2,"ya-more"),o()),n&2){let e=t.$implicit;c(),D(e.folder?-1:1)}}function Vn(n,t){n&1&&f(0,"tr",48)}function Fn(n,t){if(n&1){let e=B();a(0,"tr",49),g("click",function(){let r=_(e).$implicit,s=d(2);return b(s.toggleOne(r))}),o()}if(n&2){let e=t.$implicit,i=d(2);T("selected",i.selection.isSelected(e))}}function $n(n,t){if(n&1&&(a(0,"table",18),y(1,22),k(2,wn,3,2,"th",23)(3,Dn,3,3,"td",24),S(),y(4,25),k(5,Bn,2,0,"th",26)(6,Tn,3,1,"td",27),S(),y(7,28),k(8,En,2,0,"th",26)(9,On,3,3,"td",27),S(),y(10,29),k(11,Pn,2,0,"th",26)(12,Ln,3,3,"td",27),S(),y(13,30),k(14,In,1,0,"th",31)(15,An,2,1,"td",32),S(),k(16,Vn,1,0,"tr",33)(17,Fn,1,2,"tr",34),o()),n&2){let e=d();m("dataSource",e.dataSource),c(16),m("cdkHeaderRowDef",e.displayedColumns),c(),m("cdkRowDefColumns",e.displayedColumns)}}function Nn(n,t){n&1&&(a(0,"ya-empty-message"),l(1,"Empty directory."),o())}var Pe=class Pe{constructor(t,e,i,r,s){this.dialog=t;this.route=i;this.breadcrumb$=new Y([]);this.dragActive$=new Y(!1);this.showPreview$=new Y(!1);this.previewWidth$=new Y(600);this.displayedColumns=["select","name","size","modified","actions"];this.dataSource=new ot([]);this.selection=new We(!0,[]);this.uploads$=new Y([]);this.progressDialogOpen=!1;this.name=i.snapshot.parent.parent.paramMap.get("name"),s.setTitle(this.name),this.storageClient=r.createStorageClient(),this.loadCurrentFolder(),this.routerSubscription=e.events.pipe(St(v=>v instanceof $t)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){let t={delimiter:"/"},e=this.route.snapshot.url;e.length&&(t.prefix=e.map(i=>i.path).join("/")+"/"),this.storageClient.listObjects(this.name,t).then(i=>{this.updateBrowsePath(),this.changedir(i)})}changedir(t){this.selection.clear();let e=[];for(let i of t.prefixes||[])e.push({folder:!0,name:i});for(let i of t.objects||[])i.name.endsWith("/")||e.push({folder:!1,name:i.name,modified:i.created,size:i.size,objectUrl:this.storageClient.getObjectURL(this.name,i.name),metadata:i.metadata});this.dataSource.data=e}toggleOne(t){(!this.selection.isSelected(t)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(t)}createFolder(){this.dialog.open(ft,{width:"400px",data:{bucket:this.name,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadObjects(){let t=this.getCurrentPath();t.startsWith("/")&&(t=t.substring(1));let e=this.uploaderEl.nativeElement.files,i=[];for(let r in e)if(!isNaN(parseInt(r,10))){let s=e[r],v=t?t+"/"+s.name:s.name,ee=this.name,Ve=this.storageClient.uploadObject(ee,v,s);i.push({filename:s.name,promise:Ve})}i.length&&this.showUploadProgress().then(()=>{for(let r of i)this.trackUpload(r);this.settlePromises(i.map(r=>r.promise)).then(()=>{this.loadCurrentFolder()})})}settlePromises(t){return Promise.all(t.map(e=>e.then(i=>({state:"fullfilled",value:i}),i=>({state:"rejected",value:i}))))}trackUpload(t){t.promise.then(()=>{t.complete=!0,this.uploads$.next([...this.uploads$.value])}).catch(e=>{e.response.json().then(i=>{t.complete=!0,t.err=i.msg,this.uploads$.next([...this.uploads$.value])}).catch(()=>{t.complete=!0,t.err=e.statusText,this.uploads$.next([...this.uploads$.value])})}),this.uploads$.next([...this.uploads$.value,t])}getCurrentPath(){let t="";for(let e of this.route.snapshot.url)t+="/"+e.path;return t||"/"}togglePreview(){this.showPreview$.next(!this.showPreview$.value)}deleteSelectedObjects(){let t=[],e=[];for(let i of this.selection.selected)i.folder?e.push(this.storageClient.listObjects(this.name,{prefix:i.name}).then(r=>{let s=r.objects||[];t.push(...s.map(v=>v.name))})):t.push(i.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${t.length} files. Are you sure you want to continue?`)){let i=[];for(let r of t)i.push(this.storageClient.deleteObject(this.name,r));Promise.all(i).then(()=>{this.loadCurrentFolder()})}})}renameFile(t){this.dialog.open(gt,{data:{bucket:this.name,name:t.name},width:"400px"}).afterClosed().subscribe(i=>{i&&this.loadCurrentFolder()})}deleteFile(t){confirm(`Are you sure you want to delete ${t.name}?`)&&this.storageClient.deleteObject(this.name,t.name).then(()=>{this.loadCurrentFolder()})}openViewMetadataDialog(t){this.dialog.open(bt,{width:"600px",data:{metadata:t.metadata||{}}})}dragEnter(t){return this.dragActive$.next(!0),t.preventDefault(),t.stopPropagation(),!1}dragOver(t){return t.preventDefault(),t.stopPropagation(),!1}dragLeave(t){return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}drop(t){let e=t.dataTransfer||{};if(e){let i=this.getCurrentPath().substring(1);i!==""&&(i+="/"),vi(e).then(r=>{if(r.length){let s=[];this.showUploadProgress().then(()=>{for(let v of r){let ee=i+v._fullPath,Ve=this.storageClient.uploadObject(this.name,ee,v);this.trackUpload({filename:v._fullPath,promise:Ve}),s.push(Ve)}this.settlePromises(s).then(()=>{this.loadCurrentFolder()})})}})}return this.dragActive$.next(!1),t.preventDefault(),t.stopPropagation(),!1}updateBrowsePath(){let t=[],e="";for(let i of this.route.snapshot.url)e+="/"+i.path,t.push({name:i.path,route:`/storage/buckets/${this.name}/objects`+e});return this.breadcrumb$.next(t),e||"/"}isImage(t){if(t.folder)return!1;let e=t.name.toLocaleLowerCase();return e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".jpg")||e.endsWith("jpeg")||e.endsWith("bmp")||e.endsWith("svg")||e.endsWith("ico")}async showUploadProgress(){if(!this.progressDialogOpen)return this.dialogRef=this.dialog.open(_t,{position:{bottom:"10px",right:"10px"},width:"500px",data:{uploads$:this.uploads$},hasBackdrop:!1,autoFocus:!1,panelClass:["progress-dialog","elevation-z1"]}),this.dialogRef.afterOpened().subscribe(()=>this.progressDialogOpen=!0),this.dialogRef.afterClosed().subscribe(()=>{this.uploads$.next([]),this.progressDialogOpen=!1}),new Promise((t,e)=>{this.dialogRef.afterOpened().subscribe(()=>{t(!0)},i=>{e(i)})})}resizeMouseDown(t){let e=t.clientX,i=this.previewWidth$.value,r=v=>{if(e!==null){let ee=i-(v.clientX-e);this.previewWidth$.next(Math.max(400,ee))}},s=v=>{e=null,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)}ngOnDestroy(){this.routerSubscription?.unsubscribe(),this.dialogRef?.close()}};Pe.\u0275fac=function(e){return new(e||Pe)(p(Ye),p(Ue),p(me),p(E),p(se))},Pe.\u0275cmp=h({type:Pe,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&(te(_n,7),te(bn,5)),e&2){let r;N(r=U())&&(i.dropArea=r.first),N(r=U())&&(i.uploaderEl=r.first)}},decls:33,vars:27,consts:[["uploader",""],["droparea",""],["cb",""],["app-storage-toolbar-label",""],["icon","file_upload",3,"clicked"],["type","file","hidden","","multiple","",3,"change"],["icon","create_new_folder",3,"clicked"],["icon","delete",3,"clicked","disabled"],[3,"clicked","icon"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[3,"autosize"],["mode","side","position","end",2,"text-align","center",3,"opened","disableClose"],[1,"resize-handle",3,"mousedown"],[3,"src"],[2,"margin-top","4em","color","#fff"],[3,"bucket"],[2,"margin-top","16px"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["routerLink","/storage/buckets","icon","arrow_back"],["label","Buckets",3,"link"],[3,"link","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",3,"click",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","modified"],["cdkColumnDef","size"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink"],["download","",3,"click","href"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-menu-item","",3,"click","disabled"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,i){if(e&1){let r=B();a(0,"app-storage-page")(1,"app-storage-toolbar"),k(2,vn,2,1,"ng-template",3),a(3,"ya-page-button",4),g("clicked",function(){_(r);let v=P(6);return b(v.click())}),l(4," Upload files "),a(5,"input",5,0),g("change",function(){return _(r),b(i.uploadObjects())}),o()(),a(7,"ya-page-button",6),g("clicked",function(){return _(r),b(i.createFolder())}),l(8," Create folder "),o(),a(9,"ya-page-button",7),g("clicked",function(){return _(r),b(i.deleteSelectedObjects())}),l(10," Delete "),o(),a(11,"ya-page-button",8),u(12,"async"),g("clicked",function(){return _(r),b(i.togglePreview())}),l(13," Preview panel "),o()(),a(14,"div",9,1),u(16,"async"),g("dragenter",function(v){return _(r),b(i.dragEnter(v))}),a(17,"div",10),u(18,"async"),g("dragover",function(v){return _(r),b(i.dragOver(v))})("dragleave",function(v){return _(r),b(i.dragLeave(v))})("drop",function(v){return _(r),b(i.drop(v))}),o(),a(19,"mat-sidenav-container",11)(20,"mat-sidenav",12),u(21,"async"),u(22,"async"),a(23,"div",13),g("mousedown",function(v){return _(r),b(i.resizeMouseDown(v))}),o(),w(24,kn,1,1,"img",14)(25,xn,5,0,"div",15),o(),a(26,"mat-sidenav-content")(27,"ya-panel"),f(28,"app-bucket-page-tabs",16),w(29,Sn,6,6,"div",17),u(30,"async"),w(31,$n,18,3,"table",18)(32,Nn,2,0,"ya-empty-message"),o()()()()()}if(e&2){let r;c(9),m("disabled",!i.selection.hasValue()),c(2),m("icon",C(12,15,i.showPreview$)?"image_not_supported":"image"),c(3),T("active",C(16,17,i.dragActive$)),c(3),T("hide",!C(18,19,i.dragActive$)),c(2),m("autosize",!0),c(),$e("width",C(21,21,i.previewWidth$)+"px"),m("opened",C(22,23,i.showPreview$))("disableClose",!1),c(4),D(i.selection.selected.length===1&&i.isImage(i.selection.selected[0])?24:25),c(4),m("bucket",i.name),c(),D((r=C(30,25,i.breadcrumb$))?29:-1,r),c(2),D(i.dataSource&&i.dataSource.data.length?31:32)}},dependencies:[Z,J,Me,K,x,H,Kt,Ge,He,Qe,Xt,Ce,qt,ze,Zt,ei,Jt,Xe,Je,Ze,Ke,et,tt,it,nt,ai,oi,si,lt,rt,ct,ke,st,G,ve,_i,xe],styles:["mat-toolbar[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;background-color:#fff;box-sizing:content-box;color:#000000a7}mat-toolbar-row[_ngcontent-%COMP%]{padding-left:24px}.droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto;user-select:none;-webkit-user-select:none}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10;user-select:none;-webkit-user-select:none}  .progress-dialog .mat-mdc-dialog-container{box-shadow:none;padding:0;overflow:hidden}  .progress-dialog .mat-mdc-dialog-content{overflow:hidden}.mat-sidenav-container[_ngcontent-%COMP%]{height:100%;width:100%;background-color:inherit}.mat-sidenav-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]{background-color:#000}.mat-sidenav[_ngcontent-%COMP%]   .mat-drawer-inner-container[_ngcontent-%COMP%]{overflow:hidden!important}.resize-handle[_ngcontent-%COMP%]{position:absolute;background-color:#000;top:0;left:0;width:20px;bottom:0;cursor:ew-resize;user-select:none;-webkit-user-select:none}.mat-sidenav-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:2em;max-width:calc(100% - 5em);max-height:calc(100% - 5em)}"],changeDetection:0});var Ct=Pe;var Le=class Le{};Le.\u0275fac=function(e){return new(e||Le)},Le.\u0275cmp=h({type:Le,selectors:[["app-bucket-placeholder"]],decls:1,vars:0,template:function(e,i){e&1&&f(0,"router-outlet")},dependencies:[Ne],encapsulation:2,changeDetection:0});var ht=Le;function Un(n,t){if(n&1&&(f(0,"ya-page-icon-button",3),l(1)),n&2){let e=d();c(),j(" ",e.name," ")}}function zn(n,t){if(n&1&&(a(0,"dt"),l(1,"Directory"),o(),a(2,"dd"),l(3),o()),n&2){let e=d();c(3),M(e.directory)}}function Yn(n,t){if(n&1&&(a(0,"div",2)(1,"dl",4)(2,"dt"),l(3,"Created"),o(),a(4,"dd"),l(5),u(6,"datetime"),u(7,"nvl"),o(),a(8,"dt"),l(9,"Location"),o(),a(10,"dd"),l(11),o(),w(12,zn,4,1),o(),a(13,"h3"),l(14,"Bucket size"),o(),a(15,"dl",4)(16,"dt"),l(17,"Limit"),o(),a(18,"dd"),l(19),u(20,"formatBytes"),u(21,"nvl"),o(),a(22,"dt"),l(23,"Used"),o(),a(24,"dd"),l(25),u(26,"formatBytes"),u(27,"nvl"),o(),a(28,"dt"),l(29,"Available"),o(),a(30,"dd"),l(31),u(32,"formatBytes"),o()(),a(33,"h3"),l(34,"Object count"),o(),a(35,"dl",4)(36,"dt"),l(37,"Limit"),o(),a(38,"dd"),l(39),u(40,"nvl"),o(),a(41,"dt"),l(42,"Used"),o(),a(43,"dd"),l(44),u(45,"nvl"),o(),a(46,"dt"),l(47,"Available"),o(),a(48,"dd"),l(49),o()()()),n&2){let e=t,i=d();c(5),M(L(7,11,C(6,9,e.created),"-")),c(6),M(e.location.description),c(),D(e.directory?12:-1),c(7),M(L(21,16,C(20,14,e.maxSize),"-")),c(6),M(L(27,21,C(26,19,e.size),"-")),c(6),M(C(32,24,i.zeroOrMore(e.maxSize-e.size))),c(8),M(L(40,26,e.maxObjects,"-")),c(5),M(L(45,29,e.numObjects,"-")),c(5),M(i.zeroOrMore(e.maxObjects-e.numObjects))}}var Ie=class Ie{constructor(t,e,i){this.bucket$=new Y(null);this.name=t.snapshot.parent.paramMap.get("name"),i.setTitle(this.name+": Properties"),this.storageClient=e.createStorageClient(),this.storageClient.getBucket(this.name).then(r=>{this.bucket$.next(r)})}bucketSizePercentage(t,e=!1){var i=100*t.size/t.maxSize;return e?Math.min(100,i):i}objectCountPercentage(t,e=!1){var i=100*t.numObjects/t.maxObjects;return e?Math.min(100,i):i}zeroOrMore(t){return Math.max(0,t)}};Ie.\u0275fac=function(e){return new(e||Ie)(p(me),p(E),p(se))},Ie.\u0275cmp=h({type:Ie,selectors:[["ng-component"]],decls:7,vars:4,consts:[["app-storage-toolbar-label",""],[3,"bucket"],[1,"small",2,"margin-top","16px"],["routerLink","/storage/buckets","icon","arrow_back"],[1,"dl-horizontal"]],template:function(e,i){if(e&1&&(a(0,"app-storage-page")(1,"app-storage-toolbar"),k(2,Un,2,1,"ng-template",0),o(),a(3,"ya-panel"),f(4,"app-bucket-page-tabs",1),w(5,Yn,50,32,"div",2),u(6,"async"),o()()),e&2){let r;c(4),m("bucket",i.name),c(),D((r=C(6,2,i.bucket$))?5:-1,r)}},dependencies:[Z,J,Me,K,x,H,ct,ke,G,ve,xe,mt],styles:[".progress[_ngcontent-%COMP%]{display:inline-block;width:100px;position:relative;text-align:center;margin-right:5px;background-color:#eee;border:1px solid rgba(0,0,0,.1)}.fill[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;width:30%;background-color:#009e87;background:linear-gradient(to bottom,#009e87,#bce3dd 50%,#009e87)}.label[_ngcontent-%COMP%]{position:absolute;inset:0;margin:0 auto}"],changeDetection:0});var vt=Ie;var Re=class Re{};Re.\u0275fac=function(e){return new(e||Re)},Re.\u0275cmp=h({type:Re,selectors:[["ng-component"]],decls:5,vars:4,consts:[["messageBar",""],[1,"storage-page-content"]],template:function(e,i){if(e&1&&(f(0,"ya-message-bar",null,0),a(2,"div",1),u(3,"async"),f(4,"router-outlet"),o()),e&2){let r=P(1);c(2),T("message-bar-visible",C(3,2,r.show$))}},dependencies:[x,Ne,pi,G],styles:[".storage-page-content[_ngcontent-%COMP%]{position:absolute;inset:48px 0 0;background-color:var(--y-background-color)}.storage-page-content.message-bar-visible[_ngcontent-%COMP%]{top:112px}mat-toolbar[_ngcontent-%COMP%]{background-color:#fcfcfc;border-bottom:1px solid #d3d3d3;box-sizing:content-box;color:#000000a7}"],changeDetection:0});var kt=Re;var lr=[{path:"",canActivate:[bi,hi],canActivateChild:[Ci],runGuardsAndResolvers:"always",component:kt,children:[{path:"",pathMatch:"full",redirectTo:"buckets"},{path:"buckets",children:[{path:"",pathMatch:"full",component:dt,data:{hasSidebar:!1}},{path:":name",children:[{path:"",pathMatch:"full",redirectTo:"objects"},{path:"objects",component:ht,children:[{path:"**",component:Ct,data:{hasSidebar:!1}}]},{path:"properties",component:vt,data:{hasSidebar:!1}}]}]}]}];export{lr as ROUTES};
