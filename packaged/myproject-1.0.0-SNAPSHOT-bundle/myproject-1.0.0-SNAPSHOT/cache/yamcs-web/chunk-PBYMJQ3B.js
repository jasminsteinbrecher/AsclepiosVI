import{a as cc}from"./chunk-QKCIWDFA.js";import{a as Hn,b as da,c as lc,e as sc}from"./chunk-6X2UVTWO.js";import{a as tc,b as ic}from"./chunk-7SRE5ACE.js";import{a as nc}from"./chunk-CS6YXD3A.js";import{a as pi}from"./chunk-E6DCO4NE.js";import{a as wl}from"./chunk-SIU2FQZX.js";import{e as rc,f as oc}from"./chunk-LWQLZ5XB.js";import{a as ma}from"./chunk-WGTQMYTO.js";import"./chunk-GVFSCYYF.js";import{a as Pl,b as ac}from"./chunk-L67MW52F.js";import{$f as Vr,Aa as F,Ac as As,Ag as oa,Ba as fs,Bc as Jt,Bf as me,Bg as bi,C as mr,Ca as E,Cb as Mt,Cc as ye,Cf as Ci,Cg as la,D as dr,Da as vr,De as Dr,Dg as ze,Ea as h,Eb as Sl,Ee as ea,F as k,Fa as _s,Fb as Cr,Fc as Se,Ff as ii,Fg as $r,Fh as $,G as A,Ga as gs,Gb as Pe,Gc as Ms,Gg as js,Gh as El,H as ur,Ha as vs,Hb as _i,Hc as Rs,Hg as it,Hh as kl,I as ms,Ia as ge,Ib as Qe,Ic as Ls,If as B,Ja as fe,Jb as Ee,Je as Ut,Jf as we,K as ds,Ka as _e,Kb as Zi,Ke as gi,Kf as W,La as ys,Lc as Is,Lf as St,Ma as Cs,Me as vi,N as Gt,Na as K,Ne as ta,Ng as Hr,O as us,Oa as kt,Pa as ae,Pc as ei,Pe as yi,Pg as zs,Qe as Pr,Qf as aa,Qg as xi,Ra as p,Rc as Rt,Re as Er,Rf as wt,Sa as X,Se as kr,Sf as na,T as hr,Ta as O,Tc as Sr,Tf as ra,Tg as Ws,Ua as Qt,Uc as ht,Uf as ai,Ug as si,V as c,Va as bs,Vf as Nr,Vg as qt,Wc as Qi,Wf as Hs,Wg as sa,Xc as Ki,Y as S,Ya as fi,Yd as Ns,Ye,Yf as ni,Z as fr,Za as Q,Ze as ft,Zf as Ys,Zg as Si,_ as N,_a as Ei,_e as _t,_f as ri,_g as Xs,a as mt,aa as _r,ab as xs,af as st,b as Pt,ba as gr,bb as T,bd as wr,be as Tr,bf as Ge,bg as ke,ca as Wi,cb as D,cg as Ot,d as xl,da as I,db as We,dc as ks,df as Ue,dg as Fr,dh as ca,eb as ki,ef as gt,eg as oi,eh as Zs,f as G,fa as dt,gd as Tl,gf as xt,gh as Yr,h as cs,hf as qe,hh as Qs,ib as ot,id as $n,ie as Vs,ig as Gs,ja as hs,jb as Ss,jc as Kt,jd as Os,jf as je,k as zi,ka as C,kb as At,kf as Lt,kg as et,kh as Gr,la as Ft,lc as br,lf as Je,lg as li,lh as Ks,m as sr,ma as b,mf as It,mg as Ve,n as cr,na as oe,nb as ws,ne as Re,nf as ia,ng as Us,oa as le,ob as yr,oc as $e,oe as He,of as Dl,og as vt,oh as pa,pa as se,pe as Le,pg as tt,ph as Js,qa as g,qc as Ce,qe as Ie,qg as qs,ra as l,rb as Ts,re as lt,rh as ec,sa as o,sb as ie,sc as pe,se as Oe,sh as Ur,t as pr,ta as x,tb as Ds,tc as ve,te as Ne,tf as Ar,th as qr,ua as Bt,ub as Xi,uc as xr,ue as ti,uf as Mr,va as Et,vc as ut,ve as Ji,vf as Rr,wa as Tt,wc as at,wf as Lr,wh as ci,xa as H,xc as ne,xf as $s,xg as Br,ya as Y,yb as Ps,yc as Ke,ye as Fs,yf as Ir,yg as Nt,z as ps,za as Bn,zb as Es,ze as Bs,zf as Or}from"./chunk-OXOWQRWE.js";var ua=class ua{constructor(i){this.dialogRef=i}confirmDiscard(){this.dialogRef.close(!0)}};ua.\u0275fac=function(e){return new(e||ua)(S(Re))},ua.\u0275cmp=N({type:ua,selectors:[["app-display-file-page-dirty-dialog"]],decls:8,vars:0,consts:[["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){e&1&&(l(0,"mat-dialog-content")(1,"p"),p(2,"You have unsaved changes on the current page. Do you want to discard them?"),o()(),l(3,"mat-dialog-actions",0)(4,"ya-button",1),p(5,"CANCEL"),o(),l(6,"ya-button",2),E("click",function(){return a.confirmDiscard()}),p(7,"DISCARD"),o()())},dependencies:[$,Ie,Ne,Oe,me],encapsulation:2});var jr=ua;var pc=t=>dr(Yn).canDeactivate(t),Ai=class Ai{constructor(i,e,a){this.dialog=i;this.authService=e;this.dialogOpen$=new G(!1);this.bucket=a.getDisplayBucket()}canDeactivate(i){return this.dialogOpen$.value?new xl(e=>{this.dialogRef.afterClosed().subscribe({next:a=>{e.next(a===!0),e.complete()},error:()=>{e.next(!1),e.complete()}})}):i.hasPendingChanges()&&this.mayManageDisplays()?new xl(e=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(jr,{width:"400px"}),this.dialogRef.afterClosed().subscribe({next:a=>{this.dialogOpen$.next(!1),e.next(a===!0),e.complete()},error:()=>{this.dialogOpen$.next(!1),e.next(!1),e.complete()}})}):cs(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}};Ai.\u0275fac=function(e){return new(e||Ai)(mr(Le),mr(St),mr(we))},Ai.\u0275prov=ps({token:Ai,factory:Ai.\u0275fac});var Yn=Ai;function Uc(t,i){if(t&1&&Tt(0,"img",6),t&2){let e=h();fs("src",e.url,hr)}}var ha=class ha{constructor(i,e){this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.url=this.storageClient.getObjectURL(this.bucket,i),Promise.resolve()}hasPendingChanges(){return!1}};ha.\u0275fac=function(e){return new(e||ha)(S(W),S(we))},ha.\u0275cmp=N({type:ha,selectors:[["app-image-viewer"]],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src"]],template:function(e,a){e&1&&(ur(),Bt(0,"svg",0)(1,"pattern",1),Tt(2,"rect",2)(3,"rect",3),Et(),Tt(4,"rect",4),Et(),ms(),Bt(5,"div",5),C(6,Uc,1,1,"img",6),Et()),e&2&&(c(6),b(a.url?6:-1))},dependencies:[$],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0});var zr=ha;function qc(t,i){if(t&1){let e=F();l(0,"ya-page-button",1),p(1,"View"),o(),l(2,"mat-menu",2,0)(4,"button",3),E("click",function(){k(e);let n=h();return A(n.resetZoom())}),l(5,"mat-icon"),p(6,"aspect_ratio"),o(),p(7," Actual size "),o(),l(8,"button",3),E("click",function(){k(e);let n=h();return A(n.fitZoom())}),l(9,"mat-icon"),p(10,"fit_screen"),o(),p(11," Zoom to fit "),o(),l(12,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomIn())}),l(13,"mat-icon"),p(14,"add_circle"),o(),p(15," Zoom in "),o(),l(16,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomOut())}),l(17,"mat-icon"),p(18,"remove_circle_outline"),o(),p(19," Zoom out "),o()()}if(t&2){let e=K(3);g("matMenuTriggerFor",e)}}var fa=class fa{constructor(){this.initialized$=new G(!1)}init(i){this.viewer=i,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}};fa.\u0275fac=function(e){return new(e||fa)},fa.\u0275cmp=N({type:fa,selectors:[["app-opi-display-viewer-controls"]],decls:2,vars:3,consts:[["viewMenu","matMenu"],["dropdown","true",3,"matMenuTriggerFor"],["overlapTrigger","false","xPosition","after","yPosition","below",1,"ya-menu"],["mat-menu-item","",3,"click"]],template:function(e,a){e&1&&(C(0,qc,20,1),T(1,"async")),e&2&&b(D(1,1,a.initialized$)?0:-1)},dependencies:[$,Rt,Qi,ht,Ki,vt,ie],encapsulation:2});var Wr=fa;var Xr=class{constructor(i){this.messageService=i}writeInfo(i){this.messageService.showInfo(i)}writeError(i){this.messageService.showError(i)}writeWarning(i){this.messageService.showInfo(i)}};var Zr=class{constructor(i){this.prefix=i}resolve(i){let e;if(i.name==="Liberation Sans"?(e="LiberationSans-Regular.woff2",i.bold&&i.italic?e="LiberationSans-BoldItalic.woff2":i.bold?e="LiberationSans-Bold.woff2":i.italic&&(e="LiberationSans-Italic.woff2")):i.name==="Liberation Mono"?(e="LiberationMono-Regular.woff2",i.bold&&i.italic?e="LiberationMono-BoldItalic.woff2":i.bold?e="LiberationMono-Bold.woff2":i.italic&&(e="LiberationMono-Italic.woff2")):i.name==="Liberation Serif"&&(e="LiberationSerif-Regular.woff2",i.bold&&i.italic?e="LiberationSerif-BoldItalic.woff2":i.bold?e="LiberationSerif-Bold.woff2":i.italic&&(e="LiberationSerif-Italic.woff2")),e)return new FontFace(i.name,`url(${this.prefix}media/${e})`,{weight:i.bold?"bold":"normal",style:i.italic?"italic":"normal"})}};var Qr=class{constructor(i){this.watermarkObserver=i;this.dirty=!1;this.valueRange=[null,null];this.archiveSamples=[];this.bufferSize=500;this.bufferWatermark=400;this.pointer=0;this.alreadyWarned=!1;this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(i){this.archiveSamples=i??[],this.dirty=!0}setValueRange(i){this.valueRange=i}addRealtimeValue(i){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=i,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){let i=this.realtimeBuffer.filter(n=>n!==void 0),e=null;i.length>0&&(e=i[0][0].getTime());let a=this.archiveSamples.filter(n=>e===null||n[0].getTime()<e).concat(i).sort((n,r)=>n[0].getTime()-r[0].getTime());return{valueRange:this.valueRange,samples:a}}};var _a=class{constructor(i,e,a){this.yamcs=i;this.configService=a;this.extendRequestedRange=!0;this.resolution=6e3;this.loading$=new G(!1);this.data$=new G({valueRange:[null,null],samples:[]});this.parameters$=new G([]);this.latestRealtimeValues=new Map;this.syncSubscription=e.syncFast(()=>this.plotNow()),this.plotBuffer=new Qr(()=>{this.reloadVisibleRange()})}plotNow(){if(this.plotBuffer.dirty&&!this.loading$.getValue()){let i=this.plotBuffer.snapshot();this.data$.next({samples:i.samples,valueRange:i.valueRange}),this.plotBuffer.dirty=!1}}addParameter(...i){if(this.parameters$.next([...this.parameters$.value,...i]),this.realtimeSubscription){let e=i.map(a=>({name:a.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(i){let e=this.parameters$.value.filter(a=>a.qualifiedName!==i);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(i,e){this.visibleStart=i,this.visibleStop=e}updateWindow(i,e,a){this.loading$.next(!0);let n=this.extendRequestedRange?e.getTime()-i.getTime():0,r=new Date(i.getTime()-n),s=new Date(e.getTime()+n),d=this.parameters$.value,m=[];for(let v of d)m.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,v.qualifiedName,{start:r.toISOString(),stop:s.toISOString(),count:this.resolution,fields:["time","n","avg","min","max"],gapTime:3e5,source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"}));let u=Promise.allSettled(m);return this.lastLoadPromise=u,u.then(v=>{if(this.lastLoadPromise===u){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=i,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;let f=[];for(let _=0;_<v.length;_++){let w=v[_];w.status==="fulfilled"?f.push(this.processSamples(w.value)):(console.warn(`Failed to retrieve samples for ${d[_].qualifiedName}`,w.reason),f.push([]))}let y=this.mergeSeries(...f);this.plotBuffer.setArchiveData(y),this.plotBuffer.setValueRange(a),this.plotNow(),this.lastLoadPromise=null}})}connectRealtime(){let i=this.parameters$.value.map(e=>({name:e.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=mt(mt({},this.idMapping),e.mapping)),e.values&&e.values.length&&this.processRealtimeDelivery(e.values)})}addToRealtimeSubscription(i){this.realtimeSubscription.addReplyListener(()=>{this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})})}processRealtimeDelivery(i){for(let r of i){let s=null,d=B.convertValueToNumber(r.engValue);d!==null&&(r.acquisitionStatus==="EXPIRED"?s=null:r.acquisitionStatus==="ACQUIRED"&&(s=[d,d,d]));let m=this.idMapping[r.numericId];this.latestRealtimeValues.set(m.name,s)}let e=new Date;e.setTime(Date.parse(i[0].generationTime));let a=this.parameters$.value.map(r=>this.latestRealtimeValues.get(r.qualifiedName)||null),n=[e,...a];this.plotBuffer.addRealtimeValue(n)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription?.cancel(),this.syncSubscription?.unsubscribe()}processSamples(i){let e=[];for(let a of i){let n=new Date;if(n.setTime(Date.parse(a.time)),a.n>0){let r=a.avg,s=a.min,d=a.max;this.minValue===void 0?(this.minValue=s,this.maxValue=d):(this.minValue>s&&(this.minValue=s),this.maxValue<d&&(this.maxValue=d)),e.push([n,[s,r,d]])}else e.push([n,null])}return e}mergeSeries(...i){if(i.length===1)return i[0];let e=null;for(let n=0;n<i.length;n++)i[n].length>0&&(e=i[n]);if(e!==null)for(let n=0;n<i.length;n++)i[n].length===0&&(i[n]=e.map(r=>[r[0],null]));let a=i[0];for(let n=1;n<i.length;n++){let r=[],s=0,d=0,m=[],u=null,v=a,f=i[n];for(;s<v.length||d<f.length;){let y=s<v.length?v[s]:null,_=d<f.length?f[d]:null;y&&_?y[0].getTime()===_[0].getTime()?(m=y.slice(1),u=_[1],r.push([y[0],...m,u]),s++,d++):y[0].getTime()<_[0].getTime()?(m=y.slice(1),r.push([y[0],...m,u]),s++):(u=_[1],r.push([_[0],...m,u]),d++):y?(m=y.slice(1),r.push([y[0],...m,u]),s++):_&&(u=_[1],r.push([_[0],...m,u]),d++)}a=r}return a}};var Kr=class{constructor(i,e,a,n,r){this.yamcs=a;this.processedSamples=[];this.subscriptions=[];this.dataSource=new _a(a,n,r),this.dataSource.extendRequestedRange=!1,this.dataSource.resolution=400,this.dataSource.addParameter({qualifiedName:i}),this.yamcs.range$.subscribe(d=>{let m=this.yamcs.getMissionTime(),u=B.subtractDuration(m,d);this.dataSource.updateWindow(u,m,[null,null])}),this.dataSource.data$.subscribe(d=>{this.processSamples(d),e.requestRepaint()});let s=n.sync(()=>{let d=this.yamcs.getMissionTime(),m=B.subtractDuration(d,this.yamcs.range$.value),u=m.getTime();for(let v=0;v<this.processedSamples.length;v++)if(this.processedSamples[v].x>=u&&v>0){this.processedSamples.splice(0,v);break}this.dataSource.updateWindowOnly(m,d),this.addEdgeSamples(this.processedSamples),e.requestRepaint()});this.subscriptions.push(s),this.backfillSubscription=a.yamcsClient.createBackfillingSubscription({instance:a.instance},d=>{d.finished&&this.dataSource.reloadVisibleRange()})}processSamples(i){let e=[];for(let a of i.samples){let n=a[0].getTime();if(a[1]){let r=a[1][1];e.push({x:n,y:r})}else e.push({x:n,y:null})}this.addEdgeSamples(e),this.processedSamples=e}addEdgeSamples(i){let{visibleStart:e,visibleStop:a}=this.dataSource;if(e&&a){let n={x:e.getTime(),y:null},r={x:a.getTime(),y:null};i.length?(i[0].x>n.x&&i.splice(0,0,n),i[i.length-1].x<r.x&&i.push(r)):(i.push(n),i.push(r))}}getSamples(){return this.processedSamples}disconnect(){this.backfillSubscription?.cancel(),this.subscriptions.forEach(i=>i.unsubscribe()),this.dataSource?.disconnect()}};var Jr=class extends lc{constructor(e,a){super(a);this.storageClient=e}resolve(e,a){if(e.startsWith("ys://")){let n=e.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(n)return this.storageClient.getObjectURL(n[1],n[2])}return super.resolve(e,a)}};var eo=class{constructor(i,e){this.yamcs=i;this.messageService=e}issueCommand(i,e){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,i,{args:e}).catch(a=>this.messageService.showError(a))}runProcedure(i,e){let a={};e&&Object.keys(e).forEach(n=>a[n]=String(e[n])),this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,i,{arguments:a}).catch(n=>this.messageService.showError(n))}};var jc=["frameInner"],zc=["displayContainer"],Un="MDB:OPS Name",Mi="ops://",Wc="args.",ga=class ga{constructor(i,e,a,n,r,s,d,m){this.yamcs=i;this.router=e;this.route=a;this.synchronizer=n;this.messageService=r;this.baseHref=s;this.configService=d;this.formatter=m;this.idMapping={};this.idInfo={};this.pvsByName=new Map;this.subscriptionDirty=!1;this.storageClient=i.createStorageClient(),this.bucket=d.getDisplayBucket()}setViewerContainerEl(i){this.viewerContainerEl=i}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();let i=[];for(let e of this.pvsByName.keys())i.push(this.getIdForPvName(e));i.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{if(e.mapping&&(this.idMapping=e.mapping),e.info){this.idInfo=e.info;for(let a in e.info){let n=e.mapping[a],r=e.info[a],s=this.getPVById(n);s&&(r.enumValues&&(s.labels=r.enumValues.map(d=>d.label)),s.writable=r.dataSource==="LOCAL"||r.dataSource==="EXTERNAL1"||r.dataSource==="EXTERNAL2"||r.dataSource==="EXTERNAL3")}}for(let a of e.invalid||[]){let n=this.getPVById(a);n&&(n.disconnected=!0)}if(e.values?.length){let a=new Map;for(let n of e.values){n.id=this.idMapping[n.numericId];let r=n.id.name;n.id.namespace===Un&&(r=Mi+r);let s=this.idInfo[n.numericId];a.set(r,this.toSample(n,s))}this.display.setValues(a)}}))}}getIdForPvName(i){return i.startsWith(Mi)?{namespace:Un,name:i.substring(Mi.length)}:{name:i}}getPVById(i){let e=i.name;return i.namespace===Un&&(e=Mi+e),this.display.getPV(e)}toSample(i,e){let a=B.toDate(i.generationTime),n=this.toAlarmSeverity(i),r={time:a,severity:n,value:void 0};return i.engValue&&(r.value=B.convertValue(i.engValue),i.engValue.type==="ENUMERATED"?r.valueIndex=Number(i.engValue.sint64Value):i.engValue.type==="BINARY"&&(r.typeHint="BINARY_STRING")),e.units&&(r.units=e.units),r}toAlarmSeverity(i){if(i.acquisitionStatus==="EXPIRED"||i.acquisitionStatus=="NOT_RECEIVED"||i.acquisitionStatus==="INVALID")return da.INVALID;if(!i.monitoringResult)return da.NONE;switch(i.monitoringResult){case"DISABLED":case"IN_LIMITS":return da.NONE;case"WATCH":case"WARNING":case"DISTRESS":return da.MINOR;case"CRITICAL":case"SEVERE":return da.MAJOR}}init(i){let e=this.displayContainer.nativeElement;this.display=new sc(e);let a=this.configService.getConfig().opi;this.display.disconnectedColor=Hn(a.disconnectedColor),this.display.invalidColor=Hn(a.invalidColor),this.display.majorColor=Hn(a.majorColor),this.display.minorColor=Hn(a.minorColor),this.display.utc=this.formatter.isUTC(),this.display.imagesPrefix=this.baseHref+"media/",this.display.setPathResolver(new Jr(this.storageClient,this.display)),this.display.setConsoleHandler(new Xr(this.messageService)),this.display.setFontResolver(new Zr(this.baseHref));let n="";i.lastIndexOf("/")!==-1&&(n=i.substring(0,i.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new eo(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",u=>{let v,f=`?c=${this.yamcs.context}&range=${this.yamcs.getTimeRange()}`;if(u.path.startsWith("/")?v=`/telemetry/displays/files${u.path}${f}`:v=`/telemetry/displays/files/${n}${u.path}${f}`,u.args)for(let y in u.args)v+="&"+Wc+encodeURIComponent(y)+"="+encodeURIComponent(u.args[y]);this.router.navigateByUrl(v)}),this.display.addEventListener("closedisplay",u=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",u=>{u.pvName.startsWith("/")?this.router.navigateByUrl(`/telemetry/parameters${u.pvName}/-/summary?c=${this.yamcs.context}`):u.pvName.startsWith(Mi)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:Un,name:u.pvName.substring(6)}).then(v=>{this.router.navigateByUrl(`/telemetry/parameters${v.qualifiedName}/-/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${u.pvName}`)}),this.display.addEventListener("runcommand",u=>{this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,u.command,{args:u.args}).catch(v=>this.messageService.showError(v))}),this.display.addEventListener("runstack",u=>{let v=u.path.split("/"),f=[];for(let w of v)w==="."||(w===".."?f.pop():f.push(w));let y=f.join("/"),_=this.storageClient.getObjectURL(this.bucket,"");if(y.startsWith(_)){let w=y.slice(_.length);this.yamcs.yamcsClient.startActivity(this.yamcs.instance,{type:"COMMAND_STACK",args:{processor:this.yamcs.processor,bucket:this.bucket,stack:w}}).catch(P=>this.messageService.showError(P))}else this.messageService.showError("Failed to resolve stack path")}),this.display.addEventListener("runprocedure",u=>{this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,u.procedure,{arguments:u.args}).catch(v=>this.messageService.showError(v))}),this.display.addProvider(this),this.display.absPrefix=this.storageClient.getObjectURL(this.bucket,"");let r=this.storageClient.getObjectURL(this.bucket,i),s={},d=this.route.snapshot.queryParams;for(let u in d)u.startsWith("args.")&&(s[u.substring(5)]=d[u]);let m=this.display.setSource(r,s);return m.then(()=>{let u;!this.display.transparent&&this.display.instance?u=this.display.instance.backgroundColor.hex():u="unset",this.frameInner.nativeElement.style.backgroundColor=u,this.syncSubscription=this.synchronizer.syncFast(()=>this.updateSubscription()),this.updateSubscription()}),m}canProvide(i){return!0}startProviding(i){for(let e of i)this.pvsByName.set(e.name,e);this.subscriptionDirty=!0}stopProviding(i){for(let e of i)this.pvsByName.delete(e.name);this.subscriptionDirty=!0}writeValue(i,e){let a=i;i.startsWith(Mi)&&(a=Un+"/"+i.substring(Mi.length)),this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,a,{type:"STRING",stringValue:String(e)}).then(()=>this.messageService.showInfo(`Parameter ${i} set to ${e}`)).catch(n=>this.messageService.showError(n))}createHistoricalDataProvider(i,e){let{yamcs:a,synchronizer:n}=this;if(this.configService.getConfig().tmArchive)return new Kr(i,e,a,n,this.configService)}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){let i=this.display.instance;if(i&&this.viewerContainerEl){let e=this.viewerContainerEl.clientWidth,a=this.viewerContainerEl.clientHeight,{width:n,height:r}=i.unscaledBounds,s=e/n,d=a/r;this.display.scale=Math.min(s,d)}}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.parameterSubscription?.cancel(),this.display.destroy()}};ga.\u0275fac=function(e){return new(e||ga)(S(W),S(Qe),S(Pe),S(It),S(Je),S(ws),S(we),S(aa))},ga.\u0275cmp=N({type:ga,selectors:[["app-opi-display-viewer"]],viewQuery:function(e,a){if(e&1&&(ge(jc,5),ge(zc,7)),e&2){let n;fe(n=_e())&&(a.frameInner=n.first),fe(n=_e())&&(a.displayContainer=n.first)}},decls:4,vars:0,consts:[["frameInner",""],["displayContainer",""],[1,"frame-inner"],[1,"display-container"]],template:function(e,a){e&1&&(Bt(0,"div",2,0),Tt(2,"div",3,1),Et())},dependencies:[$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:table}.frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center;line-height:0}.display-container[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0});var to=ga;function Zc(t,i){if(t&1&&(l(0,"mat-option",6),T(1,"memberPath"),p(2),T(3,"memberPath"),o()),t&2){let e=i.$implicit;g("value",D(1,2,e)),c(2),O(" ",D(3,4,e)," ")}}function Qc(t,i){if(t&1&&(l(0,"span",7),p(1),o()),t&2){let e=h();c(),X(e.hint)}}var va=class va{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new ne(null,[Ce.required]);this.label=a.label||"Search parameter",this.okLabel=a.okLabel||"SELECT",this.limit=a.limit||10,this.hint=a.hint}ngOnInit(){let i=this.data.exclude||[];this.filteredOptions=this.parameter.valueChanges.pipe(cr(300),pr(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:this.limit,searchMembers:!0})),zi(e=>e.parameters||[]),zi(e=>e.filter(a=>{for(let n of i){let r=B.getMemberPath(a);if(n===r)return!1}return!0})))}select(){this.dialogRef.close(this.parameter.value)}};va.\u0275fac=function(e){return new(e||va)(S(Re),S(W),S(He))},va.\u0275cmp=N({type:va,selectors:[["app-select-parameter-dialog"]],decls:16,vars:9,consts:[["auto",""],["mat-dialog-title",""],[1,"ya-form"],[3,"label"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[1,"hint"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=F();l(0,"h2",1),p(1),o(),l(2,"mat-dialog-content",2)(3,"ya-field",3),x(4,"input",4),l(5,"mat-autocomplete",5,0),le(7,Zc,4,6,"mat-option",6,oe),T(9,"async"),o(),C(10,Qc,2,1,"span",7),o()(),l(11,"mat-dialog-actions",8)(12,"ya-button",9),p(13,"CANCEL"),o(),l(14,"ya-button",10),E("click",function(){return k(n),A(a.select())}),p(15),o()()}if(e&2){let n=K(6);c(),X(a.label),c(2),g("label",a.label),c(),g("formControl",a.parameter)("matAutocomplete",n),c(3),se(D(9,7,a.filteredOptions)),c(3),b(a.hint?10:-1),c(4),g("disabled",!a.parameter.valid),c(),O(" ",a.okLabel," ")}},dependencies:[$,$e,pe,Jt,Pr,wr,Er,Ie,lt,Ne,Oe,me,ke,ie,Gr],encapsulation:2,changeDetection:0});var mi=va;var ya=class ya{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.headerOptions=[{id:"QUALIFIED_NAME",label:"Qualified names"},{id:"SHORT_NAME",label:"Short names"},{id:"NONE",label:"None"}];this.downloadURL$=new G(null);this.form=new ut({start:new ne(null),stop:new ne(null),delimiter:new ne(null,Ce.required),interval:new at(null),header:new ne(null,Ce.required)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:B.toISOString(n),stop:B.toISOString(r),delimiter:"TAB",header:"QUALIFIED_NAME",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={delimiter:this.form.value.delimiter,header:this.form.value.header};this.data.parameterIds&&(i.parameters=this.data.parameterIds),this.data.list&&(i.list=this.data.list),this.form.value.start&&(i.start=B.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=B.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval),this.data.filename&&(i.filename=this.data.filename);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}};ya.\u0275fac=function(e){return new(e||ya)(S(Re),S(W),S(He))},ya.\u0275cmp=N({type:ya,selectors:[["app-export-archive-data-dialog"]],decls:25,vars:8,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"small-tabs",3,"mat-stretch-tabs"],["label","Content"],[2,"margin-top","1em"],["label","Start"],["cdkFocusRegionstart","","formControlName","start"],["label","Stop"],["formControlName","stop"],["label","Interval (ms)","hint","(optional)"],["formControlName","interval","type","text",1,"ya-input"],["label","Format"],["label","CSV column delimiter"],["formControlName","delimiter",3,"options"],["label","Header"],["formControlName","header",3,"options"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Export archive data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-tab-group",3)(5,"mat-tab",4)(6,"div",5)(7,"ya-field",6),x(8,"ya-date-time-input",7),o(),l(9,"ya-field",8),x(10,"ya-date-time-input",9),o(),l(11,"ya-field",10),x(12,"input",11),o()()(),l(13,"mat-tab",12)(14,"div",5)(15,"ya-field",13),x(16,"ya-select",14),o(),l(17,"ya-field",15),x(18,"ya-select",16),o()()()()()(),l(19,"mat-dialog-actions",17)(20,"ya-button",18),p(21,"CANCEL"),o(),l(22,"ya-download-button",19),T(23,"async"),E("click",function(){return a.closeDialog()}),p(24," DOWNLOAD "),o()()),e&2&&(c(3),g("formGroup",a.form),c(),g("mat-stretch-tabs",!1),c(12),g("options",a.delimiterOptions),c(2),g("options",a.headerOptions),c(4),g("link",D(23,6,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,Fs,Bs,me,wt,Nr,ke,it,ie],encapsulation:2});var Ca=ya;function ep(t,i){if(t&1){let e=F();l(0,"ya-page-button",11),T(1,"async"),E("clicked",function(){k(e);let n=h(3);return A(n.save())}),p(2," SAVE "),o()}if(t&2){let e=h(3);g("disabled",!D(1,1,e.viewer.hasUnsavedChanges$))}}function tp(t,i){if(t&1){let e=F();l(0,"ya-page-button",12),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.pause())}),p(1," PAUSE "),o()}}function ip(t,i){if(t&1){let e=F();l(0,"ya-page-button",13),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.unpause())}),p(1," UNPAUSE "),o()}}function ap(t,i){if(t&1){let e=F();l(0,"ya-page-button",14),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.delete())}),p(1," DELETE "),o()}if(t&2){let e=h(3);g("disabled",e.viewer.selection.isEmpty())}}function np(t,i){if(t&1){let e=F();l(0,"ya-page-button",15),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.enableScrollView())}),p(1," SCROLL VIEW "),o()}}function rp(t,i){if(t&1){let e=F();l(0,"ya-page-button",16),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.enableStandardView())}),p(1," STANDARD VIEW "),o()}}function op(t,i){if(t&1){let e=F();C(0,ep,3,3,"ya-page-button",1),C(1,tp,2,0,"ya-page-button",2),T(2,"async"),C(3,ip,2,0,"ya-page-button",3),T(4,"async"),l(5,"ya-page-button",4),E("clicked",function(){k(e);let n=h(2);return A(n.addParameter())}),p(6,"ADD"),o(),C(7,ap,2,1,"ya-page-button",5),C(8,np,2,0,"ya-page-button",6),C(9,rp,2,0,"ya-page-button",7),l(10,"mat-menu",8,0)(12,"button",9),E("click",function(){k(e);let n=h(2);return A(n.exportArchiveData())}),p(13," Export archive data... "),o()(),x(14,"ya-page-button",10)}if(t&2){let e=i,a=K(11),n=h(2);b(n.mayManageDisplays()?0:-1),c(),b(D(2,8,n.viewer.paused$)?-1:1),c(2),b(D(4,10,n.viewer.paused$)?3:-1),c(4),b(e.scroll?-1:7),c(),b(e.scroll?-1:8),c(),b(e.scroll?9:-1),c(3),g("disabled",!e.parameters.length),c(2),g("matMenuTriggerFor",a)}}function lp(t,i){if(t&1&&(C(0,op,15,12),T(1,"async")),t&2){let e,a=h();b((e=D(1,1,a.viewer.model$))?0:-1,e)}}var ba=class ba{constructor(i,e,a,n){this.dialog=i;this.snackbar=e;this.authService=a;this.initialized$=new G(!1);this.bucket=n.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}addParameter(){this.dialog.open(mi,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.viewer.addParameter(e)})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}exportArchiveData(){let i=this.viewer.selection.selected;i.length||(i=this.viewer.getModel().parameters),this.dialog.open(Ca,{width:"400px",data:{parameterIds:i}})}};ba.\u0275fac=function(e){return new(e||ba)(S(Le),S(br),S(St),S(we))},ba.\u0275cmp=N({type:ba,selectors:[["app-parameter-table-viewer-controls"]],decls:2,vars:3,consts:[["moreMenu","matMenu"],["icon","save",3,"disabled"],["matTooltip","Pause value updates","icon","pause"],["matTooltip","Unpause value updates","icon","play_arrow"],["icon","playlist_add",3,"clicked"],["icon","delete",3,"disabled"],["icon","view_headline","iconRotate90","true"],["icon","view_headline"],["overlapTrigger","false"],["mat-menu-item","",3,"click","disabled"],["icon","more_vert",3,"matMenuTriggerFor"],["icon","save",3,"clicked","disabled"],["matTooltip","Pause value updates","icon","pause",3,"clicked"],["matTooltip","Unpause value updates","icon","play_arrow",3,"clicked"],["icon","delete",3,"clicked","disabled"],["icon","view_headline","iconRotate90","true",3,"clicked"],["icon","view_headline",3,"clicked"]],template:function(e,a){e&1&&(C(0,lp,2,3),T(1,"async")),e&2&&b(D(1,1,a.initialized$)?0:-1)},dependencies:[$,Qi,ht,Ki,Sr,vt,ie],encapsulation:2});var io=ba;var ao=class{constructor(i=10){this.pointer=0;this.latestValues=new Map;this.buf=Array(i).fill(void 0)}push(i,e){let a={};for(let n of i){let r=e[n.numericId];a[r.name]=n}this.buf[this.pointer]=a,this.pointer=(this.pointer+1)%this.buf.length;for(let n of i){let r=e[n.numericId];this.latestValues.set(r.name,n)}}getLatestValue(i){return this.latestValues.get(i)}setSize(i){this.buf=Array(i).fill(void 0),this.pointer=0}snapshot(){return this.pointer===0?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}};var sp=t=>({c:t});function cp(t,i){if(t&1){let e=F();l(0,"th",21),E("click",function(n){return k(e),K(2).toggle(),A(n.stopPropagation())}),x(1,"ya-table-checkbox",22,0),o()}if(t&2){let e=h(2);c(),g("dataSource",e.dataSource)("selection",e.selection)("transform",e.transformRowForSelection)}}function pp(t,i){if(t&1){let e=F();l(0,"td",23),E("click",function(n){return k(e),K(2).toggle(),A(n.stopPropagation())}),x(1,"ya-table-checkbox",24,0),o()}if(t&2){let e=i.$implicit,a=h(2);c(),g("dataSource",a.dataSource)("selection",a.selection)("item",e)("transform",a.transformRowForSelection)}}function mp(t,i){t&1&&(l(0,"th",25),p(1,"Name"),o())}function dp(t,i){if(t&1&&(l(0,"td",26)(1,"a",27),p(2),o()()),t&2){let e=i.$implicit,a=h(2);c(),g("routerLink","/telemetry/parameters"+e.name)("queryParams",Q(3,sp,a.yamcs.context)),c(),O(" ",e.name," ")}}function up(t,i){t&1&&(l(0,"th",25),p(1,"Severity"),o())}function hp(t,i){if(t&1&&x(0,"app-alarm-level",29),t&2){let e=h().$implicit;g("level",e.pval==null?null:e.pval.monitoringResult)}}function fp(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function _p(t,i){if(t&1&&(l(0,"td",28),C(1,hp,1,1,"app-alarm-level",29)(2,fp,2,0,"span"),o()),t&2){let e=i.$implicit;c(),b(e.pval!=null&&e.pval.monitoringResult?1:2)}}function gp(t,i){t&1&&(l(0,"th",25),p(1,"Raw"),o())}function vp(t,i){if(t&1&&(l(0,"td",30),p(1),T(2,"value"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.pval==null?null:e.pval.rawValue)||"-"," ")}}function yp(t,i){t&1&&(l(0,"th",25),p(1,"Eng"),o())}function Cp(t,i){t&1&&(l(0,"span"),p(1,"\u2193"),o())}function bp(t,i){t&1&&(l(0,"span"),p(1,"\u2191"),o())}function xp(t,i){if(t&1&&(l(0,"ya-expirable",31),p(1),T(2,"value"),C(3,Cp,2,0,"span"),C(4,bp,2,0,"span"),o()),t&2){let e=h().$implicit;g("pval",e.pval),c(),O(" ",D(2,4,e.pval==null?null:e.pval.engValue)||"-"," "),c(2),b((e.pval==null?null:e.pval.rangeCondition)==="LOW"?3:-1),c(),b((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?4:-1)}}function Sp(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function wp(t,i){if(t&1&&(l(0,"td",30),C(1,xp,5,6,"ya-expirable",31)(2,Sp,2,0,"span"),o()),t&2){let e=i.$implicit;c(),b(e.pval?1:2)}}function Tp(t,i){t&1&&(l(0,"th",25),p(1,"Reception time"),o())}function Dp(t,i){if(t&1&&(l(0,"td",28),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.pval==null?null:e.pval.acquisitionTime)||"-"," ")}}function Pp(t,i){t&1&&(l(0,"th",25),p(1,"Generation time"),o())}function Ep(t,i){if(t&1&&(l(0,"td",28),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),X(D(2,1,e.pval==null?null:e.pval.generationTime)||"-")}}function kp(t,i){t&1&&(l(0,"th",25),p(1,"Acquisition status"),o())}function Ap(t,i){if(t&1&&(l(0,"td",28),p(1),o()),t&2){let e=i.$implicit;c(),X((e.pval==null?null:e.pval.acquisitionStatus)||"-")}}function Mp(t,i){t&1&&x(0,"th",32)}function Rp(t,i){if(t&1){let e=F();l(0,"td",28)(1,"ya-icon-action",33),E("click",function(n){let r=k(e).index;return h(2).moveDown.emit(r),A(n.stopPropagation())}),o(),l(2,"ya-icon-action",34),E("click",function(n){let r=k(e).index;return h(2).moveUp.emit(r),A(n.stopPropagation())}),o()()}}function Lp(t,i){t&1&&x(0,"tr",35)}function Ip(t,i){if(t&1){let e=F();l(0,"tr",36),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n.name))}),o()}if(t&2){let e=i.$implicit,a=h(2);ae("selected",a.selection.isSelected(e.name))}}function Op(t,i){if(t&1&&(l(0,"table",2),H(1,3),I(2,cp,3,3,"th",4)(3,pp,3,4,"td",5),Y(),H(4,6),I(5,mp,2,0,"th",7)(6,dp,3,5,"td",8),Y(),H(7,9),I(8,up,2,0,"th",7)(9,_p,3,1,"td",10),Y(),H(10,11),I(11,gp,2,0,"th",7)(12,vp,3,3,"td",12),Y(),H(13,13),I(14,yp,2,0,"th",7)(15,wp,3,1,"td",12),Y(),H(16,14),I(17,Tp,2,0,"th",7)(18,Dp,3,3,"td",10),Y(),H(19,15),I(20,Pp,2,0,"th",7)(21,Ep,3,3,"td",10),Y(),H(22,16),I(23,kp,2,0,"th",7)(24,Ap,2,1,"td",10),Y(),H(25,17),I(26,Mp,1,0,"th",18)(27,Rp,3,0,"td",10),Y(),I(28,Lp,1,0,"tr",19)(29,Ip,1,2,"tr",20),o()),t&2){let e=h();ae("paused",e.paused),g("dataSource",e.dataSource),c(28),g("cdkHeaderRowDef",e.displayedColumns),c(),g("cdkRowDefColumns",e.displayedColumns)}}var xa=class xa{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!1,parameters:[]};this.moveUp=new dt;this.moveDown=new dt;this.dataSource=new Lt([]);this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"];this.transformRowForSelection=i=>i.name;this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){let i=this.model.parameters.map(e=>({name:e}));for(let e of i)e.pval=this.buffer.getLatestValue(e.name);this.dataSource.data=i,this.changeDetector.detectChanges()}ngOnChanges(){this.showActions?this.displayedColumns=["select",...this.defaultColumns,"actions"]:this.displayedColumns=this.defaultColumns}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}ngOnDestroy(){this.syncSubscription?.unsubscribe()}};xa.\u0275fac=function(e){return new(e||xa)(S(W),S(At),S(It))},xa.\u0275cmp=N({type:xa,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},features:[Gt],decls:1,vars:1,consts:[["cb",""],["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",3,"click",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","transform"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item","transform"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){e&1&&C(0,Op,30,5,"table",1),e&2&&b(a.dataSource.data.length?0:-1)},dependencies:[pi,$,Ee,yi,Ut,gi,vi,ta,Ye,Ge,Ue,qe,je,ri,Ci,Hr,Ve,qt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0});var no=xa;var Np=t=>({c:t});function Vp(t,i){t&1&&(l(0,"th",10),p(1,"Generation time"),o())}function Fp(t,i){if(t&1&&(l(0,"td",11),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),X(D(2,1,e.generationTime)||"-")}}function Bp(t,i){if(t&1){let e=F();l(0,"ya-more")(1,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveLeft.emit(n))}),p(2,"Move left"),o(),l(3,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveRight.emit(n))}),p(4,"Move right"),o(),x(5,"mat-divider"),l(6,"button",13),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.removeColumn.emit(n))}),p(7,"Remove column"),o()()}}function $p(t,i){if(t&1&&(l(0,"th",10)(1,"a",12),p(2),o(),C(3,Bp,8,0,"ya-more"),o()),t&2){let e=h().$implicit,a=h(2);c(),g("routerLink","/telemetry/parameters"+e)("queryParams",Q(4,Np,a.yamcs.context)),c(),O(" ",e," "),c(),b(a.showActions?3:-1)}}function Hp(t,i){t&1&&(l(0,"span"),p(1,"\u2193"),o())}function Yp(t,i){t&1&&(l(0,"span"),p(1,"\u2191"),o())}function Gp(t,i){if(t&1&&(l(0,"ya-expirable",14),p(1),T(2,"value"),C(3,Hp,2,0,"span"),C(4,Yp,2,0,"span"),o()),t&2){let e=h();g("pval",e),c(),O(" ",D(2,4,e.engValue)||"-"," "),c(2),b(e.rangeCondition==="LOW"?3:-1),c(),b(e.rangeCondition==="HIGH"?4:-1)}}function Up(t,i){t&1&&C(0,Gp,5,6,"ya-expirable",14),t&2&&b(i?0:-1)}function qp(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function jp(t,i){if(t&1&&(l(0,"td",11),C(1,Up,1,1)(2,qp,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit;c(),b((e=a.pvals[n])?1:2,e)}}function zp(t,i){if(t&1&&(H(0,5),I(1,$p,4,6,"th",3)(2,jp,3,1,"td",4),Y()),t&2){let e=i.$implicit;g("cdkColumnDef",e)}}function Wp(t,i){t&1&&x(0,"th",15)}function Xp(t,i){t&1&&x(0,"td",11)}function Zp(t,i){t&1&&x(0,"tr",16)}function Qp(t,i){t&1&&x(0,"tr",17)}function Kp(t,i){if(t&1&&(l(0,"table",1),H(1,2),I(2,Vp,2,0,"th",3)(3,Fp,3,3,"td",4),Y(),le(4,zp,3,1,"ng-container",5,oe),H(6,6),I(7,Wp,1,0,"th",7)(8,Xp,1,0,"td",4),Y(),I(9,Zp,1,0,"tr",8)(10,Qp,1,0,"tr",9),o()),t&2){let e=h();ae("paused",e.paused),g("dataSource",e.dataSource),c(4),se(e.model.parameters),c(5),g("cdkHeaderRowDef",e.displayedColumns),c(),g("cdkRowDefColumns",e.displayedColumns)}}function Jp(t,i){if(t&1&&(l(0,"p"),p(1,"\xA0"),o(),p(2," Buffer size: "),l(3,"select",18)(4,"option",19),p(5,"10"),o(),l(6,"option",20),p(7,"25"),o(),l(8,"option",21),p(9,"50"),o(),l(10,"option",22),p(11,"75"),o(),l(12,"option",23),p(13,"100"),o()()),t&2){let e=h();c(3),g("formControl",e.bufferSizeControl)}}var Sa=class Sa{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!0,parameters:[]};this.removeColumn=new dt;this.moveLeft=new dt;this.moveRight=new dt;this.bufferSize=new dt;this.dataSource=new Lt([]);this.bufferSizeControl=new ne("10");this.displayedColumns=["generationTime","actions"];this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{let n=this.bufferSizeControl.value;n!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(n,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){let i=[],e=this.buffer.snapshot();for(let a of e){let n=this.findAnyMatchingParameterValue(a);n&&i.push({generationTime:n.generationTime,pvals:a})}this.dataSource.data=i,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(i){for(let e in i)if(i.hasOwnProperty(e)&&this.model.parameters.indexOf(e)!==-1)return i[e]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.bufferSizeControlSubscription?.unsubscribe()}};Sa.\u0275fac=function(e){return new(e||Sa)(S(W),S(At),S(It))},Sa.\u0275cmp=N({type:Sa,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},features:[Gt],decls:2,vars:2,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(e,a){e&1&&(C(0,Kp,11,5,"table",0),C(1,Jp,14,1)),e&2&&(b(a.dataSource.data.length?0:-1),c(),b(a.showActions?1:-1))},dependencies:[$,Rs,Ls,Ms,pe,Jt,Ee,yi,Ut,gi,vi,ta,ti,ht,Ye,Ge,Ue,qe,je,ri,Nt,Ve,qt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0});var ro=Sa;function em(t,i){if(t&1){let e=F();l(0,"app-scrolling-parameter-table",3),T(1,"async"),T(2,"async"),E("moveLeft",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveRight",function(n){k(e);let r=h(3);return A(r.moveDown(n))})("removeColumn",function(n){k(e);let r=h(3);return A(r.removeParameter(n))})("bufferSize",function(n){k(e);let r=h(3);return A(r.setBufferSize(n))}),o()}if(t&2){let e=h(2),a=h();g("model",e)("buffer",a.buffer)("paused",D(1,4,a.paused$))("showActions",D(2,6,a.showActions$))}}function tm(t,i){if(t&1){let e=F();l(0,"app-multiple-parameter-table",4),T(1,"async"),T(2,"async"),E("moveUp",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveDown",function(n){k(e);let r=h(3);return A(r.moveDown(n))}),o()}if(t&2){let e=h(2),a=h();g("model",e)("buffer",a.buffer)("paused",D(1,5,a.paused$))("showActions",D(2,7,a.showActions$))("selection",a.selection)}}function im(t,i){if(t&1&&C(0,em,3,8,"app-scrolling-parameter-table",1)(1,tm,3,9,"app-multiple-parameter-table",2),t&2){let e=h();b(e.scroll?0:1)}}function am(t,i){if(t&1){let e=F();l(0,"ya-empty-message")(1,"div",5)(2,"p"),p(3," This file is empty. "),x(4,"br"),p(5," Start by "),l(6,"a",6),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),p(7," adding a parameter "),o(),p(8," . "),o()()()}}function nm(t,i){if(t&1){let e=F();l(0,"ya-empty-message")(1,"div",5)(2,"p"),p(3," This file is empty. "),x(4,"br"),p(5," Start by "),l(6,"a",6),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),p(7," adding a parameter "),o(),p(8," . "),o()()()}}function rm(t,i){t&1&&(l(0,"ya-panel"),C(1,im,2,1)(2,am,9,0,"ya-empty-message"),I(3,nm,9,0,"ng-template",null,0,ki),o()),t&2&&(c(),b(i.parameters.length?1:2))}var wa=class wa{constructor(i,e,a){this.yamcs=i;this.dialog=e;this.selection=new Ji(!0,[]);this.model$=new G(null);this.buffer=new ao;this.paused$=new G(!1);this.hasUnsavedChanges$=new G(!1);this.showActions$=new G(!1);this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{let n=JSON.parse(a);this.model$.next(n),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){let i=this.model$.value.parameters.map(e=>({name:e}));i.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=e.mapping);let a=e.values||[];this.buffer.push(a,this.idMapping)}))}addParameter(i){let e=this.model$.value;e.parameters.push(i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(i){this.model$.next({scroll:i.scroll,bufferSize:i.bufferSize||10,parameters:i.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){let i=this.model$.value;i.parameters=i.parameters.filter(e=>!this.selection.isSelected(e)),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();let i=this.model$.value;i.scroll=!0,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();let i=this.model$.value;i.scroll=!1,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}removeParameter(i){let e=this.model$.value;e.parameters=e.parameters.filter(a=>a!==i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveUp(i){let e=this.model$.value,a=e.parameters[i];i===0?(e.parameters[i]=e.parameters[e.parameters.length-1],e.parameters[e.parameters.length-1]=a):(e.parameters[i]=e.parameters[i-1],e.parameters[i-1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveDown(i){let e=this.model$.value,a=e.parameters[i];i===e.parameters.length-1?(e.parameters[i]=e.parameters[0],e.parameters[0]=a):(e.parameters[i]=e.parameters[i+1],e.parameters[i+1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}setBufferSize(i){this.buffer.setSize(i);let e=this.model$.value;e.bufferSize=i,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}save(){let i=new Blob([JSON.stringify(mt({$schema:"https://yamcs.org/schema/parameter-table.schema.json"},this.model$.value),void 0,2)],{type:"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,i).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(mi,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.addParameter(e)})}ngOnDestroy(){this.dataSubscription?.cancel()}};wa.\u0275fac=function(e){return new(e||wa)(S(W),S(Le),S(we))},wa.\u0275cmp=N({type:wa,selectors:[["app-parameter-table-viewer"]],decls:2,vars:3,consts:[["empty",""],[3,"model","buffer","paused","showActions"],[3,"model","buffer","paused","showActions","selection"],[3,"moveLeft","moveRight","removeColumn","bufferSize","model","buffer","paused","showActions"],[3,"moveUp","moveDown","model","buffer","paused","showActions","selection"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(e,a){if(e&1&&(C(0,rm,5,1,"ya-panel"),T(1,"async")),e&2){let n;b((n=D(1,1,a.model$))?0:-1,n)}},dependencies:[no,ro,$,ni,ze,ie],styles:[".ya-panel[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0});var lo=wa;function om(t,i){if(t&1){let e=F();l(0,"ya-page-button",1),T(1,"async"),E("clicked",function(){k(e);let n=h(2);return A(n.save())}),p(2," SAVE "),o()}if(t&2){let e=h(2);g("disabled",!D(1,1,e.viewer.hasUnsavedChanges$))}}function lm(t,i){if(t&1&&C(0,om,3,3,"ya-page-button",0),t&2){let e=h();b(e.mayManageDisplays()?0:-1)}}var Ta=class Ta{constructor(i,e,a){this.snackbar=i;this.authService=e;this.initialized$=new G(!1);this.bucket=a.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}};Ta.\u0275fac=function(e){return new(e||Ta)(S(br),S(St),S(we))},Ta.\u0275cmp=N({type:Ta,selectors:[["ng-component"]],decls:2,vars:3,consts:[["icon","save",3,"disabled"],["icon","save",3,"clicked","disabled"]],template:function(e,a){e&1&&(C(0,lm,1,1),T(1,"async")),e&2&&b(D(1,1,a.initialized$)?0:-1)},dependencies:[$,vt,ie],encapsulation:2});var so=Ta;var sm=["scriptContainer"],Da=class Da{constructor(i,e,a,n){this.messageService=a;this.authService=n;this.hasUnsavedChanges$=new G(!1);this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>e.text().then(a=>this.initializeEditor(a))).catch(e=>this.messageService.showError(e)),Promise.resolve()}initializeEditor(i){let e=[Vs,Os.of([Ns]),rc(),$n.lineWrapping];this.mayManageDisplays()?e.push($n.updateListener.of(r=>{r.docChanged&&this.hasUnsavedChanges$.next(!0)})):e.push(Tl.readOnly.of(!0));let a=$n.theme({"&":{width:"100%",height:"100%",fontSize:"12px"},".cm-scroller":{overflow:"auto",fontFamily:"'Roboto Mono', monospace"}},{dark:!1});e.push(a);let n=Tl.create({doc:i,extensions:e});this.editorView=new $n({state:n,parent:this.scriptContainer.nativeElement})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}hasPendingChanges(){return this.hasUnsavedChanges$.value}async save(){let i=this.editorView.state.doc.toString(),e=new Blob([i],{type:"text/javascript"});return this.storageClient.uploadObject(this.bucket,this.objectName,e).then(()=>{this.hasUnsavedChanges$.next(!1)})}};Da.\u0275fac=function(e){return new(e||Da)(S(W),S(we),S(Je),S(St))},Da.\u0275cmp=N({type:Da,selectors:[["app-script-viewer"]],viewQuery:function(e,a){if(e&1&&ge(sm,5),e&2){let n;fe(n=_e())&&(a.scriptContainer=n.first)}},decls:2,vars:0,consts:[["scriptContainer",""],[1,"script-container"]],template:function(e,a){e&1&&Tt(0,"div",1,0)},dependencies:[$],styles:[".script-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex}"],changeDetection:0});var co=Da;function cm(t,i){if(t&1&&(Bt(0,"pre"),p(1),Et()),t&2){let e=h();c(),X(e.text)}}var Pa=class Pa{constructor(i,e,a){this.changeDetector=e;this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{this.text=a,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}};Pa.\u0275fac=function(e){return new(e||Pa)(S(W),S(At),S(we))},Pa.\u0275cmp=N({type:Pa,selectors:[["app-text-viewer"]],decls:1,vars:1,template:function(e,a){e&1&&C(0,cm,2,1,"pre"),e&2&&b(a.text?0:-1)},dependencies:[$],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0});var po=Pa;var Ea=class Ea{constructor(i){this.viewContainerRef=i}};Ea.\u0275fac=function(e){return new(e||Ea)(S(fr))},Ea.\u0275dir=_r({type:Ea,selectors:[["","app-viewer-controls-host",""]]});var jn=Ea;var ka=class ka{constructor(i){this.viewContainerRef=i}};ka.\u0275fac=function(e){return new(e||ka)(S(fr))},ka.\u0275dir=_r({type:ka,selectors:[["","app-viewer-host",""]]});var zn=ka;var pm=["viewerContainer"],mm=t=>({c:t});function dm(t,i){if(t&1&&(x(0,"ya-page-icon-button",5),p(1)),t&2){let e=h();g("routerLink",e.folderLink)("queryParams",Q(3,mm,e.yamcs.context)),c(),O(" ",e.filename," ")}}function um(t,i){}function hm(t,i){}var Aa=class Aa{constructor(i,e,a,n,r){this.yamcs=i;this.route=e;this.title=n;this.subscriptions=[];let s=this.getObjectNameFromUrl();this.loadFile(s);let d=a.events.pipe(sr(u=>u instanceof Cr)).subscribe(()=>{let u=this.getObjectNameFromUrl();u!==this.objectName&&this.loadFile(u,!0)});this.subscriptions.push(d);let m=e.snapshot.queryParamMap.get("range");m&&i.range$.next(m),d=i.range$.subscribe(u=>{a.navigate([],{replaceUrl:!0,relativeTo:e,queryParams:{range:u},queryParamsHandling:"merge"})}),this.subscriptions.push(d)}getObjectNameFromUrl(){let i=this.route.snapshot.url,e="";for(let a of i)e&&(e+="/"),e+=a.path;return e}loadFile(i,e=!1){this.objectName=i;let a=this.objectName.lastIndexOf("/");if(a===-1)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{let n=this.objectName.substring(0,a);this.folderLink="/telemetry/displays/browse/"+n,this.filename=this.objectName.substring(a+1)}this.title.setTitle(this.filename),e&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){let i=this.createViewer(to);i.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(Wr).init(i),this.viewer=i}else if(this.filename.toLowerCase().endsWith(".par")){let i=this.createViewer(lo);this.createViewerControls(io).init(i),i.setEnableActions(),this.viewer=i}else if(this.isImage())this.viewer=this.createViewer(zr);else if(this.filename.toLocaleLowerCase().endsWith(".js")){let i=this.createViewer(co);this.createViewerControls(so).init(i),this.viewer=i}else this.viewer=this.createViewer(po);this.viewer.init(this.objectName)}createViewer(i){let e=this.viewerHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}createViewerControls(i){let e=this.controlsHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}isImage(){let i=this.filename.toLowerCase();return i.endsWith(".png")||i.endsWith(".gif")||i.endsWith(".jpg")||i.endsWith("jpeg")||i.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.subscriptions.forEach(i=>i.unsubscribe())}};Aa.\u0275fac=function(e){return new(e||Aa)(S(W),S(Pe),S(Qe),S(Mt),S(we))},Aa.\u0275cmp=N({type:Aa,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(ge(jn,5),ge(pm,5),ge(zn,5)),e&2){let n;fe(n=_e())&&(a.controlsHost=n.first),fe(n=_e())&&(a.viewerContainer=n.first),fe(n=_e())&&(a.viewerHost=n.first)}},decls:7,vars:0,consts:[["viewerContainer",""],["ya-instance-toolbar-label",""],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["app-viewer-host",""],["icon","arrow_back",3,"routerLink","queryParams"]],template:function(e,a){e&1&&(l(0,"ya-instance-page")(1,"ya-instance-toolbar"),I(2,dm,2,5,"ng-template",1)(3,um,0,0,"ng-template",2),o(),l(4,"div",3,0),I(6,hm,0,0,"ng-template",4),o()())},dependencies:[$,Ee,et,tt,li,bi,jn,zn],encapsulation:2,changeDetection:0});var mo=Aa;var fm=["filename"];function _m(t,i){if(t&1&&(l(0,"form",2)(1,"ya-field",7)(2,"ya-select",8),x(3,"ya-option",9),o()()()),t&2){let e=h();g("formGroup",e.typeForm)}}function gm(t,i){t&1&&(l(0,"span",12),p(1," File name must end with "),l(2,"code"),p(3,".par"),o()())}function vm(t,i){if(t&1&&(l(0,"form",2)(1,"ya-field",10),x(2,"input",11,0),C(4,gm,4,0,"span",12),o(),l(5,"ya-field",13),x(6,"input",14),o()()),t&2){let e,a,n=h();g("formGroup",n.filenameForm),c(),ae("invalid",(e=n.filenameForm.get("name"))==null?null:e.invalid),c(3),b((a=n.filenameForm.get("name"))!=null&&a.invalid?4:-1)}}function ym(t,i){if(t&1){let e=F();l(0,"ya-button",15),E("click",function(){k(e);let n=h();return A(n.selectType())}),p(1,"NEXT \xBB"),o()}if(t&2){let e=h();g("disabled",!e.typeForm.valid)}}function Cm(t,i){if(t&1){let e=F();l(0,"ya-button",16),E("click",function(){k(e);let n=h();return A(n.save())}),p(1," SAVE "),o()}if(t&2){let e=h();g("disabled",!e.filenameForm.valid)}}var Ra=class Ra{constructor(i,e,a,n,r,s){this.dialogRef=i;this.data=n;this.changeDetector=r;this.configService=s;this.page=1;this.storageClient=a.createStorageClient(),this.typeForm=e.group({type:["par",Ce.required]}),this.filenameForm=e.group({path:[n.path,Ce.required],name:["",[Ce.required,Ce.pattern(/.*\.par/i)]]})}selectType(){let i=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${i}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let i=this.filenameForm.get("path").value.trim(),e=this.filenameForm.get("name").value.trim();i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1));let a=i?i+"/"+e:e,n=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",scroll:!1,parameters:[]},void 0,2)],{type:"application/json"}),r=this.configService.getDisplayBucket(),s=this.data.prefix+a;this.storageClient.uploadObject(r,s,n).then(()=>{this.dialogRef.close(a)})}};Ra.\u0275fac=function(e){return new(e||Ra)(S(Re),S(ei),S(W),S(He),S(At),S(we))},Ra.\u0275cmp=N({type:Ra,selectors:[["app-create-display-dialog"]],viewQuery:function(e,a){if(e&1&&ge(fm,5),e&2){let n;fe(n=_e())&&(a.filenameInput=n.first)}},decls:10,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["align","end"],["mat-dialog-close",""],[3,"disabled"],["appearance","primary",3,"disabled"],["label","Type"],["formControlName","type"],["id","par","label","Parameter Table"],["label","Name"],["type","text","formControlName","name"],[1,"error-message"],["label","Path"],["type","text","formControlName","path"],[3,"click","disabled"],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",1),p(1,"Create display"),o(),l(2,"mat-dialog-content"),C(3,_m,4,1,"form",2),C(4,vm,7,4,"form",2),o(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),p(7,"CANCEL"),o(),C(8,ym,2,1,"ya-button",5),C(9,Cm,2,1,"ya-button",6),o()),e&2&&(c(3),b(a.page===1?3:-1),c(),b(a.page===2?4:-1),c(4),b(a.page===1?8:-1),c(),b(a.page===2?9:-1))},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,me,ke,oa,it],encapsulation:2});var uo=Ra;var La=class La{constructor(i,e,a,n){this.dialogRef=i;this.data=n;this.storageClient=a.createStorageClient(),this.form=e.group({name:["",Ce.required]})}save(){let{path:i,bucket:e}=this.data;i.startsWith("/")&&(i=i.substring(1));let a=this.form.value.name,n=i?`${i}/${a}/`:`${a}/`;this.storageClient.uploadObject(e,n,new Blob).then(()=>this.dialogRef.close(!0))}};La.\u0275fac=function(e){return new(e||La)(S(Re),S(ei),S(W),S(He))},La.\u0275cmp=N({type:La,selectors:[["app-create-display-folder-dialog"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Folder name"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Create folder"),o(),l(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),x(5,"input",3),o()()(),l(6,"mat-dialog-actions",4)(7,"ya-button",5),p(8,"CANCEL"),o(),l(9,"ya-button",6),E("click",function(){return a.save()}),p(10,"CREATE"),o()()),e&2&&(c(3),g("formGroup",a.form),c(6),g("disabled",!a.form.valid))},dependencies:[$,Ke,$e,pe,ve,Is,ye,Se,Ie,lt,Ne,Oe,me,ke],encapsulation:2,changeDetection:0});var ho=La;var Ia=class Ia{constructor(i,e,a,n,r){this.dialogRef=i;this.data=r;this.storageClient=a.createStorageClient(),this.bucket=n.getDisplayBucket();let s=B.getFilename(this.data.name);this.filenameForm=e.group({name:[s,[Ce.required]]})}async rename(){let i,e=this.data.name.lastIndexOf("/");e!==-1&&(i=this.data.name.substring(0,e+1));let n=await(await this.storageClient.getObject(this.bucket,this.data.name)).blob(),r=(i||"")+this.filenameForm.get("name").value;await this.storageClient.uploadObject(this.bucket,r,n),await this.storageClient.deleteObject(this.bucket,this.data.name),this.dialogRef.close(r)}};Ia.\u0275fac=function(e){return new(e||Ia)(S(Re),S(ei),S(W),S(we),S(He))},Ia.\u0275cmp=N({type:Ia,selectors:[["app-rename-display-dialog"]],decls:12,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Name"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=F();l(0,"h2",1),p(1,"Rename file"),o(),l(2,"mat-dialog-content")(3,"form",2)(4,"ya-field",3),x(5,"input",4,0),o()()(),l(7,"mat-dialog-actions",5)(8,"ya-button",6),p(9,"CANCEL"),o(),l(10,"ya-button",7),E("click",function(){return k(n),A(a.rename())}),p(11," RENAME "),o()()}if(e&2){let n;c(3),g("formGroup",a.filenameForm),c(),ae("invalid",(n=a.filenameForm.get("name"))==null?null:n.invalid),c(6),g("disabled",!a.filenameForm.valid)}},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,me,ke],encapsulation:2});var fo=Ia;var Oa=class Oa{transform(i){if(!i)return null;let e=i.toLowerCase();return e.endsWith(".opi")?"Operator Interface":e.endsWith(".par")?"Parameter Table":e.endsWith(".js")?"Script File":e.indexOf(".")!==-1?e.substr(e.lastIndexOf(".")+1).toUpperCase()+" File":null}};Oa.\u0275fac=function(e){return new(e||Oa)},Oa.\u0275pipe=gr({name:"displayType",type:Oa,pure:!0});var _o=Oa;var bm=["droparea"],xm=["uploader"],vo=t=>({c:t});function Sm(t,i){if(t&1){let e=F();l(0,"ya-page-button",11),E("clicked",function(){k(e);let n=h();return A(n.createDisplay())}),p(1,"Create display"),o()}}function wm(t,i){if(t&1){let e=F();l(0,"ya-page-button",12),E("clicked",function(){k(e);let n=K(3);return A(n.click())}),p(1," Upload files "),l(2,"input",13,1),E("change",function(){k(e);let n=h();return A(n.uploadFiles())}),o()()}}function Tm(t,i){if(t&1){let e=F();l(0,"ya-page-button",14),E("clicked",function(){k(e);let n=h();return A(n.createFolder())}),p(1," Create folder "),o()}}function Dm(t,i){if(t&1){let e=F();l(0,"ya-page-button",15),E("clicked",function(){k(e);let n=h();return A(n.deleteSelectedDisplays())}),p(1," Delete "),o()}if(t&2){let e=h();g("disabled",!e.selection.hasValue())}}function Pm(t,i){if(t&1&&x(0,"ya-breadcrumb",17),t&2){let e=i.$implicit,a=h(3);g("link",e.route)("queryParams",Q(3,vo,a.yamcs.context))("label",e.name)}}function Em(t,i){if(t&1&&(l(0,"ya-breadcrumb-trail"),x(1,"ya-breadcrumb",16),le(2,Pm,1,5,"ya-breadcrumb",17,oe),o()),t&2){let e=h(),a=h();c(),g("queryParams",Q(1,vo,a.yamcs.context)),c(),se(e)}}function km(t,i){t&1&&C(0,Em,4,3,"ya-breadcrumb-trail"),t&2&&b(i.length?0:-1)}function Am(t,i){if(t&1){let e=F();l(0,"th",32),E("click",function(n){return k(e),K(2).toggle(),A(n.stopPropagation())}),x(1,"ya-table-checkbox",33,2),o()}if(t&2){let e=h(2);c(),g("dataSource",e.dataSource)("selection",e.selection)}}function Mm(t,i){if(t&1){let e=F();l(0,"td",34),E("click",function(n){return k(e),K(2).toggle(),A(n.stopPropagation())}),x(1,"ya-table-checkbox",35,2),o()}if(t&2){let e=i.$implicit,a=h(2);c(),g("dataSource",a.dataSource)("selection",a.selection)("item",e)}}function Rm(t,i){t&1&&(l(0,"th",36),p(1,"Name"),o())}function Lm(t,i){if(t&1){let e=F();l(0,"mat-icon",38),p(1," folder "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),p(3),T(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);c(2),g("routerLink","/telemetry/displays/browse/"+e.name)("queryParams",Q(5,vo,a.yamcs.context)),c(),O(" ",D(4,3,e.name)," ")}}function Im(t,i){if(t&1){let e=F();l(0,"mat-icon",38),p(1," description "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),p(3),T(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);c(2),g("routerLink","/telemetry/displays/files/"+e.name)("queryParams",Q(5,vo,a.yamcs.context)),c(),O(" ",D(4,3,e.name)," ")}}function Om(t,i){if(t&1&&(l(0,"td",37),C(1,Lm,5,7)(2,Im,5,7),o()),t&2){let e=i.$implicit;c(),b(e.folder?1:2)}}function Nm(t,i){t&1&&(l(0,"th",36),p(1,"Type"),o())}function Vm(t,i){t&1&&p(0," Folder ")}function Fm(t,i){if(t&1&&(p(0),T(1,"displayType")),t&2){let e=h().$implicit;O(" ",D(1,1,e.name)||"-"," ")}}function Bm(t,i){if(t&1&&(l(0,"td",37),C(1,Vm,1,0)(2,Fm,2,3),o()),t&2){let e=i.$implicit;c(),b(e.folder?1:2)}}function $m(t,i){t&1&&(l(0,"th",36),p(1,"Visibility"),o())}function Hm(t,i){t&1&&(l(0,"td",37),p(1,"Private"),o())}function Ym(t,i){t&1&&(l(0,"th",36),p(1,"Date modified"),o())}function Gm(t,i){if(t&1&&(l(0,"td",37),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.modified)||"-"," ")}}function Um(t,i){t&1&&x(0,"th",40)}function qm(t,i){if(t&1){let e=F();l(0,"ya-more")(1,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.renameFile(n))}),p(2,"Rename"),o(),l(3,"a",42),p(4,"Download"),o(),x(5,"mat-divider"),l(6,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.deleteFile(n))}),p(7,"Delete"),o()()}if(t&2){let e=h(2).$implicit;c(3),g("href",e.objectUrl,hr)}}function jm(t,i){if(t&1&&C(0,qm,8,1,"ya-more"),t&2){let e=h(3);b(e.mayManageDisplays()?0:-1)}}function zm(t,i){if(t&1&&(l(0,"td",37),C(1,jm,1,1),o()),t&2){let e=i.$implicit;c(),b(e.folder?-1:1)}}function Wm(t,i){t&1&&x(0,"tr",43)}function Xm(t,i){if(t&1){let e=F();l(0,"tr",44),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);ae("selected",a.selection.isSelected(e))}}function Zm(t,i){if(t&1&&(l(0,"table",10),H(1,18),I(2,Am,3,2,"th",19)(3,Mm,3,3,"td",20),Y(),H(4,21),I(5,Rm,2,0,"th",22)(6,Om,3,1,"td",23),Y(),H(7,24),I(8,Nm,2,0,"th",22)(9,Bm,3,1,"td",23),Y(),H(10,25),I(11,$m,2,0,"th",22)(12,Hm,2,0,"td",23),Y(),H(13,26),I(14,Ym,2,0,"th",22)(15,Gm,3,3,"td",23),Y(),H(16,27),I(17,Um,1,0,"th",28)(18,zm,2,1,"td",29),Y(),I(19,Wm,1,0,"tr",30)(20,Xm,1,2,"tr",31),o()),t&2){let e=h();g("dataSource",e.dataSource),c(19),g("cdkHeaderRowDef",e.displayedColumns()),c(),g("cdkRowDefColumns",e.displayedColumns())}}function Qm(t,i){t&1&&(l(0,"ya-empty-message"),p(1,"Empty directory."),o())}var Na=class Na{constructor(i,e,a,n,r,s,d,m){this.dialog=i;this.yamcs=e;this.router=n;this.route=r;this.authService=s;this.messageService=d;this.breadcrumb$=new G([]);this.dragActive$=new G(!1);this.displayedColumns=ds(["name","type","modified","actions"]);this.dataSource=new Lt([]);this.selection=new Ji(!0,[]);a.setTitle("Displays"),this.storageClient=e.createStorageClient(),this.bucket=m.getDisplayBucket(),this.loadCurrentFolder(),this.routerSubscription=n.events.pipe(sr(u=>u instanceof Cr)).subscribe(()=>{this.loadCurrentFolder()}),this.mayManageDisplays()&&this.displayedColumns.set(["select",...this.displayedColumns()])}loadCurrentFolder(){let i={delimiter:"/"},e=this.route.snapshot.url;e.length&&(i.prefix=e.map(a=>a.path).join("/")+"/"),this.storageClient.listObjects(this.bucket,i).then(a=>{this.updateBrowsePath(),this.changedir(a)})}changedir(i){this.selection.clear();let e=[];for(let a of i.prefixes||[])e.push({folder:!0,name:a});for(let a of i.objects||[])a.name.endsWith("/")||e.push({folder:!1,name:a.name,modified:a.created,objectUrl:this.storageClient.getObjectURL(this.bucket,a.name)});this.dataSource.data=e}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}createDisplay(){this.dialog.open(uo,{width:"400px",data:{path:this.getCurrentPath(),prefix:""}}).afterClosed().subscribe(e=>{e&&this.router.navigateByUrl(`/telemetry/displays/files/${e}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(ho,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let i=this.getCurrentPath();i.startsWith("/")&&(i=i.substring(1));let e=this.uploaderEl.nativeElement.files,a=[];for(let n in e)if(!isNaN(parseInt(n,10))){let r=e[n],m=""+(i?i+"/"+r.name:r.name),u=this.storageClient.uploadObject(this.bucket,m,r);a.push(u)}Promise.all(a).then(()=>this.loadCurrentFolder()).catch(n=>this.messageService.showError(n))}getCurrentPath(){let i="";for(let e of this.route.snapshot.url)i+="/"+e.path;return i||"/"}deleteSelectedDisplays(){let i=[],e=[];for(let a of this.selection.selected)a.folder?e.push(this.storageClient.listObjects(this.bucket,{prefix:a.name}).then(n=>{let r=n.objects||[];i.push(...r.map(s=>s.name))})):i.push(a.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${i.length} files. Are you sure you want to continue?`)){let a=[];for(let n of i)a.push(this.storageClient.deleteObject(this.bucket,n));Promise.all(a).then(()=>{this.loadCurrentFolder()})}})}renameFile(i){this.dialog.open(fo,{data:{name:i.name},width:"400px"}).afterClosed().subscribe(a=>{a&&this.loadCurrentFolder()})}deleteFile(i){confirm(`Are you sure you want to delete ${i.name}?`)&&this.storageClient.deleteObject(this.bucket,i.name).then(()=>{this.loadCurrentFolder()})}dragEnter(i){return this.dragActive$.next(!0),i.preventDefault(),i.stopPropagation(),!1}dragOver(i){return i.preventDefault(),i.stopPropagation(),!1}dragLeave(i){return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}drop(i){let e=i.dataTransfer||{};if(e){let a=this.getCurrentPath().substring(1);a!==""&&(a+="/"),nc(e).then(n=>{let r=[];for(let s of n){let d=a+s._fullPath,m=this.storageClient.uploadObject(this.bucket,d,s);r.push(m)}Promise.all(r).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){let i=[],e="";for(let a of this.route.snapshot.url)e+="/"+a.path,i.push({name:a.path,route:"/telemetry/displays/browse"+e});return this.breadcrumb$.next(i),e||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}};Na.\u0275fac=function(e){return new(e||Na)(S(Le),S(W),S(Mt),S(Qe),S(Pe),S(St),S(Je),S(we))},Na.\u0275cmp=N({type:Na,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(ge(bm,7),ge(xm,5)),e&2){let n;fe(n=_e())&&(a.dropArea=n.first),fe(n=_e())&&(a.uploaderEl=n.first)}},decls:16,vars:16,consts:[["droparea",""],["uploader",""],["cb",""],["label","Displays"],["icon","add_box"],["icon","file_upload"],["icon","create_new_folder"],["icon","delete",3,"disabled"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["icon","add_box",3,"clicked"],["icon","file_upload",3,"clicked"],["type","file","hidden","","multiple","",3,"change"],["icon","create_new_folder",3,"clicked"],["icon","delete",3,"clicked","disabled"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",3,"click",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink","queryParams"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){if(e&1){let n=F();l(0,"ya-instance-page")(1,"ya-instance-toolbar",3),C(2,Sm,2,0,"ya-page-button",4),C(3,wm,4,0,"ya-page-button",5),C(4,Tm,2,0,"ya-page-button",6),C(5,Dm,2,1,"ya-page-button",7),o(),l(6,"div",8,0),T(8,"async"),E("dragenter",function(s){return k(n),A(a.dragEnter(s))}),l(9,"div",9),T(10,"async"),E("dragover",function(s){return k(n),A(a.dragOver(s))})("dragleave",function(s){return k(n),A(a.dragLeave(s))})("drop",function(s){return k(n),A(a.drop(s))}),o(),l(11,"ya-panel"),C(12,km,1,1),T(13,"async"),C(14,Zm,21,3,"table",10)(15,Qm,2,0,"ya-empty-message"),o()()()}if(e&2){let n;c(2),b(a.mayManageDisplays()?2:-1),c(),b(a.mayManageDisplays()?3:-1),c(),b(a.mayManageDisplays()?4:-1),c(),b(a.mayManageDisplays()?5:-1),c(),ae("active",D(8,10,a.dragActive$)),c(3),ae("hide",!D(10,12,a.dragActive$)),c(3),b((n=D(13,14,a.breadcrumb$))?12:-1,n),c(2),b(a.dataSource&&a.dataSource.data.length?14:15)}},dependencies:[$,Ee,yi,Ut,gi,vi,ta,Rt,ti,ht,Ye,_t,st,ft,Ge,Ue,qe,je,Or,Ir,ni,et,tt,Nt,vt,ze,Hr,_o,ie,Ve,Yr],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0});var go=Na;var Va=class Va{};Va.\u0275fac=function(e){return new(e||Va)},Va.\u0275cmp=N({type:Va,selectors:[["app-display-page"]],decls:1,vars:0,template:function(e,a){e&1&&x(0,"router-outlet")},dependencies:[_i],encapsulation:2,changeDetection:0});var yo=Va;var Fa=class Fa{};Fa.\u0275fac=function(e){return new(e||Fa)},Fa.\u0275cmp=N({type:Fa,selectors:[["app-displays-page"]],decls:1,vars:0,template:function(e,a){e&1&&x(0,"router-outlet")},dependencies:[_i],encapsulation:2,changeDetection:0});var Co=Fa;var Ba=class Ba{constructor(i,e,a,n){this.dialogRef=i;this.yamcs=e;this.messageService=a;this.data=n;this.form=new xr({queryName:new at("",Ce.required),name:new at(""),link:new at(""),filter:new at(""),shared:new at(!1,Ce.required)});this.form.patchValue({name:n.name,link:n.link,filter:n.filter||void 0})}save(){let{value:i}=this.form;this.yamcs.yamcsClient.createQuery(this.yamcs.instance,"packets",{name:i.queryName,shared:i.shared??!1,query:{name:i.name!=="ANY"?i.name:void 0,link:i.link!=="ANY"?i.link:void 0,filter:i.filter??void 0}}).then(e=>this.dialogRef.close(e)).catch(e=>this.messageService.showError(e))}};Ba.\u0275fac=function(e){return new(e||Ba)(S(Re),S(W),S(Je),S(He))},Ba.\u0275cmp=N({type:Ba,selectors:[["app-create-packet-query-dialog"]],decls:19,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Query name"],["formControlName","queryName","type","text"],["label","Query"],["formControlName","filter"],["label","Packet name"],["formControlName","name","emptyOption","Any name",3,"options"],["label","Link"],["formControlName","link","emptyOption","Any link",3,"options"],["label","Share with other users"],["formControlName","shared"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Save query"),o(),l(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),x(5,"input",3),o(),l(6,"ya-field",4),x(7,"ya-filter-textarea",5),o(),l(8,"ya-field",6),x(9,"ya-select",7),o(),l(10,"ya-field",8),x(11,"ya-select",9),o(),l(12,"ya-field",10),x(13,"mat-slide-toggle",11),o()()(),l(14,"mat-dialog-actions",12)(15,"ya-button",13),p(16,"CANCEL"),o(),l(17,"ya-button",14),E("click",function(){return a.save()}),p(18,"SAVE"),o()()),e&2&&(c(3),g("formGroup",a.form),c(6),g("options",a.data.nameOptions),c(2),g("options",a.data.linkOptions),c(6),g("disabled",!a.form.valid))},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,Dr,me,ke,Fr,it],encapsulation:2,changeDetection:0});var bo=Ba;var Jm=["*"],ed=()=>({matrixParams:"exact",paths:"exact",queryParams:"ignored"}),mc=t=>({c:t}),$a=class $a{constructor(i){this.yamcs=i}};$a.\u0275fac=function(e){return new(e||$a)(S(W))},$a.\u0275cmp=N({type:$a,selectors:[["app-packets-page-tabs"]],ngContentSelectors:Jm,decls:9,vars:12,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["routerLink","/telemetry/packets","routerLinkActive","",3,"routerLinkActiveOptions","queryParams"],["routerLink","/telemetry/packets/queries","routerLinkActive","",3,"queryParams"],["actions",""]],template:function(e,a){if(e&1&&(_s(),l(0,"ya-page-tabs")(1,"a",2,0),p(3," Query "),o(),l(4,"a",3,1),p(6," Saved queries "),o(),H(7,4),gs(8),Y(),o()),e&2){let n=K(2),r=K(5);c(),ae("active",n.isActive),g("routerLinkActiveOptions",fi(7,ed))("queryParams",Q(8,mc,a.yamcs.context)),c(3),ae("active",r.isActive),g("queryParams",Q(10,mc,a.yamcs.context))}},dependencies:[$,Ee,Zi,la],encapsulation:2,changeDetection:0});var Ha=$a;function Ya(t,i,e,a){let n=i.label+' = ""',r=Tr(t.state,n,e,a);r.selection={anchor:e+n.length-1},t.dispatch(r)}function xo(t,i,e,a){t.dispatch(Tr(t.state,i.label+" = ",e,a))}function Al(t,i,e,a){t.dispatch(Tr(t.state,i.label+" ",e,a))}var dc=[{label:"name",type:"method",info:"Filter by packet name",apply:Ya},{label:"binary",type:"method",info:"Filter by hex packet binary",apply:Ya},{label:"link",type:"method",info:"Filter by link",apply:Ya},{label:"seqNumber",type:"method",info:"Filter by packet sequence number",apply:xo},{label:"size",type:"method",info:"Filter by packet size",apply:xo},{section:"Exclude packets",label:"-name",type:"method",info:"Exclude packets based on name",apply:Ya},{section:"Exclude packets",label:"-binary",type:"method",info:"Exclude packets based on hex packet binary",apply:Ya},{section:"Exclude packets",label:"-link",type:"method",info:"Exclude packets based on link",apply:Ya},{section:"Exclude packets",label:"-seqNumber",type:"method",info:"Exclude packets based on sequence number",apply:xo},{section:"Exclude packets",label:"-size",type:"method",info:"Exclude packets based on packet size",apply:xo},{section:"Logical operators",label:"AND",type:"constant",apply:Al},{section:"Logical operators",label:"OR",type:"constant",apply:Al},{section:"Logical operators",label:"NOT",type:"constant",apply:Al}];var Ga=class Ga{constructor(i){this.yamcs=i}transform(i){if(!i)return null;let e=this.yamcs.instance;return this.yamcs.yamcsClient.getPacketDownloadURL(e,i.id.name,i.generationTime,i.sequenceNumber)}};Ga.\u0275fac=function(e){return new(e||Ga)(S(W,16))},Ga.\u0275pipe=gr({name:"packetDownloadLink",type:Ga,pure:!0});var So=Ga;var wo=class{constructor(){this.dirty=!1;this.archivePackets=[]}addArchiveData(i){this.archivePackets=this.archivePackets.concat(i),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}};var To=class extends Kt{constructor(e,a){super();this.yamcs=e;this.pageSize=100;this.blockHasMore=!1;this.packets$=new G([]);this.loading$=new G(!1);this.syncSubscription=a.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitPackets(),this.buffer.dirty=!1)}),this.buffer=new wo}connect(){return this.packets$}emitPackets(){this.packets$.next(this.buffer.snapshot())}loadEntries(e,a){return this.loading$.next(!0),this.loadPage(Pt(mt({},a),{limit:this.pageSize})).then(n=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n),this.emitPackets()})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(e){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,Pt(mt({},e),{fields:["id","generationTime","earthReceptionTime","receptionTime","sequenceNumber","link","size"]})).then(a=>(this.continuationToken=a.continuationToken,a.packets||[]))}async loadMoreData(e){if(this.continuationToken)return this.loadPage(Pt(mt({},e),{next:this.continuationToken,limit:this.pageSize})).then(a=>{this.buffer.addArchiveData(a),this.emitPackets()})}disconnect(){this.syncSubscription?.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}};var td=["searchFilter"];function id(t,i){if(t&1&&(p(0),T(1,"deltaWith")),t&2){let e=h();O(" (",We(1,1,e.earthReceptionTime,e.generationTime),") ")}}function ad(t,i){if(t&1){let e=F();p(0," Binary "),l(1,"ya-more",49)(2,"button",50),E("click",function(){k(e);let n=h(),r=h();return A(r.copyHex(n))}),p(3,"Copy hex"),o(),l(4,"button",50),E("click",function(){k(e);let n=h(),r=h();return A(r.copyBinary(n))}),p(5,"Copy binary"),o(),x(6,"mat-divider"),l(7,"ya-download-menu-item",21),T(8,"packetDownloadLink"),p(9," Download "),o()()}if(t&2){let e=h();c(7),g("link",D(8,1,e))}}function nd(t,i){if(t&1&&(l(0,"ya-detail-toolbar"),p(1,"Packet detail"),o(),l(2,"ya-attr-list",40)(3,"ya-attr",41),p(4),o(),l(5,"ya-attr",42),p(6),T(7,"datetime"),o(),l(8,"ya-attr",43),p(9),T(10,"datetime"),C(11,id,2,4),o(),l(12,"ya-attr",44),p(13),T(14,"datetime"),T(15,"deltaWith"),o(),l(16,"ya-attr",45),p(17),o(),l(18,"ya-attr",46),p(19),T(20,"formatBytes"),o(),l(21,"ya-attr"),I(22,ad,10,3,"ng-template",47),x(23,"app-hex",48,3),o()()),t&2){let e=i;c(4),O(" ",e.id.name," "),c(2),O(" ",D(7,9,e.generationTime)," "),c(3),O(" ",D(10,11,e.earthReceptionTime)||"-"," "),c(2),b(e.earthReceptionTime?11:-1),c(2),Qt(" ",D(14,13,e.receptionTime)," (",We(15,15,e.receptionTime,e.generationTime),") "),c(4),O(" ",e.link||"-"," "),c(2),O(" ",D(20,18,e.size)," "),c(4),g("base64String",e.packet)}}function rd(t,i){t&1&&(l(0,"ya-detail-toolbar"),p(1,"Select a packet"),o())}function od(t,i){if(t&1){let e=F();x(0,"ya-date-time-input",51)(1,"ya-date-time-input",52),l(2,"ya-button",39),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),p(3,"Apply"),o()}if(t&2){let e=h();c(2),g("disabled",e.filterForm.invalid)}}function ld(t,i){t&1&&x(0,"ya-dots")}function sd(t,i){if(t&1){let e=F();p(0," \xA0 "),l(1,"a",53),E("click",function(n){return k(e),h(2),K(24).doSearch(),A(n.preventDefault())}),p(2," Apply filter "),o(),p(3," . ")}}function cd(t,i){if(t&1&&(l(0,"ya-table-top"),p(1," The search filter has changed. "),C(2,sd,4,0),T(3,"async"),o()),t&2){h();let e=K(24);c(2),b(D(3,1,e.errorState$)?-1:2)}}function pd(t,i){t&1&&(l(0,"th",54),p(1,"Packet name"),o())}function md(t,i){if(t&1&&(l(0,"td",55),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.id.name," ")}}function dd(t,i){t&1&&(l(0,"th",54),p(1,"Generation time"),o())}function ud(t,i){if(t&1&&(l(0,"td",55),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.generationTime)," ")}}function hd(t,i){t&1&&(l(0,"th",54),p(1,"Seq"),o())}function fd(t,i){if(t&1&&(l(0,"td",55),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.sequenceNumber??"-"," ")}}function _d(t,i){t&1&&(l(0,"th",54),p(1,"Earth reception time"),o())}function gd(t,i){if(t&1&&(l(0,"td",55),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.earthReceptionTime)||"-"," ")}}function vd(t,i){t&1&&(l(0,"th",54),p(1,"Reception time"),o())}function yd(t,i){if(t&1&&(l(0,"td",55),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.receptionTime)," ")}}function Cd(t,i){t&1&&(l(0,"th",54),p(1,"Link"),o())}function bd(t,i){if(t&1&&(l(0,"td",55),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.link||"-"," ")}}function xd(t,i){t&1&&(l(0,"th",54),p(1,"Size"),o())}function Sd(t,i){if(t&1&&(l(0,"td",55),p(1),T(2,"formatBytes"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.size)," ")}}function wd(t,i){t&1&&x(0,"th",56)}function Td(t,i){if(t&1){let e=F();l(0,"td",55)(1,"ya-text-action",57),E("click",function(){let n=k(e).$implicit,r=h();return A(r.extractPacket(n))}),p(2,"Extract"),o(),l(3,"ya-more")(4,"button",50),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyHex(n))}),p(5,"Copy hex"),o(),l(6,"button",50),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyBinary(n))}),p(7,"Copy binary"),o(),x(8,"mat-divider"),l(9,"ya-download-menu-item",21),T(10,"packetDownloadLink"),p(11," Download "),o()()()}if(t&2){let e=i.$implicit;c(9),g("link",D(10,1,e))}}function Dd(t,i){t&1&&x(0,"tr",58)}function Pd(t,i){if(t&1){let e=F();l(0,"tr",59),E("click",function(){let n=k(e).$implicit,r=h();return A(r.selectPacket(n))}),o()}if(t&2){let e=i.$implicit,a=h();ae("selected",a.isSelected(e))}}var Ua="PT1H",qa=class qa extends ia{constructor(e,a,n){super();this.dialog=e;this.route=a;this.clipboard=n;this.filter=ot();this.name=ot();this.link=ot();this.interval=ot();this.customStart=ot();this.customStop=ot();this.parseFilterSubscription=ot.required();this.columns=[{id:"packetName",label:"Packet name",alwaysVisible:!0},{id:"generationTime",label:"Generation time",alwaysVisible:!0},{id:"earthReceptionTime",label:"Earth reception time",visible:!1},{id:"receptionTime",label:"Reception time",visible:!0},{id:"sequenceNumber",label:"Sequence number",visible:!1},{id:"link",label:"Link",visible:!0},{id:"size",label:"Size",visible:!0},{id:"actions",label:"",alwaysVisible:!0}];this.searchFilter=Ss.required("searchFilter");this.completions=dc;this.filterForm=new ut({filter:new at(null),name:new ne("ANY"),link:new ne("ANY"),interval:new at(Ua),customStart:new at(null),customStop:new at(null)});this.detailPacket$=new G(null);this.nameOptions$=new G([{id:"ANY",label:"Any name"}]);this.linkOptions$=new G([{id:"ANY",label:"Any link"}]);this.downloadURL$=new G(null);this.setTitle("Packets"),this.dataSource=new To(this.yamcs,this.synchronizer),this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(r=>{for(let s of r.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:s,label:s}]);for(let s of r.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:s,label:s}])})}ngOnInit(){this.parseFilterSubscription().addMessageListener(e=>{e.errorMessage?this.searchFilter().addErrorMark(e.errorMessage,{beginLine:e.beginLine,beginColumn:e.beginColumn,endLine:e.endLine,endColumn:e.endColumn}):this.searchFilter().clearErrorMark()}),this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.forEach(e=>{this.loadData()}),this.filterForm.get("name").valueChanges.forEach(e=>{this.loadData()}),this.filterForm.get("link").valueChanges.forEach(e=>{this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(a)),this.filterForm.get("customStop").setValue(B.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){if(this.filter()){let e=this.filter();this.filterForm.get("filter").setValue(e)}if(this.name()){let e=this.name();this.filterForm.get("name").setValue(e)}if(this.link()){let e=this.link();this.filterForm.get("link").setValue(e)}if(this.interval())if(this.appliedInterval=this.interval(),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=this.customStart();this.filterForm.get("customStart").setValue(e),this.validStart=B.toDate(e);let a=this.customStop();this.filterForm.get("customStop").setValue(a),this.validStop=B.toDate(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Ua,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Ua)}jumpToNow(){let e=this.filterForm.value.interval;e==="NO_LIMIT"?this.filterForm.get("interval").setValue(Ua):e==="CUSTOM"?this.filterForm.get("interval").setValue(Ua):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){let{controls:e}=this.filterForm;this.validStart=B.toDate(e.customStart.value),this.validStop=B.toDate(e.customStop.value),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let{controls:e}=this.filterForm;this.updateURL();let a={};this.validStart&&(a.start=this.validStart.toISOString()),this.validStop&&(a.stop=this.validStop.toISOString());let n=e.filter.value;n&&(a.filter=n);let r=e.name.value;r!=="ANY"&&(a.name=[r]);let s=e.link.value;s!=="ANY"&&(a.link=s);let d={};this.validStart&&(d.start=this.validStart.toISOString()),this.validStop&&(d.stop=this.validStop.toISOString()),r!=="ANY"&&(d.name=r),s!=="ANY"&&(d.link=s),this.dataSource.loadEntries("realtime",a).then(m=>{let u=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,d);this.downloadURL$.next(u)}).catch(m=>this.messageService.showError(m))}loadMoreData(){let{controls:e}=this.filterForm,a={};this.validStart&&(a.start=this.validStart.toISOString());let n=e.filter.value;n&&(a.filter=n);let r=e.name.value;r&&r!=="ANY"&&(a.name=[r]);let s=e.link.value;s&&s!=="ANY"&&(a.link=s),this.dataSource.loadMoreData(a).catch(d=>this.messageService.showError(d))}copyHex(e){this.fetchPacket(e).then(a=>{let n=B.convertBase64ToHex(a.packet??"");this.clipboard.copy(n)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}).catch(a=>this.messageService.showError(a))}copyBinary(e){this.fetchPacket(e).then(a=>{let n=window.atob(a.packet??"");this.clipboard.copy(n)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}).catch(a=>this.messageService.showError(a))}updateURL(){let{controls:e}=this.filterForm;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:e.filter.value||null,name:e.name.value==="ANY"?null:e.name.value,link:e.link.value==="ANY"?null:e.link.value,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(e){this.fetchPacket(e).then(a=>{this.detailPacket$.next(a),this.openDetailPane()}).catch(a=>this.messageService.showError(a))}fetchPacket(e){return this.yamcs.yamcsClient.getPacket(this.yamcs.instance,e.id.name,e.generationTime,e.sequenceNumber)}extractPacket(e){this.router.navigate(["/telemetry/packets"+e.id.name,"-","log",e.generationTime,e.sequenceNumber],{queryParams:{c:this.yamcs.context}})}isSelected(e){let a=this.detailPacket$.value;return a?e.id.name===a.id.name&&e.generationTime===a.generationTime&&e.sequenceNumber===a.sequenceNumber:!1}clearQuery(){this.filterForm.reset({severity:"INFO",source:[],interval:Ua})}openSaveQueryDialog(){let{controls:e}=this.filterForm;this.dialog.open(bo,{width:"800px",data:{name:e.name.value,nameOptions:this.nameOptions$.value,link:e.link.value,linkOptions:this.linkOptions$.value,filter:this.searchFilter().getTypedValue()}}).afterClosed().subscribe(a=>{a&&this.messageService.showInfo("Query saved")})}parseQuery(e){this.parseFilterSubscription().sendMessage({resource:"packets",filter:e})}isClearQueryEnabled(){let e=this.filterForm.value;return this.searchFilter().empty()||e.name!=="ANY"||e.link!=="ANY"}ngOnDestroy(){this.parseFilterSubscription().cancel()}};qa.\u0275fac=function(a){return new(a||qa)(S(Le),S(Pe),S(ea))},qa.\u0275cmp=N({type:qa,selectors:[["ng-component"]],viewQuery:function(a,n){a&1&&ys(n.searchFilter,td,5),a&2&&Cs()},inputs:{filter:[1,"filter"],name:[1,"name"],link:[1,"link"],interval:[1,"interval"],customStart:[1,"customStart"],customStop:[1,"customStop"],parseFilterSubscription:[1,"parseFilterSubscription"]},features:[Wi],decls:75,vars:36,consts:[["searchFilter",""],["exportMenu","matMenu"],["columnChooser",""],["hexdump",""],["label","Packets"],["icon","refresh",3,"clicked"],[1,"table-wrapper"],["appearance","text","icon","clear",3,"click","disabled"],["appearance","text","icon","save",3,"click"],[1,"query",2,"margin-top","16px",3,"formGroup"],["icon","access_time","formControlName","interval"],["id","PT1H","label","Last hour"],["id","PT6H","label","Last 6 hours"],["id","P1D","label","Last 24 hours"],["id","NO_LIMIT","label","No limit"],["id","CUSTOM","label","Custom","group","true"],["formControlName","filter","placeholder","Search packets",2,"flex","1 1 auto",3,"typedValue","completions"],["formControlName","name",3,"options"],["formControlName","link",3,"options"],[3,"duration","start","stop"],[1,"ya-menu"],[3,"link"],["icon","download","appearance","text","dropdown","true",3,"matMenuTriggerFor","disabled"],["preferenceKey","tmPackets","appearance","text","icon","view_columns",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","sequenceNumber"],["matColumnDef","earthReceptionTime"],["matColumnDef","receptionTime"],["matColumnDef","link"],["matColumnDef","size"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["appearance","bottom","align","center"],[3,"click","disabled"],[2,"padding","0 16px 16px 16px"],["label","Packet name"],["label","Generation time"],["label","Earth reception time"],["label","Reception time"],["label","Link"],["label","Size"],["ya-attr-label",""],[3,"base64String"],["icon","more_horiz"],["mat-menu-item","",3,"click"],["formControlName","customStart"],["formControlName","customStop"],["href","",1,"ya-link",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["icon","output",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,n){if(a&1){let r=F();l(0,"ya-instance-page")(1,"ya-instance-toolbar",4)(2,"ya-page-button",5),E("clicked",function(){return k(r),A(n.jumpToNow())}),p(3,"Jump to now"),o()(),l(4,"ya-detail-pane"),C(5,nd,25,20),T(6,"async"),Ft(7,rd,2,0,"ya-detail-toolbar"),o(),l(8,"div",6)(9,"ya-panel")(10,"app-packets-page-tabs")(11,"ya-button",7),E("click",function(){return k(r),A(n.clearQuery())}),p(12," Clear query "),o(),l(13,"ya-button",8),E("click",function(){return k(r),A(n.openSaveQueryDialog())}),p(14," Save query "),o()(),l(15,"ya-filter-bar",9)(16,"ya-select",10),x(17,"ya-option",11)(18,"ya-option",12)(19,"ya-option",13)(20,"ya-option",14)(21,"ya-option",15),o(),C(22,od,4,1),l(23,"ya-search-filter2",16,0),E("typedValue",function(d){return k(r),A(n.parseQuery(d))}),o(),x(25,"ya-select",17),T(26,"async"),x(27,"ya-select",18),T(28,"async"),o(),l(29,"ya-table-window",19),C(30,ld,1,0,"ya-dots"),T(31,"async"),l(32,"mat-menu",20,1)(34,"ya-download-menu-item",21),T(35,"async"),p(36,"Raw dump"),o()(),l(37,"ya-button",22),T(38,"async"),p(39," Export "),o(),x(40,"ya-column-chooser",23,2),o(),C(42,cd,4,3,"ya-table-top"),l(43,"table",24),H(44,25),I(45,pd,2,0,"th",26)(46,md,2,1,"td",27),Y(),H(47,28),I(48,dd,2,0,"th",26)(49,ud,3,3,"td",27),Y(),H(50,29),I(51,hd,2,0,"th",26)(52,fd,2,1,"td",27),Y(),H(53,30),I(54,_d,2,0,"th",26)(55,gd,3,3,"td",27),Y(),H(56,31),I(57,vd,2,0,"th",26)(58,yd,3,3,"td",27),Y(),H(59,32),I(60,Cd,2,0,"th",26)(61,bd,2,1,"td",27),Y(),H(62,33),I(63,xd,2,0,"th",26)(64,Sd,3,3,"td",27),Y(),H(65,34),I(66,wd,1,0,"th",35)(67,Td,12,3,"td",27),Y(),I(68,Dd,1,0,"tr",36),T(69,"async"),I(70,Pd,1,2,"tr",37),T(71,"async"),o(),l(72,"ya-toolbar",38)(73,"ya-button",39),E("click",function(){return k(r),A(n.loadMoreData())}),p(74,"Load more"),o()()()()()}if(a&2){let r,s,d=K(24),m=K(33),u=K(41);c(5),b((r=D(6,20,n.detailPacket$))?5:7,r),c(6),g("disabled",!n.isClearQueryEnabled()),c(4),g("formGroup",n.filterForm),c(7),b(n.filterForm.value.interval==="CUSTOM"?22:-1),c(),g("completions",n.completions),c(2),g("options",D(26,22,n.nameOptions$)),c(2),g("options",D(28,24,n.linkOptions$)),c(2),g("duration",n.appliedInterval)("start",n.validStart)("stop",n.validStop),c(),b(D(31,26,n.dataSource.loading$)?30:-1),c(4),g("link",D(35,28,n.downloadURL$)),c(3),g("matMenuTriggerFor",m)("disabled",!((s=D(38,30,n.dataSource.packets$))!=null&&s.length)),c(3),g("columns",n.columns),c(2),b(d.dirty()?42:-1),c(),g("dataSource",n.dataSource),c(25),g("matHeaderRowDef",D(69,32,u.displayedColumns$)),c(2),g("matRowDefColumns",D(71,34,u.displayedColumns$)),c(3),g("disabled",!n.dataSource.hasMore())}},dependencies:[ma,Ha,$,pe,ve,ye,Se,Ar,ti,Qi,ht,Ki,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,Rr,Mr,me,ii,wt,na,ra,ai,Hs,Ot,et,tt,Nt,oa,vt,ze,js,it,zs,xi,oi,si,So,ie,Ve,ca,Qs],styles:[".ya-filter-bar.query[_ngcontent-%COMP%]{height:unset}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-wrapper[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var Do=qa;var ja=class ja{constructor(i,e,a,n){this.dialogRef=i;this.yamcs=e;this.messageService=a;this.data=n;this.form=new xr({queryName:new at("",Ce.required),name:new at(""),link:new at(""),filter:new at(""),shared:new at(!1,Ce.required)});let{query:r}=n;this.form.patchValue({queryName:r.name,name:r.query.name||"ANY",link:r.query.link||"ANY",filter:r.query.filter||void 0,shared:r.shared})}save(){let{value:i}=this.form,e=this.data.query.id;this.yamcs.yamcsClient.editQuery(this.yamcs.instance,"packets",e,{name:i.queryName,shared:i.shared??!1,query:{name:i.name!=="ANY"?i.name:void 0,link:i.link!=="ANY"?i.link:void 0,filter:i.filter??void 0}}).then(a=>this.dialogRef.close(a)).catch(a=>this.messageService.showError(a))}};ja.\u0275fac=function(e){return new(e||ja)(S(Re),S(W),S(Je),S(He))},ja.\u0275cmp=N({type:ja,selectors:[["app-edit-packet-query-dialog"]],decls:19,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Query name"],["formControlName","queryName","type","text"],["label","Query"],["formControlName","filter"],["label","Packet name"],["formControlName","name","emptyOption","Any name",3,"options"],["label","Link"],["formControlName","link","emptyOption","Any link",3,"options"],["label","Share with other users"],["formControlName","shared"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Edit query"),o(),l(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),x(5,"input",3),o(),l(6,"ya-field",4),x(7,"ya-filter-textarea",5),o(),l(8,"ya-field",6),x(9,"ya-select",7),o(),l(10,"ya-field",8),x(11,"ya-select",9),o(),l(12,"ya-field",10),x(13,"mat-slide-toggle",11),o()()(),l(14,"mat-dialog-actions",12)(15,"ya-button",13),p(16,"CANCEL"),o(),l(17,"ya-button",14),E("click",function(){return a.save()}),p(18,"SAVE"),o()()),e&2&&(c(3),g("formGroup",a.form),c(6),g("options",a.data.nameOptions),c(2),g("options",a.data.linkOptions),c(6),g("disabled",!a.form.valid))},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,Dr,me,ke,Fr,it],encapsulation:2,changeDetection:0});var Po=ja;var Ed=(t,i,e,a)=>({filter:t,name:i,link:e,c:a});function kd(t,i){t&1&&(l(0,"th",11),p(1,"Name"),o())}function Ad(t,i){if(t&1&&(l(0,"td",12)(1,"a",13),p(2),o()()),t&2){let e=i.$implicit,a=h();c(),g("queryParams",xs(2,Ed,e.query.filter,e.query.name,e.query.link,a.yamcs.context)),c(),O(" ",e.name," ")}}function Md(t,i){t&1&&(l(0,"th",14),p(1,"Visibility"),o())}function Rd(t,i){if(t&1&&(l(0,"td",12),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.shared?"Shared":"Private"," ")}}function Ld(t,i){t&1&&x(0,"th",15)}function Id(t,i){if(t&1){let e=F();l(0,"td",12)(1,"ya-more")(2,"button",16),E("click",function(){let n=k(e).$implicit,r=h();return A(r.openEditQueryDialog(n))}),p(3,"Edit query"),o(),l(4,"button",16),E("click",function(){let n=k(e).$implicit,r=h();return A(r.openDeleteQueryDialog(n))}),p(5,"Delete query"),o()()()}}function Od(t,i){t&1&&x(0,"tr",17)}function Nd(t,i){t&1&&x(0,"tr",18)}var za=class za{constructor(i,e,a){this.yamcs=i;this.messageService=e;this.dialog=a;this.displayedColumns=["name","visibility","actions"];this.dataSource=new Lt;this.nameOptions$=new G([{id:"ANY",label:"Any name"}]);this.linkOptions$=new G([{id:"ANY",label:"Any link"}]);this.refreshTable(),this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(n=>{for(let r of n.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:r,label:r}]);for(let r of n.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:r,label:r}])})}refreshTable(){this.yamcs.yamcsClient.getQueries(this.yamcs.instance,"packets").then(i=>this.dataSource.data=i).catch(i=>this.messageService.showError(i))}openEditQueryDialog(i){this.dialog.open(Po,{width:"800px",data:{query:i,nameOptions:this.nameOptions$.value,linkOptions:this.linkOptions$.value}}).afterClosed().subscribe(e=>{e&&(this.refreshTable(),this.messageService.showInfo("Query updated"))})}openDeleteQueryDialog(i){confirm(`Are you sure you want to delete query ${i.name}`)&&this.yamcs.yamcsClient.deleteQuery(this.yamcs.instance,"packets",i.id).then(()=>this.refreshTable()).catch(e=>this.messageService.showError(e))}};za.\u0275fac=function(e){return new(e||za)(S(W),S(Je),S(Le))},za.\u0275cmp=N({type:za,selectors:[["app-packet-query-list"]],decls:16,vars:3,consts:[["label","Packets"],["mat-table","",1,"ya-data-table","expand",2,"margin-top","16px",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","style","min-width: 200px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","visibility"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"min-width","200px"],["mat-cell",""],["routerLink","/telemetry/packets",3,"queryParams"],["mat-header-cell",""],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&(l(0,"ya-instance-page"),x(1,"ya-instance-toolbar",0),l(2,"ya-panel"),x(3,"app-packets-page-tabs"),l(4,"table",1),H(5,2),I(6,kd,2,0,"th",3)(7,Ad,3,7,"td",4),Y(),H(8,5),I(9,Md,2,0,"th",6)(10,Rd,2,1,"td",4),Y(),H(11,7),I(12,Ld,1,0,"th",8)(13,Id,6,0,"td",4),Y(),I(14,Od,1,0,"tr",9)(15,Nd,1,0,"tr",10),o()()()),e&2&&(c(4),g("dataSource",a.dataSource),c(10),g("matHeaderRowDef",a.displayedColumns),c(),g("matRowDefColumns",a.displayedColumns))},dependencies:[Ha,$,Ee,ht,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,et,tt,Nt,ze],encapsulation:2});var Eo=za;var Vd=["hex"],Wn=t=>({c:t}),Ml=()=>[];function Fd(t,i){if(t&1&&(x(0,"ya-page-icon-button",40),p(1)),t&2){let e=h(),a=h();g("queryParams",Q(4,Wn,a.yamcs.context)),c(),bs(" ",e.id.name," / ",e.generationTime," / ",e.sequenceNumber," ")}}function Bd(t,i){if(t&1&&(l(0,"tr")(1,"td",43)(2,"mat-icon",44),p(3,"warning"),o()(),l(4,"td",45),p(5),o()()),t&2){let e=i.$implicit;c(5),X(e)}}function $d(t,i){if(t&1&&(l(0,"h4"),p(1,"Warnings"),o(),l(2,"table",41),le(3,Bd,6,1,"tr",null,oe),T(5,"async"),o(),l(6,"div",42),x(7,"mat-divider"),o()),t&2){let e=h(2);c(3),se(D(5,0,e.messages$))}}function Hd(t,i){t&1&&x(0,"th",46)}function Yd(t,i){if(t&1&&x(0,"ya-icon-action",48),t&2){let e=h().$implicit;g("icon",e.expanded?"expand_more":"chevron_right")("padding",!1)}}function Gd(t,i){if(t&1&&(l(0,"td",47),C(1,Yd,1,2,"ya-icon-action",48),o()),t&2){let e=i.$implicit;c(),b(e.type==="CONTAINER"?1:-1)}}function Ud(t,i){t&1&&(l(0,"th",49),p(1,"Loc"),o())}function qd(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.location," ")}}function jd(t,i){if(t&1&&(l(0,"td",50),C(1,qd,1,1),o()),t&2){let e=i.$implicit;c(),b(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function zd(t,i){t&1&&(l(0,"th",46),p(1,"Bits"),o())}function Wd(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.size," ")}}function Xd(t,i){if(t&1&&(l(0,"td",51),C(1,Wd,1,1),o()),t&2){let e=i.$implicit;c(),b(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Zd(t,i){t&1&&x(0,"th",52)}function Qd(t,i){if(t&1&&x(0,"ya-icon-action",54),t&2){let e=h().$implicit;g("icon",e.expanded?"expand_more":"chevron_right")}}function Kd(t,i){if(t&1&&(l(0,"td",53),C(1,Qd,1,1,"ya-icon-action",54),o()),t&2){let e=i.$implicit;c(),b(e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Jd(t,i){t&1&&(l(0,"th",55),p(1,"Entry"),o())}function eu(t,i){if(t&1&&(l(0,"a",57),p(1),T(2,"spaceSystemName"),T(3,"relativize"),o()),t&2){let e=h().$implicit,a=h(2);g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Q(8,Wn,a.yamcs.context)),c(),O(" ",We(3,5,e.parameter.qualifiedName,D(2,3,e.relto.qualifiedName))," ")}}function tu(t,i){t&1&&(l(0,"mat-icon",58),p(1,"chevron_right"),o())}function iu(t,i){if(t&1&&(le(0,tu,2,0,"mat-icon",58,oe),l(2,"a",57),p(3),o()),t&2){let e=h().$implicit,a=h(2);se(fi(3,Ml).constructor(e.depth)),c(2),g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Q(4,Wn,a.yamcs.context)),c(),O(" ",e.name," ")}}function au(t,i){if(t&1&&(l(0,"mat-icon",44),p(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;kt("visibility",e===a-1?"visible":"hidden"),c(),O(" ",n.expanded?"expand_more":"chevron_right"," ")}}function nu(t,i){if(t&1&&(le(0,au,2,3,"mat-icon",59,oe),l(2,"a",57),p(3),o()),t&2){let e=h().$implicit,a=h(2);se(fi(3,Ml).constructor(e.depth)),c(2),g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Q(4,Wn,a.yamcs.context)),c(),O(" ",e.name," ")}}function ru(t,i){if(t&1&&(l(0,"mat-icon",44),p(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;kt("visibility",e===a-1?"visible":"hidden"),c(),O(" ",n.expanded?"expand_more":"chevron_right"," ")}}function ou(t,i){if(t&1&&(le(0,ru,2,3,"mat-icon",59,oe),l(2,"a",57),p(3),o()),t&2){let e=h().$implicit,a=h(2);se(fi(3,Ml).constructor(e.depth)),c(2),g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",Q(4,Wn,a.yamcs.context)),c(),O(" ",e.name," ")}}function lu(t,i){if(t&1&&(l(0,"td",56),C(1,eu,4,10,"a",57),C(2,iu,4,6),C(3,nu,4,6),C(4,ou,4,6),o()),t&2){let e=i.$implicit;c(),b(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1),c(),b(e.type==="SIMPLE_VALUE"?2:-1),c(),b(e.type==="AGGREGATE_VALUE"?3:-1),c(),b(e.type==="ARRAY_VALUE"?4:-1)}}function su(t,i){t&1&&(l(0,"th",60),p(1,"Type"),o())}function cu(t,i){t&1&&p(0," container ")}function pu(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.parameter.type.engType," ")}}function mu(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.parameter.type.engType," ")}}function du(t,i){if(t&1&&p(0),t&2){let e=h().$implicit,a=h(2);O(" ",a.fillTypeWithValueDimension(e.parameter.type.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function uu(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.parameterType.engType," ")}}function hu(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.parameterType.engType," ")}}function fu(t,i){if(t&1&&p(0),t&2){let e=h().$implicit,a=h(2);O(" ",a.fillTypeWithValueDimension(e.parameterType.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function _u(t,i){if(t&1&&(l(0,"td",61),C(1,cu,1,0),C(2,pu,1,1),C(3,mu,1,1),C(4,du,1,1),C(5,uu,1,1),C(6,hu,1,1),C(7,fu,1,1),o()),t&2){let e=i.$implicit;c(),b(e.type==="CONTAINER"?1:-1),c(),b(e.type==="SIMPLE_PARAMETER"?2:-1),c(),b(e.type==="AGGREGATE_PARAMETER"?3:-1),c(),b(e.type==="ARRAY_PARAMETER"?4:-1),c(),b(e.type==="SIMPLE_VALUE"?5:-1),c(),b(e.type==="AGGREGATE_VALUE"?6:-1),c(),b(e.type==="ARRAY_VALUE"?7:-1)}}function gu(t,i){t&1&&(l(0,"th",60),p(1,"Raw value"),o())}function vu(t,i){if(t&1&&x(0,"ya-value",63),t&2){let e=h();g("value",e)}}function yu(t,i){if(t&1&&x(0,"ya-value",63),t&2){let e=h();g("value",e)}}function Cu(t,i){if(t&1&&(C(0,vu,1,1,"ya-value",63),C(1,yu,1,1,"ya-value",63)),t&2){let e=h().$implicit;b(e.type==="SIMPLE_PARAMETER"?0:-1),c(),b(e.type==="SIMPLE_VALUE"?1:-1)}}function bu(t,i){if(t&1&&(l(0,"td",62),C(1,Cu,2,2),o()),t&2){let e,a=i.$implicit;c(),b((e=a.rawValue)?1:-1,e)}}function xu(t,i){t&1&&(l(0,"th",60),p(1,"Engineering value"),o())}function Su(t,i){t&1&&(p(0),T(1,"units")),t&2&&O(" ",D(1,1,i)," ")}function wu(t,i){if(t&1&&(x(0,"ya-value",63),C(1,Su,2,3)),t&2){let e,a=h(),n=h().$implicit;g("value",a),c(),b((e=n.parameter.type==null?null:n.parameter.type.unitSet)?1:-1,e)}}function Tu(t,i){t&1&&(p(0),T(1,"units")),t&2&&O(" ",D(1,1,i)," ")}function Du(t,i){if(t&1&&(x(0,"ya-value",63),C(1,Tu,2,3)),t&2){let e,a=h(),n=h().$implicit;g("value",a),c(),b((e=n.parameterType.unitSet)?1:-1,e)}}function Pu(t,i){if(t&1&&(C(0,wu,2,2),C(1,Du,2,2)),t&2){let e=h().$implicit;b(e.type==="SIMPLE_PARAMETER"?0:-1),c(),b(e.type==="SIMPLE_VALUE"?1:-1)}}function Eu(t,i){if(t&1&&(l(0,"td",62),C(1,Pu,2,2),o()),t&2){let e,a=i.$implicit;c(),b((e=a.engValue)?1:-1,e)}}function ku(t,i){t&1&&x(0,"th",64)}function Au(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.container.qualifiedName," ")}}function Mu(t,i){if(t&1&&(l(0,"td",65),C(1,Au,1,1),o()),t&2){let e=i.$implicit;hs("colspan",4),c(),b(e.type==="CONTAINER"?1:-1)}}function Ru(t,i){t&1&&x(0,"th",66)}function Lu(t,i){if(t&1){let e=F();l(0,"ya-more",68)(1,"button",6),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.selectBitRange(n))}),p(2,"Select in hex view"),o()()}t&2&&g("padding",!1)}function Iu(t,i){if(t&1&&(l(0,"td",67),C(1,Lu,3,1,"ya-more",68),o()),t&2){let e=i.$implicit;c(),b(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Ou(t,i){t&1&&x(0,"tr",69)}function Nu(t,i){if(t&1){let e=F();l(0,"tr",70),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}}function Vu(t,i){if(t&1){let e=F();l(0,"tr",71),E("mouseover",function(){let n=k(e).$implicit,r=h(2);return A(r.highlightBitRange(n))})("mouseout",function(){k(e);let n=h(2);return A(n.clearHighlightedBitRange())})("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);ae("expandable",a.isExpandable(e))}}function Fu(t,i){if(t&1){let e=F();l(0,"ya-instance-page")(1,"ya-instance-toolbar"),I(2,Fd,2,6,"ng-template",1),l(3,"ya-page-button",2),E("clicked",function(){k(e);let n=h();return A(n.expandAll())}),p(4,"Expand all"),o(),l(5,"ya-page-button",3),E("clicked",function(){k(e);let n=h();return A(n.collapseAll())}),p(6,"Collapse all"),o()(),l(7,"ya-detail-pane",4)(8,"ya-detail-toolbar",4),p(9," Hex view "),x(10,"span",5),l(11,"ya-more")(12,"button",6),E("click",function(){let n=k(e),r=h();return A(r.copyHex(n.packet))}),p(13,"Copy hex"),o(),l(14,"button",6),E("click",function(){let n=k(e),r=h();return A(r.copyBinary(n.packet))}),p(15,"Copy binary"),o()()(),l(16,"div",7),x(17,"app-hex",8,0),o()(),l(19,"div",9)(20,"ya-panel"),C(21,$d,8,2),T(22,"async"),l(23,"table",10),H(24,11),I(25,Hd,1,0,"th",12)(26,Gd,2,1,"td",13),Y(),H(27,14),I(28,Ud,2,0,"th",15)(29,jd,2,1,"td",16),Y(),H(30,17),I(31,zd,2,0,"th",12)(32,Xd,2,1,"td",18),Y(),H(33,19),I(34,Zd,1,0,"th",20)(35,Kd,2,1,"td",21),Y(),H(36,22),I(37,Jd,2,0,"th",23)(38,lu,5,4,"td",24),Y(),H(39,25),I(40,su,2,0,"th",26)(41,_u,8,7,"td",27),Y(),H(42,28),I(43,gu,2,0,"th",26)(44,bu,2,1,"td",29),Y(),H(45,30),I(46,xu,2,0,"th",26)(47,Eu,2,1,"td",29),Y(),H(48,31),I(49,ku,1,0,"th",32)(50,Mu,2,2,"td",33),Y(),H(51,34),I(52,Ru,1,0,"th",35)(53,Iu,2,1,"td",36),Y(),I(54,Ou,1,0,"tr",37)(55,Nu,1,0,"tr",38)(56,Vu,1,2,"tr",39),o()()()()}if(t&2){let e,a=h();c(7),g("alwaysOpen",!0),c(),g("alwaysOpen",!0),c(9),g("base64String",i.packet),c(4),b((e=D(22,10,a.messages$))!=null&&e.length?21:-1),c(2),g("dataSource",a.dataSource),c(31),g("matHeaderRowDef",a.displayedColumns),c(),g("matRowDefColumns",a.containerColumns)("matRowDefWhen",a.isContainer),c(),g("matRowDefColumns",a.displayedColumns)("matRowDefWhen",a.isNoContainer)}}var Wa=class Wa extends ia{constructor(e,a){super();this.route=e;this.clipboard=a;this.packetName=ot.required({alias:"packet"});this.packet$=new G(null);this.messages$=new G([]);this.allNodes=[];this.dataSource=new Lt;this.displayedColumns=["icon","location","size","expand-aggray","entry","type","rawValue","engValue","actions"];this.containerColumns=["icon","containerName","type","rawValue","engValue","actions"];this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}]}ngOnInit(){let e=this.packetName(),a=this.route.snapshot.paramMap.get("gentime"),n=Number(this.route.snapshot.paramMap.get("seqno"));this.setTitle(e),this.yamcs.yamcsClient.getPacket(this.yamcs.instance,e,a,n).then(r=>this.packet$.next(r)).catch(r=>this.messageService.showError(r)),this.yamcs.yamcsClient.extractPacket(this.yamcs.instance,e,a,n).then(r=>this.processResponse(r)).catch(r=>this.messageService.showError(r))}processResponse(e){this.messages$.next(e.messages||[]);let a;for(let n of e.parameterValues||[]){if(n.entryContainer.qualifiedName!==a?.container.qualifiedName){let r={type:"CONTAINER",container:n.entryContainer,expanded:!1};this.allNodes.push(r),a=r}this.addParameterNodes(a,n,this.allNodes)}a&&(a.expanded=!0),this.updateDataSource()}addParameterNodes(e,a,n){let{parameter:r,location:s,rawValue:d,engValue:m,size:u}=a;if(r.type?.engType.endsWith("[]")){let v={type:"ARRAY_PARAMETER",parent:e,expanded:!1,parameter:r,location:s,rawValue:d,engValue:m,size:u,relto:e.container};n.push(v);let f=d?.arrayValue||[],y=m?.arrayValue||[],_=r.type.arrayInfo.type;for(let w=0;w<y.length;w++)this.addValueNode(v,r,_,"["+w+"]","["+w+"]",1,f[w],y[w],n)}else if(r.type?.engType==="aggregate"){let v={type:"AGGREGATE_PARAMETER",parent:e,expanded:!1,parameter:r,location:s,rawValue:d,engValue:m,size:u,relto:e.container};n.push(v);let f=d.aggregateValue,y=m.aggregateValue;for(let _=0;_<y.name.length;_++){let w=r.type.member[_].type;this.addValueNode(v,r,w,y.name[_],"."+y.name[_],1,f.value[_],y.value[_],n)}}else n.push({type:"SIMPLE_PARAMETER",parent:e,expanded:!1,parameter:r,location:s,rawValue:d,engValue:m,size:u,relto:e.container})}addValueNode(e,a,n,r,s,d,m,u,v){if(n.engType.endsWith("[]")){let f={type:"ARRAY_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:s,rawValue:m,engValue:u,depth:d};v.push(f);let y=m?.arrayValue||[],_=u?.arrayValue||[];for(let w=0;w<_.length;w++)this.addValueNode(f,a,n.arrayInfo.type,"["+w+"]",s+"["+w+"]",d+1,y[w],_[w],v)}else if(n.engType==="aggregate"){let f={type:"AGGREGATE_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:s,rawValue:m,engValue:u,depth:d};v.push(f);let y=m.aggregateValue,_=u.aggregateValue;for(let w=0;w<_.name.length;w++){let P=n.member[w].type;this.addValueNode(f,a,P,_.name[w],s+"."+_.name[w],d+1,y.value[w],_.value[w],v)}}else v.push({type:"SIMPLE_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:s,rawValue:m,engValue:u,depth:d})}get hex(){return this._hex}set hex(e){this._hex=e}highlightBitRange(e){(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER")&&this.hex?.setHighlight(new Dl(e.location,e.size))}clearHighlightedBitRange(){this.hex?.setHighlight(null)}selectBitRange(e){(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER")&&this.hex?.setSelection(new Dl(e.location,e.size))}toggleRow(e){this.isExpandable(e)&&(e.expanded?this.collapseNode(e):e.expanded=!0),this.updateDataSource()}collapseNode(e){for(let a of this.allNodes)a.parent===e&&this.collapseNode(a);e.expanded=!1,this.updateDataSource()}expandAll(){for(let e of this.allNodes)this.isExpandable(e)&&(e.expanded=!0);this.updateDataSource()}collapseAll(){for(let e of this.allNodes)e.expanded=!1;this.updateDataSource()}isExpandable(e){return e.type==="CONTAINER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"||e.type==="AGGREGATE_VALUE"||e.type==="ARRAY_VALUE"}updateDataSource(){let e=[];for(let a of this.allNodes)(!a.parent||a.parent?.expanded)&&e.push(a);this.dataSource.data=e}isContainer(e,a){return a.type==="CONTAINER"}isNoContainer(e,a){return a.type!=="CONTAINER"}copyHex(e){let a=B.convertBase64ToHex(e);this.clipboard.copy(a)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}copyBinary(e){let a=window.atob(e);this.clipboard.copy(a)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}fillTypeWithValueDimension(e,a){if(e.endsWith("[]")){let n=a?.length||0;e=e.substring(0,e.length-2)+"["+n+"]"}return e.replaceAll("[]","[?]")}};Wa.\u0275fac=function(a){return new(a||Wa)(S(Pe),S(ea))},Wa.\u0275cmp=N({type:Wa,selectors:[["ng-component"]],viewQuery:function(a,n){if(a&1&&ge(Vd,5),a&2){let r;fe(r=_e())&&(n.hex=r.first)}},inputs:{packetName:[1,"packet","packetName"]},features:[Wi],decls:2,vars:3,consts:[["hex",""],["ya-instance-toolbar-label",""],["icon","unfold_more",3,"clicked"],["icon","unfold_less",3,"clicked"],[3,"alwaysOpen"],[2,"flex","1 1 auto"],["mat-menu-item","",3,"click"],[2,"padding","0 16px 16px 16px"],[3,"base64String"],[1,"table-wrapper"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop",4,"matCellDef"],["matColumnDef","location"],["mat-header-cell","","class","no-left-padding","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop right no-left-padding",4,"matCellDef"],["matColumnDef","size"],["mat-cell","","class","vtop right",4,"matCellDef"],["matColumnDef","expand-aggray"],["mat-header-cell","","width","1","class","icon",4,"matHeaderCellDef"],["mat-cell","","class","icon vtop",4,"matCellDef"],["matColumnDef","entry"],["mat-header-cell","","class","entry",4,"matHeaderCellDef"],["mat-cell","","class","entry vtop",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","mono vtop",4,"matCellDef"],["matColumnDef","rawValue"],["mat-cell","","class","vtop wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","containerName"],["mat-header-cell","","class","no-left-padding",4,"matHeaderCellDef"],["mat-cell","","class","no-left-padding",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","","class","icon",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","expandable container",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-row","",3,"expandable","mouseover","mouseout","click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["routerLink","/telemetry/packets","icon","arrow_back",3,"queryParams"],["yaDataTable","",1,"expand"],[1,"section-divider"],[1,"iconcol"],[1,"icon12"],[1,"expand"],["mat-header-cell","","width","1"],["mat-cell","",1,"vtop"],[3,"icon","padding"],["mat-header-cell","","width","1",1,"no-left-padding"],["mat-cell","",1,"vtop","right","no-left-padding"],["mat-cell","",1,"vtop","right"],["mat-header-cell","","width","1",1,"icon"],["mat-cell","",1,"icon","vtop"],[3,"icon"],["mat-header-cell","",1,"entry"],["mat-cell","",1,"entry","vtop"],[1,"ya-link",3,"routerLink","queryParams"],[1,"icon12",2,"visibility","hidden"],[1,"icon12",3,"visibility"],["mat-header-cell",""],["mat-cell","",1,"mono","vtop"],["mat-cell","",1,"vtop","wrap200"],[3,"value"],["mat-header-cell","",1,"no-left-padding"],["mat-cell","",1,"no-left-padding"],["mat-header-cell","",1,"expand"],["mat-cell","",1,"icon"],[3,"padding"],["mat-header-row",""],["mat-row","",1,"expandable","container",3,"click"],["mat-row","",3,"mouseover","mouseout","click"]],template:function(a,n){if(a&1&&(C(0,Fu,57,12,"ya-instance-page"),T(1,"async")),a&2){let r;b((r=D(1,1,n.packet$))?0:-1,r)}},dependencies:[ma,$,Ee,Si,Rt,ti,ht,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,na,ra,Ci,et,tt,li,Nt,vt,bi,ze,sa,ie,ec,qr,ci],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f0f0f0}tr.container[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f0f0f0!important}tr.expandable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}td.vtop[_ngcontent-%COMP%]{vertical-align:top}td.icon[_ngcontent-%COMP%]{padding:0;line-height:25px;text-align:right}th.entry[_ngcontent-%COMP%], td.entry[_ngcontent-%COMP%]{padding-left:7px}td.right[_ngcontent-%COMP%]{text-align:right}th.no-left-padding[_ngcontent-%COMP%], td.no-left-padding[_ngcontent-%COMP%]{padding-left:5px}.icon12[_ngcontent-%COMP%]{vertical-align:middle}"],changeDetection:0});var ko=Wa;var hc=(t,i)=>{let a=dr(W).yamcsClient.createParseFilterSubscription({resource:"packets",filter:""},()=>null);return new Promise((n,r)=>{a.addReplyListener(()=>{n(a)})})};var Bu=t=>({c:t});function $u(t,i){if(t&1&&(x(0,"ya-page-icon-button",12),p(1," Create parameter list ")),t&2){let e=h();g("queryParams",Q(1,Bu,e.yamcs.context))}}function Hu(t,i){t&1&&(l(0,"tr")(1,"td",13),p(2,"No rows to display"),o()())}function Yu(t,i){if(t&1){let e=F();l(0,"tr")(1,"td"),p(2),o(),l(3,"td",14)(4,"ya-icon-action",15),E("click",function(n){let r=k(e).$index;return h(2).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",16),E("click",function(n){let r=k(e).$index;return h(2).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",17),E("click",function(){let n=k(e).$index,r=h(2);return A(r.deletePattern(n))}),p(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;c(2),X(e)}}function Gu(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),p(3,"Pattern"),o(),x(4,"th"),o(),C(5,Hu,3,0,"tr"),le(6,Yu,8,1,"tr",null,oe),o()),t&2){let e=i;c(5),b(e.length?-1:5),c(),se(e)}}var Xa=class Xa{constructor(i,e,a,n,r,s,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=s;this.messageService=d;this.location=m;this.patterns$=new G([]);e.setTitle("Create a Parameter List"),this.form=i.group({name:new ne("",[Ce.required]),description:new ne})}showAddPatternDialog(){this.dialog.open(mi,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&this.patterns$.next([...this.patterns$.value,e])})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value])}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value])}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value])}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patterns:[...this.patterns$.value]};this.yamcs.yamcsClient.createParameterList(this.yamcs.instance,i).then(()=>this.router.navigate([".."],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})).catch(e=>this.messageService.showError(e))}};Xa.\u0275fac=function(e){return new(e||Xa)(S(ei),S(Mt),S(Qe),S(Pe),S(W),S(Le),S(Je),S(yr))},Xa.\u0275cmp=N({type:Xa,selectors:[["ng-component"]],decls:21,vars:5,consts:[["ya-instance-toolbar-label",""],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["label","Name"],["formControlName","name","type","text"],["label","Description"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle",3,"click"],["yaDataTable","",2,"width","100%","margin-top","16px"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["routerLink","..","icon","arrow_back",3,"queryParams"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(l(0,"ya-instance-page")(1,"ya-instance-toolbar"),I(2,$u,2,3,"ng-template",0),o(),l(3,"div",1)(4,"form",2)(5,"ya-field",3),x(6,"input",4),o(),l(7,"ya-field",5),x(8,"textarea",6),o(),x(9,"ya-field-divider"),l(10,"ya-button",7),E("click",function(){return a.showAddPatternDialog()}),p(11," Add parameter or pattern "),o(),C(12,Gu,8,1,"table",8),T(13,"async"),o(),l(14,"p"),p(15,"\xA0"),o(),l(16,"ya-toolbar",9)(17,"ya-button",10),E("click",function(){return a.location.back()}),p(18,"Cancel"),o(),l(19,"ya-button",11),E("click",function(){return a.onConfirm()}),p(20," CREATE "),o()()()()),e&2){let n;c(4),g("formGroup",a.form),c(8),b((n=D(13,3,a.patterns$))?12:-1,n),c(7),g("disabled",!a.form.valid)}},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ee,Si,me,ke,Vr,Ci,et,tt,li,bi,oi,si,ie],encapsulation:2,changeDetection:0});var Ao=Xa;function Uu(t,i){t&1&&(l(0,"tr")(1,"td",12),p(2,"No rows to display"),o()())}function qu(t,i){if(t&1){let e=F();l(0,"tr")(1,"td"),p(2),o(),l(3,"td",13)(4,"ya-icon-action",14),E("click",function(n){let r=k(e).$index;return h(3).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",15),E("click",function(n){let r=k(e).$index;return h(3).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",16),E("click",function(){let n=k(e).$index,r=h(3);return A(r.deletePattern(n))}),p(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;c(2),X(e)}}function ju(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),p(3,"Pattern"),o(),x(4,"th"),o(),C(5,Uu,3,0,"tr"),le(6,qu,8,1,"tr",null,oe),o()),t&2){let e=i;c(5),b(e.length?-1:5),c(),se(e)}}function zu(t,i){if(t&1){let e=F();l(0,"ya-instance-page"),x(1,"ya-instance-toolbar",0),l(2,"div",1)(3,"form",2)(4,"ya-field",3),x(5,"input",4),o(),l(6,"ya-field",5),x(7,"textarea",6),o(),x(8,"ya-field-divider"),l(9,"ya-button",7),E("click",function(){k(e);let n=h();return A(n.showAddPatternDialog())}),p(10," Add parameter or pattern "),o(),C(11,ju,8,1,"table",8),T(12,"async"),o(),l(13,"p"),p(14,"\xA0"),o(),l(15,"ya-toolbar",9)(16,"ya-button",10),E("click",function(){k(e);let n=h();return A(n.location.back())}),p(17,"Cancel"),o(),l(18,"ya-button",11),T(19,"async"),E("click",function(){k(e);let n=h();return A(n.onConfirm())}),p(20," SAVE CHANGES "),o()()()()}if(t&2){let e,a=h();c(),g("label","Edit list: "+i.name),c(2),g("formGroup",a.form),c(8),b((e=D(12,4,a.patterns$))?11:-1,e),c(7),g("disabled",!D(19,6,a.dirty$)||!a.form.valid)}}var Za=class Za{constructor(i,e,a,n,r,s,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=s;this.messageService=d;this.location=m;this.patterns$=new G([]);this.dirty$=new G(!1);e.setTitle("Edit Parameter List");let u=n.snapshot.paramMap.get("list");this.plist$=r.yamcsClient.getParameterList(r.instance,u),this.plist$.then(v=>{this.plist=v,this.form=i.group({name:new ne(v.name,[Ce.required]),description:new ne(v.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)}),this.patterns$.next(v.patterns||[])})}showAddPatternDialog(){this.dialog.open(mi,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&(this.patterns$.next([...this.patterns$.value,e]),this.dirty$.next(!0))})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patternDefinition:{patterns:[...this.patterns$.value]}};this.yamcs.yamcsClient.updateParameterList(this.yamcs.instance,this.plist.id,i).then(()=>this.router.navigateByUrl(`/telemetry/parameter-lists/${this.plist.id}?c=${this.yamcs.context}`)).catch(e=>this.messageService.showError(e))}ngOnDestroy(){this.formSubscription?.unsubscribe()}};Za.\u0275fac=function(e){return new(e||Za)(S(ei),S(Mt),S(Qe),S(Pe),S(W),S(Le),S(Je),S(yr))},Za.\u0275cmp=N({type:Za,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"label"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["label","Name"],["formControlName","name","type","text"],["label","Description"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle",3,"click"],["yaDataTable","",2,"width","100%","margin-top","16px"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(C(0,zu,21,8,"ya-instance-page"),T(1,"async")),e&2){let n;b((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[$,Ke,$e,pe,ve,ye,Se,Si,me,ke,Vr,Ci,et,tt,oi,si,ie],encapsulation:2,changeDetection:0});var Mo=Za;function Wu(t,i){if(t&1){let e=F();x(0,"ya-date-time-input",6)(1,"ya-date-time-input",7),l(2,"ya-button",8),E("click",function(){k(e);let n=h(2);return A(n.applyCustomDates())}),p(3,"Apply"),o()}if(t&2){let e=h(2);c(2),g("disabled",e.filterForm.invalid)}}function Xu(t,i){if(t&1){let e=F();l(0,"ya-button",9),E("click",function(){k(e);let n=h(2);return A(n.jumpToNow())}),p(1,"Jump to now"),o()}}function Zu(t,i){t&1&&(l(0,"th",19),p(1,"Generation time"),o())}function Qu(t,i){if(t&1&&(l(0,"td",20),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.generationTime)," ")}}function Ku(t,i){if(t&1&&(l(0,"th",19),p(1),o()),t&2){let e=h().$implicit;c(),X(e)}}function Ju(t,i){if(t&1&&(l(0,"td",20),p(1),o()),t&2){let e=i.$implicit,a=h().$index;c(),O(" ",e.values[a]??"-"," ")}}function e0(t,i){if(t&1&&(H(0,14),I(1,Ku,2,1,"th",12)(2,Ju,2,1,"td",13),Y()),t&2){let e=i.$implicit;g("cdkColumnDef",e)}}function t0(t,i){t&1&&x(0,"th",21)}function i0(t,i){t&1&&x(0,"td",20)}function a0(t,i){t&1&&x(0,"tr",22)}function n0(t,i){t&1&&x(0,"tr",23)}function r0(t,i){if(t&1&&(l(0,"div",5)(1,"table",10),H(2,11),I(3,Zu,2,0,"th",12)(4,Qu,3,3,"td",13),Y(),le(5,e0,3,1,"ng-container",14,oe),H(7,15),I(8,t0,1,0,"th",16)(9,i0,1,0,"td",13),Y(),I(10,a0,1,0,"tr",17),T(11,"async"),I(12,n0,1,0,"tr",18),T(13,"async"),o()()),t&2){let e=h(2);c(),g("dataSource",e.dataSource),c(4),se(i.headers),c(5),g("matHeaderRowDef",D(11,4,e.displayedColumns$))("matHeaderRowDefSticky",!0),c(2),g("cdkRowDefColumns",D(13,6,e.displayedColumns$))}}function o0(t,i){if(t&1){let e=F();l(0,"ya-panel")(1,"ya-filter-bar",0),x(2,"ya-select",1),C(3,Wu,4,1)(4,Xu,2,0,"ya-button"),x(5,"div",2),l(6,"ya-button",3),E("click",function(){k(e);let n=h();return A(n.exportParameterData())}),p(7," Export CSV "),o()(),x(8,"ya-table-window",4),C(9,r0,14,8,"div",5),T(10,"async"),o()}if(t&2){let e,a=h();c(),g("formGroup",a.filterForm),c(),g("options",a.intervalOptions),c(),b(a.filterForm.value.interval==="CUSTOM"?3:4),c(5),g("duration",a.appliedInterval)("start",a.validStart)("stop",a.validStop),c(),b((e=D(10,7,a.exportData$))?9:-1,e)}}var Qa="PT1H",Ka=class Ka{constructor(i,e,a,n){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new ut({interval:new ne(Qa),customStart:new ne(null),customStop:new ne(null)});this.displayedColumns=["generationTime","actions"];this.displayedColumns$=new G(this.displayedColumns);this.plist$=new G(null);this.exportData$=new G(null);this.dataSource=new Lt;this.plistId=e.snapshot.paramMap.get("list"),this.validStop=a.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Qa),this.appliedInterval=Qa,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(r=>{if(r==="CUSTOM"){let s=this.validStart||this.yamcs.getMissionTime(),d=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(s)),this.filterForm.get("customStop").setValue(B.toISOString(d))}else r==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=r,this.loadData()):(this.validStop=a.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,r),this.appliedInterval=r,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Qa,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Qa)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(Qa):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filterForm.value.customStart),this.validStop=B.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={delimiter:"TAB",limit:100,order:"desc"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,this.plistId).then(e=>{this.plist$.next(e),e.match&&this.yamcs.yamcsClient.exportParameterValues(this.yamcs.instance,Pt(mt({},i),{list:e.id})).then(a=>{let n=this.processCsv(a);this.exportData$.next(n),this.displayedColumns$.next(["generationTime",...n.headers,"actions"]),this.dataSource.data=n.records})})}processCsv(i){let e=[],a=i.split(/\r?\n/);for(let d=1;d<a.length;d++){let m=a[d];if(!m)continue;let u=m.split(/\t/),v={generationTime:u[0],values:[]};for(let f=1;f<u.length;f++)v.values[f-1]=u[f]||null;e.push(v)}return{headers:a[0].split(/\t/).slice(1).map(d=>B.getFilename(d)),records:e}}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){let i=this.plist$.value;if(i?.match){let a=i.name;this.validStart&&this.validStop?a+="_"+this.validStart.toISOString()+"_"+this.validStop.toISOString():this.validStart?a+="_"+this.validStart.toISOString():this.validStop&&(a+="_"+this.validStop.toISOString()),a+=".csv",this.dialog.open(Ca,{width:"400px",data:{list:i.id,start:this.validStart,stop:this.validStop,filename:a}})}}};Ka.\u0275fac=function(e){return new(e||Ka)(S(Qe),S(Pe),S(W),S(Le))},Ka.\u0275cmp=N({type:Ka,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"formGroup"],["icon","access_time","formControlName","interval",3,"options"],[2,"flex","1 1 auto"],["appearance","primary","icon","download",3,"click"],[3,"duration","start","stop"],[1,"table-container"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime","sticky",""],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(C(0,o0,11,9,"ya-panel"),T(1,"async")),e&2){let n;b((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[$,pe,ve,ye,Se,yi,Ut,gi,vi,Ye,gt,st,Ge,Ue,qe,je,me,wt,Ot,ze,it,xi,ie,Ve],styles:[".table-container[_ngcontent-%COMP%]{position:absolute;inset:96px 0 0;overflow:auto;margin-top:24px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;background-color:inherit;border-bottom:none}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background-color:var(--y-background-color);border-left:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}"],changeDetection:0});var Ro=Ka;var Rl=t=>({c:t}),l0=t=>[t,"edit"];function s0(t,i){if(t&1&&(l(0,"ya-page-button",1),p(1," Create list "),o()),t&2){let e=h();g("queryParams",Q(1,Rl,e.yamcs.context))}}function c0(t,i){t&1&&(l(0,"th",13),p(1,"Name"),o())}function p0(t,i){if(t&1&&(l(0,"td",14)(1,"a",15),p(2),o()()),t&2){let e=i.$implicit,a=h();c(),g("routerLink",e.id)("queryParams",Q(3,Rl,a.yamcs.context)),c(),X(e.name)}}function m0(t,i){t&1&&(l(0,"th",13),p(1,"Description"),o())}function d0(t,i){if(t&1&&(l(0,"td",16),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.description||"-"," ")}}function u0(t,i){t&1&&x(0,"th",17)}function h0(t,i){if(t&1){let e=F();l(0,"td",14)(1,"ya-more")(2,"a",18),p(3," Edit list "),o(),l(4,"button",19),E("click",function(){let n=k(e).$implicit,r=h();return A(r.deleteList(n))}),p(5,"Delete list"),o()()()}if(t&2){let e=i.$implicit,a=h();c(2),g("routerLink",Q(2,l0,e.id))("queryParams",Q(4,Rl,a.yamcs.context))}}function f0(t,i){t&1&&x(0,"tr",20)}function _0(t,i){t&1&&x(0,"tr",21)}function g0(t,i){t&1&&(l(0,"ya-empty-message"),p(1,"No rows to display"),o())}var Ja=class Ja{constructor(i,e,a,n,r,s){this.yamcs=i;this.authService=e;this.route=n;this.router=r;this.messageService=s;this.filterControl=new ne;this.displayedColumns=["name","description","actions"];this.dataSource=new Lt;a.setTitle("Parameter lists"),this.dataSource.filterPredicate=(d,m)=>d.name.toLowerCase().indexOf(m)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh()}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}refresh(){this.yamcs.yamcsClient.getParameterLists(this.yamcs.instance).then(i=>{this.dataSource.data=i}).catch(i=>this.messageService.showError(i))}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteList(i){confirm(`Are you sure you want to delete the list '${i.name}'`)&&this.yamcs.yamcsClient.deleteParameterList(this.yamcs.instance,i.id).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}};Ja.\u0275fac=function(e){return new(e||Ja)(S(W),S(St),S(Mt),S(Pe),S(Qe),S(Je))},Ja.\u0275cmp=N({type:Ja,selectors:[["ng-component"]],decls:19,vars:6,consts:[["label","Parameter lists"],["routerLink","create","icon","add_box",3,"queryParams"],["placeholder","Filter lists",3,"formControl"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","vertical-align: top",4,"matCellDef"],["matColumnDef","description"],["mat-cell","","class","wrap400","style","white-space: pre-wrap",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",2,"vertical-align","top"],[3,"routerLink","queryParams"],["mat-cell","",1,"wrap400",2,"white-space","pre-wrap"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&(l(0,"ya-instance-page")(1,"ya-instance-toolbar",0),C(2,s0,2,3,"ya-page-button",1),o(),l(3,"ya-panel")(4,"ya-filter-bar"),x(5,"ya-search-filter",2),o(),l(6,"table",3),H(7,4),I(8,c0,2,0,"th",5)(9,p0,3,5,"td",6),Y(),H(10,7),I(11,m0,2,0,"th",5)(12,d0,2,1,"td",8),Y(),H(13,9),I(14,u0,1,0,"th",10)(15,h0,6,6,"td",6),Y(),I(16,f0,1,0,"tr",11)(17,_0,1,0,"tr",12),o(),C(18,g0,2,0,"ya-empty-message"),o()()),e&2&&(c(2),b(a.mayManageParameterLists()?2:-1),c(3),g("formControl",a.filterControl),c(),g("dataSource",a.dataSource),c(10),g("matHeaderRowDef",a.displayedColumns),c(),g("matRowDefColumns",a.displayedColumns),c(),b(a.dataSource.data.length?-1:18))},dependencies:[$,pe,Jt,Ee,ht,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,ni,Ot,et,tt,Nt,vt,ze,$r],encapsulation:2,changeDetection:0});var Lo=Ja;var Io=class extends Kt{constructor(e,a,n){super();this.yamcs=e;this.synchronizer=a;this.changeDetection=n;this.binaryPreview=16;this.items$=new G([]);this.totalSize$=new G(0);this.loading$=new G(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){return this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,e).then(a=>{this.totalSize$.next(a.totalSize);let n=[];for(let r of a.systems||[])n.push({name:r.qualifiedName,system:r});for(let r of a.parameters||[])n.push({name:B.getMemberPath(r),parameter:r});this.items$.next(n),this.startSubscription(a.parameters||[])}).finally(()=>this.loading$.next(!1))}refreshTable(){let e=this.items$.value;for(let a of e)a.system||(a.pval=this.latestValues.get(a.name));this.items$.next([...e]),this.changeDetection.detectChanges()}startSubscription(e){let a=e.map(n=>({name:B.getMemberPath(n)}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),n.mapping&&this.refreshTable()}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}getAliasNamespaces(){let e=[];for(let a of this.items$.value)if(a.parameter?.alias)for(let n of a.parameter.alias)n.namespace&&e.indexOf(n.namespace)===-1&&e.push(n.namespace);return e.sort()}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var v0=["top"],fc=t=>({c:t}),y0=(t,i)=>({c:t,system:i}),_c=t=>({maxBytes:t});function C0(t,i){if(t&1&&x(0,"ya-breadcrumb",31),t&2){let e=i.$implicit;g("link",e.route)("queryParams",e.queryParams)("label",e.name)}}function b0(t,i){if(t&1&&(l(0,"ya-filter-bar")(1,"ya-breadcrumb-trail"),x(2,"ya-breadcrumb",30),le(3,C0,1,3,"ya-breadcrumb",31,oe),o()()),t&2){let e=h(),a=h();c(2),g("queryParams",Q(1,fc,a.yamcs.context)),c(),se(e)}}function x0(t,i){t&1&&C(0,b0,5,3,"ya-filter-bar"),t&2&&b(i.length?0:-1)}function S0(t,i){t&1&&x(0,"ya-dots")}function w0(t,i){t&1&&(l(0,"th",32),p(1,"Name"),o())}function T0(t,i){if(t&1&&(l(0,"mat-icon",34),p(1,"folder"),o(),l(2,"a",35),p(3),T(4,"filename"),o()),t&2){let e=h().$implicit,a=h();c(2),g("queryParams",Ei(4,y0,a.yamcs.context,e.name)),c(),O(" ",D(4,2,e.name),"/ ")}}function D0(t,i){if(t&1&&x(0,"ya-highlight",37),t&2){let e=h(2).$implicit,a=h();g("text",e.name)("term",a.filterForm.value.filter)}}function P0(t,i){if(t&1&&(x(0,"ya-highlight",37),T(1,"slice")),t&2){let e=h(2).$implicit,a=h();g("text",We(1,2,e.name,i.length+1))("term",a.filterForm.value.filter)}}function E0(t,i){if(t&1&&(l(0,"mat-icon",34),p(1,"toll"),o(),l(2,"a",36),C(3,D0,1,2,"ya-highlight",37),T(4,"async"),C(5,P0,2,5,"ya-highlight",37),T(6,"async"),o()),t&2){let e,a=h().$implicit,n=h();c(2),g("routerLink","/telemetry/parameters"+a.name)("queryParams",Q(8,fc,n.yamcs.context)),c(),b(D(4,4,n.system$)?-1:3),c(2),b((e=D(6,6,n.system$))?5:-1,e)}}function k0(t,i){if(t&1&&(l(0,"td",33),C(1,T0,5,7),C(2,E0,7,10),o()),t&2){let e=i.$implicit;c(),b(e.system?1:-1),c(),b(e.system?-1:2)}}function A0(t,i){t&1&&(l(0,"th",38),p(1,"Raw value"),o())}function M0(t,i){if(t&1&&(l(0,"td",39),p(1),T(2,"value"),o()),t&2){let e=i.$implicit,a=h();c(),O(" ",We(2,1,e.pval==null?null:e.pval.rawValue,Q(4,_c,a.dataSource.binaryPreview))||"-"," ")}}function R0(t,i){t&1&&(l(0,"th",38),p(1,"Value"),o())}function L0(t,i){if(t&1&&(l(0,"span"),p(1),T(2,"parameterTypeForPath"),T(3,"units"),o()),t&2){let e,a=h(2).$implicit;c(),O(" ",D(3,3,(e=D(2,1,a.parameter))==null?null:e.unitSet)," ")}}function I0(t,i){t&1&&(l(0,"span"),p(1,"\u2193"),o())}function O0(t,i){t&1&&(l(0,"span"),p(1,"\u2191"),o())}function N0(t,i){if(t&1&&(l(0,"ya-expirable",40),p(1),T(2,"value"),C(3,L0,4,5,"span"),C(4,I0,2,0,"span"),C(5,O0,2,0,"span"),o()),t&2){let e=h().$implicit,a=h();g("pval",e.pval),c(),O(" ",We(2,5,e.pval==null?null:e.pval.engValue,Q(8,_c,a.dataSource.binaryPreview))||"-"," "),c(2),b(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),c(),b((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),c(),b((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function V0(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function F0(t,i){if(t&1&&(l(0,"td",39),C(1,N0,6,10,"ya-expirable",40),C(2,V0,2,0,"span"),o()),t&2){let e=i.$implicit;ae("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),c(),b(e.pval?1:-1),c(),b(e.pval?-1:2)}}function B0(t,i){t&1&&(l(0,"th",32),p(1,"Generation time"),o())}function $0(t,i){if(t&1&&(l(0,"td",39),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.pval==null?null:e.pval.generationTime)||"-"," ")}}function H0(t,i){t&1&&(l(0,"th",32),p(1,"Reception time"),o())}function Y0(t,i){if(t&1&&(p(0),T(1,"deltaWith")),t&2){let e=h().$implicit;O(" (",We(1,1,e.pval.acquisitionTime,e.pval.generationTime),") ")}}function G0(t,i){if(t&1&&(l(0,"td",39),p(1),T(2,"datetime"),C(3,Y0,2,4),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,2,e.pval==null?null:e.pval.acquisitionTime)||"-"," "),c(2),b(e.pval!=null&&e.pval.generationTime&&(e.pval!=null&&e.pval.acquisitionTime)?3:-1)}}function U0(t,i){t&1&&(l(0,"th",32),p(1,"Type"),o())}function q0(t,i){t&1&&(l(0,"span",41),p(1),o()),t&2&&(c(),O(" ",i," "))}function j0(t,i){t&1&&p(0," - ")}function z0(t,i){if(t&1&&(l(0,"td",39),C(1,q0,2,1,"span",41),T(2,"parameterTypeForPath"),Ft(3,j0,1,0),o()),t&2){let e,a=i.$implicit;c(),b((e=(e=D(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function W0(t,i){t&1&&(l(0,"th",32),p(1,"Data source"),o())}function X0(t,i){if(t&1&&(l(0,"td",39),p(1),T(2,"titlecase"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function Z0(t,i){t&1&&(l(0,"th",38),p(1,"Description"),o())}function Q0(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.system.shortDescription||"-"," ")}}function K0(t,i){if(t&1&&p(0),t&2){let e=h().$implicit;O(" ",e.parameter.shortDescription||"-"," ")}}function J0(t,i){if(t&1&&(l(0,"td",39),C(1,Q0,1,1),C(2,K0,1,1),o()),t&2){let e=i.$implicit;c(),b(e.system?1:-1),c(),b(e.parameter?2:-1)}}function eh(t,i){if(t&1&&(l(0,"th",32),p(1),o()),t&2){let e=h().$implicit;c(),O(" ",e.label," ")}}function th(t,i){if(t&1&&x(0,"ya-highlight",37),t&2){let e=h(3);g("text",i)("term",e.filterForm.value.filter)}}function ih(t,i){t&1&&p(0," - ")}function ah(t,i){if(t&1&&(l(0,"td",39),C(1,th,1,2,"ya-highlight",37),T(2,"alias"),Ft(3,ih,1,0),o()),t&2){let e,a=i.$implicit,n=h().$implicit;c(),b((e=We(2,1,a.parameter,n.id))?1:3,e)}}function nh(t,i){if(t&1&&(H(0,24),I(1,eh,2,1,"th",11)(2,ah,4,4,"td",19),Y()),t&2){let e=i.$implicit;g("matColumnDef",e.id)}}function rh(t,i){t&1&&x(0,"th",42)}function oh(t,i){t&1&&x(0,"td",39)}function lh(t,i){t&1&&x(0,"tr",43)}function sh(t,i){if(t&1&&x(0,"tr",44),t&2){let e=i.$implicit,a=h();ae("selected",a.selection.isSelected(e))}}function ch(t,i){if(t&1&&(l(0,"ya-panel"),p(1," The Mission Database for "),l(2,"i"),p(3),o(),p(4," does not define any parameters. "),o()),t&2){let e=h();c(3),X(e.yamcs.instance)}}var Ll=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"gentime",label:"Generation time",visible:!1},{id:"rectime",label:"Reception time",visible:!1},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],ph=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],mh=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],en=class en{constructor(i,e,a,n,r){this.yamcs=i;this.route=e;this.router=a;this.synchronizer=n;this.filterForm=new ut({filter:new ne,type:new ne("ANY"),source:new ne("ANY")});this.shortName=!1;this.pageSize=100;this.system=null;this.system$=new G(null);this.breadcrumb$=new G([]);this.columns=Ll;this.typeOptions=ph;this.sourceOptions=mh;this.aliasColumns$=new G([]);this.selection=new Ji(!1);this.dataSource=new Io(this.yamcs,this.synchronizer,r)}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filter=i.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),i.has("type")&&(this.type=i.get("type"),this.filterForm.get("type").setValue(this.type)),i.has("source")&&(this.source=i.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(e=>{this.paginator.pageIndex=0,this.filter=e,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(e=>{this.type=e!=="ANY"?e:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(e=>{this.source=e!=="ANY"?e:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(e=>{e.get("system")!==this.system&&this.changeSystem(e)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(i){this.system=i.get("system"),this.updateBrowsePath(),i.has("page")?this.paginator.pageIndex=Number(i.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let i={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(i.q=this.filter,i.searchMembers=!0),this.type&&(i.type=this.type),this.source&&(i.source=this.source),this.dataSource.loadParameters(i).then(()=>{this.selection.clear(),this.updateBrowsePath(),this.system$.next(this.system);let e=[...this.columns];for(let n of this.aliasColumns$.value){let r=e.indexOf(n);r!==-1&&e.splice(r,1)}let a=[];for(let n of this.dataSource.getAliasNamespaces()){let r={id:n,label:n,alwaysVisible:!0};a.push(r)}e.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(e)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let i=[],e="";if(this.system)for(let a of this.system.slice(1).split("/"))e+="/"+a,i.push({name:a,route:"/telemetry/parameters",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(i)}selectNext(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.min(i.indexOf(a)+1,i.length-1))}this.selection.select(i[e])}selectPrevious(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.max(i.indexOf(a)-1,0))}this.selection.select(i[e])}applySelection(){if(this.selection.hasValue()){let i=this.selection.selected[0],e=this.dataSource.items$.value;i.parameter&&e.indexOf(i)!==-1&&this.router.navigate(["/telemetry/parameters"+i.parameter?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe(),this.dataSource.disconnect()}};en.\u0275fac=function(e){return new(e||en)(S(W),S(Pe),S(Qe),S(It),S(At))},en.\u0275cmp=N({type:en,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(ge(v0,7),ge(kr,7),ge(ii,5)),e&2){let n;fe(n=_e())&&(a.top=n.first),fe(n=_e())&&(a.paginator=n.first),fe(n=_e())&&(a.columnChooser=n.first)}},decls:54,vars:26,consts:[["top",""],["columnChooser",""],["empty",""],["label","Parameters"],[3,"formGroup"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","gentime"],["mat-cell","",4,"matCellDef"],["matColumnDef","rectime"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/telemetry/parameters",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1){let n=F();l(0,"ya-instance-page"),x(1,"ya-instance-toolbar",3)(2,"span",null,0),l(4,"ya-panel"),C(5,x0,1,1),T(6,"async"),l(7,"ya-filter-bar",4)(8,"ya-search-filter",5),E("onArrowDown",function(){return k(n),A(a.selectNext())})("onArrowUp",function(){return k(n),A(a.selectPrevious())})("onEnter",function(){return k(n),A(a.applySelection())}),o(),x(9,"ya-select",6)(10,"ya-select",7)(11,"ya-column-chooser",8,1),C(13,S0,1,0,"ya-dots"),T(14,"async"),o(),l(15,"table",9),H(16,10),I(17,w0,2,0,"th",11)(18,k0,3,2,"td",12),Y(),H(19,13),I(20,A0,2,0,"th",14)(21,M0,3,6,"td",15),Y(),H(22,16),I(23,R0,2,0,"th",14)(24,F0,3,4,"td",17),Y(),H(25,18),I(26,B0,2,0,"th",11)(27,$0,3,3,"td",19),Y(),H(28,20),I(29,H0,2,0,"th",11)(30,G0,4,4,"td",19),Y(),H(31,21),I(32,U0,2,0,"th",11)(33,z0,4,3,"td",19),Y(),H(34,22),I(35,W0,2,0,"th",11)(36,X0,3,3,"td",19),Y(),H(37,23),I(38,Z0,2,0,"th",14)(39,J0,3,2,"td",19),Y(),le(40,nh,3,1,"ng-container",24,oe),T(42,"async"),H(43,25),I(44,rh,1,0,"th",26)(45,oh,1,0,"td",19),Y(),I(46,lh,1,0,"tr",27),T(47,"async"),I(48,sh,1,2,"tr",28),T(49,"async"),o(),x(50,"mat-paginator",29),T(51,"async"),o(),I(52,ch,5,1,"ng-template",null,2,ki),o()}if(e&2){let n,r=K(12);c(5),b((n=D(6,14,a.breadcrumb$))?5:-1,n),c(2),g("formGroup",a.filterForm),c(),g("formControl",a.filterForm.controls.filter),c(),g("options",a.typeOptions),c(),g("options",a.sourceOptions),c(),g("columns",a.columns),c(2),b(D(14,16,a.dataSource.loading$)?13:-1),c(2),g("dataSource",a.dataSource),c(25),se(D(42,18,a.aliasColumns$)),c(6),g("matHeaderRowDef",D(47,20,r.displayedColumns$)),c(2),g("matRowDefColumns",D(49,22,r.displayedColumns$)),c(2),g("pageSize",a.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",D(51,24,a.dataSource.totalSize$))}},dependencies:[$,pe,ve,Jt,ye,Se,Ee,Ut,Rt,kr,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,Or,Ir,ii,ai,ri,Ot,Gs,et,tt,ze,$r,it,ie,Es,Xi,Xs,Ve,ca,Yr,pa,ci,qt],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}.alert[_ngcontent-%COMP%]{color:var(--y-error-color)!important}"],changeDetection:0});var Oo=en;var No=class extends Kt{constructor(e,a,n){super();this.yamcs=e;this.synchronizer=a;this.changeDetection=n;this.binaryPreview=16;this.items$=new G([]);this.totalSize$=new G(0);this.loading$=new G(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0);let a=[];for(let n of e)a.push({name:n.qualifiedName,parameter:n});this.items$.next(a),this.startSubscription(e||[])}refreshTable(){let e=this.items$.value;for(let a of e)a.pval=this.latestValues.get(a.name);this.items$.next([...e]),this.changeDetection.detectChanges()}startSubscription(e){let a=e.map(n=>({name:n.qualifiedName}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),this.loading$.next(!1),n.mapping&&this.refreshTable()}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var dh=t=>({c:t}),gc=t=>({maxBytes:t});function uh(t,i){t&1&&x(0,"ya-dots")}function hh(t,i){t&1&&(l(0,"th",20),p(1,"Name"),o())}function fh(t,i){if(t&1&&(l(0,"td",21)(1,"a",22),p(2),o()()),t&2){let e=i.$implicit,a=h(2);c(),g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Q(3,dh,a.yamcs.context)),c(),O(" ",e.name," ")}}function _h(t,i){t&1&&(l(0,"th",23),p(1,"Raw value"),o())}function gh(t,i){if(t&1&&(l(0,"td",21),p(1),T(2,"value"),o()),t&2){let e=i.$implicit,a=h(2);c(),O(" ",We(2,1,e.pval==null?null:e.pval.rawValue,Q(4,gc,a.dataSource.binaryPreview))||"-"," ")}}function vh(t,i){t&1&&(l(0,"th",23),p(1,"Value"),o())}function yh(t,i){if(t&1&&(l(0,"span"),p(1),T(2,"parameterTypeForPath"),T(3,"units"),o()),t&2){let e,a=h(2).$implicit;c(),O(" ",D(3,3,(e=D(2,1,a.parameter))==null?null:e.unitSet)," ")}}function Ch(t,i){t&1&&(l(0,"span"),p(1,"\u2193"),o())}function bh(t,i){t&1&&(l(0,"span"),p(1,"\u2191"),o())}function xh(t,i){if(t&1&&(l(0,"ya-expirable",24),p(1),T(2,"value"),C(3,yh,4,5,"span"),C(4,Ch,2,0,"span"),C(5,bh,2,0,"span"),o()),t&2){let e=h().$implicit,a=h(2);g("pval",e.pval),c(),O(" ",We(2,5,e.pval==null?null:e.pval.engValue,Q(8,gc,a.dataSource.binaryPreview))||"-"," "),c(2),b(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),c(),b((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),c(),b((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function Sh(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function wh(t,i){if(t&1&&(l(0,"td",21),C(1,xh,6,10,"ya-expirable",24)(2,Sh,2,0,"span"),o()),t&2){let e=i.$implicit;ae("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),c(),b(e.pval?1:2)}}function Th(t,i){t&1&&(l(0,"th",20),p(1,"Generation time"),o())}function Dh(t,i){if(t&1&&(l(0,"td",21),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.pval==null?null:e.pval.generationTime)||"-"," ")}}function Ph(t,i){t&1&&(l(0,"th",20),p(1,"Reception time"),o())}function Eh(t,i){if(t&1&&(p(0),T(1,"deltaWith")),t&2){let e=h().$implicit;O(" (",We(1,1,e.pval.acquisitionTime,e.pval.generationTime),") ")}}function kh(t,i){if(t&1&&(l(0,"td",21),p(1),T(2,"datetime"),C(3,Eh,2,4),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,2,e.pval==null?null:e.pval.acquisitionTime)||"-"," "),c(2),b(e.pval!=null&&e.pval.generationTime&&(e.pval!=null&&e.pval.acquisitionTime)?3:-1)}}function Ah(t,i){t&1&&(l(0,"th",20),p(1,"Type"),o())}function Mh(t,i){t&1&&(l(0,"span",25),p(1),o()),t&2&&(c(),O(" ",i," "))}function Rh(t,i){t&1&&p(0," - ")}function Lh(t,i){if(t&1&&(l(0,"td",21),C(1,Mh,2,1,"span",25),T(2,"parameterTypeForPath"),Ft(3,Rh,1,0),o()),t&2){let e,a=i.$implicit;c(),b((e=(e=D(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function Ih(t,i){t&1&&(l(0,"th",20),p(1,"Data source"),o())}function Oh(t,i){if(t&1&&(l(0,"td",21),p(1),T(2,"titlecase"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function Nh(t,i){t&1&&(l(0,"th",23),p(1,"Description"),o())}function Vh(t,i){if(t&1&&(l(0,"td",21),p(1),o()),t&2){let e=i.$implicit;c(),O(" ",e.parameter.shortDescription||"-"," ")}}function Fh(t,i){t&1&&x(0,"th",26)}function Bh(t,i){t&1&&x(0,"td",21)}function $h(t,i){t&1&&x(0,"tr",27)}function Hh(t,i){t&1&&x(0,"tr",28)}function Yh(t,i){if(t&1&&(l(0,"ya-filter-bar"),x(1,"ya-column-chooser",1,0),C(3,uh,1,0,"ya-dots"),T(4,"async"),o(),l(5,"table",2),H(6,3),I(7,hh,2,0,"th",4)(8,fh,3,5,"td",5),Y(),H(9,6),I(10,_h,2,0,"th",7)(11,gh,3,6,"td",8),Y(),H(12,9),I(13,vh,2,0,"th",7)(14,wh,3,3,"td",10),Y(),H(15,11),I(16,Th,2,0,"th",4)(17,Dh,3,3,"td",5),Y(),H(18,12),I(19,Ph,2,0,"th",4)(20,kh,4,4,"td",5),Y(),H(21,13),I(22,Ah,2,0,"th",4)(23,Lh,4,3,"td",5),Y(),H(24,14),I(25,Ih,2,0,"th",4)(26,Oh,3,3,"td",5),Y(),H(27,15),I(28,Nh,2,0,"th",7)(29,Vh,2,1,"td",5),Y(),H(30,16),I(31,Fh,1,0,"th",17)(32,Bh,1,0,"td",5),Y(),I(33,$h,1,0,"tr",18),T(34,"async"),I(35,Hh,1,0,"tr",19),T(36,"async"),o()),t&2){let e=K(2),a=h();c(),g("columns",a.columns),c(2),b(D(4,6,a.dataSource.loading$)?3:-1),c(2),g("dataSource",a.dataSource)("trackBy",a.tableTrackerFn),c(28),g("matHeaderRowDef",D(34,8,e.displayedColumns$)),c(2),g("matRowDefColumns",D(36,10,e.displayedColumns$))}}var tn=class tn{constructor(i,e,a,n){this.yamcs=e;this.synchronizer=a;this.plist$=new G(null);this.columns=Ll;this.tableTrackerFn=(i,e)=>e.name;this.dataSource=new No(this.yamcs,this.synchronizer,n),i.paramMap.subscribe(r=>{let s=r.get("list");this.changeList(s)})}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.dataSource.loadParameters(e.match||[])})}ngOnDestroy(){this.dataSource?.disconnect()}};tn.\u0275fac=function(e){return new(e||tn)(S(Pe),S(W),S(It),S(At))},tn.\u0275cmp=N({type:tn,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&ge(ii,5),e&2){let n;fe(n=_e())&&(a.columnChooser=n.first)}},decls:3,vars:3,consts:[["columnChooser",""],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","gentime"],["matColumnDef","rectime"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"wrap200"],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(l(0,"ya-panel"),C(1,Yh,37,12),T(2,"async"),o()),e&2){let n;c(),b((n=D(2,1,a.plist$))?1:-1,n)}},dependencies:[$,Ee,Ut,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,ii,ai,ri,Ot,ze,ie,Xi,Ve,ca,pa,ci,qt],styles:[".alert[_ngcontent-%COMP%]{color:var(--y-error-color)!important}"],changeDetection:0});var Vo=tn;var Bo=t=>({c:t});function Gh(t,i){if(t&1&&(x(0,"ya-page-icon-button",7),p(1)),t&2){let e=h(),a=h();g("queryParams",Q(2,Bo,a.yamcs.context)),c(),O(" ",e.name," ")}}function Uh(t,i){if(t&1&&(l(0,"ya-page-button",3),p(1," Edit list "),o()),t&2){let e=h(2);g("queryParams",Q(1,Bo,e.yamcs.context))}}function qh(t,i){if(t&1&&(l(0,"a",8,1),p(2," Historical data "),o()),t&2){let e=K(1),a=h(2);ae("active",e.isActive),g("queryParams",Q(3,Bo,a.yamcs.context))}}function jh(t,i){if(t&1&&(l(0,"ya-instance-page")(1,"ya-instance-toolbar"),I(2,Gh,2,4,"ng-template",2),C(3,Uh,2,3,"ya-page-button",3),o(),l(4,"ya-page-tabs")(5,"a",4,0),p(7," Realtime "),o(),C(8,qh,3,5,"a",5),o(),l(9,"div",6),x(10,"router-outlet"),o()()),t&2){let e=K(6),a=h();c(3),b(a.mayManageParameterLists()?3:-1),c(2),ae("active",e.isActive),g("queryParams",Q(5,Bo,a.yamcs.context)),c(3),b(a.config.tmArchive?8:-1)}}var an=class an{constructor(i,e,a,n,r){this.yamcs=e;this.authService=a;this.title=n;this.plist$=new G(null);this.config=r.getConfig(),i.paramMap.subscribe(s=>{let d=s.get("list");this.changeList(d)})}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.title.setTitle(e.name)})}};an.\u0275fac=function(e){return new(e||an)(S(Pe),S(W),S(St),S(Mt),S(we))},an.\u0275cmp=N({type:an,selectors:[["ng-component"]],decls:2,vars:3,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["ya-instance-toolbar-label",""],["routerLink","edit","icon","edit",3,"queryParams"],["routerLink","realtime","routerLinkActive","",3,"queryParams"],["routerLink","data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"],["routerLink","..","icon","arrow_back",3,"queryParams"],["routerLink","data","routerLinkActive","",3,"queryParams"]],template:function(e,a){if(e&1&&(C(0,jh,11,7,"ya-instance-page"),T(1,"async")),e&2){let n;b((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[$,_i,Ee,Zi,et,tt,li,vt,bi,la,ie],encapsulation:2,changeDetection:0});var Fo=an;function zh(t,i){t&1&&(l(0,"th",16),p(1,"Severity"),o())}function Wh(t,i){if(t&1&&(l(0,"td",17),x(1,"app-alarm-level",18),o()),t&2){let e=i.$implicit;c(),g("level",e.severity)("grayscale",!0)}}function Xh(t,i){t&1&&(l(0,"th",16),p(1,"Start"),o())}function Zh(t,i){if(t&1&&(l(0,"td",17),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),X(D(2,1,e.triggerTime)||"-")}}function Qh(t,i){t&1&&(l(0,"th",16),p(1,"Stop"),o())}function Kh(t,i){if(t&1&&(l(0,"td",17),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),O(" ",D(2,1,e.updateTime)||"-"," ")}}function Jh(t,i){t&1&&(l(0,"th",16),p(1,"Trip value"),o())}function ef(t,i){t&1&&(l(0,"span"),p(1,"\u2193"),o())}function tf(t,i){t&1&&(l(0,"span"),p(1,"\u2191"),o())}function af(t,i){if(t&1&&(p(0),T(1,"value"),C(2,ef,2,0,"span"),C(3,tf,2,0,"span")),t&2){let e=i;O(" ",D(1,3,e.triggerValue.engValue)," "),c(2),b(e.triggerValue.rangeCondition==="LOW"?2:-1),c(),b(e.triggerValue.rangeCondition==="HIGH"?3:-1)}}function nf(t,i){if(t&1&&(l(0,"td",19),C(1,af,4,5),o()),t&2){let e,a=i.$implicit;c(),b((e=a.parameterDetail)?1:-1,e)}}function rf(t,i){t&1&&(l(0,"th",16),p(1,"Duration"),o())}function of(t,i){if(t&1&&(p(0),T(1,"duration")),t&2){let e=h().$implicit,a=h(2);O(" ",D(1,1,a.durationFor(e))||"-"," ")}}function lf(t,i){if(t&1&&(l(0,"mat-icon",20),p(1,"comment"),o()),t&2){let e=h(2).$implicit;g("matTooltip",e.clearInfo==null?null:e.clearInfo.clearMessage)}}function sf(t,i){if(t&1&&(p(0),C(1,lf,2,1,"mat-icon",20)),t&2){let e=h().$implicit;O(" (cleared by ",e.clearInfo==null?null:e.clearInfo.clearedBy,") "),c(),b(e.clearInfo!=null&&e.clearInfo.clearMessage?1:-1)}}function cf(t,i){if(t&1&&(l(0,"td",17),C(1,of,2,3),C(2,sf,2,2),o()),t&2){let e=i.$implicit;c(),b(e.updateTime?1:-1),c(),b(e.clearInfo!=null&&e.clearInfo.clearedBy?2:-1)}}function pf(t,i){t&1&&(l(0,"th",21),p(1,"Violations"),o())}function mf(t,i){if(t&1&&(p(0),T(1,"number"),T(2,"number")),t&2){let e=h().$implicit;Qt(" ",D(1,2,e.violations)," (",We(2,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function df(t,i){t&1&&p(0," - ")}function uf(t,i){if(t&1&&(l(0,"td",22),C(1,mf,3,7)(2,df,1,0),o()),t&2){let e=i.$implicit;c(),b(e.violations?1:2)}}function hf(t,i){t&1&&x(0,"th",23)}function ff(t,i){if(t&1){let e=F();l(0,"td",17)(1,"ya-text-action",24),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showChart(n))}),p(2,"Show chart"),o(),l(3,"ya-text-action",25),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showData(n))}),p(4,"Show data"),o()()}}function _f(t,i){t&1&&x(0,"tr",26)}function gf(t,i){t&1&&x(0,"tr",27)}function vf(t,i){if(t&1&&(l(0,"table",0),H(1,1),I(2,zh,2,0,"th",2)(3,Wh,2,2,"td",3),Y(),H(4,4),I(5,Xh,2,0,"th",2)(6,Zh,3,3,"td",3),Y(),H(7,5),I(8,Qh,2,0,"th",2)(9,Kh,3,3,"td",3),Y(),H(10,6),I(11,Jh,2,0,"th",2)(12,nf,2,1,"td",7),Y(),H(13,8),I(14,rf,2,0,"th",2)(15,cf,3,2,"td",3),Y(),H(16,9),I(17,pf,2,0,"th",10)(18,uf,3,1,"td",11),Y(),H(19,12),I(20,hf,1,0,"th",13)(21,ff,5,0,"td",3),Y(),I(22,_f,1,0,"tr",14)(23,gf,1,0,"tr",15),o()),t&2){let e=h();g("dataSource",e.dataSource),c(22),g("matHeaderRowDef",e.displayedColumns),c(),g("matRowDefColumns",e.displayedColumns)}}var nn=class nn{constructor(i,e){this.router=i;this.yamcs=e;this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(i){if(i.updateTime)return B.toDate(i.updateTime).getTime()-B.toDate(i.triggerTime).getTime()}showChart(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=wl(B.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}showData(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=wl(B.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}};nn.\u0275fac=function(e){return new(e||nn)(S(Qe),S(W))},nn.\u0275cmp=N({type:nn,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],["mat-cell","",1,"wrap200"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&C(0,vf,24,3,"table",0),e&2&&b(a.dataSource?0:-1)},dependencies:[pi,$,Rt,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,Sr,oi,Ps,Ve,Us,qt],encapsulation:2,changeDetection:0});var $o=nn;var Ho=class extends Kt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.alarms$=new G([]);this.loading$=new G(!1)}connect(e){return this.alarms$}isEmpty(){return this.alarms$.value.length===0}loadAlarms(e){return this.loading$.next(!0),this.loadPage(Pt(mt({},e),{limit:this.pageSize+1})).then(a=>{this.loading$.next(!1),this.alarms$.next(a)})}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}loadMoreData(e){this.offscreenRecord&&this.loadPage(Pt(mt({},e),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(a=>{let n=this.alarms$.getValue().concat(a);this.alarms$.next(n)})}disconnect(){this.alarms$.complete(),this.loading$.complete()}};function yf(t,i){if(t&1){let e=F();x(0,"ya-date-time-input",5)(1,"ya-date-time-input",6),l(2,"ya-button",7),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),p(3,"Apply"),o()}if(t&2){let e=h();c(2),g("disabled",e.filter.invalid)}}function Cf(t,i){if(t&1){let e=F();l(0,"ya-button",8),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),p(1,"Jump to now"),o()}}function bf(t,i){t&1&&x(0,"ya-dots")}function xf(t,i){t&1&&(l(0,"ya-empty-message"),p(1," No records found matching current filter in the selected time range. "),o())}function Sf(t,i){if(t&1){let e=F();l(0,"ya-toolbar",4)(1,"ya-button",7),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),p(2,"Load more"),o()()}if(t&2){let e=h();c(),g("disabled",!e.dataSource.hasMore())}}var Yo="P1M",rn=class rn{constructor(i){this.yamcs=i;this.qualifiedName=ot.required({alias:"parameter"});this.intervalOptions=[{id:"P1M",label:"Last month"},{id:"P1Y",label:"Last year"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom"}];this.filter=new ut({interval:new ne(Yo),customStart:new ne(null),customStop:new ne(null)})}ngOnInit(){let i=this.qualifiedName();this.dataSource=new Ho(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Yo),this.appliedInterval=Yo,this.loadData(),this.filter.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(B.toISOString(a)),this.filter.get("customStop").setValue(B.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}jumpToNow(){let i=this.filter.value.interval;i==="NO_LIMIT"?this.filter.get("interval").setValue(Yo):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filter.value.customStart),this.validStop=B.toDate(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(i)}loadMoreData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.dataSource.loadMoreData(i)}ngOnDestroy(){this.dataSource?.disconnect()}};rn.\u0275fac=function(e){return new(e||rn)(S(W))},rn.\u0275cmp=N({type:rn,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:12,vars:14,consts:[[3,"formGroup"],["formControlName","interval","icon","access_time",3,"options"],[3,"duration","start","stop"],[3,"dataSource"],["appearance","bottom","align","center"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"]],template:function(e,a){e&1&&(l(0,"ya-panel")(1,"ya-filter-bar",0),x(2,"ya-select",1),C(3,yf,4,1)(4,Cf,2,0,"ya-button"),C(5,bf,1,0,"ya-dots"),T(6,"async"),o(),x(7,"ya-table-window",2)(8,"app-parameter-alarms-table",3),C(9,xf,2,0,"ya-empty-message"),C(10,Sf,3,1,"ya-toolbar",4),T(11,"async"),o()),e&2&&(c(),g("formGroup",a.filter),c(),g("options",a.intervalOptions),c(),b(a.filter.value.interval==="CUSTOM"?3:4),c(2),b(D(6,10,a.dataSource.loading$)?5:-1),c(2),g("duration",a.appliedInterval)("start",a.validStart)("stop",a.validStop),c(),g("dataSource",a.dataSource),c(),b(a.dataSource.isEmpty()?9:-1),c(),b(!D(11,12,a.dataSource.loading$)&&!a.dataSource.isEmpty()?10:-1))},dependencies:[$o,$,pe,ve,ye,Se,me,wt,ai,ni,Ot,ze,it,xi,si,ie],encapsulation:2,changeDetection:0});var Go=rn;var vc=function(t,i,e,a,n,r){var s=function(d){return d==="logscale"?!1:a(d)};return di(t,i,e,s,n,r)},di=function(t,i,e,a,n,r){var s=a("pixelsPerLabel"),d=[],m,u,v,f;if(r)for(m=0;m<r.length;m++)d.push({v:r[m]});else{if(a("logscale")){f=Math.floor(e/s);var y=Xn(t,Uo,1),_=Xn(i,Uo,-1);y==-1&&(y=0),_==-1&&(_=Uo.length-1);var w=null;if(_-y>=f/4){for(var P=_;P>=y;P--){var R=Uo[P],L=Math.log(R/t)/Math.log(i/t)*e,V={v:R};w===null?w={tickValue:R,pixel_coord:L}:Math.abs(L-w.pixel_coord)>=s?w={tickValue:R,pixel_coord:L}:V.label="",d.push(V)}d.reverse()}}if(d.length===0){var U=a("labelsKMG2"),q,ee;U?(q=[1,2,4,8,16,32,64,128,256],ee=16):(q=[1,2,5,10,20,50,100],ee=10);var Me=Math.ceil(e/s),j=Math.abs(i-t)/Me,te=Math.floor(Math.log(j)/Math.log(ee)),he=Math.pow(ee,te),z,ue,Ct,Ze;for(u=0;u<q.length&&(z=he*q[u],ue=Math.floor(t/z)*z,Ct=Math.ceil(i/z)*z,f=Math.abs(Ct-ue)/z,Ze=e/f,!(Ze>s));u++);for(ue>Ct&&(z*=-1),m=0;m<=f;m++)v=ue+m*z,d.push({v})}}var Vt=a("axisLabelFormatter");for(m=0;m<d.length;m++)d[m].label===void 0&&(d[m].label=Vt.call(n,d[m].v,0,a,n));return d},Ri=function(t,i,e,a,n,r){var s=wf(t,i,e,a);return s>=0?Il(t,i,s,a,n):[]},ce={MILLISECONDLY:0,TWO_MILLISECONDLY:1,FIVE_MILLISECONDLY:2,TEN_MILLISECONDLY:3,FIFTY_MILLISECONDLY:4,HUNDRED_MILLISECONDLY:5,FIVE_HUNDRED_MILLISECONDLY:6,SECONDLY:7,TWO_SECONDLY:8,FIVE_SECONDLY:9,TEN_SECONDLY:10,THIRTY_SECONDLY:11,MINUTELY:12,TWO_MINUTELY:13,FIVE_MINUTELY:14,TEN_MINUTELY:15,THIRTY_MINUTELY:16,HOURLY:17,TWO_HOURLY:18,SIX_HOURLY:19,DAILY:20,TWO_DAILY:21,WEEKLY:22,MONTHLY:23,QUARTERLY:24,BIANNUAL:25,ANNUAL:26,DECADAL:27,CENTENNIAL:28,NUM_GRANULARITIES:29},de={DATEFIELD_Y:0,DATEFIELD_M:1,DATEFIELD_D:2,DATEFIELD_HH:3,DATEFIELD_MM:4,DATEFIELD_SS:5,DATEFIELD_MS:6,NUM_DATEFIELDS:7},be=[];be[ce.MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:1,spacing:1};be[ce.TWO_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:2,spacing:2};be[ce.FIVE_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:5,spacing:5};be[ce.TEN_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:10,spacing:10};be[ce.FIFTY_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:50,spacing:50};be[ce.HUNDRED_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:100,spacing:100};be[ce.FIVE_HUNDRED_MILLISECONDLY]={datefield:de.DATEFIELD_MS,step:500,spacing:500};be[ce.SECONDLY]={datefield:de.DATEFIELD_SS,step:1,spacing:1e3*1};be[ce.TWO_SECONDLY]={datefield:de.DATEFIELD_SS,step:2,spacing:1e3*2};be[ce.FIVE_SECONDLY]={datefield:de.DATEFIELD_SS,step:5,spacing:1e3*5};be[ce.TEN_SECONDLY]={datefield:de.DATEFIELD_SS,step:10,spacing:1e3*10};be[ce.THIRTY_SECONDLY]={datefield:de.DATEFIELD_SS,step:30,spacing:1e3*30};be[ce.MINUTELY]={datefield:de.DATEFIELD_MM,step:1,spacing:1e3*60};be[ce.TWO_MINUTELY]={datefield:de.DATEFIELD_MM,step:2,spacing:1e3*60*2};be[ce.FIVE_MINUTELY]={datefield:de.DATEFIELD_MM,step:5,spacing:1e3*60*5};be[ce.TEN_MINUTELY]={datefield:de.DATEFIELD_MM,step:10,spacing:1e3*60*10};be[ce.THIRTY_MINUTELY]={datefield:de.DATEFIELD_MM,step:30,spacing:1e3*60*30};be[ce.HOURLY]={datefield:de.DATEFIELD_HH,step:1,spacing:1e3*3600};be[ce.TWO_HOURLY]={datefield:de.DATEFIELD_HH,step:2,spacing:1e3*3600*2};be[ce.SIX_HOURLY]={datefield:de.DATEFIELD_HH,step:6,spacing:1e3*3600*6};be[ce.DAILY]={datefield:de.DATEFIELD_D,step:1,spacing:1e3*86400};be[ce.TWO_DAILY]={datefield:de.DATEFIELD_D,step:2,spacing:1e3*86400*2};be[ce.WEEKLY]={datefield:de.DATEFIELD_D,step:7,spacing:1e3*604800};be[ce.MONTHLY]={datefield:de.DATEFIELD_M,step:1,spacing:1e3*7200*365.2425};be[ce.QUARTERLY]={datefield:de.DATEFIELD_M,step:3,spacing:1e3*21600*365.2425};be[ce.BIANNUAL]={datefield:de.DATEFIELD_M,step:6,spacing:1e3*43200*365.2425};be[ce.ANNUAL]={datefield:de.DATEFIELD_Y,step:1,spacing:1e3*86400*365.2425};be[ce.DECADAL]={datefield:de.DATEFIELD_Y,step:10,spacing:1e3*864e3*365.2425};be[ce.CENTENNIAL]={datefield:de.DATEFIELD_Y,step:100,spacing:1e3*864e4*365.2425};var Uo=function(){for(var t=[],i=-39;i<=39;i++)for(var e=Math.pow(10,i),a=1;a<=9;a++){var n=e*a;t.push(n)}return t}(),wf=function(t,i,e,a){for(var n=a("pixelsPerLabel"),r=0;r<ce.NUM_GRANULARITIES;r++){var s=Tf(t,i,r);if(e/s>=n)return r}return-1},Tf=function(t,i,e){var a=be[e].spacing;return Math.round(1*(i-t)/a)},Il=function(t,i,e,a,n){var r=a("axisLabelFormatter"),s=a("labelsUTC"),d=s?jo:qo,m=be[e].datefield,u=be[e].step,v=be[e].spacing,f=new Date(t),y=[];y[de.DATEFIELD_Y]=d.getFullYear(f),y[de.DATEFIELD_M]=d.getMonth(f),y[de.DATEFIELD_D]=d.getDate(f),y[de.DATEFIELD_HH]=d.getHours(f),y[de.DATEFIELD_MM]=d.getMinutes(f),y[de.DATEFIELD_SS]=d.getSeconds(f),y[de.DATEFIELD_MS]=d.getMilliseconds(f);var _=y[m]%u;e==ce.WEEKLY&&(_=d.getDay(f)),y[m]-=_;for(var w=m+1;w<de.NUM_DATEFIELDS;w++)y[w]=w===de.DATEFIELD_D?1:0;var P=[],R=d.makeDate.apply(null,y),L=R.getTime();if(e<=ce.HOURLY)for(L<t&&(L+=v,R=new Date(L));L<=i;)P.push({v:L,label:r.call(n,R,e,a,n)}),L+=v,R=new Date(L);else for(L<t&&(y[m]+=u,R=d.makeDate.apply(null,y),L=R.getTime());L<=i;)(e>=ce.DAILY||d.getHours(R)%u===0)&&P.push({v:L,label:r.call(n,R,e,a,n)}),y[m]+=u,R=d.makeDate.apply(null,y),L=R.getTime();return P};var Ii=10,Df=Math.log(Ii),De=function(t){return Math.log(t)/Df},Qn=function(t,i,e){var a=De(t),n=De(i),r=a+e*(n-a),s=Math.pow(Ii,r);return s};var wc=[7,3],Tc=[7,2,2,2],on=1,ln=2,sn=function(t){return t.getContext("2d")},Oi=function(i,e,a){i.addEventListener(e,a,!1)};function $t(t,i,e){t.removeEventListener(i,e,!1)}function ui(t){return t=t||window.event,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.cancel=!0,t.returnValue=!1,!1}function Dc(t,i,e){var a,n,r;if(i===0)a=e,n=e,r=e;else{var s=Math.floor(t*6),d=t*6-s,m=e*(1-i),u=e*(1-i*d),v=e*(1-i*(1-d));switch(s){case 1:a=u,n=e,r=m;break;case 2:a=m,n=e,r=v;break;case 3:a=m,n=u,r=e;break;case 4:a=v,n=m,r=e;break;case 5:a=e,n=m,r=u;break;case 6:case 0:a=e,n=v,r=m;break}}return a=Math.floor(255*a+.5),n=Math.floor(255*n+.5),r=Math.floor(255*r+.5),"rgb("+a+","+n+","+r+")"}function Ti(t){var i=t.getBoundingClientRect(),e=window,a=document.documentElement;return{x:i.left+(e.pageXOffset||a.scrollLeft),y:i.top+(e.pageYOffset||a.scrollTop)}}function cn(t){return!t.pageX||t.pageX<0?0:t.pageX}function pn(t){return!t.pageY||t.pageY<0?0:t.pageY}function mn(t,i){return cn(t)-i.px}function dn(t,i){return pn(t)-i.py}function Pc(t){return!!t&&!isNaN(t)}function un(t,i){return!(!t||t.yval===null||t.x===null||t.x===void 0||t.y===null||t.y===void 0||isNaN(t.x)||!i&&isNaN(t.y))}function Bl(t,i){var e=Math.min(Math.max(1,i||2),21);return Math.abs(t)<.001&&t!==0?t.toExponential(e-1):t.toPrecision(e)}function Li(t){return t<10?"0"+t:""+t}var qo={getFullYear:t=>t.getFullYear(),getMonth:t=>t.getMonth(),getDate:t=>t.getDate(),getHours:t=>t.getHours(),getMinutes:t=>t.getMinutes(),getSeconds:t=>t.getSeconds(),getMilliseconds:t=>t.getMilliseconds(),getDay:t=>t.getDay(),makeDate:function(t,i,e,a,n,r,s){return new Date(t,i,e,a,n,r,s)}},jo={getFullYear:t=>t.getUTCFullYear(),getMonth:t=>t.getUTCMonth(),getDate:t=>t.getUTCDate(),getHours:t=>t.getUTCHours(),getMinutes:t=>t.getUTCMinutes(),getSeconds:t=>t.getUTCSeconds(),getMilliseconds:t=>t.getUTCMilliseconds(),getDay:t=>t.getUTCDay(),makeDate:function(t,i,e,a,n,r,s){return new Date(Date.UTC(t,i,e,a,n,r,s))}};function Fl(t,i,e,a){var n=Li(t)+":"+Li(i);if(e&&(n+=":"+Li(e),a)){var r=""+a;n+="."+("000"+r).substring(r.length)}return n}function $l(t,i){var e=i?jo:qo,a=new Date(t),n=e.getFullYear(a),r=e.getMonth(a),s=e.getDate(a),d=e.getHours(a),m=e.getMinutes(a),u=e.getSeconds(a),v=e.getMilliseconds(a),f=""+n,y=Li(r+1),_=Li(s),w=d*3600+m*60+u+.001*v,P=f+"/"+y+"/"+_;return w&&(P+=" "+Fl(d,m,u,v)),P}function Nl(t,i){var e=Math.pow(10,i);return Math.round(t*e)/e}function Xn(t,i,e,a,n){if((a==null||n===null||n===void 0)&&(a=0,n=i.length-1),a>n)return-1;e==null&&(e=0);var r=function(u){return u>=0&&u<i.length},s=parseInt((a+n)/2,10),d=i[s],m;return d==t?s:d>t?e>0&&(m=s-1,r(m)&&i[m]<t)?s:Xn(t,i,e,a,s-1):d<t?e<0&&(m=s+1,r(m)&&i[m]>t)?s:Xn(t,i,e,s+1,n):-1}function Hl(t){var i,e;if((t.search("-")==-1||t.search("T")!=-1||t.search("Z")!=-1)&&(e=Vl(t),e&&!isNaN(e)))return e;if(t.search("-")!=-1){for(i=t.replace("-","/","g");i.search("-")!=-1;)i=i.replace("-","/");e=Vl(i)}else e=Vl(t);return(!e||isNaN(e))&&console.error("Couldn't parse "+t+" as a date"),e}function Vl(t){return new Date(t).getTime()}function Dt(t,i){if(typeof i<"u"&&i!==null)for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}var Pf=typeof Node<"u"&&Node!==null&&typeof Node=="object"?function(i){return i instanceof Node}:function(i){return typeof i=="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"};function Wo(t,i){if(typeof i<"u"&&i!==null){for(var e in i)if(i.hasOwnProperty(e)){let a=i[e];a===null?t[e]=null:Ni(a)?t[e]=a.slice():Pf(a)?t[e]=a:typeof a=="object"?((typeof t[e]!="object"||t[e]===null)&&(t[e]={}),Wo(t[e],a)):t[e]=a}}return t}function Ec(t){if(t===null)return"null";let i=typeof t;return(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4?"array":i}function Ni(t){let i=typeof t;return t!==null&&(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4}function Yl(t){return t!==null&&typeof t=="object"&&typeof t.getTime=="function"}function Gl(t){for(var i=[],e=0;e<t.length;e++)Ni(t[e])?i.push(Gl(t[e])):i.push(t[e]);return i}function hn(){return document.createElement("canvas")}function Kn(t){try{var i=window.devicePixelRatio,e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i!==void 0?i/e:1}catch{return 1}}function kc(t,i,e,a){i=i||0,e=e||t.length,this.hasNext=!0,this.peek=null,this.start_=i,this.array_=t,this.predicate_=a,this.end_=Math.min(t.length,i+e),this.nextIdx_=i-1,this.next()}kc.prototype.next=function(){if(!this.hasNext)return null;for(var t=this.peek,i=this.nextIdx_+1,e=!1;i<this.end_;){if(!this.predicate_||this.predicate_(this.array_,i)){this.peek=this.array_[i],e=!0;break}i++}return this.nextIdx_=i,e||(this.hasNext=!1,this.peek=null),t};function Xo(t,i,e,a){return new kc(t,i,e,a)}var Ef=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function Ul(t,i,e,a){var n=0,r,s=new Date().getTime();if(t(n),i==1){a();return}var d=i-1;(function m(){n>=i||Ef.call(window,function(){var u=new Date().getTime(),v=u-s;r=n,n=Math.floor(v/e);var f=n-r,y=n+f>d;y||n>=d?(t(d),a()):(f!==0&&t(n),m())})})()}var yc={annotationClickHandler:!0,annotationDblClickHandler:!0,annotationMouseOutHandler:!0,annotationMouseOverHandler:!0,axisLineColor:!0,axisLineWidth:!0,clickCallback:!0,drawCallback:!0,drawHighlightPointCallback:!0,drawPoints:!0,drawPointCallback:!0,drawGrid:!0,fillAlpha:!0,gridLineColor:!0,gridLineWidth:!0,hideOverlayOnMouseOut:!0,highlightCallback:!0,highlightCircleSize:!0,interactionModel:!0,labelsDiv:!0,labelsKMB:!0,labelsKMG2:!0,labelsSeparateLines:!0,labelsShowZeroValues:!0,legend:!0,panEdgeFraction:!0,pixelsPerYLabel:!0,pointClickCallback:!0,pointSize:!0,rangeSelectorPlotFillColor:!0,rangeSelectorPlotFillGradientColor:!0,rangeSelectorPlotStrokeColor:!0,rangeSelectorBackgroundStrokeColor:!0,rangeSelectorBackgroundLineWidth:!0,rangeSelectorPlotLineWidth:!0,rangeSelectorForegroundStrokeColor:!0,rangeSelectorForegroundLineWidth:!0,rangeSelectorAlpha:!0,showLabelsOnHighlight:!0,showRoller:!0,strokeWidth:!0,underlayCallback:!0,unhighlightCallback:!0,zoomCallback:!0};function Ac(t,i){var e={};if(t)for(var a=1;a<t.length;a++)e[t[a]]=!0;var n=function(m){for(var u in m)if(m.hasOwnProperty(u)&&!yc[u])return!0;return!1};for(var r in i)if(i.hasOwnProperty(r)){if(r=="highlightSeriesOpts"||e[r]&&!i.series){if(n(i[r]))return!0}else if(r=="series"||r=="axes"){var s=i[r];for(var d in s)if(s.hasOwnProperty(d)&&n(s[d]))return!0}else if(!yc[r])return!0}return!1}var Jn={DEFAULT:function(t,i,e,a,n,r,s){e.beginPath(),e.fillStyle=r,e.arc(a,n,s,0,2*Math.PI,!1),e.fill()}};function ql(t){for(var i=0;i<t.length;i++){var e=t.charAt(i);if(e==="\r")return i+1<t.length&&t.charAt(i+1)===`
`?`\r
`:e;if(e===`
`)return i+1<t.length&&t.charAt(i+1)==="\r"?`
\r`:e}return null}function jl(t,i){if(i===null||t===null)return!1;for(var e=t;e&&e!==i;)e=e.parentNode;return e===i}function Cc(t,i){return i<0?1/Math.pow(t,-i):Math.pow(t,i)}var kf=/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})?$/,Af=/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*([01](?:\.\d+)?))?\)$/;function bc(t){var i,e,a,n,r=null;if(i=kf.exec(t))e=parseInt(i[1],16),a=parseInt(i[2],16),n=parseInt(i[3],16),i[4]&&(r=parseInt(i[4],16));else if(i=Af.exec(t))e=parseInt(i[1],10),a=parseInt(i[2],10),n=parseInt(i[3],10),i[4]&&(r=parseFloat(i[4]));else return null;return r!==null?{r:e,g:a,b:n,a:r}:{r:e,g:a,b:n}}function fn(t){var i=bc(t);if(i)return i;var e=document.createElement("div");e.style.backgroundColor=t,e.style.visibility="hidden",document.body.appendChild(e);var a=window.getComputedStyle(e,null).backgroundColor;return document.body.removeChild(e),bc(a)}function Mc(t){try{var i=t||document.createElement("canvas");i.getContext("2d")}catch{return!1}return!0}function hi(t,i,e){var a=parseFloat(t);if(!isNaN(a))return a;if(/^ *$/.test(t))return null;if(/^ *nan *$/i.test(t))return NaN;var n="Unable to parse '"+t+"' as a number";return e!==void 0&&i!==void 0&&(n+=" on line "+(1+(i||0))+" ('"+e+"') of CSV."),console.error(n),null}var Mf=["k","M","G","T","P","E","Z","Y"],Rc=["m","\xB5","n","p","f","a","z","y"],Rf=["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],Lf=["p-10","p-20","p-30","p-40","p-50","p-60","p-70","p-80"],If=["K","M","G","T","P","E","Z","Y"],Of=Rc;function Zo(t,i){var e=i("sigFigs");if(e!==null)return Bl(t,e);if(t===0)return"0";var a=i("digitsAfterDecimal"),n=i("maxNumberWidth"),r=i("labelsKMB"),s=i("labelsKMG2"),d,m=Math.abs(t);if(r||s){var u,v=[],f=[];r&&(u=1e3,v=Mf,f=Rc),s&&(u=1024,v=Rf,f=Lf,r&&(v=If,f=Of));var y,_;if(m>=u){for(_=v.length;_>0;)if(y=Cc(u,_),--_,m>=y)return m/y>=Math.pow(10,n)?d=t.toExponential(a):d=Nl(t/y,a)+v[_],d}else if(m<1){for(_=0;_<f.length&&(++_,y=Cc(u,_),!(m*y>=1)););return m*y<Math.pow(10,-a)?d=t.toExponential(a):d=Nl(t*y,a)+f[_-1],d}}return m>=Math.pow(10,n)||m<Math.pow(10,-a)?d=t.toExponential(a):d=""+Nl(t,a),d}function er(t,i,e){return Zo.call(this,t,e)}var xc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Vi(t,i,e){var a=e("labelsUTC"),n=a?jo:qo,r=n.getFullYear(t),s=n.getMonth(t),d=n.getDate(t),m=n.getHours(t),u=n.getMinutes(t),v=n.getSeconds(t),f=n.getMilliseconds(t);if(i>=ce.DECADAL)return""+r;if(i>=ce.MONTHLY)return xc[s]+"&#160;"+r;var y=m*3600+u*60+v+.001*f;if(y===0||i>=ce.DAILY)return Li(d)+"&#160;"+xc[s];if(i<ce.SECONDLY){var _=""+f;return Li(v)+"."+("000"+_).substring(_.length)}else return i>ce.MINUTELY?Fl(m,u,v,0):Fl(m,u,v,f)}function _n(t,i){return $l(t,i("labelsUTC"))}var zo=[],Sc=!1;function Zn(t){return typeof t=="function"&&t(),!0}function Lc(t){if(typeof document<"u"){let i=function(){if(!Sc){Sc=!0,t.onDOMready=Zn,document.removeEventListener("DOMContentLoaded",i,!1),window.removeEventListener("load",i,!1);for(let a=0;a<zo.length;++a)zo[a]();zo=null}};t.onDOMready=function(a){if(document.readyState==="complete")return t.onDOMready=Zn,Zn(a);let n=function(s){return typeof s=="function"&&zo.push(s),!1};return t.onDOMready=n,document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1),document.readyState==="complete"?(i(),t.onDOMready=Zn,Zn(a)):n(a)}}}var yt=function(t){this.dygraph_=t,this.points=[],this.setNames=[],this.annotations=[],this.yAxes_=null,this.xTicks_=null,this.yTicks_=null};yt.prototype.addDataset=function(t,i){this.points.push(i),this.setNames.push(t)};yt.prototype.getPlotArea=function(){return this.area_};yt.prototype.computePlotArea=function(){var t={x:0,y:0};t.w=this.dygraph_.width_-t.x-this.dygraph_.getOption("rightGap"),t.h=this.dygraph_.height_;var i={chart_div:this.dygraph_.graphDiv,reserveSpaceLeft:function(e){var a={x:t.x,y:t.y,w:e,h:t.h};return t.x+=e,t.w-=e,a},reserveSpaceRight:function(e){var a={x:t.x+t.w-e,y:t.y,w:e,h:t.h};return t.w-=e,a},reserveSpaceTop:function(e){var a={x:t.x,y:t.y,w:t.w,h:e};return t.y+=e,t.h-=e,a},reserveSpaceBottom:function(e){var a={x:t.x,y:t.y+t.h-e,w:t.w,h:e};return t.h-=e,a},chartRect:function(){return{x:t.x,y:t.y,w:t.w,h:t.h}}};this.dygraph_.cascadeEvents_("layout",i),this.area_=t};yt.prototype.setAnnotations=function(t){this.annotations=[];for(var i=this.dygraph_.getOption("xValueParser")||function(n){return n},e=0;e<t.length;e++){var a={};if(!t[e].xval&&t[e].x===void 0){console.error("Annotations must have an 'x' property");return}if(t[e].icon&&!(t[e].hasOwnProperty("width")&&t[e].hasOwnProperty("height"))){console.error("Must set width and height when setting annotation.icon property");return}Dt(a,t[e]),a.xval||(a.xval=i(a.x)),this.annotations.push(a)}};yt.prototype.setXTicks=function(t){this.xTicks_=t};yt.prototype.setYAxes=function(t){this.yAxes_=t};yt.prototype.evaluate=function(){this._xAxis={},this._evaluateLimits(),this._evaluateLineCharts(),this._evaluateLineTicks(),this._evaluateAnnotations()};yt.prototype._evaluateLimits=function(){var t=this.dygraph_.xAxisRange();this._xAxis.minval=t[0],this._xAxis.maxval=t[1];var i=t[1]-t[0];this._xAxis.scale=i!==0?1/i:1,this.dygraph_.getOptionForAxis("logscale","x")&&(this._xAxis.xlogrange=De(this._xAxis.maxval)-De(this._xAxis.minval),this._xAxis.xlogscale=this._xAxis.xlogrange!==0?1/this._xAxis.xlogrange:1);for(var e=0;e<this.yAxes_.length;e++){var a=this.yAxes_[e];a.minyval=a.computedValueRange[0],a.maxyval=a.computedValueRange[1],a.yrange=a.maxyval-a.minyval,a.yscale=a.yrange!==0?1/a.yrange:1,(this.dygraph_.getOption("logscale")||a.logscale)&&(a.ylogrange=De(a.maxyval)-De(a.minyval),a.ylogscale=a.ylogrange!==0?1/a.ylogrange:1,(!isFinite(a.ylogrange)||isNaN(a.ylogrange))&&console.error("axis "+e+" of graph at "+a.g+" can't be displayed in log scale for range ["+a.minyval+" - "+a.maxyval+"]"))}};yt.calcXNormal_=function(t,i,e){return e?(De(t)-De(i.minval))*i.xlogscale:(t-i.minval)*i.scale};yt.calcYNormal_=function(t,i,e){if(e){var a=1-(De(i)-De(t.minyval))*t.ylogscale;return isFinite(a)?a:NaN}else return 1-(i-t.minyval)*t.yscale};yt.prototype._evaluateLineCharts=function(){for(var t=this.dygraph_.getOption("stackedGraph"),i=this.dygraph_.getOptionForAxis("logscale","x"),e=0;e<this.points.length;e++){for(var a=this.points[e],n=this.setNames[e],r=this.dygraph_.getOption("connectSeparatedPoints",n),s=this.dygraph_.axisPropertiesForSeries(n),d=this.dygraph_.attributes_.getForSeries("logscale",n),m=0;m<a.length;m++){var u=a[m];u.x=yt.calcXNormal_(u.xval,this._xAxis,i);var v=u.yval;t&&(u.y_stacked=yt.calcYNormal_(s,u.yval_stacked,d),v!==null&&!isNaN(v)&&(v=u.yval_stacked)),v===null&&(v=NaN,r||(u.yval=NaN)),u.y=yt.calcYNormal_(s,v,d)}this.dygraph_.dataHandler_.onLineEvaluated(a,s,d)}};yt.prototype._evaluateLineTicks=function(){var t,i,e,a,n,r;for(this.xticks=[],t=0;t<this.xTicks_.length;t++)i=this.xTicks_[t],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentXCoord(n),a>=0&&a<1&&this.xticks.push({pos:a,label:e,has_tick:r});for(this.yticks=[],t=0;t<this.yAxes_.length;t++)for(var s=this.yAxes_[t],d=0;d<s.ticks.length;d++)i=s.ticks[d],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentYCoord(n,t),a>0&&a<=1&&this.yticks.push({axis:t,pos:a,label:e,has_tick:r})};yt.prototype._evaluateAnnotations=function(){var t,i={};for(t=0;t<this.annotations.length;t++){var e=this.annotations[t];i[e.xval+","+e.series]=e}if(this.annotated_points=[],!(!this.annotations||!this.annotations.length))for(var a=0;a<this.points.length;a++){var n=this.points[a];for(t=0;t<n.length;t++){var r=n[t],s=r.xval+","+r.name;s in i&&(r.annotation=i[s],this.annotated_points.push(r),delete i[s])}}};yt.prototype.removeAllDatasets=function(){delete this.points,delete this.setNames,delete this.setPointsLengths,delete this.setPointsOffsets,this.points=[],this.setNames=[],this.setPointsLengths=[],this.setPointsOffsets=[]};var tr=yt;var Ae=function(t,i,e,a){if(this.dygraph_=t,this.layout=a,this.element=i,this.elementContext=e,this.height=t.height_,this.width=t.width_,!Mc(this.element))throw"Canvas is not supported.";this.area=a.getPlotArea();var n=this.dygraph_.canvas_ctx_;n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip(),n=this.dygraph_.hidden_ctx_,n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip()};Ae.prototype.clear=function(){this.elementContext.clearRect(0,0,this.width,this.height)};Ae.prototype.render=function(){this._updatePoints(),this._renderLineChart()};Ae._getIteratorPredicate=function(t){return t?Ae._predicateThatSkipsEmptyPoints:null};Ae._predicateThatSkipsEmptyPoints=function(t,i){return t[i].yval!==null};Ae._drawStyledLine=function(t,i,e,a,n,r,s){var d=t.dygraph,m=d.getBooleanOption("stepPlot",t.setName);Ni(a)||(a=null);var u=d.getBooleanOption("drawGapEdgePoints",t.setName),v=t.points,f=t.setName,y=Xo(v,0,v.length,Ae._getIteratorPredicate(d.getBooleanOption("connectSeparatedPoints",f))),_=a&&a.length>=2,w=t.drawingContext;w.save(),_&&w.setLineDash&&w.setLineDash(a);var P=Ae._drawSeries(t,y,e,s,n,u,m,i);Ae._drawPointsOnLine(t,P,r,i,s),_&&w.setLineDash&&w.setLineDash([]),w.restore()};Ae._drawSeries=function(t,i,e,a,n,r,s,d){var m=null,u=null,v=null,f,y,_=[],w=!0,P=t.drawingContext;P.beginPath(),P.strokeStyle=d,P.lineWidth=e;for(var R=i.array_,L=i.end_,V=i.predicate_,U=i.start_;U<L;U++){if(y=R[U],V){for(;U<L&&!V(R,U);)U++;if(U==L)break;y=R[U]}if(y.canvasy===null||y.canvasy!=y.canvasy)s&&m!==null&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),m=u=null;else{if(f=!1,r||m===null){i.nextIdx_=U,i.next(),v=i.hasNext?i.peek.canvasy:null;var q=v===null||v!=v;f=m===null&&q,r&&(!w&&m===null||i.hasNext&&q)&&(f=!0)}m!==null?e&&(s&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),P.lineTo(y.canvasx,y.canvasy)):P.moveTo(y.canvasx,y.canvasy),(n||f)&&_.push([y.canvasx,y.canvasy,y.idx]),m=y.canvasx,u=y.canvasy}w=!1}return P.stroke(),_};Ae._drawPointsOnLine=function(t,i,e,a,n){for(var r=t.drawingContext,s=0;s<i.length;s++){var d=i[s];r.save(),e.call(t.dygraph,t.dygraph,t.setName,r,d[0],d[1],a,n,d[2]),r.restore()}};Ae.prototype._updatePoints=function(){for(var t=this.layout.points,i=t.length;i--;)for(var e=t[i],a=e.length;a--;){var n=e[a];n.canvasx=this.area.w*n.x+this.area.x,n.canvasy=this.area.h*n.y+this.area.y}};Ae.prototype._renderLineChart=function(t,i){var e=i||this.elementContext,a,n=this.layout.points,r=this.layout.setNames,s;this.colors=this.dygraph_.colorsMap_;var d=this.dygraph_.getOption("plotter"),m=d;Ni(m)||(m=[m]);var u={};for(a=0;a<r.length;a++){s=r[a];var v=this.dygraph_.getOption("plotter",s);v!=d&&(u[s]=v)}for(a=0;a<m.length;a++)for(var f=m[a],y=a==m.length-1,_=0;_<n.length;_++)if(s=r[_],!(t&&s!=t)){var w=n[_],P=f;if(s in u)if(y)P=u[s];else continue;var R=this.colors[s],L=this.dygraph_.getOption("strokeWidth",s);e.save(),e.strokeStyle=R,e.lineWidth=L,P({points:w,setName:s,drawingContext:e,color:R,strokeWidth:L,dygraph:this.dygraph_,axis:this.dygraph_.axisPropertiesForSeries(s),plotArea:this.area,seriesIndex:_,seriesCount:n.length,singleSeriesName:t,allSeriesPoints:n}),e.restore()}};Ae._Plotters={linePlotter:function(t){Ae._linePlotter(t)},fillPlotter:function(t){Ae._fillPlotter(t)},errorPlotter:function(t){Ae._errorPlotter(t)}};Ae._linePlotter=function(t){var i=t.dygraph,e=t.setName,a=t.strokeWidth,n=i.getNumericOption("strokeBorderWidth",e),r=i.getOption("drawPointCallback",e)||Jn.DEFAULT,s=i.getOption("strokePattern",e),d=i.getBooleanOption("drawPoints",e),m=i.getNumericOption("pointSize",e);n&&a&&Ae._drawStyledLine(t,i.getOption("strokeBorderColor",e),a+2*n,s,d,r,m),Ae._drawStyledLine(t,t.color,a,s,d,r,m)};Ae._errorPlotter=function(t){var i=t.dygraph,e=t.setName,a=i.getBooleanOption("errorBars")||i.getBooleanOption("customBars");if(a){var n=i.getBooleanOption("fillGraph",e);n&&console.warn("Can't use fillGraph option with customBars or errorBars option");var r=t.drawingContext,s=t.color,d=i.getNumericOption("fillAlpha",e),m=i.getBooleanOption("stepPlot",e),u=t.points,v=Xo(u,0,u.length,Ae._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",e))),f,y=NaN,_=NaN,w=[-1,-1],P=fn(s),R="rgba("+P.r+","+P.g+","+P.b+","+d+")";r.fillStyle=R,r.beginPath();for(var L=function(U){return U==null||isNaN(U)};v.hasNext;){var V=v.next();if(!m&&L(V.y)||m&&!isNaN(_)&&L(_)){y=NaN;continue}f=[V.y_bottom,V.y_top],m&&(_=V.y),isNaN(f[0])&&(f[0]=V.y),isNaN(f[1])&&(f[1]=V.y),f[0]=t.plotArea.h*f[0]+t.plotArea.y,f[1]=t.plotArea.h*f[1]+t.plotArea.y,isNaN(y)||(m?(r.moveTo(y,w[0]),r.lineTo(V.canvasx,w[0]),r.lineTo(V.canvasx,w[1])):(r.moveTo(y,w[0]),r.lineTo(V.canvasx,f[0]),r.lineTo(V.canvasx,f[1])),r.lineTo(y,w[1]),r.closePath()),w=f,y=V.canvasx}r.fill()}};Ae._fastCanvasProxy=function(t){var i=[],e=null,a=null,n=1,r=2,s=0,d=function(v){if(!(i.length<=1)){for(var f=i.length-1;f>0;f--){var y=i[f];if(y[0]==r){var _=i[f-1];_[1]==y[1]&&_[2]==y[2]&&i.splice(f,1)}}for(var f=0;f<i.length-1;){var y=i[f];y[0]==r&&i[f+1][0]==r?i.splice(f,1):f++}if(i.length>2&&!v){var w=0;i[0][0]==r&&w++;for(var P=null,R=null,f=w;f<i.length;f++){var y=i[f];if(y[0]==n)if(P===null&&R===null)P=f,R=f;else{var L=y[2];L<i[P][2]?P=f:L>i[R][2]&&(R=f)}}var V=i[P],U=i[R];i.splice(w,i.length-w),P<R?(i.push(V),i.push(U)):(P>R&&i.push(U),i.push(V))}}},m=function(v){d(v);for(var f=0,y=i.length;f<y;f++){var _=i[f];_[0]==n?t.lineTo(_[1],_[2]):_[0]==r&&t.moveTo(_[1],_[2])}i.length&&(a=i[i.length-1][1]),s+=i.length,i=[]},u=function(v,f,y){var _=Math.round(f);if(e===null||_!=e){var w=e-a>1,P=_-e>1,R=w||P;m(R),e=_}i.push([v,f,y])};return{moveTo:function(v,f){u(r,v,f)},lineTo:function(v,f){u(n,v,f)},stroke:function(){m(!0),t.stroke()},fill:function(){m(!0),t.fill()},beginPath:function(){m(!0),t.beginPath()},closePath:function(){m(!0),t.closePath()},_count:function(){return s}}};Ae._fillPlotter=function(t){if(!t.singleSeriesName&&t.seriesIndex===0){for(var i=t.dygraph,e=i.getLabels().slice(1),a=e.length;a>=0;a--)i.visibility()[a]||e.splice(a,1);var n=function(){for(var Wt=0;Wt<e.length;Wt++)if(i.getBooleanOption("fillGraph",e[Wt]))return!0;return!1}();if(n)for(var r=t.plotArea,s=t.allSeriesPoints,d=s.length,m=i.getBooleanOption("stackedGraph"),u=i.getColors(),v={},f,y,_=function(Wt,Yc,Gc,ls){if(Wt.lineTo(Yc,Gc),m)for(var bl=ls.length-1;bl>=0;bl--){var ss=ls[bl];Wt.lineTo(ss[0],ss[1])}},w=d-1;w>=0;w--){var P=t.drawingContext,R=e[w];if(i.getBooleanOption("fillGraph",R)){var L=i.getNumericOption("fillAlpha",R),V=i.getBooleanOption("stepPlot",R),U=u[w],q=i.axisPropertiesForSeries(R),ee=1+q.minyval*q.yscale;ee<0?ee=0:ee>1&&(ee=1),ee=r.h*ee+r.y;var Me=s[w],j=Xo(Me,0,Me.length,Ae._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",R))),te=NaN,he=[-1,-1],z,ue=fn(U),Ct="rgba("+ue.r+","+ue.g+","+ue.b+","+L+")";P.fillStyle=Ct,P.beginPath();var Ze,Vt=!0;(Me.length>2*i.width_||nt.FORCE_FAST_PROXY)&&(P=Ae._fastCanvasProxy(P));for(var rt=[],Te;j.hasNext;){if(Te=j.next(),!Pc(Te.y)&&!V){_(P,te,he[1],rt),rt=[],te=NaN,Te.y_stacked!==null&&!isNaN(Te.y_stacked)&&(v[Te.canvasx]=r.h*Te.y_stacked+r.y);continue}if(m){if(!Vt&&Ze==Te.xval)continue;Vt=!1,Ze=Te.xval,f=v[Te.canvasx];var ji;f===void 0?ji=ee:y?ji=f[0]:ji=f,z=[Te.canvasy,ji],V?he[0]===-1?v[Te.canvasx]=[Te.canvasy,ee]:v[Te.canvasx]=[Te.canvasy,he[0]]:v[Te.canvasx]=Te.canvasy}else isNaN(Te.canvasy)&&V?z=[r.y+r.h,ee]:z=[Te.canvasy,ee];isNaN(te)?(P.moveTo(Te.canvasx,z[1]),P.lineTo(Te.canvasx,z[0])):(V&&P.lineTo(Te.canvasx,he[0]),P.lineTo(Te.canvasx,z[0]),m&&(rt.push([te,he[1]]),y&&f?rt.push([Te.canvasx,f[1]]):rt.push([Te.canvasx,z[1]]))),he=z,te=Te.canvasx}y=V,z&&Te&&(_(P,Te.canvasx,z[1],rt),rt=[]),P.fill()}}}};var Fi=Ae;var Nf=100,xe={};xe.maybeTreatMouseOpAsClick=function(t,i,e){e.dragEndX=mn(t,e),e.dragEndY=dn(t,e);var a=Math.abs(e.dragEndX-e.dragStartX),n=Math.abs(e.dragEndY-e.dragStartY);a<2&&n<2&&i.lastx_!==void 0&&i.lastx_!==null&&xe.treatMouseOpAsClick(i,t,e),e.regionWidth=a,e.regionHeight=n};xe.startPan=function(t,i,e){var a,n;e.isPanning=!0;var r=i.xAxisRange();if(i.getOptionForAxis("logscale","x")?(e.initialLeftmostDate=De(r[0]),e.dateRange=De(r[1])-De(r[0])):(e.initialLeftmostDate=r[0],e.dateRange=r[1]-r[0]),e.xUnitsPerPixel=e.dateRange/(i.plotter_.area.w-1),i.getNumericOption("panEdgeFraction")){var s=i.width_*i.getNumericOption("panEdgeFraction"),d=i.xAxisExtremes(),m=i.toDomXCoord(d[0])-s,u=i.toDomXCoord(d[1])+s,v=i.toDataXCoord(m),f=i.toDataXCoord(u);e.boundedDates=[v,f];var y=[],_=i.height_*i.getNumericOption("panEdgeFraction");for(a=0;a<i.axes_.length;a++){n=i.axes_[a];var w=n.extremeRange,P=i.toDomYCoord(w[0],a)+_,R=i.toDomYCoord(w[1],a)-_,L=i.toDataYCoord(P,a),V=i.toDataYCoord(R,a);y[a]=[L,V]}e.boundedValues=y}else e.boundedDates=null,e.boundedValues=null;for(e.is2DPan=!1,e.axes=[],a=0;a<i.axes_.length;a++){n=i.axes_[a];var U={},q=i.yAxisRange(a),ee=i.attributes_.getForAxis("logscale",a);ee?(U.initialTopValue=De(q[1]),U.dragValueRange=De(q[1])-De(q[0])):(U.initialTopValue=q[1],U.dragValueRange=q[1]-q[0]),U.unitsPerPixel=U.dragValueRange/(i.plotter_.area.h-1),e.axes.push(U),n.valueRange&&(e.is2DPan=!0)}};xe.movePan=function(t,i,e){e.dragEndX=mn(t,e),e.dragEndY=dn(t,e);var a=e.initialLeftmostDate-(e.dragEndX-e.dragStartX)*e.xUnitsPerPixel;e.boundedDates&&(a=Math.max(a,e.boundedDates[0]));var n=a+e.dateRange;if(e.boundedDates&&n>e.boundedDates[1]&&(a=a-(n-e.boundedDates[1]),n=a+e.dateRange),i.getOptionForAxis("logscale","x")?i.dateWindow_=[Math.pow(Ii,a),Math.pow(Ii,n)]:i.dateWindow_=[a,n],e.is2DPan)for(var r=e.dragEndY-e.dragStartY,s=0;s<i.axes_.length;s++){var d=i.axes_[s],m=e.axes[s],u=r*m.unitsPerPixel,v=e.boundedValues?e.boundedValues[s]:null,f=m.initialTopValue+u;v&&(f=Math.min(f,v[1]));var y=f-m.dragValueRange;v&&y<v[0]&&(f=f-(y-v[0]),y=f-m.dragValueRange),i.attributes_.getForAxis("logscale",s)?d.valueRange=[Math.pow(Ii,y),Math.pow(Ii,f)]:d.valueRange=[y,f]}i.drawGraph_(!1)};xe.endPan=xe.maybeTreatMouseOpAsClick;xe.startZoom=function(t,i,e){e.isZooming=!0,e.zoomMoved=!1};xe.moveZoom=function(t,i,e){e.zoomMoved=!0,e.dragEndX=mn(t,e),e.dragEndY=dn(t,e);var a=Math.abs(e.dragStartX-e.dragEndX),n=Math.abs(e.dragStartY-e.dragEndY);e.dragDirection=a<n/2?ln:on,i.drawZoomRect_(e.dragDirection,e.dragStartX,e.dragEndX,e.dragStartY,e.dragEndY,e.prevDragDirection,e.prevEndX,e.prevEndY),e.prevEndX=e.dragEndX,e.prevEndY=e.dragEndY,e.prevDragDirection=e.dragDirection};xe.treatMouseOpAsClick=function(t,i,e){for(var a=t.getFunctionOption("clickCallback"),n=t.getFunctionOption("pointClickCallback"),r=null,s=-1,d=Number.MAX_VALUE,m=0;m<t.selPoints_.length;m++){var u=t.selPoints_[m],v=Math.pow(u.canvasx-e.dragEndX,2)+Math.pow(u.canvasy-e.dragEndY,2);!isNaN(v)&&(s==-1||v<d)&&(d=v,s=m)}var f=t.getNumericOption("highlightCircleSize")+2;if(d<=f*f&&(r=t.selPoints_[s]),r){var _={cancelable:!0,point:r,canvasx:e.dragEndX,canvasy:e.dragEndY},y=t.cascadeEvents_("pointClick",_);if(y)return;n&&n.call(t,i,r)}var _={cancelable:!0,xval:t.lastx_,pts:t.selPoints_,canvasx:e.dragEndX,canvasy:e.dragEndY};t.cascadeEvents_("click",_)||a&&a.call(t,i,t.lastx_,t.selPoints_)};xe.endZoom=function(t,i,e){i.clearZoomRect_(),e.isZooming=!1,xe.maybeTreatMouseOpAsClick(t,i,e);var a=i.getArea();if(e.regionWidth>=10&&e.dragDirection==on){var n=Math.min(e.dragStartX,e.dragEndX),r=Math.max(e.dragStartX,e.dragEndX);n=Math.max(n,a.x),r=Math.min(r,a.x+a.w),n<r&&i.doZoomX_(n,r),e.cancelNextDblclick=!0}else if(e.regionHeight>=10&&e.dragDirection==ln){var s=Math.min(e.dragStartY,e.dragEndY),d=Math.max(e.dragStartY,e.dragEndY);s=Math.max(s,a.y),d=Math.min(d,a.y+a.h),s<d&&i.doZoomY_(s,d),e.cancelNextDblclick=!0}e.dragStartX=null,e.dragStartY=null};xe.startTouch=function(t,i,e){t.preventDefault(),t.touches.length>1&&(e.startTimeForDoubleTapMs=null);for(var a=[],n=0;n<t.touches.length;n++){var r=t.touches[n],s=r.target.getBoundingClientRect();a.push({pageX:r.pageX,pageY:r.pageY,dataX:i.toDataXCoord(r.clientX-s.left),dataY:i.toDataYCoord(r.clientY-s.top)})}if(e.initialTouches=a,a.length==1)e.initialPinchCenter=a[0],e.touchDirections={x:!0,y:!0};else if(a.length>=2){e.initialPinchCenter={pageX:.5*(a[0].pageX+a[1].pageX),pageY:.5*(a[0].pageY+a[1].pageY),dataX:.5*(a[0].dataX+a[1].dataX),dataY:.5*(a[0].dataY+a[1].dataY)};var d=180/Math.PI*Math.atan2(e.initialPinchCenter.pageY-a[0].pageY,a[0].pageX-e.initialPinchCenter.pageX);d=Math.abs(d),d>90&&(d=90-d),e.touchDirections={x:d<90-45/2,y:d>45/2}}e.initialRange={x:i.xAxisRange(),y:i.yAxisRange()}};xe.moveTouch=function(t,i,e){e.startTimeForDoubleTapMs=null;var a,n=[];for(a=0;a<t.touches.length;a++){var r=t.touches[a];n.push({pageX:r.pageX,pageY:r.pageY})}var s=e.initialTouches,d,m=e.initialPinchCenter;n.length==1?d=n[0]:d={pageX:.5*(n[0].pageX+n[1].pageX),pageY:.5*(n[0].pageY+n[1].pageY)};var u={pageX:d.pageX-m.pageX,pageY:d.pageY-m.pageY},v=e.initialRange.x[1]-e.initialRange.x[0],f=e.initialRange.y[0]-e.initialRange.y[1];u.dataX=u.pageX/i.plotter_.area.w*v,u.dataY=u.pageY/i.plotter_.area.h*f;var y,_;if(n.length==1)y=1,_=1;else if(n.length>=2){var w=s[1].pageX-m.pageX;y=(n[1].pageX-d.pageX)/w;var P=s[1].pageY-m.pageY;_=(n[1].pageY-d.pageY)/P}y=Math.min(8,Math.max(.125,y)),_=Math.min(8,Math.max(.125,_));var R=!1;if(e.touchDirections.x){var L=m.dataX-u.dataX/y;i.dateWindow_=[L+(e.initialRange.x[0]-m.dataX)/y,L+(e.initialRange.x[1]-m.dataX)/y],R=!0}if(e.touchDirections.y)for(a=0;a<1;a++){var V=i.axes_[a],U=i.attributes_.getForAxis("logscale",a);if(!U){var L=m.dataY-u.dataY/_;V.valueRange=[L+(e.initialRange.y[0]-m.dataY)/_,L+(e.initialRange.y[1]-m.dataY)/_],R=!0}}if(i.drawGraph_(!1),R&&n.length>1&&i.getFunctionOption("zoomCallback")){var q=i.xAxisRange();i.getFunctionOption("zoomCallback").call(i,q[0],q[1],i.yAxisRanges())}};xe.endTouch=function(t,i,e){if(t.touches.length!==0)xe.startTouch(t,i,e);else if(t.changedTouches.length==1){var a=new Date().getTime(),n=t.changedTouches[0];e.startTimeForDoubleTapMs&&a-e.startTimeForDoubleTapMs<500&&e.doubleTapX&&Math.abs(e.doubleTapX-n.screenX)<50&&e.doubleTapY&&Math.abs(e.doubleTapY-n.screenY)<50?i.resetZoom():(e.startTimeForDoubleTapMs=a,e.doubleTapX=n.screenX,e.doubleTapY=n.screenY)}};var Ic=function(t,i,e){return t<i?i-t:t>e?t-e:0},Vf=function(t,i){var e=Ti(i.canvas_),a={left:e.x,right:e.x+i.canvas_.offsetWidth,top:e.y,bottom:e.y+i.canvas_.offsetHeight},n={x:cn(t),y:pn(t)},r=Ic(n.x,a.left,a.right),s=Ic(n.y,a.top,a.bottom);return Math.max(r,s)};xe.defaultModel={mousedown:function(t,i,e){if(!(t.button&&t.button==2)){e.initializeMouseDown(t,i,e),t.altKey||t.shiftKey?xe.startPan(t,i,e):xe.startZoom(t,i,e);var a=function(r){if(e.isZooming){var s=Vf(r,i);s<Nf?xe.moveZoom(r,i,e):e.dragEndX!==null&&(e.dragEndX=null,e.dragEndY=null,i.clearZoomRect_())}else e.isPanning&&xe.movePan(r,i,e)},n=function(r){e.isZooming?e.dragEndX!==null?xe.endZoom(r,i,e):xe.maybeTreatMouseOpAsClick(r,i,e):e.isPanning&&xe.endPan(r,i,e),$t(document,"mousemove",a),$t(document,"mouseup",n),e.destroy()};i.addAndTrackEvent(document,"mousemove",a),i.addAndTrackEvent(document,"mouseup",n)}},willDestroyContextMyself:!0,touchstart:function(t,i,e){xe.startTouch(t,i,e)},touchmove:function(t,i,e){xe.moveTouch(t,i,e)},touchend:function(t,i,e){xe.endTouch(t,i,e)},dblclick:function(t,i,e){if(e.cancelNextDblclick){e.cancelNextDblclick=!1;return}var a={canvasx:e.dragEndX,canvasy:e.dragEndY,cancelable:!0};i.cascadeEvents_("dblclick",a)||t.altKey||t.shiftKey||i.resetZoom()}};xe.nonInteractiveModel_={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e)},mouseup:xe.maybeTreatMouseOpAsClick};xe.dragIsPanInteractionModel={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e),xe.startPan(t,i,e)},mousemove:function(t,i,e){e.isPanning&&xe.movePan(t,i,e)},mouseup:function(t,i,e){e.isPanning&&xe.endPan(t,i,e)}};var Ht=xe;var Ff={highlightCircleSize:3,highlightSeriesOpts:null,highlightSeriesBackgroundAlpha:.5,highlightSeriesBackgroundColor:"rgb(255, 255, 255)",labelsSeparateLines:!1,labelsShowZeroValues:!0,labelsKMB:!1,labelsKMG2:!1,showLabelsOnHighlight:!0,digitsAfterDecimal:2,maxNumberWidth:6,sigFigs:null,strokeWidth:1,strokeBorderWidth:0,strokeBorderColor:"white",axisTickSize:3,axisLabelFontSize:14,rightGap:5,showRoller:!1,xValueParser:void 0,delimiter:",",sigma:2,errorBars:!1,fractions:!1,wilsonInterval:!0,customBars:!1,fillGraph:!1,fillAlpha:.15,connectSeparatedPoints:!1,stackedGraph:!1,stackedGraphNaNFill:"all",hideOverlayOnMouseOut:!0,resizable:"no",legend:"onmouseover",legendFollowOffsetX:50,legendFollowOffsetY:-50,stepPlot:!1,xRangePad:0,yRangePad:null,drawAxesAtZero:!1,titleHeight:28,xLabelHeight:18,yLabelWidth:18,axisLineColor:"black",axisLineWidth:.3,gridLineWidth:.3,axisLabelWidth:50,gridLineColor:"rgb(128,128,128)",interactionModel:Ht.defaultModel,animatedZooms:!1,animateBackgroundFade:!0,showRangeSelector:!1,rangeSelectorHeight:40,rangeSelectorPlotStrokeColor:"#808FAB",rangeSelectorPlotFillGradientColor:"white",rangeSelectorPlotFillColor:"#A7B1C4",rangeSelectorBackgroundStrokeColor:"gray",rangeSelectorBackgroundLineWidth:1,rangeSelectorPlotLineWidth:1.5,rangeSelectorForegroundStrokeColor:"black",rangeSelectorForegroundLineWidth:1,rangeSelectorAlpha:.6,showInRangeSelector:null,plotter:[Fi._fillPlotter,Fi._errorPlotter,Fi._linePlotter],plugins:[],axes:{x:{pixelsPerLabel:70,axisLabelWidth:60,axisLabelFormatter:Vi,valueFormatter:_n,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:Ri},y:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:Zo,axisLabelFormatter:er,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:di},y2:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:Zo,axisLabelFormatter:er,drawAxis:!0,drawGrid:!1,independentTicks:!1,ticker:di}}},gn=Ff;var bt=function(t){this.dygraph_=t,this.yAxes_=[],this.xAxis_={},this.series_={},this.global_=this.dygraph_.attrs_,this.user_=this.dygraph_.user_attrs_||{},this.labels_=[],this.highlightSeries_=this.get("highlightSeriesOpts")||{},this.reparseSeries()};bt.AXIS_STRING_MAPPINGS_={y:0,Y:0,y1:0,Y1:0,y2:1,Y2:1};bt.axisToIndex_=function(t){if(typeof t=="string"){if(bt.AXIS_STRING_MAPPINGS_.hasOwnProperty(t))return bt.AXIS_STRING_MAPPINGS_[t];throw"Unknown axis : "+t}if(typeof t=="number"){if(t===0||t===1)return t;throw"Dygraphs only supports two y-axes, indexed from 0-1."}if(t)throw"Unknown axis : "+t;return 0};bt.prototype.reparseSeries=function(){var t=this.get("labels");if(t){this.labels_=t.slice(1),this.yAxes_=[{series:[],options:{}}],this.xAxis_={options:{}},this.series_={};for(var i=this.user_.series||{},e=0;e<this.labels_.length;e++){var a=this.labels_[e],n=i[a]||{},r=bt.axisToIndex_(n.axis);this.series_[a]={idx:e,yAxis:r,options:n},this.yAxes_[r]?this.yAxes_[r].series.push(a):this.yAxes_[r]={series:[a],options:{}}}var s=this.user_.axes||{};Dt(this.yAxes_[0].options,s.y||{}),this.yAxes_.length>1&&Dt(this.yAxes_[1].options,s.y2||{}),Dt(this.xAxis_.options,s.x||{}),typeof process<"u"}};bt.prototype.get=function(t){var i=this.getGlobalUser_(t);return i!==null?i:this.getGlobalDefault_(t)};bt.prototype.getGlobalUser_=function(t){return this.user_.hasOwnProperty(t)?this.user_[t]:null};bt.prototype.getGlobalDefault_=function(t){return this.global_.hasOwnProperty(t)?this.global_[t]:gn.hasOwnProperty(t)?gn[t]:null};bt.prototype.getForAxis=function(t,i){var e,a;if(typeof i=="number")e=i,a=e===0?"y":"y2";else{if(i=="y1"&&(i="y"),i=="y")e=0;else if(i=="y2")e=1;else if(i=="x")e=-1;else throw"Unknown axis "+i;a=i}var n=e==-1?this.xAxis_:this.yAxes_[e];if(n){var r=n.options;if(r.hasOwnProperty(t))return r[t]}if(!(i==="x"&&t==="logscale")){var s=this.getGlobalUser_(t);if(s!==null)return s}var d=gn.axes[a];return d.hasOwnProperty(t)?d[t]:this.getGlobalDefault_(t)};bt.prototype.getForSeries=function(t,i){if(i===this.dygraph_.getHighlightSeries()&&this.highlightSeries_.hasOwnProperty(t))return this.highlightSeries_[t];if(!this.series_.hasOwnProperty(i))throw"Unknown series: "+i;var e=this.series_[i],a=e.options;return a.hasOwnProperty(t)?a[t]:this.getForAxis(t,e.yAxis)};bt.prototype.numAxes=function(){return this.yAxes_.length};bt.prototype.axisForSeries=function(t){return this.series_[t].yAxis};bt.prototype.axisOptions=function(t){return this.yAxes_[t].options};bt.prototype.seriesForAxis=function(t){return this.yAxes_[t].series};bt.prototype.seriesNames=function(){return this.labels_};var Oc=bt;function zl(){this.tarps=[]}zl.prototype.cover=function(){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++){var e=t[i],a=Ti(e),n=a.x,r=a.y,s=e.offsetWidth,d=e.offsetHeight,m=document.createElement("div");m.style.position="absolute",m.style.left=n+"px",m.style.top=r+"px",m.style.width=s+"px",m.style.height=d+"px",m.style.zIndex=999,document.body.appendChild(m),this.tarps.push(m)}};zl.prototype.uncover=function(){for(var t=0;t<this.tarps.length;t++)this.tarps[t].parentNode.removeChild(this.tarps[t]);this.tarps=[]};var Qo=zl;var Nc=function(){},jt=Nc;jt.X=0;jt.Y=1;jt.EXTRAS=2;jt.prototype.extractSeries=function(t,i,e){};jt.prototype.seriesToPoints=function(t,i,e){for(var a=[],n=0;n<t.length;++n){var r=t[n],s=r[1],d=s===null?null:jt.parseFloat(s),m={x:NaN,y:NaN,xval:jt.parseFloat(r[0]),yval:d,name:i,idx:n+e,canvasx:NaN,canvasy:NaN};a.push(m)}return this.onPointsCreated_(t,a),a};jt.prototype.onPointsCreated_=function(t,i){};jt.prototype.rollingAverage=function(t,i,e,a){};jt.prototype.getExtremeYValues=function(t,i,e){};jt.prototype.onLineEvaluated=function(t,i,e){};jt.parseFloat=function(t){return t===null?NaN:t};var Bi=Nc;var ir=function(){};ir.prototype=new Bi;ir.prototype.extractSeries=function(t,i,e){var a=[];let n=e.get("labels")[i],r=e.getForSeries("logscale",n);for(var s=0;s<t.length;s++){var d=t[s][0],m=t[s][i];r&&m<=0&&(m=null),a.push([d,m])}return a};ir.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,s,d,m,u;if(i==1)return t;for(r=0;r<t.length;r++){for(m=0,u=0,s=Math.max(0,r-i+1);s<r+1;s++)d=t[s][1],!(d===null||isNaN(d))&&(u++,m+=t[s][1]);u?n[r]=[t[r][0],m/u]:n[r]=[t[r][0],null]}return n};ir.prototype.getExtremeYValues=function(i,e,a){for(var n=null,r=null,s,d=0,m=i.length-1,u=d;u<=m;u++)s=i[u][1],!(s===null||isNaN(s))&&((r===null||s>r)&&(r=s),(n===null||s<n)&&(n=s));return[n,r]};var ar=ir;var $i=function(){Bi.call(this)};$i.prototype=new Bi;$i.prototype.extractSeries=function(t,i,e){};$i.prototype.rollingAverage=function(t,i,e,a){};$i.prototype.onPointsCreated_=function(t,i){for(var e=0;e<t.length;++e){var a=t[e],n=i[e];n.y_top=NaN,n.y_bottom=NaN,n.yval_minus=Bi.parseFloat(a[2][0]),n.yval_plus=Bi.parseFloat(a[2][1])}};$i.prototype.getExtremeYValues=function(t,i,e){for(var a=null,n=null,r,s=0,d=t.length-1,m=s;m<=d;m++)if(r=t[m][1],!(r===null||isNaN(r))){var u=t[m][2][0],v=t[m][2][1];u>r&&(u=r),v<r&&(v=r),(n===null||v>n)&&(n=v),(a===null||u<a)&&(a=u)}return[a,n]};$i.prototype.onLineEvaluated=function(t,i,e){for(var a,n=0;n<t.length;n++)a=t[n],a.y_top=tr.calcYNormal_(i,a.yval_minus,e),a.y_bottom=tr.calcYNormal_(i,a.yval_plus,e)};var Di=$i;var Ko=function(){};Ko.prototype=new Di;Ko.prototype.extractSeries=function(t,i,e){var a=[],n,r,s,d;let m=e.get("labels")[i],u=e.getForSeries("logscale",m),v=e.getForSeries("sigma",m);for(var f=0;f<t.length;f++)n=t[f][0],d=t[f][i],u&&d!==null&&(d[0]<=0||d[0]-v*d[1]<=0)&&(d=null),d!==null?(r=d[0],r!==null&&!isNaN(r)?(s=v*d[1],a.push([n,r,[r-s,r+s,d[1]]])):a.push([n,r,[r,r,r]])):a.push([n,null,[null,null,null]]);return a};Ko.prototype.rollingAverage=function(t,i,e,d){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[d],s=e.getForSeries("sigma",r);var d,m,u,v,f,y,_,w,P;for(d=0;d<t.length;d++){for(f=0,w=0,y=0,m=Math.max(0,d-i+1);m<d+1;m++)u=t[m][1],!(u===null||isNaN(u))&&(y++,f+=u,w+=Math.pow(t[m][2][2],2));y?(_=Math.sqrt(w)/y,P=f/y,n[d]=[t[d][0],P,[P-s*_,P+s*_]]):(v=i==1?t[d][1]:null,n[d]=[t[d][0],v,[v,v]])}return n};var Wl=Ko;var Jo=function(){};Jo.prototype=new Di;Jo.prototype.extractSeries=function(t,i,e){var a=[],n,r,s;let d=e.get("labels")[i],m=e.getForSeries("logscale",d);for(var u=0;u<t.length;u++)n=t[u][0],s=t[u][i],m&&s!==null&&(s[0]<=0||s[1]<=0||s[2]<=0)&&(s=null),s!==null?(r=s[1],r!==null&&!isNaN(r)?a.push([n,r,[s[0],s[2]]]):a.push([n,r,[r,r]])):a.push([n,null,[null,null]]);return a};Jo.prototype.rollingAverage=function(t,i,e,v){i=Math.min(i,t.length);var n=[],r,s,d,m,u,v,f;for(s=0,m=0,d=0,u=0,v=0;v<t.length;v++){if(r=t[v][1],f=t[v][2],n[v]=t[v],r!==null&&!isNaN(r)&&(s+=f[0],m+=r,d+=f[1],u+=1),v-i>=0){var y=t[v-i];y[1]!==null&&!isNaN(y[1])&&(s-=y[2][0],m-=y[1],d-=y[2][1],u-=1)}u?n[v]=[t[v][0],1*m/u,[1*s/u,1*d/u]]:n[v]=[t[v][0],null,[null,null]]}return n};var Xl=Jo;var el=function(){};el.prototype=new ar;el.prototype.extractSeries=function(t,i,e){var a=[],n,r,s,d,m,u,v=100;let f=e.get("labels")[i],y=e.getForSeries("logscale",f);for(var _=0;_<t.length;_++)n=t[_][0],s=t[_][i],y&&s!==null&&(s[0]<=0||s[1]<=0)&&(s=null),s!==null?(d=s[0],m=s[1],d!==null&&!isNaN(d)?(u=m?d/m:0,r=v*u,a.push([n,r,[d,m]])):a.push([n,d,[d,m]])):a.push([n,null,[null,null]]);return a};el.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,s=0,d=0,m=100;for(r=0;r<t.length;r++){s+=t[r][2][0],d+=t[r][2][1],r-i>=0&&(s-=t[r-i][2][0],d-=t[r-i][2][1]);var u=t[r][0],v=d?s/d:0;n[r]=[u,m*v]}return n};var Zl=el;var tl=function(){};tl.prototype=new Di;tl.prototype.extractSeries=function(t,i,e){var a=[],n,r,s,d,m,u,v,f,y=100;let _=e.get("labels")[i],w=e.getForSeries("logscale",_),P=e.getForSeries("sigma",_);for(var R=0;R<t.length;R++)n=t[R][0],s=t[R][i],w&&s!==null&&(s[0]<=0||s[1]<=0)&&(s=null),s!==null?(d=s[0],m=s[1],d!==null&&!isNaN(d)?(u=m?d/m:0,v=m?P*Math.sqrt(u*(1-u)/m):1,f=y*v,r=y*u,a.push([n,r,[r-f,r+f,d,m]])):a.push([n,d,[d,d,d,m]])):a.push([n,null,[null,null,null,null]]);return a};tl.prototype.rollingAverage=function(t,i,e,v){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[v],s=e.getForSeries("sigma",r),d=e.getForSeries("wilsonInterval",r);var m,u,v,f,y=0,_=0,w=100;for(v=0;v<t.length;v++){y+=t[v][2][2],_+=t[v][2][3],v-i>=0&&(y-=t[v-i][2][2],_-=t[v-i][2][3]);var P=t[v][0],R=_?y/_:0;if(d)if(_){var L=R<0?0:R,V=_,U=s*Math.sqrt(L*(1-L)/V+s*s/(4*V*V)),q=1+s*s/_;m=(L+s*s/(2*_)-U)/q,u=(L+s*s/(2*_)+U)/q,n[v]=[P,L*w,[m*w,u*w]]}else n[v]=[P,0,[0,0]];else f=_?s*Math.sqrt(R*(1-R)/_):1,n[v]=[P,w*R,[w*(R-f),w*(R+f)]]}return n};var Ql=tl;var Hi=function(){this.annotations_=[]};Hi.prototype.toString=function(){return"Annotations Plugin"};Hi.prototype.activate=function(t){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}};Hi.prototype.detachLabels=function(){for(var t=0;t<this.annotations_.length;t++){var i=this.annotations_[t];i.parentNode&&i.parentNode.removeChild(i),this.annotations_[t]=null}this.annotations_=[]};Hi.prototype.clearChart=function(t){this.detachLabels()};Hi.prototype.didDrawChart=function(t){var i=t.dygraph,e=i.layout_.annotated_points;if(!(!e||e.length===0))for(var a=t.canvas.parentNode,n=function(q,ee,Me){return function(j){var te=Me.annotation;te.hasOwnProperty(q)?te[q](te,Me,i,j):i.getOption(ee)&&i.getOption(ee)(te,Me,i,j)}},r=t.dygraph.getArea(),s={},d=0;d<e.length;d++){var m=e[d];if(!(m.canvasx<r.x||m.canvasx>r.x+r.w||m.canvasy<r.y||m.canvasy>r.y+r.h)){var u=m.annotation,v=6;u.hasOwnProperty("tickHeight")&&(v=u.tickHeight);var f=document.createElement("div");f.style.fontSize=i.getOption("axisLabelFontSize")+"px";var y="dygraph-annotation";u.hasOwnProperty("icon")||(y+=" dygraphDefaultAnnotation dygraph-default-annotation"),u.hasOwnProperty("cssClass")&&(y+=" "+u.cssClass),f.className=y;var _=u.hasOwnProperty("width")?u.width:16,w=u.hasOwnProperty("height")?u.height:16;if(u.hasOwnProperty("icon")){var P=document.createElement("img");P.src=u.icon,P.width=_,P.height=w,f.appendChild(P)}else m.annotation.hasOwnProperty("shortText")&&f.appendChild(document.createTextNode(m.annotation.shortText));var R=m.canvasx-_/2;f.style.left=R+"px";var L=0;if(u.attachAtBottom){var V=r.y+r.h-w-v;s[R]?V-=s[R]:s[R]=0,s[R]+=v+w,L=V}else L=m.canvasy-w-v;f.style.top=L+"px",f.style.width=_+"px",f.style.height=w+"px",f.title=m.annotation.text,f.style.color=i.colorsMap_[m.name],f.style.borderColor=i.colorsMap_[m.name],u.div=f,i.addAndTrackEvent(f,"click",n("clickHandler","annotationClickHandler",m,this)),i.addAndTrackEvent(f,"mouseover",n("mouseOverHandler","annotationMouseOverHandler",m,this)),i.addAndTrackEvent(f,"mouseout",n("mouseOutHandler","annotationMouseOutHandler",m,this)),i.addAndTrackEvent(f,"dblclick",n("dblClickHandler","annotationDblClickHandler",m,this)),a.appendChild(f),this.annotations_.push(f);var U=t.drawingContext;if(U.save(),U.strokeStyle=u.hasOwnProperty("tickColor")?u.tickColor:i.colorsMap_[m.name],U.lineWidth=u.hasOwnProperty("tickWidth")?u.tickWidth:i.getOption("strokeWidth"),U.beginPath(),!u.attachAtBottom)U.moveTo(m.canvasx,m.canvasy),U.lineTo(m.canvasx,m.canvasy-2-v);else{var V=L+w;U.moveTo(m.canvasx,V),U.lineTo(m.canvasx,V+v)}U.closePath(),U.stroke(),U.restore()}}};Hi.prototype.destroy=function(){this.detachLabels()};var Kl=Hi;var Yi=function(){this.xlabels_=[],this.ylabels_=[]};Yi.prototype.toString=function(){return"Axes Plugin"};Yi.prototype.activate=function(t){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}};Yi.prototype.layout=function(t){var i=t.dygraph;if(i.getOptionForAxis("drawAxis","y")){var e=i.getOptionForAxis("axisLabelWidth","y")+2*i.getOptionForAxis("axisTickSize","y");t.reserveSpaceLeft(e)}if(i.getOptionForAxis("drawAxis","x")){var a;i.getOption("xAxisHeight")?a=i.getOption("xAxisHeight"):a=i.getOptionForAxis("axisLabelFontSize","x")+2*i.getOptionForAxis("axisTickSize","x"),t.reserveSpaceBottom(a)}if(i.numAxes()==2){if(i.getOptionForAxis("drawAxis","y2")){var e=i.getOptionForAxis("axisLabelWidth","y2")+2*i.getOptionForAxis("axisTickSize","y2");t.reserveSpaceRight(e)}}else i.numAxes()>2&&i.error("Only two y-axes are supported at this time. (Trying to use "+i.numAxes()+")")};Yi.prototype.detachLabels=function(){function t(i){for(var e=0;e<i.length;e++){var a=i[e];a.parentNode&&a.parentNode.removeChild(a)}}t(this.xlabels_),t(this.ylabels_),this.xlabels_=[],this.ylabels_=[]};Yi.prototype.clearChart=function(t){this.detachLabels()};Yi.prototype.willDrawChart=function(t){var i=t.dygraph;if(!i.getOptionForAxis("drawAxis","x")&&!i.getOptionForAxis("drawAxis","y")&&!i.getOptionForAxis("drawAxis","y2"))return;function e(z){return Math.round(z)+.5}function a(z){return Math.round(z)-.5}var n=t.drawingContext,r=t.canvas.parentNode,s=i.width_,d=i.height_,m,u,v,f,y,_=function(z){return{position:"absolute",fontSize:i.getOptionForAxis("axisLabelFontSize",z)+"px",width:i.getOptionForAxis("axisLabelWidth",z)+"px"}},w={x:_("x"),y:_("y"),y2:_("y2")},P=function(z,ue,Ct){var Ze=document.createElement("div"),Vt=w[Ct=="y2"?"y2":ue];Dt(Ze.style,Vt);var rt=document.createElement("div");return rt.className="dygraph-axis-label dygraph-axis-label-"+ue+(Ct?" dygraph-axis-label-"+Ct:""),rt.innerHTML=z,Ze.appendChild(rt),Ze};n.save();var R=i.layout_,L=t.dygraph.plotter_.area,V=function(z){return function(ue){return i.getOptionForAxis(ue,z)}};let U=this;if(i.getOptionForAxis("drawAxis","y")||i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")){if(R.yticks&&R.yticks.length>0){var q=i.numAxes(),ee=[V("y"),V("y2")];R.yticks.forEach(function(z){if(z.label!==void 0){u=L.x;var ue=1,Ct="y1",Ze=ee[0];if(z.axis==1&&(u=L.x+L.w,ue=-1,Ct="y2",Ze=ee[1]),!!Ze("drawAxis")){var Vt=Ze("axisLabelFontSize");v=L.y+z.pos*L.h,m=P(z.label,"y",q==2?Ct:null);var rt=v-Vt/2;rt<0&&(rt=0),rt+Vt+3>d?m.style.bottom="0":m.style.top=Math.min(rt,d-2*Vt)+"px",z.axis===0?(m.style.left=L.x-Ze("axisLabelWidth")-Ze("axisTickSize")+"px",m.style.textAlign="right"):z.axis==1&&(m.style.left=L.x+L.w+Ze("axisTickSize")+"px",m.style.textAlign="left"),m.style.width=Ze("axisLabelWidth")+"px",r.appendChild(m),U.ylabels_.push(m)}}})}var Me;if(i.getOption("drawAxesAtZero")){var j=i.toPercentXCoord(0);(j>1||j<0||isNaN(j))&&(j=0),Me=e(L.x+j*L.w)}else Me=e(L.x);n.strokeStyle=i.getOptionForAxis("axisLineColor","y"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y"),n.beginPath(),n.moveTo(Me,a(L.y)),n.lineTo(Me,a(L.y+L.h)),n.closePath(),n.stroke(),i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")&&(n.strokeStyle=i.getOptionForAxis("axisLineColor","y2"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y2"),n.beginPath(),n.moveTo(a(L.x+L.w),a(L.y)),n.lineTo(a(L.x+L.w),a(L.y+L.h)),n.closePath(),n.stroke())}if(i.getOptionForAxis("drawAxis","x")){if(R.xticks){var te=V("x");R.xticks.forEach(function(z){if(z.label!==void 0){u=L.x+z.pos*L.w,v=L.y+L.h,m=P(z.label,"x"),m.style.textAlign="center",m.style.top=v+te("axisTickSize")+"px";var ue=u-te("axisLabelWidth")/2;ue+te("axisLabelWidth")>s&&(ue=s-te("axisLabelWidth"),m.style.textAlign="right"),ue<0&&(ue=0,m.style.textAlign="left"),m.style.left=ue+"px",m.style.width=te("axisLabelWidth")+"px",r.appendChild(m),U.xlabels_.push(m)}})}n.strokeStyle=i.getOptionForAxis("axisLineColor","x"),n.lineWidth=i.getOptionForAxis("axisLineWidth","x"),n.beginPath();var he;if(i.getOption("drawAxesAtZero")){var j=i.toPercentYCoord(0,0);(j>1||j<0)&&(j=1),he=a(L.y+j*L.h)}else he=a(L.y+L.h);n.moveTo(e(L.x),he),n.lineTo(e(L.x+L.w),he),n.closePath(),n.stroke()}n.restore()};var Jl=Yi;var Pi=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};Pi.prototype.toString=function(){return"ChartLabels Plugin"};Pi.prototype.activate=function(t){return{layout:this.layout,didDrawChart:this.didDrawChart}};var Vc=function(t){var i=document.createElement("div");return i.style.position="absolute",i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.width=t.w+"px",i.style.height=t.h+"px",i};Pi.prototype.detachLabels_=function(){for(var t=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],i=0;i<t.length;i++){var e=t[i];e&&e.parentNode&&e.parentNode.removeChild(e)}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var Fc=function(t,i,e,a,n){var r=document.createElement("div");r.style.position="absolute",e==1?r.style.left="0px":r.style.left=i.x+"px",r.style.top=i.y+"px",r.style.width=i.w+"px",r.style.height=i.h+"px",r.style.fontSize=t.getOption("yLabelWidth")-2+"px";var s=document.createElement("div");s.style.position="absolute",s.style.width=i.h+"px",s.style.height=i.w+"px",s.style.top=i.h/2-i.w/2+"px",s.style.left=i.w/2-i.h/2+"px",s.className="dygraph-label-rotate-"+(e==1?"right":"left");var d=document.createElement("div");return d.className=a,d.innerHTML=n,s.appendChild(d),r.appendChild(s),r};Pi.prototype.layout=function(t){this.detachLabels_();var i=t.dygraph,e=t.chart_div;if(i.getOption("title")){var a=t.reserveSpaceTop(i.getOption("titleHeight"));this.title_div_=Vc(a),this.title_div_.style.fontSize=i.getOption("titleHeight")-8+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-title",n.innerHTML=i.getOption("title"),this.title_div_.appendChild(n),e.appendChild(this.title_div_)}if(i.getOption("xlabel")){var r=t.reserveSpaceBottom(i.getOption("xLabelHeight"));this.xlabel_div_=Vc(r),this.xlabel_div_.style.fontSize=i.getOption("xLabelHeight")-2+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-xlabel",n.innerHTML=i.getOption("xlabel"),this.xlabel_div_.appendChild(n),e.appendChild(this.xlabel_div_)}if(i.getOption("ylabel")){var s=t.reserveSpaceLeft(0);this.ylabel_div_=Fc(i,s,1,"dygraph-label dygraph-ylabel",i.getOption("ylabel")),e.appendChild(this.ylabel_div_)}if(i.getOption("y2label")&&i.numAxes()==2){var d=t.reserveSpaceRight(0);this.y2label_div_=Fc(i,d,2,"dygraph-label dygraph-y2label",i.getOption("y2label")),e.appendChild(this.y2label_div_)}};Pi.prototype.didDrawChart=function(t){var i=t.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=i.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=i.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=i.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=i.getOption("y2label"))};Pi.prototype.clearChart=function(){};Pi.prototype.destroy=function(){this.detachLabels_()};var es=Pi;var nr=function(){};nr.prototype.toString=function(){return"Gridline Plugin"};nr.prototype.activate=function(t){return{willDrawChart:this.willDrawChart}};nr.prototype.willDrawChart=function(t){var i=t.dygraph,e=t.drawingContext,a=i.layout_,n=t.dygraph.plotter_.area;function r(L){return Math.round(L)+.5}function s(L){return Math.round(L)-.5}var d,m,u,v;if(i.getOptionForAxis("drawGrid","y")){for(var f=["y","y2"],y=[],_=[],w=[],P=[],R=[],u=0;u<f.length;u++)w[u]=i.getOptionForAxis("drawGrid",f[u]),w[u]&&(y[u]=i.getOptionForAxis("gridLineColor",f[u]),_[u]=i.getOptionForAxis("gridLineWidth",f[u]),R[u]=i.getOptionForAxis("gridLinePattern",f[u]),P[u]=R[u]&&R[u].length>=2);v=a.yticks,e.save(),v.forEach(L=>{if(L.has_tick){var V=L.axis;w[V]&&(e.save(),P[V]&&e.setLineDash&&e.setLineDash(R[V]),e.strokeStyle=y[V],e.lineWidth=_[V],d=r(n.x),m=s(n.y+L.pos*n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d+n.w,m),e.stroke(),e.restore())}}),e.restore()}if(i.getOptionForAxis("drawGrid","x")){v=a.xticks,e.save();var R=i.getOptionForAxis("gridLinePattern","x"),P=R&&R.length>=2;P&&e.setLineDash&&e.setLineDash(R),e.strokeStyle=i.getOptionForAxis("gridLineColor","x"),e.lineWidth=i.getOptionForAxis("gridLineWidth","x"),v.forEach(U=>{U.has_tick&&(d=r(n.x+U.pos*n.w),m=s(n.y+n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d,n.y),e.stroke())}),P&&e.setLineDash&&e.setLineDash([]),e.restore()}};nr.prototype.destroy=function(){};var ts=nr;var Yt=function(){this.legend_div_=null,this.is_generated_div_=!1};Yt.prototype.toString=function(){return"Legend Plugin"};Yt.prototype.activate=function(t){var i,e=t.getOption("labelsDiv");return e&&e!==null?typeof e=="string"||e instanceof String?i=document.getElementById(e):i=e:(i=document.createElement("div"),i.className="dygraph-legend",t.graphDiv.appendChild(i),this.is_generated_div_=!0),this.legend_div_=i,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var Bf=function(t){var i=document.createElement("span");i.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),t.appendChild(i);var e=i.offsetWidth;return t.removeChild(i),e},$f=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&#34;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};Yt.prototype.select=function(t){var i=t.selectedX,e=t.selectedPoints,a=t.selectedRow,n=t.dygraph.getOption("legend");if(n==="never"){this.legend_div_.style.display="none";return}var r=Yt.generateLegendHTML(t.dygraph,i,e,this.one_em_width_,a);if(r instanceof Node&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(r)):this.legend_div_.innerHTML=r,this.legend_div_.style.display="",n==="follow"){var s=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth,m=t.dygraph.getOptionForAxis("axisLabelWidth","y"),u=t.dygraph.getHighlightSeries(),v;u?(v=e.find(P=>P.name===u),v||(v=e[0])):v=e[0];let _=t.dygraph.getNumericOption("legendFollowOffsetX"),w=t.dygraph.getNumericOption("legendFollowOffsetY");var f=v.x*s.w+_,y=v.y*s.h+w;f+d+1>s.w&&(f=f-2*_-d-(m-s.x)),this.legend_div_.style.left=m+f+"px",this.legend_div_.style.top=y+"px"}else if(n==="onmouseover"&&this.is_generated_div_){var s=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth;this.legend_div_.style.left=s.x+s.w-d-1+"px",this.legend_div_.style.top=s.y+"px"}};Yt.prototype.deselect=function(t){var i=t.dygraph.getOption("legend");i!=="always"&&(this.legend_div_.style.display="none");var e=Bf(this.legend_div_);this.one_em_width_=e;var a=Yt.generateLegendHTML(t.dygraph,void 0,void 0,e,null);a instanceof Node&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(a)):this.legend_div_.innerHTML=a};Yt.prototype.didDrawChart=function(t){this.deselect(t)};Yt.prototype.predraw=function(t){if(this.is_generated_div_){t.dygraph.graphDiv.appendChild(this.legend_div_);var i=t.dygraph.plotter_.area,e=this.legend_div_.offsetWidth;this.legend_div_.style.left=i.x+i.w-e-1+"px",this.legend_div_.style.top=i.y+"px"}};Yt.prototype.destroy=function(){this.legend_div_=null};Yt.generateLegendHTML=function(t,i,e,a,n){var r={dygraph:t,x:i,i:n,series:[]},s={},d=t.getLabels();if(d)for(var m=1;m<d.length;m++){var u=t.getPropertiesForSeries(d[m]),v=t.getOption("strokePattern",d[m]),f={dashHTML:Hf(v,u.color,a),label:d[m],labelHTML:$f(d[m]),isVisible:u.visible,color:u.color};r.series.push(f),s[d[m]]=f}if(typeof i<"u"){var y=t.optionsViewForAxis_("x"),_=y("valueFormatter");r.xHTML=_.call(t,i,y,d[0],t,n,0);for(var w=[],P=t.numAxes(),m=0;m<P;m++)w[m]=t.optionsViewForAxis_("y"+(m?1+m:""));var R=t.getOption("labelsShowZeroValues"),L=t.getHighlightSeries();for(m=0;m<e.length;m++){var V=e[m],f=s[V.name];if(f.y=V.yval,V.yval===0&&!R||isNaN(V.canvasy)){f.isVisible=!1;continue}var u=t.getPropertiesForSeries(V.name),U=w[u.axis-1],q=U("valueFormatter"),ee=q.call(t,V.yval,U,V.name,t,n,d.indexOf(V.name));Dt(f,{yHTML:ee}),V.name==L&&(f.isHighlighted=!0)}}var Me=t.getOption("legendFormatter")||Yt.defaultFormatter;return Me.call(t,r)};Yt.defaultFormatter=function(t){var i=t.dygraph;if(i.getOption("showLabelsOnHighlight")!==!0)return"";var e=i.getOption("labelsSeparateLines"),a;if(typeof t.x>"u"){if(i.getOption("legend")!="always")return"";a="";for(var n=0;n<t.series.length;n++){var r=t.series[n];r.isVisible&&(a!==""&&(a+=e?"<br />":" "),a+=`<span style='font-weight: bold; color: ${r.color};'>${r.dashHTML} ${r.labelHTML}</span>`)}return a}a=t.xHTML+":";for(var n=0;n<t.series.length;n++){var r=t.series[n];if(!(!r.y&&!r.yHTML)&&r.isVisible){e&&(a+="<br>");var s=r.isHighlighted?' class="highlight"':"";a+=`<span${s}> <b><span style='color: ${r.color};'>${r.labelHTML}</span></b>:&#160;${r.yHTML}</span>`}}return a};function Hf(t,i,e){if(!t||t.length<=1)return`<div class="dygraph-legend-line" style="border-bottom-color: ${i};"></div>`;var a,n,r,s,d=0,m=0,u=[],v;for(a=0;a<=t.length;a++)d+=t[a%t.length];if(v=Math.floor(e/(d-t[0])),v>1){for(a=0;a<t.length;a++)u[a]=t[a]/e;m=u.length}else{for(v=1,a=0;a<t.length;a++)u[a]=t[a]/d;m=u.length+1}var f="";for(n=0;n<v;n++)for(a=0;a<m;a+=2)r=u[a%u.length],a<t.length?s=u[(a+1)%u.length]:s=0,f+=`<div class="dygraph-legend-dash" style="margin-right: ${s}em; padding-left: ${r}em;"></div>`;return f}var is=Yt;var Xe=function(){this.hasTouchInterface_=typeof TouchEvent<"u",this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};Xe.prototype.toString=function(){return"RangeSelector Plugin"};Xe.prototype.activate=function(t){return this.dygraph_=t,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}};Xe.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null};Xe.prototype.getOption_=function(t,i){return this.dygraph_.getOption(t,i)};Xe.prototype.setDefaultOption_=function(t,i){this.dygraph_.attrs_[t]=i};Xe.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()};Xe.prototype.addToGraph_=function(){var t=this.graphDiv_=this.dygraph_.graphDiv;t.appendChild(this.bgcanvas_),t.appendChild(this.fgcanvas_),t.appendChild(this.leftZoomHandle_),t.appendChild(this.rightZoomHandle_)};Xe.prototype.removeFromGraph_=function(){var t=this.graphDiv_;t.removeChild(this.bgcanvas_),t.removeChild(this.fgcanvas_),t.removeChild(this.leftZoomHandle_),t.removeChild(this.rightZoomHandle_),this.graphDiv_=null};Xe.prototype.reserveSpace_=function(t){this.getOption_("showRangeSelector")&&t.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)};Xe.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())};Xe.prototype.renderInteractiveLayer_=function(){!this.updateVisibility_()||this.isChangingRange_||(this.placeZoomHandles_(),this.drawInteractiveLayer_())};Xe.prototype.updateVisibility_=function(){var t=this.getOption_("showRangeSelector");if(t)this.interfaceCreated_?(!this.graphDiv_||!this.graphDiv_.parentNode)&&this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var i=this.dygraph_;setTimeout(function(){i.width_=0,i.resize()},1)}return t};Xe.prototype.resize_=function(){function t(n,r,s,d){var m=d||Kn(r);n.style.top=s.y+"px",n.style.left=s.x+"px",n.width=s.w*m,n.height=s.h*m,n.style.width=s.w+"px",n.style.height=s.h+"px",m!=1&&r.scale(m,m)}var i=this.dygraph_.layout_.getPlotArea(),e=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(e=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:i.x,y:i.y+i.h+e+4,w:i.w,h:this.getOption_("rangeSelectorHeight")};var a=this.dygraph_.getNumericOption("pixelRatio");t(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_,a),t(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_,a)};Xe.prototype.createCanvases_=function(){this.bgcanvas_=hn(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=sn(this.bgcanvas_),this.fgcanvas_=hn(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=sn(this.fgcanvas_)};Xe.prototype.createZoomHandles_=function(){var t=new Image;t.className="dygraph-rangesel-zoomhandle",t.style.position="absolute",t.style.zIndex=10,t.style.visibility="hidden",t.style.cursor="col-resize",t.width=9,t.height=16,t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII=",this.isMobileDevice_&&(t.width*=2,t.height*=2),this.leftZoomHandle_=t,this.rightZoomHandle_=t.cloneNode(!1)};Xe.prototype.initInteraction_=function(){var t=this,i=document,e=0,a=null,n=!1,r=!1,s=!this.isMobileDevice_,d=new Qo,m,u,v,f,y,_,w,P,R,L,V,U,q,ee;m=function(j){var te=t.dygraph_.xAxisExtremes(),he=(te[1]-te[0])/t.canvasRect_.w,z=te[0]+(j.leftHandlePos-t.canvasRect_.x)*he,ue=te[0]+(j.rightHandlePos-t.canvasRect_.x)*he;return[z,ue]},u=function(j){return ui(j),n=!0,e=j.clientX,a=j.target?j.target:j.srcElement,(j.type==="mousedown"||j.type==="dragstart")&&(Oi(i,"mousemove",v),Oi(i,"mouseup",f)),t.fgcanvas_.style.cursor="col-resize",d.cover(),!0},v=function(j){if(!n)return!1;ui(j);var te=j.clientX-e;if(Math.abs(te)<4)return!0;e=j.clientX;var he=t.getZoomHandleStatus_(),z;a==t.leftZoomHandle_?(z=he.leftHandlePos+te,z=Math.min(z,he.rightHandlePos-a.width-3),z=Math.max(z,t.canvasRect_.x)):(z=he.rightHandlePos+te,z=Math.min(z,t.canvasRect_.x+t.canvasRect_.w),z=Math.max(z,he.leftHandlePos+a.width+3));var ue=a.width/2;return a.style.left=z-ue+"px",t.drawInteractiveLayer_(),s&&y(),!0},f=function(j){return n?(n=!1,d.uncover(),$t(i,"mousemove",v),$t(i,"mouseup",f),t.fgcanvas_.style.cursor="default",s||y(),!0):!1},y=function(){try{var j=t.getZoomHandleStatus_();if(t.isChangingRange_=!0,!j.isZoomed)t.dygraph_.resetZoom();else{var te=m(j);t.dygraph_.doZoomXDates_(te[0],te[1])}}finally{t.isChangingRange_=!1}},_=function(j){var te=t.leftZoomHandle_.getBoundingClientRect(),he=te.left+te.width/2;te=t.rightZoomHandle_.getBoundingClientRect();var z=te.left+te.width/2;return j.clientX>he&&j.clientX<z},w=function(j){return!r&&_(j)&&t.getZoomHandleStatus_().isZoomed?(ui(j),r=!0,e=j.clientX,j.type==="mousedown"&&(Oi(i,"mousemove",P),Oi(i,"mouseup",R)),!0):!1},P=function(j){if(!r)return!1;ui(j);var te=j.clientX-e;if(Math.abs(te)<4)return!0;e=j.clientX;var he=t.getZoomHandleStatus_(),z=he.leftHandlePos,ue=he.rightHandlePos,Ct=ue-z;z+te<=t.canvasRect_.x?(z=t.canvasRect_.x,ue=z+Ct):ue+te>=t.canvasRect_.x+t.canvasRect_.w?(ue=t.canvasRect_.x+t.canvasRect_.w,z=ue-Ct):(z+=te,ue+=te);var Ze=t.leftZoomHandle_.width/2;return t.leftZoomHandle_.style.left=z-Ze+"px",t.rightZoomHandle_.style.left=ue-Ze+"px",t.drawInteractiveLayer_(),s&&L(),!0},R=function(j){return r?(r=!1,$t(i,"mousemove",P),$t(i,"mouseup",R),s||L(),!0):!1},L=function(){try{t.isChangingRange_=!0,t.dygraph_.dateWindow_=m(t.getZoomHandleStatus_()),t.dygraph_.drawGraph_(!1)}finally{t.isChangingRange_=!1}},V=function(j){if(!(n||r)){var te=_(j)?"move":"default";te!=t.fgcanvas_.style.cursor&&(t.fgcanvas_.style.cursor=te)}},U=function(j){j.type=="touchstart"&&j.targetTouches.length==1?u(j.targetTouches[0])&&ui(j):j.type=="touchmove"&&j.targetTouches.length==1?v(j.targetTouches[0])&&ui(j):f(j)},q=function(j){j.type=="touchstart"&&j.targetTouches.length==1?w(j.targetTouches[0])&&ui(j):j.type=="touchmove"&&j.targetTouches.length==1?P(j.targetTouches[0])&&ui(j):R(j)},ee=function(j,te){for(var he=["touchstart","touchend","touchmove","touchcancel"],z=0;z<he.length;z++)t.dygraph_.addAndTrackEvent(j,he[z],te)},this.setDefaultOption_("interactionModel",Ht.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);var Me=window.opera?"mousedown":"dragstart";this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,Me,u),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,Me,u),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",w),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",V),this.hasTouchInterface_&&(ee(this.leftZoomHandle_,U),ee(this.rightZoomHandle_,U),ee(this.fgcanvas_,q))};Xe.prototype.drawStaticLayer_=function(){var t=this.bgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(e){console.warn(e)}var i=.5;this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorBackgroundLineWidth"),t.strokeStyle=this.getOption_("rangeSelectorBackgroundStrokeColor"),t.beginPath(),t.moveTo(i,i),t.lineTo(i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,i),t.stroke()};Xe.prototype.drawMiniPlot_=function(){var t=this.getOption_("rangeSelectorPlotFillColor"),i=this.getOption_("rangeSelectorPlotFillGradientColor"),e=this.getOption_("rangeSelectorPlotStrokeColor");if(!(!t&&!e)){var a=this.getOption_("stepPlot"),n=this.computeCombinedSeriesAndLimits_(),r=n.yMax-n.yMin,s=this.bgcanvas_ctx_,d=.5,m=this.dygraph_.xAxisExtremes(),u=Math.max(m[1]-m[0],1e-30),v=(this.canvasRect_.w-d)/u,f=(this.canvasRect_.h-d)/r,y=this.canvasRect_.w-d,_=this.canvasRect_.h-d,w=null,P=null;s.beginPath(),s.moveTo(d,_);for(var R=0;R<n.data.length;R++){var L=n.data[R],V=L[0]!==null?(L[0]-m[0])*v:NaN,U=L[1]!==null?_-(L[1]-n.yMin)*f:NaN;!a&&w!==null&&Math.round(V)==Math.round(w)||(isFinite(V)&&isFinite(U)?(w===null?s.lineTo(V,_):a&&s.lineTo(V,P),s.lineTo(V,U),w=V,P=U):(w!==null&&(a?(s.lineTo(V,P),s.lineTo(V,_)):s.lineTo(w,_)),w=P=null))}if(s.lineTo(y,_),s.closePath(),t){var q=this.bgcanvas_ctx_.createLinearGradient(0,0,0,_);i&&q.addColorStop(0,i),q.addColorStop(1,t),this.bgcanvas_ctx_.fillStyle=q,s.fill()}e&&(this.bgcanvas_ctx_.strokeStyle=e,this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorPlotLineWidth"),s.stroke())}};Xe.prototype.computeCombinedSeriesAndLimits_=function(){var t=this.dygraph_,i=this.getOption_("logscale"),e,a=t.numColumns(),n=t.getLabels(),r=new Array(a),s=!1,d=t.visibility(),m=[];for(e=1;e<a;e++){var u=this.getOption_("showInRangeSelector",n[e]);m.push(u),u!==null&&(s=!0)}if(s)for(e=1;e<a;e++)r[e]=m[e-1];else for(e=1;e<a;e++)r[e]=d[e-1];var v=[],f=t.dataHandler_,y=t.attributes_;for(e=1;e<t.numColumns();e++)if(r[e]){var _=f.extractSeries(t.rawData_,e,y);t.rollPeriod()>1&&(_=f.rollingAverage(_,t.rollPeriod(),y,e)),v.push(_)}var w=[];for(e=0;e<v[0].length;e++){for(var P=0,R=0,L=0;L<v.length;L++){var V=v[L][e][1];V===null||isNaN(V)||(R++,P+=V)}w.push([v[0][e][0],P/R])}var U=Number.MAX_VALUE,q=-Number.MAX_VALUE;for(e=0;e<w.length;e++){var ee=w[e][1];ee!==null&&isFinite(ee)&&(!i||ee>0)&&(U=Math.min(U,ee),q=Math.max(q,ee))}var Me=.25;if(i)for(q=De(q),q+=q*Me,U=De(U),e=0;e<w.length;e++)w[e][1]=De(w[e][1]);else{var j,te=q-U;te<=Number.MIN_VALUE?j=q*Me:j=te*Me,q+=j,U-=j}return{data:w,yMin:U,yMax:q}};Xe.prototype.placeZoomHandles_=function(){var t=this.dygraph_.xAxisExtremes(),i=this.dygraph_.xAxisRange(),e=t[1]-t[0],a=Math.max(0,(i[0]-t[0])/e),n=Math.max(0,(t[1]-i[1])/e),r=this.canvasRect_.x+this.canvasRect_.w*a,s=this.canvasRect_.x+this.canvasRect_.w*(1-n),d=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),m=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=r-m+"px",this.leftZoomHandle_.style.top=d+"px",this.rightZoomHandle_.style.left=s-m+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"};Xe.prototype.drawInteractiveLayer_=function(){var t=this.fgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var i=1,e=this.canvasRect_.w-i,a=this.canvasRect_.h-i,n=this.getZoomHandleStatus_();if(t.strokeStyle=this.getOption_("rangeSelectorForegroundStrokeColor"),t.lineWidth=this.getOption_("rangeSelectorForegroundLineWidth"),!n.isZoomed)t.beginPath(),t.moveTo(i,i),t.lineTo(i,a),t.lineTo(e,a),t.lineTo(e,i),t.stroke();else{var r=Math.max(i,n.leftHandlePos-this.canvasRect_.x),s=Math.min(e,n.rightHandlePos-this.canvasRect_.x);let d=this.getOption_("rangeSelectorVeilColour");t.fillStyle=d||"rgba(240, 240, 240, "+this.getOption_("rangeSelectorAlpha").toString()+")",t.fillRect(0,0,r,this.canvasRect_.h),t.fillRect(s,0,this.canvasRect_.w-s,this.canvasRect_.h),t.beginPath(),t.moveTo(i,i),t.lineTo(r,i),t.lineTo(r,a),t.lineTo(s,a),t.lineTo(s,i),t.lineTo(e,i),t.stroke()}};Xe.prototype.getZoomHandleStatus_=function(){var t=this.leftZoomHandle_.width/2,i=parseFloat(this.leftZoomHandle_.style.left)+t,e=parseFloat(this.rightZoomHandle_.style.left)+t;return{leftHandlePos:i,rightHandlePos:e,isZoomed:i-1>this.canvasRect_.x||e+1<this.canvasRect_.x+this.canvasRect_.w}};var as=Xe;var il=function(t){this.container=t};il.prototype.draw=function(t,i){this.container.innerHTML="",typeof this.date_graph<"u"&&this.date_graph.destroy(),this.date_graph=new nt(this.container,t,i)};il.prototype.setSelection=function(t){var i=!1;t.length&&(i=t[0].row),this.date_graph.setSelection(i)};il.prototype.getSelection=function(){var t=[],i=this.date_graph.getSelection();if(i<0)return t;for(var e=this.date_graph.layout_.points,a=0;a<e.length;++a)t.push({row:i,column:a+1});return t};var Bc=il;var M=function(i,e,a){this.__init__(i,e,a)};M.NAME="Dygraph";M.VERSION="2.2.1";var ns={};M._require=function(i){return i in ns?ns[i]:M._require._b(i)};M._require._b=null;M._require.add=function(i,e){ns[i]=e};M.DEFAULT_ROLL_PERIOD=1;M.DEFAULT_WIDTH=480;M.DEFAULT_HEIGHT=320;M.ANIMATION_STEPS=12;M.ANIMATION_DURATION=200;M.Plotters=Fi._Plotters;M.addedAnnotationCSS=!1;M.prototype.__init__=function(t,i,e){if(this.is_initial_draw_=!0,this.readyFns_=[],e==null&&(e={}),e=M.copyUserAttrs_(e),typeof t=="string"&&(t=document.getElementById(t)),!t)throw new Error("Constructing dygraph with a non-existent div!");this.maindiv_=t,this.file_=i,this.rollPeriod_=e.rollPeriod||M.DEFAULT_ROLL_PERIOD,this.previousVerticalX_=-1,this.fractions_=e.fractions||!1,this.dateWindow_=e.dateWindow||null,this.annotations_=[],t.innerHTML="";let a=window.getComputedStyle(t,null);(a.paddingLeft!=="0px"||a.paddingRight!=="0px"||a.paddingTop!=="0px"||a.paddingBottom!=="0px")&&console.error("Main div contains padding; graph will misbehave"),t.style.width===""&&e.width&&(t.style.width=e.width+"px"),t.style.height===""&&e.height&&(t.style.height=e.height+"px"),t.style.height===""&&t.clientHeight===0&&(t.style.height=M.DEFAULT_HEIGHT+"px",t.style.width===""&&(t.style.width=M.DEFAULT_WIDTH+"px")),this.width_=t.clientWidth||e.width||0,this.height_=t.clientHeight||e.height||0,e.stackedGraph&&(e.fillGraph=!0),this.user_attrs_={},Dt(this.user_attrs_,e),this.attrs_={},Wo(this.attrs_,gn),this.boundaryIds_=[],this.setIndexByName_={},this.datasetIndex_=[],this.registeredEvents_=[],this.eventListeners_={},this.attributes_=new Oc(this),this.createInterface_(),this.plugins_=[];for(var n=M.PLUGINS.concat(this.getOption("plugins")),r=0;r<n.length;r++){var s=n[r],d;typeof s.activate<"u"?d=s:d=new s;var m={plugin:d,events:{},options:{},pluginOptions:{}},u=d.activate(this);for(var v in u)u.hasOwnProperty(v)&&(m.events[v]=u[v]);this.plugins_.push(m)}for(var r=0;r<this.plugins_.length;r++){var f=this.plugins_[r];for(var v in f.events)if(f.events.hasOwnProperty(v)){var y=f.events[v],_=[f.plugin,y];v in this.eventListeners_?this.eventListeners_[v].push(_):this.eventListeners_[v]=[_]}}this.createDragInterface_(),this.start_()};M.prototype.cascadeEvents_=function(t,i){if(!(t in this.eventListeners_))return!1;var e={dygraph:this,cancelable:!1,defaultPrevented:!1,preventDefault:function(){if(!e.cancelable)throw"Cannot call preventDefault on non-cancelable event.";e.defaultPrevented=!0},propagationStopped:!1,stopPropagation:function(){e.propagationStopped=!0}};Dt(e,i);var a=this.eventListeners_[t];if(a)for(var n=a.length-1;n>=0;n--){var r=a[n][0],s=a[n][1];if(s.call(r,e),e.propagationStopped)break}return e.defaultPrevented};M.prototype.getPluginInstance_=function(t){for(var i=0;i<this.plugins_.length;i++){var e=this.plugins_[i];if(e.plugin instanceof t)return e.plugin}return null};M.prototype.isZoomed=function(t){let i=!!this.dateWindow_;if(t==="x")return i;let e=this.axes_.map(a=>!!a.valueRange).indexOf(!0)>=0;if(t==null)return i||e;if(t==="y")return e;throw new Error(`axis parameter is [${t}] must be null, 'x' or 'y'.`)};M.prototype.toString=function(){var t=this.maindiv_,i=t&&t.id?t.id:t;return"[Dygraph "+i+"]"};M.prototype.attr_=function(t,i){return typeof process<"u",i?this.attributes_.getForSeries(t,i):this.attributes_.get(t)};M.prototype.getOption=function(t,i){return this.attr_(t,i)};M.prototype.getNumericOption=function(t,i){return this.getOption(t,i)};M.prototype.getStringOption=function(t,i){return this.getOption(t,i)};M.prototype.getBooleanOption=function(t,i){return this.getOption(t,i)};M.prototype.getFunctionOption=function(t,i){return this.getOption(t,i)};M.prototype.getOptionForAxis=function(t,i){return this.attributes_.getForAxis(t,i)};M.prototype.optionsViewForAxis_=function(t){var i=this;return function(e){var a=i.user_attrs_.axes;return a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t==="x"&&e==="logscale"?!1:typeof i.user_attrs_[e]<"u"?i.user_attrs_[e]:(a=i.attrs_.axes,a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t=="y"&&i.axes_[0].hasOwnProperty(e)?i.axes_[0][e]:t=="y2"&&i.axes_[1].hasOwnProperty(e)?i.axes_[1][e]:i.attr_(e))}};M.prototype.rollPeriod=function(){return this.rollPeriod_};M.prototype.xAxisRange=function(){return this.dateWindow_?this.dateWindow_:this.xAxisExtremes()};M.prototype.xAxisExtremes=function(){var t=this.getNumericOption("xRangePad")/this.plotter_.area.w;if(this.numRows()===0)return[0-t,1+t];var i=this.rawData_[0][0],e=this.rawData_[this.rawData_.length-1][0];if(t){var a=e-i;i-=a*t,e+=a*t}return[i,e]};M.prototype.yAxisExtremes=function(){let t=this.gatherDatasets_(this.rolledSeries_,null),{extremes:i}=t,e=this.axes_;this.computeYAxisRanges_(i);let a=this.axes_;return this.axes_=e,a.map(n=>n.extremeRange)};M.prototype.yAxisRange=function(t){if(typeof t>"u"&&(t=0),t<0||t>=this.axes_.length)return null;var i=this.axes_[t];return[i.computedValueRange[0],i.computedValueRange[1]]};M.prototype.yAxisRanges=function(){for(var t=[],i=0;i<this.axes_.length;i++)t.push(this.yAxisRange(i));return t};M.prototype.toDomCoords=function(t,i,e){return[this.toDomXCoord(t),this.toDomYCoord(i,e)]};M.prototype.toDomXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();return i.x+(t-e[0])/(e[1]-e[0])*i.w};M.prototype.toDomYCoord=function(t,i){var e=this.toPercentYCoord(t,i);if(e===null)return null;var a=this.plotter_.area;return a.y+e*a.h};M.prototype.toDataCoords=function(t,i,e){return[this.toDataXCoord(t),this.toDataYCoord(i,e)]};M.prototype.toDataXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();if(this.attributes_.getForAxis("logscale","x")){var a=(t-i.x)/i.w;return Qn(e[0],e[1],a)}else return e[0]+(t-i.x)/i.w*(e[1]-e[0])};M.prototype.toDataYCoord=function(t,i){if(t===null)return null;var e=this.plotter_.area,a=this.yAxisRange(i);if(typeof i>"u"&&(i=0),this.attributes_.getForAxis("logscale",i)){var n=(t-e.y)/e.h;return Qn(a[1],a[0],n)}else return a[0]+(e.y+e.h-t)/e.h*(a[1]-a[0])};M.prototype.toPercentYCoord=function(t,i){if(t===null)return null;typeof i>"u"&&(i=0);var e=this.yAxisRange(i),a,n=this.attributes_.getForAxis("logscale",i);if(n){var r=De(e[0]),s=De(e[1]);a=(s-De(t))/(s-r)}else a=(e[1]-t)/(e[1]-e[0]);return a};M.prototype.toPercentXCoord=function(t){if(t===null)return null;var i=this.xAxisRange(),e,a=this.attributes_.getForAxis("logscale","x");if(a===!0){var n=De(i[0]),r=De(i[1]);e=(De(t)-n)/(r-n)}else e=(t-i[0])/(i[1]-i[0]);return e};M.prototype.numColumns=function(){return this.rawData_?this.rawData_[0]?this.rawData_[0].length:this.attr_("labels").length:0};M.prototype.numRows=function(){return this.rawData_?this.rawData_.length:0};M.prototype.getValue=function(t,i){return t<0||t>=this.rawData_.length||i<0||i>=this.rawData_[t].length?null:this.rawData_[t][i]};M.prototype.createInterface_=function(){var t=this.maindiv_;this.graphDiv=document.createElement("div"),this.graphDiv.style.textAlign="left",this.graphDiv.style.position="relative",t.appendChild(this.graphDiv),this.canvas_=hn(),this.canvas_.style.position="absolute",this.canvas_.style.top=0,this.canvas_.style.left=0,this.hidden_=this.createPlotKitCanvas_(this.canvas_),this.canvas_ctx_=sn(this.canvas_),this.hidden_ctx_=sn(this.hidden_),this.resizeElements_(),this.graphDiv.appendChild(this.hidden_),this.graphDiv.appendChild(this.canvas_),this.mouseEventElement_=this.createMouseEventElement_(),this.layout_=new tr(this);var i=this;if(this.mouseMoveHandler_=function(a){i.mouseMove_(a)},this.mouseOutHandler_=function(a){var n=a.target||a.fromElement,r=a.relatedTarget||a.toElement;jl(n,i.graphDiv)&&!jl(r,i.graphDiv)&&i.mouseOut_(a)},this.addAndTrackEvent(window,"mouseout",this.mouseOutHandler_),this.addAndTrackEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),!this.resizeHandler_){this.resizeHandler_=function(a){i.resize()},this.addAndTrackEvent(window,"resize",this.resizeHandler_),this.resizeObserver_=null;var e=this.getStringOption("resizable");if(typeof ResizeObserver>"u"&&e!=="no"&&(console.error("ResizeObserver unavailable; ignoring resizable property"),e="no"),e==="horizontal"||e==="vertical"||e==="both"?t.style.resize=e:e!=="passive"&&(e="no"),e!=="no"){let a=window.getComputedStyle(t).overflow;window.getComputedStyle(t).overflow==="visible"&&(t.style.overflow="hidden"),this.resizeObserver_=new ResizeObserver(this.resizeHandler_),this.resizeObserver_.observe(t)}}};M.prototype.resizeElements_=function(){this.graphDiv.style.width=this.width_+"px",this.graphDiv.style.height=this.height_+"px";var t=this.getNumericOption("pixelRatio"),i=t||Kn(this.canvas_ctx_);this.canvas_.width=this.width_*i,this.canvas_.height=this.height_*i,this.canvas_.style.width=this.width_+"px",this.canvas_.style.height=this.height_+"px",i!==1&&this.canvas_ctx_.scale(i,i);var e=t||Kn(this.hidden_ctx_);this.hidden_.width=this.width_*e,this.hidden_.height=this.height_*e,this.hidden_.style.width=this.width_+"px",this.hidden_.style.height=this.height_+"px",e!==1&&this.hidden_ctx_.scale(e,e)};M.prototype.destroy=function(){this.canvas_ctx_.restore(),this.hidden_ctx_.restore();for(var t=this.plugins_.length-1;t>=0;t--){var i=this.plugins_.pop();i.plugin.destroy&&i.plugin.destroy()}var e=function(n){for(;n.hasChildNodes();)e(n.firstChild),n.removeChild(n.firstChild)};this.removeTrackedEvents_(),$t(window,"mouseout",this.mouseOutHandler_),$t(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),$t(window,"resize",this.resizeHandler_),this.resizeHandler_=null,e(this.maindiv_);var a=function(r){for(var s in r)typeof r[s]=="object"&&(r[s]=null)};a(this.layout_),a(this.plotter_),a(this)};M.prototype.createPlotKitCanvas_=function(t){var i=hn();return i.style.position="absolute",i.style.top=t.style.top,i.style.left=t.style.left,i.width=this.width_,i.height=this.height_,i.style.width=this.width_+"px",i.style.height=this.height_+"px",i};M.prototype.createMouseEventElement_=function(){return this.canvas_};M.prototype.setColors_=function(){var t=this.getLabels(),i=t.length-1;this.colors_=[],this.colorsMap_={};for(var e=this.getNumericOption("colorSaturation")||1,a=this.getNumericOption("colorValue")||.5,n=Math.ceil(i/2),r=this.getOption("colors"),s=this.visibility(),d=0;d<i;d++)if(s[d]){var m=t[d+1],u=this.attributes_.getForSeries("color",m);if(!u)if(r)u=r[d%r.length];else{var v=d%2?n+(d+1)/2:Math.ceil((d+1)/2),f=1*v/(1+i);u=Dc(f,e,a)}this.colors_.push(u),this.colorsMap_[m]=u}};M.prototype.getColors=function(){return this.colors_};M.prototype.getPropertiesForSeries=function(t){for(var i=-1,e=this.getLabels(),a=1;a<e.length;a++)if(e[a]==t){i=a;break}return i==-1?null:{name:t,column:i,visible:this.visibility()[i-1],color:this.colorsMap_[t],axis:1+this.attributes_.axisForSeries(t)}};M.prototype.createRollInterface_=function(){var t=this.roller_;t||(this.roller_=t=document.createElement("input"),t.type="text",t.style.display="none",t.className="dygraph-roller",this.graphDiv.appendChild(t));var i=this.getBooleanOption("showRoller")?"block":"none",e=this.getArea(),a={top:e.y+e.h-25+"px",left:e.x+1+"px",display:i};t.size="2",t.value=this.rollPeriod_,Dt(t.style,a);let n=this;t.onchange=function(){return n.adjustRoll(t.value)}};M.prototype.createDragInterface_=function(){var t={isZooming:!1,isPanning:!1,is2DPan:!1,dragStartX:null,dragStartY:null,dragEndX:null,dragEndY:null,dragDirection:null,prevEndX:null,prevEndY:null,prevDragDirection:null,cancelNextDblclick:!1,initialLeftmostDate:null,xUnitsPerPixel:null,dateRange:null,px:0,py:0,boundedDates:null,boundedValues:null,tarp:new Qo,initializeMouseDown:function(s,d,m){s.preventDefault?s.preventDefault():(s.returnValue=!1,s.cancelBubble=!0);var u=Ti(d.canvas_);m.px=u.x,m.py=u.y,m.dragStartX=mn(s,m),m.dragStartY=dn(s,m),m.cancelNextDblclick=!1,m.tarp.cover()},destroy:function(){var s=this;if((s.isZooming||s.isPanning)&&(s.isZooming=!1,s.dragStartX=null,s.dragStartY=null),s.isPanning){s.isPanning=!1,s.draggingDate=null,s.dateRange=null;for(var d=0;d<e.axes_.length;d++)delete e.axes_[d].draggingValue,delete e.axes_[d].dragValueRange}s.tarp.uncover()}},i=this.getOption("interactionModel"),e=this,a=function(s){return function(d){s(d,e,t)}};for(var n in i)i.hasOwnProperty(n)&&this.addAndTrackEvent(this.mouseEventElement_,n,a(i[n]));if(!i.willDestroyContextMyself){var r=function(s){t.destroy()};this.addAndTrackEvent(document,"mouseup",r)}};M.prototype.drawZoomRect_=function(t,i,e,a,n,r,s,d){var m=this.canvas_ctx_;r==on?m.clearRect(Math.min(i,s),this.layout_.getPlotArea().y,Math.abs(i-s),this.layout_.getPlotArea().h):r==ln&&m.clearRect(this.layout_.getPlotArea().x,Math.min(a,d),this.layout_.getPlotArea().w,Math.abs(a-d)),t==on?e&&i&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(Math.min(i,e),this.layout_.getPlotArea().y,Math.abs(e-i),this.layout_.getPlotArea().h)):t==ln&&n&&a&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(this.layout_.getPlotArea().x,Math.min(a,n),this.layout_.getPlotArea().w,Math.abs(n-a)))};M.prototype.clearZoomRect_=function(){this.currentZoomRectArgs_=null,this.canvas_ctx_.clearRect(0,0,this.width_,this.height_)};M.prototype.doZoomX_=function(t,i){this.currentZoomRectArgs_=null;var e=this.toDataXCoord(t),a=this.toDataXCoord(i);this.doZoomXDates_(e,a)};M.prototype.doZoomXDates_=function(t,i){var e=this.xAxisRange(),a=[t,i];let n=this.getFunctionOption("zoomCallback"),r=this;this.doAnimatedZoom(e,a,null,null,function(){n&&n.call(r,t,i,r.yAxisRanges())})};M.prototype.doZoomY_=function(t,i){this.currentZoomRectArgs_=null;for(var e=this.yAxisRanges(),a=[],n=0;n<this.axes_.length;n++){var r=this.toDataYCoord(t,n),s=this.toDataYCoord(i,n);a.push([s,r])}let d=this.getFunctionOption("zoomCallback"),m=this;this.doAnimatedZoom(null,null,e,a,function(){if(d){let[v,f]=m.xAxisRange();d.call(m,v,f,m.yAxisRanges())}})};M.zoomAnimationFunction=function(t,i){var e=1.5;return(1-Math.pow(e,-t))/(1-Math.pow(e,-i))};M.prototype.resetZoom=function(){let t=this.isZoomed("x"),i=this.isZoomed("y"),e=t||i;if(this.clearSelection(),!e)return;let[a,n]=this.xAxisExtremes(),r=this.getBooleanOption("animatedZooms"),s=this.getFunctionOption("zoomCallback");if(!r){this.dateWindow_=null,this.axes_.forEach(y=>{y.valueRange&&delete y.valueRange}),this.drawGraph_(),s&&s.call(this,a,n,this.yAxisRanges());return}var d=null,m=null,u=null,v=null;t&&(d=this.xAxisRange(),m=[a,n]),i&&(u=this.yAxisRanges(),v=this.yAxisExtremes());let f=this;this.doAnimatedZoom(d,m,u,v,function(){f.dateWindow_=null,f.axes_.forEach(_=>{_.valueRange&&delete _.valueRange}),s&&s.call(f,a,n,f.yAxisRanges())})};M.prototype.doAnimatedZoom=function(t,i,e,a,n){var r=this.getBooleanOption("animatedZooms")?M.ANIMATION_STEPS:1,s=[],d=[],m,u;if(t!==null&&i!==null)for(m=1;m<=r;m++)u=M.zoomAnimationFunction(m,r),s[m-1]=[t[0]*(1-u)+u*i[0],t[1]*(1-u)+u*i[1]];if(e!==null&&a!==null)for(m=1;m<=r;m++){u=M.zoomAnimationFunction(m,r);for(var v=[],f=0;f<this.axes_.length;f++)v.push([e[f][0]*(1-u)+u*a[f][0],e[f][1]*(1-u)+u*a[f][1]]);d[m-1]=v}let y=this;Ul(function(_){if(d.length)for(var w=0;w<y.axes_.length;w++){var P=d[_][w];y.axes_[w].valueRange=[P[0],P[1]]}s.length&&(y.dateWindow_=s[_]),y.drawGraph_()},r,M.ANIMATION_DURATION/r,n)};M.prototype.getArea=function(){return this.plotter_.area};M.prototype.eventToDomCoords=function(t){if(t.offsetX&&t.offsetY)return[t.offsetX,t.offsetY];var i=Ti(this.mouseEventElement_),e=cn(t)-i.x,a=pn(t)-i.y;return[e,a]};M.prototype.findClosestRow=function(t){for(var i=1/0,e=-1,a=this.layout_.points,n=0;n<a.length;n++)for(var r=a[n],s=r.length,d=0;d<s;d++){var m=r[d];if(un(m,!0)){var u=Math.abs(m.canvasx-t);u<i&&(i=u,e=m.idx)}}return e};M.prototype.findClosestPoint=function(t,i){for(var e=1/0,a,n,r,s,d,m,u,v=this.layout_.points.length-1;v>=0;--v)for(var f=this.layout_.points[v],y=0;y<f.length;++y)s=f[y],un(s)&&(n=s.canvasx-t,r=s.canvasy-i,a=n*n+r*r,a<e&&(e=a,d=s,m=v,u=s.idx));var _=this.layout_.setNames[m];return{row:u,seriesName:_,point:d}};M.prototype.findStackedPoint=function(t,i){for(var e=this.findClosestRow(t),a,n,r=0;r<this.layout_.points.length;++r){var s=this.getLeftBoundary_(r),d=e-s,m=this.layout_.points[r];if(!(d>=m.length)){var u=m[d];if(un(u)){var v=u.canvasy;if(t>u.canvasx&&d+1<m.length){var f=m[d+1];if(un(f)){var y=f.canvasx-u.canvasx;if(y>0){var _=(t-u.canvasx)/y;v+=_*(f.canvasy-u.canvasy)}}}else if(t<u.canvasx&&d>0){var w=m[d-1];if(un(w)){var y=u.canvasx-w.canvasx;if(y>0){var _=(u.canvasx-t)/y;v+=_*(w.canvasy-u.canvasy)}}}(r===0||v<i)&&(a=u,n=r)}}}var P=this.layout_.setNames[n];return{row:e,seriesName:P,point:a}};M.prototype.mouseMove_=function(t){var i=this.layout_.points;if(i!=null){var e=this.eventToDomCoords(t),a=e[0],n=e[1],r=this.getOption("highlightSeriesOpts"),s=!1;if(r&&!this.isSeriesLocked()){var d;this.getBooleanOption("stackedGraph")?d=this.findStackedPoint(a,n):d=this.findClosestPoint(a,n),s=this.setSelection(d.row,d.seriesName)}else{var m=this.findClosestRow(a);s=this.setSelection(m)}var u=this.getFunctionOption("highlightCallback");u&&s&&u.call(this,t,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}};M.prototype.getLeftBoundary_=function(t){if(this.boundaryIds_[t])return this.boundaryIds_[t][0];for(var i=0;i<this.boundaryIds_.length;i++)if(this.boundaryIds_[i]!==void 0)return this.boundaryIds_[i][0];return 0};M.prototype.animateSelection_=function(t){var i=10,e=30;this.fadeLevel===void 0&&(this.fadeLevel=0),this.animateId===void 0&&(this.animateId=0);var a=this.fadeLevel,n=t<0?a:i-a;if(n<=0){this.fadeLevel&&this.updateSelection_(1);return}var r=++this.animateId,s=this,d=function(){s.fadeLevel!==0&&t<0&&(s.fadeLevel=0,s.clearSelection())};Ul(function(m){s.animateId==r&&(s.fadeLevel+=t,s.fadeLevel===0?s.clearSelection():s.updateSelection_(s.fadeLevel/i))},n,e,d)};M.prototype.updateSelection_=function(t){this.cascadeEvents_("select",{selectedRow:this.lastRow_===-1?void 0:this.lastRow_,selectedX:this.lastx_===null?void 0:this.lastx_,selectedPoints:this.selPoints_});var i,e=this.canvas_ctx_;if(this.getOption("highlightSeriesOpts")){e.clearRect(0,0,this.width_,this.height_);var a=1-this.getNumericOption("highlightSeriesBackgroundAlpha"),n=fn(this.getOption("highlightSeriesBackgroundColor"));if(a){var r=this.getBooleanOption("animateBackgroundFade");if(r){if(t===void 0){this.animateSelection_(1);return}a*=t}e.fillStyle="rgba("+n.r+","+n.g+","+n.b+","+a+")",e.fillRect(0,0,this.width_,this.height_)}this.plotter_._renderLineChart(this.highlightSet_,e)}else if(this.previousVerticalX_>=0){var s=0,d=this.attr_("labels");for(i=1;i<d.length;i++){var m=this.getNumericOption("highlightCircleSize",d[i]);m>s&&(s=m)}var u=this.previousVerticalX_;e.clearRect(u-s-1,0,2*s+2,this.height_)}if(this.selPoints_.length>0){var v=this.selPoints_[0].canvasx;for(e.save(),i=0;i<this.selPoints_.length;i++){var f=this.selPoints_[i];if(!isNaN(f.canvasy)){var y=this.getNumericOption("highlightCircleSize",f.name),_=this.getFunctionOption("drawHighlightPointCallback",f.name),w=this.plotter_.colors[f.name];_||(_=Jn.DEFAULT),e.lineWidth=this.getNumericOption("strokeWidth",f.name),e.strokeStyle=w,e.fillStyle=w,_.call(this,this,f.name,e,v,f.canvasy,w,y,f.idx)}}e.restore(),this.previousVerticalX_=v}};M.prototype.setSelection=function(i,e,a,n){this.selPoints_=[];var r=!1;if(i!==!1&&i>=0){i!=this.lastRow_&&(r=!0),this.lastRow_=i;for(var s=0;s<this.layout_.points.length;++s){var d=this.layout_.points[s],m=i-this.getLeftBoundary_(s);if(m>=0&&m<d.length&&d[m].idx==i){var u=d[m];u.yval!==null&&this.selPoints_.push(u)}else for(var v=0;v<d.length;++v){var u=d[v];if(u.idx==i){u.yval!==null&&this.selPoints_.push(u);break}}}}else this.lastRow_>=0&&(r=!0),this.lastRow_=-1;if(this.selPoints_.length?this.lastx_=this.selPoints_[0].xval:this.lastx_=null,e!==void 0&&(this.highlightSet_!==e&&(r=!0),this.highlightSet_=e),a!==void 0&&(this.lockedSet_=a),r&&(this.updateSelection_(void 0),n)){var f=this.getFunctionOption("highlightCallback");if(f){var y={};f.call(this,y,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}}return r};M.prototype.mouseOut_=function(t){this.getFunctionOption("unhighlightCallback")&&this.getFunctionOption("unhighlightCallback").call(this,t),this.getBooleanOption("hideOverlayOnMouseOut")&&!this.lockedSet_&&this.clearSelection()};M.prototype.clearSelection=function(){if(this.cascadeEvents_("deselect",{}),this.lockedSet_=!1,this.fadeLevel){this.animateSelection_(-1);return}this.canvas_ctx_.clearRect(0,0,this.width_,this.height_),this.fadeLevel=0,this.selPoints_=[],this.lastx_=null,this.lastRow_=-1,this.highlightSet_=null};M.prototype.getSelection=function(){if(!this.selPoints_||this.selPoints_.length<1)return-1;for(var t=0;t<this.layout_.points.length;t++)for(var i=this.layout_.points[t],e=0;e<i.length;e++)if(i[e].x==this.selPoints_[0].x)return i[e].idx;return-1};M.prototype.getHighlightSeries=function(){return this.highlightSet_};M.prototype.isSeriesLocked=function(){return this.lockedSet_};M.prototype.loadedEvent_=function(t){this.rawData_=this.parseCSV_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_()};M.prototype.addXTicks_=function(){var t;this.dateWindow_?t=[this.dateWindow_[0],this.dateWindow_[1]]:t=this.xAxisExtremes();var i=this.optionsViewForAxis_("x"),e=i("ticker")(t[0],t[1],this.plotter_.area.w,i,this);this.layout_.setXTicks(e)};M.prototype.getHandlerClass_=function(){var t;return this.attr_("dataHandler")?t=this.attr_("dataHandler"):this.fractions_?this.getBooleanOption("errorBars")?t=Ql:t=Zl:this.getBooleanOption("customBars")?t=Xl:this.getBooleanOption("errorBars")?t=Wl:t=ar,t};M.prototype.predraw_=function(){var t=new Date;this.dataHandler_=new(this.getHandlerClass_()),this.layout_.computePlotArea(),this.computeYAxes_(),this.is_initial_draw_||(this.canvas_ctx_.restore(),this.hidden_ctx_.restore()),this.canvas_ctx_.save(),this.hidden_ctx_.save(),this.plotter_=new Fi(this,this.hidden_,this.hidden_ctx_,this.layout_),this.createRollInterface_(),this.cascadeEvents_("predraw"),this.rolledSeries_=[null];for(var i=1;i<this.numColumns();i++){var e=this.dataHandler_.extractSeries(this.rawData_,i,this.attributes_);this.rollPeriod_>1&&(e=this.dataHandler_.rollingAverage(e,this.rollPeriod_,this.attributes_,i)),this.rolledSeries_.push(e)}this.drawGraph_();var a=new Date;this.drawingTimeMs_=a-t};M.PointType=void 0;M.stackPoints_=function(t,i,e,a){for(var n=null,r=null,s=null,d=-1,m=function(w){if(!(d>=w)){for(var P=w;P<t.length;++P)if(s=null,!isNaN(t[P].yval)&&t[P].yval!==null){d=P,s=t[P];break}}},u=0;u<t.length;++u){var v=t[u],f=v.xval;i[f]===void 0&&(i[f]=0);var y=v.yval;isNaN(y)||y===null?a=="none"?y=0:(m(u),r&&s&&a!="none"?y=r.yval+(s.yval-r.yval)*((f-r.xval)/(s.xval-r.xval)):r&&a=="all"?y=r.yval:s&&a=="all"?y=s.yval:y=0):r=v;var _=i[f];n!=f&&(_+=y,i[f]=_),n=f,v.yval_stacked=_,_>e[1]&&(e[1]=_),_<e[0]&&(e[0]=_)}};M.prototype.gatherDatasets_=function(t,i){var e=[],a=[],n=[],r={},s,d,m,u,v,f=t.length-1,y;for(s=f;s>=1;s--)if(this.visibility()[s-1]){if(i){y=t[s];var _=i[0],w=i[1];for(m=null,u=null,d=0;d<y.length;d++)y[d][0]>=_&&m===null&&(m=d),y[d][0]<=w&&(u=d);m===null&&(m=0);for(var P=m,R=!0;R&&P>0;)P--,R=y[P][1]===null;u===null&&(u=y.length-1);var L=u;for(R=!0;R&&L<y.length-1;)L++,R=y[L][1]===null;P!==m&&(m=P),L!==u&&(u=L),e[s-1]=[m,u],y=y.slice(m,u+1)}else y=t[s],e[s-1]=[0,y.length-1];var V=this.attr_("labels")[s],U=this.dataHandler_.getExtremeYValues(y,i,this.getBooleanOption("stepPlot",V)),q=this.dataHandler_.seriesToPoints(y,V,e[s-1][0]);this.getBooleanOption("stackedGraph")&&(v=this.attributes_.axisForSeries(V),n[v]===void 0&&(n[v]=[]),M.stackPoints_(q,n[v],U,this.getBooleanOption("stackedGraphNaNFill"))),r[V]=U,a[s]=q}return{points:a,extremes:r,boundaryIds:e}};M.prototype.drawGraph_=function(){var t=new Date,i=this.is_initial_draw_;this.is_initial_draw_=!1,this.layout_.removeAllDatasets(),this.setColors_(),this.attrs_.pointSize=.5*this.getNumericOption("highlightCircleSize");var e=this.gatherDatasets_(this.rolledSeries_,this.dateWindow_),a=e.points,n=e.extremes;this.boundaryIds_=e.boundaryIds,this.setIndexByName_={};for(var r=this.attr_("labels"),s=0,d=1;d<a.length;d++)this.visibility()[d-1]&&(this.layout_.addDataset(r[d],a[d]),this.datasetIndex_[d]=s++);for(var d=0;d<r.length;d++)this.setIndexByName_[r[d]]=d;if(this.computeYAxisRanges_(n),this.layout_.setYAxes(this.axes_),this.addXTicks_(),this.layout_.evaluate(),this.renderGraph_(i),this.getStringOption("timingName")){var m=new Date;console.log(this.getStringOption("timingName")+" - drawGraph: "+(m-t)+"ms")}};M.prototype.renderGraph_=function(t){this.cascadeEvents_("clearChart"),this.plotter_.clear();let i=this.getFunctionOption("underlayCallback");i&&i.call(this,this.hidden_ctx_,this.layout_.getPlotArea(),this,this);var e={canvas:this.hidden_,drawingContext:this.hidden_ctx_};this.cascadeEvents_("willDrawChart",e),this.plotter_.render(),this.cascadeEvents_("didDrawChart",e),this.lastRow_=-1,this.canvas_.getContext("2d").clearRect(0,0,this.width_,this.height_);let a=this.getFunctionOption("drawCallback");if(a!==null&&a.call(this,this,t),t)for(this.readyFired_=!0;this.readyFns_.length>0;){var n=this.readyFns_.pop();n(this)}};M.prototype.computeYAxes_=function(){var t,i,e,a;for(this.axes_=[],t=0;t<this.attributes_.numAxes();t++)e={g:this},Dt(e,this.attributes_.axisOptions(t)),this.axes_[t]=e;for(t=0;t<this.axes_.length;t++)if(t===0)e=this.optionsViewForAxis_("y"+(t?"2":"")),a=e("valueRange"),a&&(this.axes_[t].valueRange=a);else{var n=this.user_attrs_.axes;n&&n.y2&&(a=n.y2.valueRange,a&&(this.axes_[t].valueRange=a))}};M.prototype.numAxes=function(){return this.attributes_.numAxes()};M.prototype.axisPropertiesForSeries=function(t){return this.axes_[this.attributes_.axisForSeries(t)]};M.prototype.computeYAxisRanges_=function(t){for(var i=function(Wt){return isNaN(parseFloat(Wt))},e=this.attributes_.numAxes(),a,n,r,s,d,m=0;m<e;m++){var u=this.axes_[m],v=this.attributes_.getForAxis("logscale",m),f=this.attributes_.getForAxis("includeZero",m),y=this.attributes_.getForAxis("independentTicks",m);r=this.attributes_.seriesForAxis(m),a=!0,s=.1;let Wt=this.getNumericOption("yRangePad");if(Wt!==null&&(a=!1,s=Wt/this.plotter_.area.h),r.length===0)u.extremeRange=[0,1];else{for(var _=1/0,w=-1/0,P,R,L=0;L<r.length;L++)t.hasOwnProperty(r[L])&&(P=t[r[L]][0],P!==null&&(_=Math.min(P,_)),R=t[r[L]][1],R!==null&&(w=Math.max(R,w)));f&&!v&&(_>0&&(_=0),w<0&&(w=0)),_==1/0&&(_=0),w==-1/0&&(w=1),n=w-_,n===0&&(w!==0?n=Math.abs(w):(w=1,n=1));var V=w,U=_;a&&(v?(V=w+s*n,U=_):(V=w+s*n,U=_-s*n,U<0&&_>=0&&(U=0),V>0&&w<=0&&(V=0))),u.extremeRange=[U,V]}if(u.valueRange){var q=i(u.valueRange[0])?u.extremeRange[0]:u.valueRange[0],ee=i(u.valueRange[1])?u.extremeRange[1]:u.valueRange[1];u.computedValueRange=[q,ee]}else u.computedValueRange=u.extremeRange;if(!a){if(q=u.computedValueRange[0],ee=u.computedValueRange[1],q===ee)if(q===0)ee=1;else{var Me=Math.abs(q/10);q-=Me,ee+=Me}if(v){var j=s/(2*s-1),te=(s-1)/(2*s-1);u.computedValueRange[0]=Qn(q,ee,j),u.computedValueRange[1]=Qn(q,ee,te)}else n=ee-q,u.computedValueRange[0]=q-n*s,u.computedValueRange[1]=ee+n*s}if(y){u.independentTicks=y;var he=this.optionsViewForAxis_("y"+(m?"2":"")),z=he("ticker");u.ticks=z(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,he,this),d||(d=u)}}if(d===void 0)throw'Configuration Error: At least one axis has to have the "independentTicks" option activated.';for(var m=0;m<e;m++){var u=this.axes_[m];if(!u.independentTicks){for(var he=this.optionsViewForAxis_("y"+(m?"2":"")),z=he("ticker"),ue=d.ticks,Ct=d.computedValueRange[1]-d.computedValueRange[0],Ze=u.computedValueRange[1]-u.computedValueRange[0],Vt=[],rt=0;rt<ue.length;rt++){var Te=(ue[rt].v-d.computedValueRange[0])/Ct,ji=u.computedValueRange[0]+Te*Ze;Vt.push(ji)}u.ticks=z(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,he,this,Vt)}}};M.prototype.detectTypeFromString_=function(t){var i=!1,e=t.indexOf("-");(e>0&&t[e-1]!="e"&&t[e-1]!="E"||t.indexOf("/")>=0||isNaN(parseFloat(t)))&&(i=!0),this.setXAxisOptions_(i)};M.prototype.setXAxisOptions_=function(t){t?(this.attrs_.xValueParser=Hl,this.attrs_.axes.x.valueFormatter=_n,this.attrs_.axes.x.ticker=Ri,this.attrs_.axes.x.axisLabelFormatter=Vi):(this.attrs_.xValueParser=function(i){return parseFloat(i)},this.attrs_.axes.x.valueFormatter=function(i){return i},this.attrs_.axes.x.ticker=di,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter)};M.prototype.parseCSV_=function(t){var i=[],e=ql(t),a=t.split(e||`
`),n,r,s=this.getStringOption("delimiter");a[0].indexOf(s)==-1&&a[0].indexOf("	")>=0&&(s="	");var d=0;"labels"in this.user_attrs_||(d=1,this.attrs_.labels=a[0].split(s),this.attributes_.reparseSeries());for(var m=0,u,v=!1,f=this.attr_("labels").length,y=!1,_=d;_<a.length;_++){var w=a[_];if(m=_,w.length!==0&&w[0]!="#"){var P=w.split(s);if(!(P.length<2)){var R=[];if(v||(this.detectTypeFromString_(P[0]),u=this.getFunctionOption("xValueParser"),v=!0),R[0]=u(P[0],this),this.fractions_)for(r=1;r<P.length;r++)n=P[r].split("/"),n.length!=2?(console.error(`Expected fractional "num/den" values in CSV data but found a value '`+P[r]+"' on line "+(1+_)+" ('"+w+"') which is not of this form."),R[r]=[0,0]):R[r]=[hi(n[0],_,w),hi(n[1],_,w)];else if(this.getBooleanOption("errorBars"))for(P.length%2!=1&&console.error("Expected alternating (value, stdev.) pairs in CSV data but line "+(1+_)+" has an odd number of values ("+(P.length-1)+"): '"+w+"'"),r=1;r<P.length;r+=2)R[(r+1)/2]=[hi(P[r],_,w),hi(P[r+1],_,w)];else if(this.getBooleanOption("customBars"))for(r=1;r<P.length;r++){var L=P[r];/^ *$/.test(L)?R[r]=[null,null,null]:(n=L.split(";"),n.length==3?R[r]=[hi(n[0],_,w),hi(n[1],_,w),hi(n[2],_,w)]:console.warn('When using customBars, values must be either blank or "low;center;high" tuples (got "'+L+'" on line '+(1+_)+")"))}else for(r=1;r<P.length;r++)R[r]=hi(P[r],_,w);if(i.length>0&&R[0]<i[i.length-1][0]&&(y=!0),R.length!=f&&console.error("Number of columns in line "+_+" ("+R.length+") does not agree with number of labels ("+f+") "+w),_===0&&this.attr_("labels")){var V=!0;for(r=0;V&&r<R.length;r++)R[r]&&(V=!1);if(V){console.warn("The dygraphs 'labels' option is set, but the first row of CSV data ('"+w+"') appears to also contain labels. Will drop the CSV labels and use the option labels.");continue}}i.push(R)}}}return y&&(console.warn("CSV is out of order; order it correctly to speed loading."),i.sort(function(U,q){return U[0]-q[0]})),i};function Yf(t){let i=t[0],e=i[0];if(typeof e!="number"&&!Yl(e))throw new Error(`Expected number or date but got ${typeof e}: ${e}.`);for(let a=1;a<i.length;a++){let n=i[a];if(n!=null&&typeof n!="number"&&!Ni(n))throw new Error(`Expected number or array but got ${typeof n}: ${n}.`)}}M.prototype.parseArray_=function(t){if(t.length===0&&(t=[[0]]),t[0].length===0)return console.error("Data set cannot contain an empty row"),null;Yf(t);var i;if(this.attr_("labels")===null){for(console.warn("Using default labels. Set labels explicitly via 'labels' in the options parameter"),this.attrs_.labels=["X"],i=1;i<t[0].length;i++)this.attrs_.labels.push("Y"+i);this.attributes_.reparseSeries()}else{var e=this.attr_("labels");if(e.length!=t[0].length)return console.error("Mismatch between number of labels ("+e+") and number of columns in array ("+t[0].length+")"),null}if(Yl(t[0][0])){this.attrs_.axes.x.valueFormatter=_n,this.attrs_.axes.x.ticker=Ri,this.attrs_.axes.x.axisLabelFormatter=Vi;var a=Gl(t);for(i=0;i<t.length;i++){if(a[i].length===0)return console.error("Row "+(1+i)+" of data is empty"),null;if(a[i][0]===null||typeof a[i][0].getTime!="function"||isNaN(a[i][0].getTime()))return console.error("x value in row "+(1+i)+" is not a Date"),null;a[i][0]=a[i][0].getTime()}return a}else return this.attrs_.axes.x.valueFormatter=function(n){return n},this.attrs_.axes.x.ticker=di,this.attrs_.axes.x.axisLabelFormatter=er,t};M.prototype.parseDataTable_=function(t){var i=function(q){var ee=String.fromCharCode(65+q%26);for(q=Math.floor(q/26);q>0;)ee=String.fromCharCode(65+(q-1)%26)+ee.toLowerCase(),q=Math.floor((q-1)/26);return ee},e=t.getNumberOfColumns(),a=t.getNumberOfRows(),n=t.getColumnType(0);if(n=="date"||n=="datetime")this.attrs_.xValueParser=Hl,this.attrs_.axes.x.valueFormatter=_n,this.attrs_.axes.x.ticker=Ri,this.attrs_.axes.x.axisLabelFormatter=Vi;else if(n=="number")this.attrs_.xValueParser=function(q){return parseFloat(q)},this.attrs_.axes.x.valueFormatter=function(q){return q},this.attrs_.axes.x.ticker=di,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter;else throw new Error("only 'date', 'datetime' and 'number' types are supported for column 1 of DataTable input (Got '"+n+"')");var r=[],s={},d=!1,m,u;for(m=1;m<e;m++){var v=t.getColumnType(m);if(v=="number")r.push(m);else if(v=="string"&&this.getBooleanOption("displayAnnotations")){var f=r[r.length-1];s.hasOwnProperty(f)?s[f].push(m):s[f]=[m],d=!0}else throw new Error("Only 'number' is supported as a dependent type with Gviz. 'string' is only supported if displayAnnotations is true")}var y=[t.getColumnLabel(0)];for(m=0;m<r.length;m++)y.push(t.getColumnLabel(r[m])),this.getBooleanOption("errorBars")&&(m+=1);this.attrs_.labels=y,e=y.length;var _=[],w=!1,P=[];for(m=0;m<a;m++){var R=[];if(typeof t.getValue(m,0)>"u"||t.getValue(m,0)===null){console.warn("Ignoring row "+m+" of DataTable because of undefined or null first column.");continue}if(n=="date"||n=="datetime"?R.push(t.getValue(m,0).getTime()):R.push(t.getValue(m,0)),this.getBooleanOption("errorBars"))for(u=0;u<e-1;u++)R.push([t.getValue(m,1+2*u),t.getValue(m,2+2*u)]);else{for(u=0;u<r.length;u++){var L=r[u];if(R.push(t.getValue(m,L)),d&&s.hasOwnProperty(L)&&t.getValue(m,s[L][0])!==null){var V={};V.series=t.getColumnLabel(L),V.xval=R[0],V.shortText=i(P.length),V.text="";for(var U=0;U<s[L].length;U++)U&&(V.text+=`
`),V.text+=t.getValue(m,s[L][U]);P.push(V)}}for(u=0;u<R.length;u++)isFinite(R[u])||(R[u]=null)}_.length>0&&R[0]<_[_.length-1][0]&&(w=!0),_.push(R)}w&&(console.warn("DataTable is out of order; order it correctly to speed loading."),_.sort(function(q,ee){return q[0]-ee[0]})),this.rawData_=_,P.length>0&&this.setAnnotations(P,!0),this.attributes_.reparseSeries()};M.prototype.cascadeDataDidUpdateEvent_=function(){this.cascadeEvents_("dataDidUpdate",{})};M.prototype.start_=function(){var t=this.file_;typeof t=="function"&&(t=t());let i=Ec(t);if(i=="array")this.rawData_=this.parseArray_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="object"&&typeof t.getColumnRange=="function")this.parseDataTable_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="string"){var e=ql(t);if(e)this.loadedEvent_(t);else{var a;window.XMLHttpRequest?a=new XMLHttpRequest:a=new ActiveXObject("Microsoft.XMLHTTP");var n=this;a.onreadystatechange=function(){a.readyState==4&&(a.status===200||a.status===0)&&n.loadedEvent_(a.responseText)},a.open("GET",t,!0),a.send(null)}}else console.error("Unknown data format: "+i)};M.prototype.updateOptions=function(t,i){typeof i>"u"&&(i=!1);var e=t.file,a=M.copyUserAttrs_(t),n=this.attributes_.numAxes();"rollPeriod"in a&&(this.rollPeriod_=a.rollPeriod),"dateWindow"in a&&(this.dateWindow_=a.dateWindow);var r=Ac(this.attr_("labels"),a);Wo(this.user_attrs_,a),this.attributes_.reparseSeries(),n<this.attributes_.numAxes()&&this.plotter_.clear(),e?(this.cascadeEvents_("dataWillUpdate",{}),this.file_=e,i||this.start_()):i||(r?this.predraw_():this.renderGraph_(!1))};M.copyUserAttrs_=function(t){var i={};for(var e in t)t.hasOwnProperty(e)&&e!="file"&&t.hasOwnProperty(e)&&(i[e]=t[e]);return i};M.prototype.resize=function(t,i){if(!this.resize_lock){this.resize_lock=!0,t===null!=(i===null)&&(console.warn("Dygraph.resize() should be called with zero parameters or two non-NULL parameters. Pretending it was zero."),t=i=null);var e=this.width_,a=this.height_;t?(this.maindiv_.style.width=t+"px",this.maindiv_.style.height=i+"px",this.width_=t,this.height_=i):(this.width_=this.maindiv_.clientWidth,this.height_=this.maindiv_.clientHeight),(e!=this.width_||a!=this.height_)&&(this.resizeElements_(),this.predraw_()),this.resize_lock=!1}};M.prototype.adjustRoll=function(t){this.rollPeriod_=t,this.predraw_()};M.prototype.visibility=function(){for(this.getOption("visibility")||(this.attrs_.visibility=[]);this.getOption("visibility").length<this.numColumns()-1;)this.attrs_.visibility.push(!0);return this.getOption("visibility")};M.prototype.setVisibility=function(t,i){var e=this.visibility(),a=!1;if(Array.isArray(t)||(t!==null&&typeof t=="object"?a=!0:t=[t]),a)for(var n in t)t.hasOwnProperty(n)&&(n<0||n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]);else for(var n=0;n<t.length;n++)typeof t[n]=="boolean"?n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]:t[n]<0||t[n]>=e.length?console.warn("Invalid series number in setVisibility: "+t[n]):e[t[n]]=i;this.predraw_()};M.prototype.size=function(){return{width:this.width_,height:this.height_}};M.prototype.setAnnotations=function(t,i){if(this.annotations_=t,!this.layout_){console.warn("Tried to setAnnotations before dygraph was ready. Try setting them in a ready() block. See dygraphs.com/tests/annotation.html");return}this.layout_.setAnnotations(this.annotations_),i||this.predraw_()};M.prototype.annotations=function(){return this.annotations_};M.prototype.getLabels=function(){var t=this.attr_("labels");return t?t.slice():null};M.prototype.indexFromSetName=function(t){return this.setIndexByName_[t]};M.prototype.getRowForX=function(t){for(var i=0,e=this.numRows()-1;i<=e;){var a=e+i>>1,n=this.getValue(a,0);if(n<t)i=a+1;else if(n>t)e=a-1;else if(i!=a)e=a;else return a}return null};M.prototype.ready=function(t){this.is_initial_draw_?this.readyFns_.push(t):t.call(this,this)};M.prototype.addAndTrackEvent=function(t,i,e){Oi(t,i,e),this.registeredEvents_.push({elem:t,type:i,fn:e})};M.prototype.removeTrackedEvents_=function(){if(this.registeredEvents_)for(var t=0;t<this.registeredEvents_.length;t++){var i=this.registeredEvents_[t];$t(i.elem,i.type,i.fn)}this.registeredEvents_=[]};M.PLUGINS=[is,Jl,as,es,Kl,ts];M.GVizChart=Bc;M.DASHED_LINE=wc;M.DOT_DASH_LINE=Tc;M.dateAxisLabelFormatter=Vi;M.toRGB_=fn;M.findPos=Ti;M.pageX=cn;M.pageY=pn;M.dateString_=$l;M.defaultInteractionModel=Ht.defaultModel;M.nonInteractiveModel=M.nonInteractiveModel_=Ht.nonInteractiveModel_;M.Circles=Jn;M.Plugins={Legend:is,Axes:Jl,Annotations:Kl,ChartLabels:es,Grid:ts,RangeSelector:as};M.DataHandlers={DefaultHandler:ar,BarsHandler:Di,CustomBarsHandler:Xl,DefaultFractionHandler:Zl,ErrorBarsHandler:Wl,FractionsBarsHandler:Ql};M.startPan=Ht.startPan;M.startZoom=Ht.startZoom;M.movePan=Ht.movePan;M.moveZoom=Ht.moveZoom;M.endPan=Ht.endPan;M.endZoom=Ht.endZoom;M.numericLinearTicks=vc;M.numericTicks=di;M.dateTicker=Ri;M.Granularity=ce;M.getDateAxis=Il;M.floatFormat=Bl;Lc(M);var nt=M;function Gf(t,i){t&1&&Tt(0,"div",0)}function Uf(t,i){if(t&1){let e=F();Bt(0,"div",1),vr("click",function(){let n=k(e).$implicit,r=h();return A(r.doSelect(n))}),Et(),C(1,Gf,1,0,"div",0)}if(t&2){let e=i.$implicit,a=i.$index,n=h();kt("background-color",e),ae("selected",e===n.selectedColor),c(),b((a+1)%10===0?1:-1)}}var rs=["#ff0029","#377eb8","#66a61e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#000000"],vn=class vn{constructor(){this.selectedColor=rs[Math.floor(Math.random()*rs.length)];this.select=new dt;this.colors=rs}doSelect(i){this.select.emit(i),this.selectedColor=i}};vn.\u0275fac=function(e){return new(e||vn)},vn.\u0275cmp=N({type:vn,selectors:[["app-color-palette"]],inputs:{selectedColor:"selectedColor"},outputs:{select:"select"},decls:3,vars:0,consts:[[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(le(0,Uf,2,5,null,null,oe),Tt(2,"div",0)),e&2&&se(a.colors)},dependencies:[$],styles:[".box[_ngcontent-%COMP%]{float:left;width:20px;height:20px;box-sizing:border-box;cursor:pointer}.box[_ngcontent-%COMP%]:hover{border:1px solid black}.box.selected[_ngcontent-%COMP%]{border:2px solid black}"],changeDetection:0});var yn=vn;function qf(t,i){if(t&1){let e=F();Bt(0,"div",2),vr("click",function(){let n=k(e).$implicit,r=h();return A(r.select(n))}),Et()}if(t&2){let e=i.$implicit,a=h();kt("border-bottom",e+"px solid")("border-color",e===a.selectedThickness?a.color:"black"),ae("selected",e===a.selectedThickness)}}var Cn=class Cn{constructor(i){this.changeDetection=i;this.options=[1,2,3,4];this.selectedThickness=2}select(i){this.selectedThickness=i}changeColor(i){this.color=i,this.changeDetection.detectChanges()}};Cn.\u0275fac=function(e){return new(e||Cn)(S(At))},Cn.\u0275cmp=N({type:Cn,selectors:[["app-thickness"]],inputs:{selectedThickness:"selectedThickness",color:"color"},decls:3,vars:0,consts:[[1,"box",3,"selected","borderBottom","borderColor"],[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(le(0,qf,1,6,"div",0,oe),Tt(2,"div",1)),e&2&&se(a.options)},dependencies:[$],styles:[".box[_ngcontent-%COMP%]{float:left;width:30px;height:20px;box-sizing:border-box;cursor:pointer;margin-right:5px}"],changeDetection:0});var bn=Cn;var jf=["palette"],zf=["thickness"],xn=class xn{constructor(i,e){this.dialogRef=i;this.data=e}select(){this.dialogRef.close({color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}};xn.\u0275fac=function(e){return new(e||xn)(S(Re),S(He))},xn.\u0275cmp=N({type:xn,selectors:[["app-modify-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(ge(jf,7),ge(zf,7)),e&2){let n;fe(n=_e())&&(a.palette=n.first),fe(n=_e())&&(a.thickness=n.first)}},decls:12,vars:3,consts:[["palette",""],["thickness",""],["label","Color"],[3,"select","selectedColor"],["label","Thickness"],[3,"selectedThickness","color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){if(e&1){let n=F();l(0,"mat-dialog-content")(1,"ya-field",2)(2,"app-color-palette",3,0),E("select",function(s){k(n);let d=K(6);return A(d.changeColor(s))}),o()(),l(4,"ya-field",4),x(5,"app-thickness",5,1),o()(),l(7,"mat-dialog-actions",6)(8,"ya-button",7),p(9,"CANCEL"),o(),l(10,"ya-button",8),E("click",function(){return k(n),A(a.select())}),p(11,"OK"),o()()}e&2&&(c(2),g("selectedColor",a.data.color),c(3),g("selectedThickness",a.data.strokeWidth)("color",a.data.color))},dependencies:[yn,$,Ie,Ne,Oe,me,ke,bn],encapsulation:2,changeDetection:0});var al=xn;function Wf(t,i){if(t&1&&(Bt(0,"div",1)(1,"div",2)(2,"span",3),p(3),T(4,"datetime"),Et()()()),t&2){let e=h(2);kt("left",e.timestampData.canvasx+"px"),c(),kt("background-color","black"),c(2),X(We(4,5,e.timestampData.timestamp,!1))}}function Xf(t,i){if(t&1&&C(0,Wf,5,8,"div",0),t&2){let e=h();b(e.timestampData?0:-1)}}var Sn=class Sn{};Sn.\u0275fac=function(e){return new(e||Sn)},Sn.\u0275cmp=N({type:Sn,selectors:[["app-timestamp-tracker"]],inputs:{legendData:"legendData",timestampData:"timestampData"},decls:1,vars:1,consts:[[1,"timestamp",2,"pointer-events","none",3,"left"],[1,"timestamp",2,"pointer-events","none"],[1,"box"],[1,"xvalue"]],template:function(e,a){e&1&&C(0,Xf,1,1),e&2&&b(a.legendData!=null&&a.legendData.x?0:-1)},dependencies:[$,Ve],styles:[".timestamp[_ngcontent-%COMP%]{position:absolute;bottom:0;background-color:transparent}.box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:3px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative;left:-50%}.xvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700;color:#fff;white-space:nowrap}"],changeDetection:0});var nl=Sn;var rr=class{constructor(){this.canvas=document.createElement("canvas")}activate(i){return i.graphDiv.appendChild(this.canvas),{select:this.select,deselect:this.deselect}}select(i){let e=i.dygraph.width_,a=i.dygraph.height_;this.canvas.width=e,this.canvas.height=a,this.canvas.style.width=e+"px",this.canvas.style.height=a+"px";let n=this.canvas.getContext("2d");n.clearRect(0,0,e,a),n.strokeStyle="#e1e1e1",n.beginPath();for(let r of i.dygraph.selPoints_){let s=Math.floor(r.canvasy)+.5;n.moveTo(0,s),n.lineTo(e,s)}n.stroke(),n.closePath()}deselect(i){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}destroy(){this.canvas=null}toString(){return"Crosshair Plugin"}};var wn=class{constructor(){this.yLimits=[]}activate(i){return{willDrawChart:this.willDrawChart}}setAlarmZones(i){this.yLimits=[];for(let e of i)this.yLimits.push(e.y1IsLimit?e.y1:e.y2)}willDrawChart(i){let e=i.dygraph,a=i.drawingContext,n=e.layout_,r=i.dygraph.plotter_.area;if(e.getOptionForAxis("drawGrid","y")){let s=["y","y2"],d=[],m=[],u=[],v=[],f=[];for(let _=0;_<s.length;_++)u[_]=e.getOptionForAxis("drawGrid",s[_]),u[_]&&(d[_]=e.getOptionForAxis("gridLineColor",s[_]),m[_]=e.getOptionForAxis("gridLineWidth",s[_]),f[_]=e.getOptionForAxis("gridLinePattern",s[_]),v[_]=f[_]&&f[_].length>=2);let y=n.yticks;a.save();for(let _ of y){if(!_.has_tick||this.yLimits.indexOf(parseFloat(_.label))>=0)continue;let w=_.axis;if(u[w]){a.save(),v[w]&&a.setLineDash&&a.setLineDash(f[w]),a.strokeStyle=d[w],a.lineWidth=m[w];let P=this.halfUp(r.x),R=this.halfDown(r.y+_.pos*r.h);a.beginPath(),a.moveTo(P,R),a.lineTo(P+r.w,R),a.stroke(),a.restore()}}a.restore()}if(e.getOptionForAxis("drawGrid","x")){let s=n.xticks;a.save();let d=e.getOptionForAxis("gridLinePattern","x"),m=d&&d.length>=2;m&&a.setLineDash&&a.setLineDash(d),a.strokeStyle=e.getOptionForAxis("gridLineColor","x"),a.lineWidth=e.getOptionForAxis("gridLineWidth","x");for(let u of s){if(!u.has_tick)continue;let v=this.halfUp(r.x+u.pos*r.w),f=this.halfDown(r.y+r.h);a.beginPath(),a.moveTo(v,f),a.lineTo(v,r.y),a.closePath(),a.stroke()}m&&a.setLineDash&&a.setLineDash([]),a.restore()}}halfUp(i){return Math.round(i)+.5}halfDown(i){return Math.round(i)-.5}toString(){return"Gridline Plugin"}destroy(){}};function rl(t){let i,e,a=[];if(t.type&&t.type.defaultAlarm){let r=t.type.defaultAlarm;if(r.staticAlarmRanges){let s=-1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.minInclusive!==void 0){let u={y1:s,y2:m.minInclusive,y1IsLimit:!1,color:$c(m.level)||"black"};a.push(u),s=u.y2,i===void 0?i=m.minInclusive:i=Math.min(i,m.minInclusive)}}s=1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.maxInclusive){let u={y1:m.maxInclusive,y2:s,y1IsLimit:!0,color:$c(m.level)||"black"};a.push(u),s=u.y1,e===void 0?e=m.maxInclusive:e=Math.max(e,m.maxInclusive)}}}}let n=[null,null];return i!==void 0&&(n[0]=i),e!==void 0&&(n[1]=e),{valueRange:n,staticAlarmZones:a}}function $c(t){switch(t){case"WATCH":return"#ffdddb";case"WARNING":return"#ffc3c1";case"DISTRESS":return"#ffaaa8";case"CRITICAL":return"#c35e5c";case"SEVERE":return"#a94442";default:console.error("Unknown level "+t)}}function Zf(t,i){if(t&1&&(l(0,"span",4),p(1),o()),t&2){let e=h().$implicit;c(),X(e.yHTML)}}function Qf(t,i){if(t&1){let e=F();l(0,"div",6),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.close.emit(n.label))}),l(1,"mat-icon",7),p(2,"close"),o()()}}function Kf(t,i){if(t&1){let e=F();l(0,"div",2)(1,"span",3),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.select.emit(n.label))}),p(2),o(),C(3,Zf,2,1,"span",4),C(4,Qf,3,0,"div",5),o()}if(t&2){let e=i.$implicit,a=i.$index,n=h(2);kt("background-color",n.backgroundColor)("border","1px solid "+n.borderColor)("border-left","3px solid "+e.color)("padding-right",n.closable&&a!==0?"15px":"5px"),c(2),X(e.label),c(),b(e.yHTML?3:-1),c(),b(n.closable&&a!==0?4:-1)}}function Jf(t,i){if(t&1&&(l(0,"div",0),le(1,Kf,5,11,"div",1,oe),o()),t&2){let e=h();c(),se(e.data.series)}}var Tn=class Tn{constructor(){this.closable=!1;this.select=new dt;this.close=new dt}};Tn.\u0275fac=function(e){return new(e||Tn)},Tn.\u0275cmp=N({type:Tn,selectors:[["app-parameter-legend"]],inputs:{data:"data",backgroundColor:"backgroundColor",borderColor:"borderColor",closable:"closable"},outputs:{select:"select",close:"close"},decls:1,vars:1,consts:[[1,"legend"],[1,"legend-box",3,"backgroundColor","border","borderLeft","paddingRight"],[1,"legend-box"],[1,"trace-label",3,"click"],[1,"yvalue"],[1,"close-button"],[1,"close-button",3,"click"],[1,"icon12"]],template:function(e,a){e&1&&C(0,Jf,3,0,"div",0),e&2&&b(a.data?0:-1)},dependencies:[Rt],styles:[".legend[_ngcontent-%COMP%]{position:absolute;top:0;left:63px;background-color:transparent;user-select:none;-webkit-user-select:none}.legend-box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:15px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative}.trace-label[_ngcontent-%COMP%]{cursor:pointer}.trace-label[_ngcontent-%COMP%]:hover{opacity:.7}.yvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700}.close-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer}"],changeDetection:0});var ol=Tn;var Dn=class Dn{constructor(){this.grid=!1;this.axis=!0;this.axisLineWidth=1;this.alarmRanges="line";this.color="#1b61b9";this.strokeWidth=2}};Dn.\u0275fac=function(e){return new(e||Dn)},Dn.\u0275cmp=N({type:Dn,selectors:[["app-parameter-series"]],inputs:{parameter:"parameter",grid:"grid",axis:"axis",axisLineWidth:"axisLineWidth",alarmRanges:"alarmRanges",color:"color",label:"label",strokeWidth:"strokeWidth"},decls:0,vars:0,template:function(e,a){},encapsulation:2});var Gi=Dn;var e_=["graphContainer"],Pn=class Pn{constructor(i,e){this.dialog=i;this.formatter=e;this.fillGraph=!1;this.xGrid=!1;this.xAxis=!0;this.xAxisLineWidth=1;this.duration="PT1H";this.height="100%";this.width="100%";this.removableSeries=!1;this.stop=new Date;this.crosshair="vertical";this.axisBackgroundColor="#fafafa";this.axisLineColor="#e1e1e1";this.gridLineColor="#f2f2f2";this.plotAreaBackgroundColor="#fff";this.highlightColor="#e1e1e1";this.onVisibleRange=new dt;this.onManualRangeChange=new dt;this.parameters=[];this.parameterConfig=new Map;this.disableDataReload=!1;this.legendData$=new G(null);this.timestampTrackerData$=new G(null)}ngAfterViewInit(){this.dataSource.parameters$.value.forEach(e=>{this.parameters.push(e)}),this.seriesComponents.forEach(e=>{this.parameterConfig.set(e.parameter,e)});let i=this.graphContainer.nativeElement;if(this.initDygraphs(i),this.dataSource.data$.subscribe(e=>{if(this.disableDataReload)return;let a={file:e.samples.length?e.samples:`X
`};if(this.dataSource.visibleStart&&(a.dateWindow=[this.dataSource.visibleStart.getTime(),this.dataSource.visibleStop.getTime()],this.onVisibleRange.emit([this.dataSource.visibleStart,this.dataSource.visibleStop])),e.valueRange[0]!==null&&e.valueRange[1]!==null)a.axes={y:{valueRange:e.valueRange}};else{let n=rl(this.parameters[0]).valueRange,r=n[0];this.dataSource.minValue!==void 0&&(r=r!==null?Math.min(r,this.dataSource.minValue):this.dataSource.minValue);let s=n[1];this.dataSource.maxValue!==void 0&&(s=s!==null?Math.max(s,this.dataSource.maxValue):this.dataSource.maxValue),r===s&&r!==null&&(r=Math.min(r,0),s=Math.max(s,0)),r!==null&&s!==null&&(r=r-(s-r)*.1,s=s+(s-r)*.1),a.axes={y:{valueRange:[r,s]}}}this.dygraph.updateOptions(a)}),this.duration){let e=this.stop,a=B.subtractDuration(e,this.duration);this.dataSource.updateWindow(a,e,[null,null])}this.applyTheme()}initDygraphs(i){let e={},a=this.parameters.map(f=>this.parameterConfig.get(f.qualifiedName));a.forEach(f=>{e[f.label||f.parameter]={color:f.color,strokeWidth:f.strokeWidth}});let n=this.parameters[0],r=a[0],d=rl(n).staticAlarmZones,m=null,u={legend:"always",fillGraph:this.fillGraph,drawGrid:!1,drawPoints:!1,showRoller:!1,customBars:!0,gridLineColor:this.gridLineColor,axisLineColor:this.axisLineColor,axisLabelFontSize:11,digitsAfterDecimal:6,labels:["Generation Time",...a.map(f=>f.label||f.parameter)],rightGap:0,labelsUTC:this.formatter.isUTC(),series:e,axes:{x:{drawAxis:this.xAxis,drawGrid:this.xGrid,axisLineWidth:this.xAxisLineWidth||1e-7},y:{axisLabelWidth:50,drawAxis:r.axis,drawGrid:r.grid,axisLineWidth:r.axisLineWidth||1e-7,valueRange:rl(n).valueRange}},interactionModel:{mousedown:(f,y,_)=>{_.initializeMouseDown(f,y,_),f.altKey||f.shiftKey?nt.startZoom(f,y,_):nt.startPan(f,y,_)},mousemove:(f,y,_)=>{_.isPanning?(this.disableDataReload=!0,nt.movePan(f,y,_)):_.isZooming&&(this.disableDataReload=!0,nt.moveZoom(f,y,_))},mouseup:(f,y,_)=>{_.isPanning?nt.endPan(f,y,_):_.isZooming&&nt.endZoom(f,y,_);let w=y.xAxisRange(),P=new Date(w[0]),R=new Date(w[1]),L=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,L),this.onManualRangeChange.emit(),this.disableDataReload=!1},click:(f,y,_)=>{m=y,f.preventDefault(),f.stopPropagation()},mouseout:(f,y,_)=>{if(_.isPanning){let w=y.xAxisRange(),P=new Date(w[0]),R=new Date(w[1]),L=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,L)}this.disableDataReload=!1},mousewheel:(f,y,_)=>{if(m!==y)return;let P=(f.detail?f.detail*-1:f.deltaY/40)/50;f.offsetX&&f.offsetY||(f.offsetX=f.layerX-f.target.offsetLeft,f.offsetY=f.layerY-f.target.offsetTop);let R=this.offsetToPercentage(f.offsetX);this.zoom(P,R),f.preventDefault(),f.stopPropagation()}},underlayCallback:(f,y,_)=>{if(f.save(),f.globalAlpha=1,f.fillStyle=this.plotAreaBackgroundColor,f.fillRect(y.x,y.y,y.w,y.h),r.alarmRanges==="line")for(let w of d){let P=w.y1IsLimit?w.y1:w.y2,R=_.toDomCoords(0,P)[1];f.strokeStyle=w.color,f.lineWidth=1,f.beginPath(),f.moveTo(y.x,R),f.lineTo(y.x+y.w,R),f.stroke()}else if(r.alarmRanges==="fill"){f.globalAlpha=.2;for(let w of d){if(w.y2===null)return;let P,R;w.y1===-1/0?P=y.y+y.h:P=_.toDomCoords(0,w.y1)[1],w.y2===1/0?R=0:R=_.toDomCoords(0,w.y2)[1],f.fillStyle=w.color,f.fillRect(y.x,Math.min(P,R),y.w,Math.abs(R-P))}}f.restore()},drawHighlightPointCallback:(f,y,_,w,P,R,L)=>{if((r.label||r.parameter)===y){_.save(),_.setLineDash([5,5]),_.strokeStyle=this.highlightColor,_.lineWidth=1,this.timestampTrackerData$.next({timestamp:new Date(f.selPoints_[0].xval),canvasx:f.selPoints_[0].canvasx}),_.beginPath();let V=Math.floor(f.selPoints_[0].canvasx)+.5;if((this.crosshair==="vertical"||this.crosshair==="both")&&(_.moveTo(V,0),_.lineTo(V,f.height_)),this.crosshair==="horizontal"||this.crosshair==="both")for(let U of f.selPoints_){let q=Math.floor(U.canvasy)+.5;_.moveTo(0,q),_.lineTo(f.width_,q)}_.stroke(),_.closePath(),_.restore()}_.beginPath(),_.arc(w,P,L,0,2*Math.PI,!1),_.fill()},legendFormatter:f=>{for(let y of f.series)if(y.y===void 0){let _=this.dataSource.latestRealtimeValues.get(y.label);_&&(y.y=_[1],y.yHTML=String(_[1]))}return this.legendData$.next(f),""},plugins:[new rr]};this.xAxisHeight!==void 0&&(u.xAxisHeight=this.xAxisHeight),nt.Plugins.Grid=wn,nt.PLUGINS=[nt.Plugins.Legend,nt.Plugins.Axes,nt.Plugins.Annotations,nt.Plugins.ChartLabels,nt.Plugins.Grid,nt.Plugins.RangeSelector],this.dygraph=new nt(i,`X
`,u),this.dygraph.getPluginInstance_(wn).setAlarmZones(d)}getParameters(){return this.parameters}addParameter(i,e){this.dataSource.addParameter(i),this.parameters.push(i),this.parameterConfig.set(i.qualifiedName,e),this.updateDygraphSeries()}removeParameter(i){let e=i;this.dataSource.removeParameter(e),this.parameters=this.parameters.filter(a=>a.qualifiedName!==e),this.parameterConfig.delete(e),this.updateDygraphSeries()}modifyParameter(i){let e=this.dygraph.getPropertiesForSeries(i);this.dialog.open(al,{data:Pt(mt({},e),{strokeWidth:this.dygraph.getOption("strokeWidth",i)})}).afterClosed().subscribe(n=>{if(n){let r=this.parameterConfig.get(i);r.color=n.color,r.strokeWidth=n.thickness,this.updateDygraphSeries()}})}updateDygraphSeries(){let i={},e=this.parameters.map(n=>this.parameterConfig.get(n.qualifiedName));e.forEach(n=>{i[n.label||n.parameter]={color:n.color,strokeWidth:n.strokeWidth}});let a={labels:["Generation Time",...e.map(n=>n.label||n.parameter)],series:i};this.dataSource.reloadVisibleRange().then(()=>{this.dygraph.updateOptions(a,!0)})}applyTheme(){if(this.dygraph&&this.dygraph.updateOptions({axisLineColor:this.axisLineColor,gridLineColor:this.gridLineColor}),this.graphContainer){let i=this.graphContainer.nativeElement;i.style.backgroundColor=this.axisBackgroundColor}}getDateRange(){if(this.dygraph){let i=this.dygraph.xAxisRange();return[new Date(i[0]),new Date(i[1])]}}zoomIn(){this.zoom(.2)}zoomOut(){this.zoom(-.25)}reset(){let i=this.dygraph.xAxisRange(),e=new Date(i[0]),a=new Date(i[1]);this.dataSource.updateWindow(e,a,[null,null])}zoom(i,e=.5){this.dygraph.updateOptions({dateWindow:this.adjustAxis(this.dygraph.xAxisRange(),i,e)});let a=this.dygraph.xAxisRange(),n=new Date(a[0]),r=new Date(a[1]);this.dataSource.updateWindow(n,r,[null,null]),this.onManualRangeChange.emit()}updateWindowOnly(i,e){this.dataSource.updateWindowOnly(i,e),this.dygraph.updateOptions({dateWindow:[i,e]})}adjustAxis(i,e,a){let r=(i[1]-i[0])*e,s=[r*a,r*(1-a)];return[i[0]+s[0],i[1]-s[1]]}offsetToPercentage(i){let e=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[0],null)[0],a=i-e,n=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[1],null)[0]-e;return n===0?0:a/n}ngOnDestroy(){this.dygraph?.destroy()}};Pn.\u0275fac=function(e){return new(e||Pn)(S(Le),S(aa))},Pn.\u0275cmp=N({type:Pn,selectors:[["app-parameter-plot"]],contentQueries:function(e,a,n){if(e&1&&vs(n,Gi,4),e&2){let r;fe(r=_e())&&(a.seriesComponents=r)}},viewQuery:function(e,a){if(e&1&&ge(e_,7),e&2){let n;fe(n=_e())&&(a.graphContainer=n.first)}},inputs:{dataSource:"dataSource",fillGraph:"fillGraph",xGrid:"xGrid",xAxis:"xAxis",xAxisLineWidth:"xAxisLineWidth",xAxisHeight:"xAxisHeight",duration:"duration",height:"height",width:"width",removableSeries:"removableSeries",stop:"stop",crosshair:"crosshair"},outputs:{onVisibleRange:"onVisibleRange",onManualRangeChange:"onManualRangeChange"},decls:9,vars:16,consts:[["graphContainer",""],[1,"legend-wrapper"],[3,"close","select","data","backgroundColor","borderColor","closable"],[1,"timestamp-wrapper"],[3,"legendData","timestampData"],[1,"graph-container"]],template:function(e,a){if(e&1){let n=F();l(0,"div",1)(1,"app-parameter-legend",2),T(2,"async"),E("close",function(s){return k(n),A(a.removeParameter(s))})("select",function(s){return k(n),A(a.modifyParameter(s))}),o()(),l(3,"div",3),x(4,"app-timestamp-tracker",4),T(5,"async"),T(6,"async"),o(),x(7,"div",5,0)}e&2&&(c(),g("data",D(2,10,a.legendData$))("backgroundColor",a.plotAreaBackgroundColor)("borderColor",a.gridLineColor)("closable",a.removableSeries),c(3),g("legendData",D(5,12,a.legendData$))("timestampData",D(6,14,a.timestampTrackerData$)),c(3),kt("height",a.height)("width",a.width))},dependencies:[ol,nl,ie],styles:[".legend-wrapper[_ngcontent-%COMP%]{position:relative;z-index:50}.timestamp-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:50;bottom:4px}.graph-container[_ngcontent-%COMP%]{overflow:hidden}  .annotation{background-color:#ffb6c1;color:red!important;opacity:.7;border-color:red!important}  .dygraph-axis-label{color:#aaa}  .dygraph-legend{position:absolute;font-size:14px;z-index:10;width:250px;background:#fff;line-height:normal;text-align:left;overflow:hidden}  .dygraph-legend-line{display:inline-block;position:relative;bottom:.5ex;padding-left:1em;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-legend-dash{display:inline-block;position:relative;bottom:.5ex;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-roller{position:absolute;z-index:10}  .dygraph-annotation{position:absolute;z-index:10;overflow:hidden}  .dygraph-default-annotation{border:1px solid black;background-color:#fff;text-align:center}  .dygraph-axis-label{z-index:10;line-height:normal;overflow:hidden;color:#000}  .dygraph-title{font-weight:700;z-index:10;text-align:center}  .dygraph-xlabel{text-align:center}  .dygraph-label-rotate-left{text-align:center;transform:rotate(90deg)}  .dygraph-label-rotate-right{text-align:center;transform:rotate(-90deg)}"],changeDetection:0});var or=Pn;var t_=["palette"],i_=["thickness"];function a_(t,i){if(t&1&&(l(0,"mat-option",7),T(1,"memberPath"),p(2),T(3,"memberPath"),o()),t&2){let e=i.$implicit;g("value",D(1,2,e)),c(2),O(" ",D(3,4,e)," ")}}var En=class En{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new ne(null,[Ce.required])}ngOnInit(){let i=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe(cr(300),pr(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:10,searchMembers:!0})),zi(e=>e.parameters||[]),zi(e=>e.filter(a=>{for(let n of i){let r=B.getMemberPath(a);if(n.qualifiedName===r)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}};En.\u0275fac=function(e){return new(e||En)(S(Re),S(W),S(He))},En.\u0275cmp=N({type:En,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(ge(t_,7),ge(i_,7)),e&2){let n;fe(n=_e())&&(a.palette=n.first),fe(n=_e())&&(a.thickness=n.first)}},decls:19,vars:6,consts:[["auto",""],["palette",""],["thickness",""],[1,"ya-form"],["label","Search parameter for comparison"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],["label","Color"],["label","Thickness"],[3,"color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=F();l(0,"mat-dialog-content",3)(1,"ya-field",4),x(2,"input",5),l(3,"mat-autocomplete",6,0),le(5,a_,4,6,"mat-option",7,oe),T(7,"async"),o()(),l(8,"ya-field",8),x(9,"app-color-palette",null,1),o(),l(11,"ya-field",9),x(12,"app-thickness",10,2),o()(),l(14,"mat-dialog-actions",11)(15,"ya-button",12),p(16,"CANCEL"),o(),l(17,"ya-button",13),E("click",function(){return k(n),A(a.select())}),p(18,"ADD"),o()()}if(e&2){let n=K(4),r=K(10);c(2),g("formControl",a.parameter)("matAutocomplete",n),c(3),se(D(7,4,a.filteredOptions)),c(7),g("color",r.selectedColor),c(5),g("disabled",!a.parameter.valid)}},dependencies:[yn,$,$e,pe,Jt,Pr,wr,Er,Ie,Ne,Oe,me,ke,bn,ie,Gr],encapsulation:2,changeDetection:0});var ll=En;var kn=class kn{constructor(i,e,a){this.dialogRef=i;this.yamcs=a;this.form=new ut({start:new ne(null,Ce.required),stop:new ne(null,Ce.required)});let n=e.start,r=e.stop;(!n||!r)&&(r=this.yamcs.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:B.toISOString(n),stop:B.toISOString(r)})}select(){let i=B.toDate(this.form.value.start),e=B.toDate(this.form.value.stop);this.dialogRef.close({start:i,stop:e})}};kn.\u0275fac=function(e){return new(e||kn)(S(Re),S(He),S(W))},kn.\u0275cmp=N({type:kn,selectors:[["app-select-range-dialog"]],decls:13,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["label","Start"],["formControlName","start"],["label","Stop"],["formControlName","stop"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Select range"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"ya-field",3),x(5,"ya-date-time-input",4),o(),l(6,"ya-field",5),x(7,"ya-date-time-input",6),o()()(),l(8,"mat-dialog-actions",7)(9,"ya-button",8),p(10,"CANCEL"),o(),l(11,"ya-button",9),E("click",function(){return a.select()}),p(12,"OK"),o()()),e&2&&(c(3),g("formGroup",a.form),c(8),g("disabled",!a.form.valid))},dependencies:[$,Ke,pe,ve,ye,Se,Ie,lt,Ne,Oe,me,wt,ke],encapsulation:2});var sl=kn;function n_(t,i){t&1&&(l(0,"span"),p(1,"Date Range"),o())}function r_(t,i){if(t&1&&(l(0,"span"),p(1),T(2,"datetime"),T(3,"datetime"),o()),t&2){let e=h(),a=h();c(),Qt("",D(2,2,a)," - ",D(3,4,e))}}function o_(t,i){if(t&1&&C(0,r_,4,6,"span"),t&2){let e=h(2);b(e==="CUSTOM"?0:-1)}}function l_(t,i){if(t&1&&(C(0,o_,1,1),T(1,"async")),t&2){let e,a=h(3);b((e=D(1,1,a.customStop$))?0:-1,e)}}function s_(t,i){if(t&1){let e=F();l(0,"div",2)(1,"ya-text-action",10),E("click",function(){k(e);let n=h(2);return A(n.compareParameter())}),p(2,"Comparison"),o(),x(3,"span",9),l(4,"ya-text-action",11),E("click",function(){k(e);let n=h(2);return A(n.chooseRange())}),C(5,n_,2,0,"span"),C(6,l_,2,3),T(7,"async"),o(),l(8,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1M"))}),p(9," 1 minute "),o(),l(10,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT5M"))}),p(11," 5 minutes "),o(),l(12,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT15M"))}),p(13," 15 minutes "),o(),l(14,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT30M"))}),p(15," 30 minutes "),o(),l(16,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1H"))}),p(17," 1 hour "),o(),l(18,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT6H"))}),p(19," 6 hours "),o(),l(20,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT12H"))}),p(21," 12 hours "),o(),l(22,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1D"))}),p(23," 1 day "),o(),l(24,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2D"))}),p(25," 2 days "),o(),l(26,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1W"))}),p(27," 7 days "),o(),l(28,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2W"))}),p(29," 14 days "),o(),l(30,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1M"))}),p(31," 30 days "),o()()}if(t&2){let e,a=i,n=h(2);c(4),g("active",a==="CUSTOM"),c(),b(a!=="CUSTOM"?5:-1),c(),b((e=D(7,15,n.customStart$))?6:-1,e),c(2),g("active",a==="PT1M"),c(2),g("active",a==="PT5M"),c(2),g("active",a==="PT15M"),c(2),g("active",a==="PT30M"),c(2),g("active",a==="PT1H"),c(2),g("active",a==="PT6H"),c(2),g("active",a==="PT12H"),c(2),g("active",a==="P1D"),c(2),g("active",a==="P2D"),c(2),g("active",a==="P1W"),c(2),g("active",a==="P2W"),c(2),g("active",a==="P1M")}}function c_(t,i){t&1&&(l(0,"span"),p(1,"the last minute"),o())}function p_(t,i){t&1&&(l(0,"span"),p(1,"the last 5 minutes"),o())}function m_(t,i){t&1&&(l(0,"span"),p(1,"the last 15 minutes"),o())}function d_(t,i){t&1&&(l(0,"span"),p(1,"the last 30 minutes"),o())}function u_(t,i){t&1&&(l(0,"span"),p(1,"the last hour"),o())}function h_(t,i){t&1&&(l(0,"span"),p(1,"the last 6 hours"),o())}function f_(t,i){t&1&&(l(0,"span"),p(1,"the last 12 hours"),o())}function __(t,i){t&1&&(l(0,"span"),p(1,"the last 24 hours"),o())}function g_(t,i){t&1&&(l(0,"span"),p(1,"the last 2 days"),o())}function v_(t,i){t&1&&(l(0,"span"),p(1,"the last week"),o())}function y_(t,i){t&1&&(l(0,"span"),p(1,"the last 2 weeks"),o())}function C_(t,i){t&1&&(l(0,"span"),p(1,"the last month"),o())}function b_(t,i){t&1&&(l(0,"span"),p(1,"the selected range"),o())}function x_(t,i){if(t&1&&(l(0,"span",14),p(1," There is no data for this chart in "),C(2,c_,2,0,"span")(3,p_,2,0,"span")(4,m_,2,0,"span")(5,d_,2,0,"span")(6,u_,2,0,"span")(7,h_,2,0,"span")(8,f_,2,0,"span")(9,__,2,0,"span")(10,g_,2,0,"span")(11,v_,2,0,"span")(12,y_,2,0,"span")(13,C_,2,0,"span")(14,b_,2,0,"span"),o()),t&2){let e;c(2),b((e=i)==="PT1M"?2:e==="PT5M"?3:e==="PT15M"?4:e==="PT30M"?5:e==="PT1H"?6:e==="PT6H"?7:e==="PT12H"?8:e==="P1D"?9:e==="P2D"?10:e==="P1W"?11:e==="P2W"?12:e==="P1M"?13:14)}}function S_(t,i){if(t&1&&(l(0,"div",13),C(1,x_,15,1,"span",14),T(2,"async"),o()),t&2){let e,a=h(4);c(),b((e=D(2,1,a.range$))?1:-1,e)}}function w_(t,i){if(t&1&&C(0,S_,3,3,"div",13),t&2){let e=h();b(e.samples.length===0?0:-1)}}function T_(t,i){if(t&1&&(C(0,w_,1,1),T(1,"async")),t&2){let e=h(2);b(D(1,1,e.dataSource.loading$)?-1:0)}}function D_(t,i){if(t&1){let e=F();l(0,"div",1),C(1,s_,32,17,"div",2),T(2,"async"),o(),l(3,"div",3)(4,"app-parameter-plot",4,0),E("onVisibleRange",function(n){k(e);let r=h();return A(r.onVisibleRange(n))})("onManualRangeChange",function(){k(e);let n=h();return A(n.onManualRangeChange())}),x(6,"app-parameter-series",5),o(),l(7,"div",6)(8,"div",7)(9,"button",8),E("click",function(){k(e);let n=K(5);return A(n.zoomIn())}),l(10,"mat-icon"),p(11,"add"),o()(),x(12,"span",9),l(13,"button",8),E("click",function(){k(e);let n=K(5);return A(n.zoomOut())}),l(14,"mat-icon"),p(15,"remove"),o()()()(),C(16,T_,2,3),T(17,"async"),o()}if(t&2){let e,a,n=h();c(),b((e=D(2,9,n.range$))?1:-1,e),c(3),g("xGrid",!0)("xAxisHeight",24)("dataSource",n.dataSource)("stop",n.missionTime)("removableSeries",!0),c(2),g("parameter",i.qualifiedName)("grid",!0),c(10),b((a=D(17,11,n.dataSource.data$))?16:-1,a)}}var An=class An{constructor(i,e,a,n,r,s){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.synchronizer=r;this.configService=s;this.qualifiedName=ot.required({alias:"parameter"});this.range$=new G("PT15M");this.customStart$=new G(null);this.customStop$=new G(null)}ngOnInit(){this.missionTime=this.yamcs.getMissionTime(),this.initializeOptions();let i=this.qualifiedName();this.dataSource=new _a(this.yamcs,this.synchronizer,this.configService),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i),this.parameter$.then(e=>{if(e.qualifiedName=i,this.dataSource.addParameter(e),this.range$.value==="CUSTOM"){let n=this.customStart$.value,r=this.customStop$.value;this.dataSource.updateWindow(n,r,[null,null])}else{let n=this.yamcs.getMissionTime(),r=B.subtractDuration(n,this.range$.value);this.dataSource.updateWindow(r,n,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{if(this.range$.value!=="CUSTOM"){let n=this.yamcs.getMissionTime(),r=B.subtractDuration(n,this.range$.value);this.plot?.updateWindowOnly(r,n)}}),this.backfillSubscription=this.yamcs.yamcsClient.createBackfillingSubscription({instance:this.yamcs.instance},n=>{n.finished&&this.dataSource.reloadVisibleRange()})})}initializeOptions(){let i=this.route.snapshot.queryParamMap;i.has("interval")&&(this.range$.next(i.get("interval")),i.get("interval")==="CUSTOM"&&(this.customStart$.next(new Date(i.get("customStart"))),this.customStop$.next(new Date(i.get("customStop"))))),this.updateURL()}onVisibleRange(i){this.customStart$.next(i[0]),this.customStop$.next(i[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(i){this.range$.next(i);let e=this.yamcs.getMissionTime(),a=B.subtractDuration(e,i);this.updateURL(),this.dataSource.updateWindow(a,e,[null,null])}chooseRange(){let i=this.plot.getDateRange();i&&this.dialog.open(sl,{width:"400px",data:{start:i[0],stop:i[1]}}).afterClosed().subscribe(a=>{a&&(this.range$.next("CUSTOM"),this.customStart$.next(a.start),this.customStop$.next(a.stop),this.updateURL(),this.dataSource.updateWindow(a.start,a.stop,[null,null]))})}compareParameter(){this.dialog.open(ll,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(e=>{e&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e.qualifiedName).then(a=>{let n=new Gi;n.parameter=e.qualifiedName,n.color=e.color,n.strokeWidth=e.thickness,a.qualifiedName=e.qualifiedName,this.plot.addParameter(a,n)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:this.range$.value==="CUSTOM"?this.customStart$.value:null,customStop:this.range$.value==="CUSTOM"?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.backfillSubscription?.cancel(),this.timeSubscription?.unsubscribe(),this.dataSource?.disconnect()}};An.\u0275fac=function(e){return new(e||An)(S(Qe),S(Pe),S(W),S(Le),S(It),S(we))},An.\u0275cmp=N({type:An,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&ge(or,5),e&2){let n;fe(n=_e())&&(a.plot=n.first)}},inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:2,vars:3,consts:[["plot",""],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],[1,"plot-top-actions"],[1,"plot-container"],["duration","",3,"onVisibleRange","onManualRangeChange","xGrid","xAxisHeight","dataSource","stop","removableSeries"],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],["icon","add_circle",3,"click"],["icon","date_range",3,"click","active"],[3,"click","active"],[1,"no-data-message"],[1,"mat-caption",2,"color","#777"]],template:function(e,a){if(e&1&&(C(0,D_,18,13),T(1,"async")),e&2){let n;b((n=D(1,1,a.parameter$))?0:-1,n)}},dependencies:[or,Gi,$,ks,Rt,oi,ie,Ve],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0});var cl=An;var Mn=class Mn{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.downloadURL$=new G(null);this.form=new ut({start:new ne(null),stop:new ne(null),delimiter:new ne(null,Ce.required),interval:new at(null)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=B.subtractDuration(r,"PT1H")),this.form.setValue({start:a.start?B.toISOString(a.start):"",stop:a.stop?B.toISOString(a.stop):"",delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(i.start=B.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=B.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}};Mn.\u0275fac=function(e){return new(e||Mn)(S(Re),S(W),S(He))},Mn.\u0275cmp=N({type:Mn,selectors:[["ng-component"]],decls:18,vars:6,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["label","Start","hint","(optional)"],["formControlName","start"],["label","Stop","hint","(optional)"],["formControlName","stop"],["label","CSV column delimiter"],["formControlName","delimiter",3,"options"],["label","Interval (ms)","hint","(optional)"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Export parameter data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"ya-field",3),x(5,"ya-date-time-input",4),o(),l(6,"ya-field",5),x(7,"ya-date-time-input",6),o(),l(8,"ya-field",7),x(9,"ya-select",8),o(),l(10,"ya-field",9),x(11,"input",10),o()()(),l(12,"mat-dialog-actions",11)(13,"ya-button",12),p(14,"CANCEL"),o(),l(15,"ya-download-button",13),T(16,"async"),E("click",function(){return a.closeDialog()}),p(17," DOWNLOAD "),o()()),e&2&&(c(3),g("formGroup",a.form),c(6),g("options",a.delimiterOptions),c(6),g("link",D(16,4,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[$,Ke,$e,pe,ve,ye,Se,Ie,lt,Ne,Oe,me,wt,Nr,ke,it,ie],encapsulation:2,changeDetection:0});var pl=Mn;function P_(t,i){t&1&&(l(0,"th",15),p(1,"Severity"),o())}function E_(t,i){if(t&1&&x(0,"app-alarm-level",17),t&2){let e=h().$implicit;g("level",e.monitoringResult)}}function k_(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function A_(t,i){if(t&1&&(l(0,"td",16),C(1,E_,1,1,"app-alarm-level",17),C(2,k_,2,0,"span"),o()),t&2){let e=i.$implicit;c(),b(e.monitoringResult?1:-1),c(),b(e.monitoringResult?-1:2)}}function M_(t,i){t&1&&(l(0,"th",15),p(1,"Generation time"),o())}function R_(t,i){if(t&1&&(l(0,"td",16),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),X(D(2,1,e.generationTime)??"-")}}function L_(t,i){t&1&&(l(0,"th",15),p(1,"Reception time"),o())}function I_(t,i){if(t&1&&(l(0,"td",16),p(1),T(2,"datetime"),o()),t&2){let e=i.$implicit;c(),X(D(2,1,e.acquisitionTime)??"-")}}function O_(t,i){t&1&&(l(0,"th",15),p(1,"Raw"),o())}function N_(t,i){if(t&1&&(l(0,"td",18),x(1,"ya-value",19),o()),t&2){let e=i.$implicit;c(),g("value",e.rawValue)}}function V_(t,i){t&1&&(l(0,"th",15),p(1,"Eng"),o())}function F_(t,i){if(t&1&&(l(0,"td",18),x(1,"ya-value",19),o()),t&2){let e=i.$implicit;c(),g("value",e.engValue)}}function B_(t,i){t&1&&(l(0,"th",15),p(1,"Range condition"),o())}function $_(t,i){if(t&1&&(l(0,"td",16),p(1),o()),t&2){let e=i.$implicit;c(),X(e.rangeCondition||"-")}}function H_(t,i){t&1&&(l(0,"th",15),p(1,"Acquisition status"),o())}function Y_(t,i){if(t&1&&(l(0,"td",16),p(1),o()),t&2){let e=i.$implicit;c(),X(e.acquisitionStatus||"-")}}function G_(t,i){t&1&&x(0,"th",20)}function U_(t,i){t&1&&x(0,"td",16)}function q_(t,i){t&1&&x(0,"tr",21)}function j_(t,i){if(t&1){let e=F();l(0,"tr",22),T(1,"async"),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.selectValue(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);ae("selected",D(1,2,a.selectedValue)===e)}}function z_(t,i){if(t&1&&(l(0,"table",0),H(1,1),I(2,P_,2,0,"th",2)(3,A_,3,2,"td",3),Y(),H(4,4),I(5,M_,2,0,"th",2)(6,R_,3,3,"td",3),Y(),H(7,5),I(8,L_,2,0,"th",2)(9,I_,3,3,"td",3),Y(),H(10,6),I(11,O_,2,0,"th",2)(12,N_,2,1,"td",7),Y(),H(13,8),I(14,V_,2,0,"th",2)(15,F_,2,1,"td",7),Y(),H(16,9),I(17,B_,2,0,"th",2)(18,$_,2,1,"td",3),Y(),H(19,10),I(20,H_,2,0,"th",2)(21,Y_,2,1,"td",3),Y(),H(22,11),I(23,G_,1,0,"th",12)(24,U_,1,0,"td",3),Y(),I(25,q_,1,0,"tr",13)(26,j_,2,4,"tr",14),o()),t&2){let e=h();g("dataSource",e.dataSource),c(25),g("matHeaderRowDef",e.displayedColumns),c(),g("matRowDefColumns",e.displayedColumns)}}var Ui=class Ui extends ia{constructor(){super(...arguments);this.selectedValue=new dt;this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}selectValue(e){this.selectedValue.emit(e),this.openDetailPane()}};Ui.\u0275fac=(()=>{let e;return function(n){return(e||(e=us(Ui)))(n||Ui)}})(),Ui.\u0275cmp=N({type:Ui,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},outputs:{selectedValue:"selectedValue"},features:[Wi],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,n){a&1&&C(0,z_,27,3,"table",0),a&2&&b(n.dataSource?0:-1)},dependencies:[pi,$,Ye,_t,gt,st,ft,xt,Ge,Ue,qe,je,sa,ie,Ve],styles:["tr[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var ml=Ui;var dl=class extends Kt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.pvals$=new G([]);this.loading$=new G(!1)}connect(e){return this.pvals$}isEmpty(){return this.pvals$.value.length===0}loadParameterValues(e){return this.loading$.next(!0),this.loadPage(Pt(mt({},e),{limit:this.pageSize+1})).then(a=>{this.pvals$.next(a)}).finally(()=>this.loading$.next(!1))}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}async loadMoreData(e){if(this.offscreenRecord)return this.loadPage(Pt(mt({},e),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(a=>{let n=this.pvals$.getValue().concat(a);this.pvals$.next(n)})}disconnect(){this.pvals$.complete(),this.loading$.complete()}};var ul=t=>({value:t});function W_(t,i){if(t&1&&x(0,"app-alarm-level",12),t&2){let e=h();g("level",e.monitoringResult)}}function X_(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function Z_(t,i){t&1&&Bn(0)}function Q_(t,i){if(t&1&&(p(0," Raw value "),I(1,Z_,1,0,"ng-container",16)),t&2){let e=h();h();let a=K(21);c(),g("ngTemplateOutlet",a)("ngTemplateOutletContext",Q(2,ul,e.rawValue))}}function K_(t,i){if(t&1&&(l(0,"ya-meta"),p(1),T(2,"lowercase"),o()),t&2){let e=h();c(),O(" ",D(2,1,e.rawValue.type)," ")}}function J_(t,i){t&1&&Bn(0)}function eg(t,i){t&1&&Bn(0)}function tg(t,i){if(t&1&&(p(0," Engineering value "),I(1,eg,1,0,"ng-container",16)),t&2){let e=h();h();let a=K(21);c(),g("ngTemplateOutlet",a)("ngTemplateOutletContext",Q(2,ul,e.engValue))}}function ig(t,i){if(t&1&&(l(0,"ya-meta"),p(1),T(2,"lowercase"),o()),t&2){let e=h();c(),O(" ",D(2,1,e.engValue.type)," ")}}function ag(t,i){t&1&&Bn(0)}function ng(t,i){if(t&1&&(l(0,"ya-detail-toolbar"),p(1,"Value detail"),o(),l(2,"ya-attr-list",10)(3,"ya-attr",11),C(4,W_,1,1,"app-alarm-level",12)(5,X_,2,0,"span"),o(),l(6,"ya-attr",13),p(7),T(8,"datetime"),o(),l(9,"ya-attr",14),p(10),T(11,"millisDuration"),o(),l(12,"ya-attr"),I(13,Q_,2,4,"ng-template",15),C(14,K_,3,3,"ya-meta"),I(15,J_,1,0,"ng-container",16),o(),l(16,"ya-attr"),I(17,tg,2,4,"ng-template",15),C(18,ig,3,3,"ya-meta"),I(19,ag,1,0,"ng-container",16),o(),l(20,"ya-attr",17),p(21),o(),l(22,"ya-attr",18),p(23),o()()),t&2){let e=i;h();let a=K(23);c(4),b(e.monitoringResult?4:5),c(3),O(" ",D(8,11,e.generationTime)," "),c(3),O(" ",D(11,13,e.expireMillis)||"-"," "),c(4),b(e.rawValue?14:-1),c(),g("ngTemplateOutlet",a)("ngTemplateOutletContext",Q(15,ul,e.rawValue)),c(3),b(e.engValue?18:-1),c(),g("ngTemplateOutlet",a)("ngTemplateOutletContext",Q(17,ul,e.engValue)),c(2),O(" ",e.rangeCondition||"-"," "),c(2),O(" ",e.acquisitionStatus||"-"," ")}}function rg(t,i){t&1&&(l(0,"ya-detail-toolbar"),p(1,"Select a value"),o())}function og(t,i){if(t&1){let e=F();x(0,"ya-date-time-input",19)(1,"ya-date-time-input",20),l(2,"ya-button",21),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),p(3,"Apply"),o()}if(t&2){let e=h();c(2),g("disabled",e.filterForm.invalid)}}function lg(t,i){if(t&1){let e=F();l(0,"ya-button",22),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),p(1,"Jump to now"),o()}}function sg(t,i){t&1&&x(0,"ya-dots")}function cg(t,i){t&1&&(l(0,"ya-empty-message"),p(1," No records found matching current filter in the selected time range. "),o())}function pg(t,i){if(t&1){let e=F();l(0,"ya-toolbar",9)(1,"ya-button",21),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),p(2,"Load more"),o()()}if(t&2){let e=h();c(),g("disabled",!e.dataSource.hasMore())}}function mg(t,i){if(t&1){let e=F();l(0,"ya-more",23)(1,"button",24),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyHex(n.binaryValue))}),p(2,"Copy hex"),o(),l(3,"button",24),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyBinary(n.binaryValue))}),p(4,"Copy binary"),o()()}}function dg(t,i){if(t&1&&C(0,mg,5,0,"ya-more",23),t&2){let e,a=i.value;b((e=a==null?null:a.type)==="BINARY"?0:-1)}}function ug(t,i){if(t&1&&x(0,"app-hex",25),t&2){let e=h().value;g("base64String",e.binaryValue)}}function hg(t,i){if(t&1&&x(0,"ya-value",26),t&2){let e=h().value;g("value",e)}}function fg(t,i){if(t&1&&C(0,ug,1,1,"app-hex",25)(1,hg,1,1,"ya-value",26),t&2){let e,a=i.value;b((e=a==null?null:a.type)==="BINARY"?0:1)}}var Rn="PT1H",Ln=class Ln{constructor(i,e,a,n,r,s,d){this.route=i;this.router=e;this.yamcs=a;this.dialog=n;this.clipboard=r;this.messageService=s;this.configService=d;this.qualifiedName=ot.required({alias:"parameter"});this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new ut({interval:new ne(Rn),customStart:new ne(null),customStop:new ne(null)});this.downloadURL$=new G(null)}ngOnInit(){let i=this.qualifiedName();this.dataSource=new dl(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Rn),this.appliedInterval=Rn,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(B.toISOString(a)),this.filterForm.get("customStop").setValue(B.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Rn,this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,Rn)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(Rn):(this.validStop=this.yamcs.getMissionTime(),this.validStart=B.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=B.toDate(this.filterForm.value.customStart),this.validStop=B.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(i).catch(e=>this.messageService.showError(e))}loadMoreData(){let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.dataSource.loadMoreData(i).catch(e=>this.messageService.showError(e))}copyHex(i){let e=B.convertBase64ToHex(i);this.clipboard.copy(e)}copyBinary(i){let e=window.atob(i);this.clipboard.copy(e)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(pl,{width:"400px",data:{parameter:this.qualifiedName(),start:this.validStart,stop:this.validStop}})}ngOnDestroy(){this.dataSource?.disconnect()}};Ln.\u0275fac=function(e){return new(e||Ln)(S(Pe),S(Qe),S(W),S(Le),S(ea),S(Je),S(we))},Ln.\u0275cmp=N({type:Ln,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:24,vars:17,consts:[["table",""],["valueActionsTemplate",""],["valueTemplate",""],[1,"table-wrapper"],[3,"formGroup"],["icon","access_time","formControlName","interval",3,"options"],[3,"duration","start","stop"],["appearance","text","icon","download",3,"click"],[3,"dataSource"],["appearance","bottom","align","center"],[2,"padding","0 16px"],["label","Severity"],[3,"level"],["label","Generation time"],["label","Valid for"],["ya-attr-label",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["label","Range condition"],["label","Acquisition status"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[3,"base64String"],[3,"value"]],template:function(e,a){if(e&1){let n=F();l(0,"ya-detail-pane"),C(1,ng,24,19),T(2,"async"),Ft(3,rg,2,0,"ya-detail-toolbar"),o(),l(4,"div",3)(5,"ya-panel")(6,"ya-filter-bar",4),x(7,"ya-select",5),C(8,og,4,1)(9,lg,2,0,"ya-button"),C(10,sg,1,0,"ya-dots"),T(11,"async"),o(),l(12,"ya-table-window",6)(13,"ya-button",7),E("click",function(){return k(n),A(a.exportParameterData())}),p(14," Export CSV "),o()(),x(15,"app-parameter-values-table",8,0),C(17,cg,2,0,"ya-empty-message"),C(18,pg,3,1,"ya-toolbar",9),T(19,"async"),o()(),I(20,dg,1,1,"ng-template",null,1,ki)(22,fg,2,1,"ng-template",null,2,ki)}if(e&2){let n,r=K(16);c(),b((n=D(2,11,r.selectedValue))?1:3,n),c(5),g("formGroup",a.filterForm),c(),g("options",a.intervalOptions),c(),b(a.filterForm.value.interval==="CUSTOM"?8:9),c(2),b(D(11,13,a.dataSource.loading$)?10:-1),c(2),g("duration",a.appliedInterval)("start",a.validStart)("stop",a.validStop),c(3),g("dataSource",a.dataSource),c(2),b(a.dataSource.isEmpty()?17:-1),c(),b(!D(19,15,a.dataSource.loading$)&&!a.dataSource.isEmpty()?18:-1)}},dependencies:[pi,ma,ml,$,Ts,pe,ve,ye,Se,Ar,ht,Rr,Mr,me,wt,na,ra,ai,ni,Ot,Br,Nt,ze,it,xi,si,sa,ie,Ds,Ve,Ks],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}"],changeDetection:0});var hl=Ln;var _g=["container"],zt="http://www.w3.org/2000/svg",In=class In{constructor(){this.watchColor="#ffff98";this.warningColor="#ffff00";this.distressColor="#ff6600";this.criticalColor="#ff0000";this.severeColor="#800000"}ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){let i=this.container.nativeElement,e=document.createElementNS(zt,"rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100"),e.setAttribute("height","50"),e.setAttribute("shape-rendering","crispEdges"),e.style.fill="#00ff00",i.appendChild(e),this.watchLowRange=document.createElementNS(zt,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill=this.watchColor,i.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(zt,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill=this.watchColor,i.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(zt,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill=this.warningColor,i.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(zt,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill=this.warningColor,i.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(zt,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill=this.distressColor,i.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(zt,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill=this.distressColor,i.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(zt,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill=this.criticalColor,i.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(zt,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill=this.criticalColor,i.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(zt,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill=this.severeColor,i.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(zt,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill=this.severeColor,i.appendChild(this.severeHighRange),this.indicator=document.createElementNS(zt,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",i.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let i,e,a=new Map;if(this.pval.alarmRange)for(let n of this.pval.alarmRange)a.set(n.level,n),n.minInclusive!==void 0&&(i===void 0||n.minInclusive<i)&&(i=n.minInclusive),n.minExclusive!==void 0&&(i===void 0||n.minExclusive<i)&&(i=n.minExclusive),n.maxInclusive!==void 0&&(e===void 0||n.maxInclusive>e)&&(e=n.maxInclusive),n.maxExclusive!==void 0&&(e===void 0||n.maxExclusive>e)&&(e=n.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",i!==void 0&&e!==void 0&&i!==e){let n=i-(e-i)/5,r=e+(e-i)/5,s=100/(r-n),d=a.get("WATCH");if(d){if(d.minInclusive){let _=(d.minInclusive-n)*s;this.watchLowRange.setAttribute("width",String(_))}else if(d.minExclusive){let _=(d.minExclusive-n)*s;this.watchLowRange.setAttribute("width",String(_))}if(d.maxInclusive){let _=(d.maxInclusive-n)*s;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}else if(d.maxExclusive){let _=(d.maxExclusive-n)*s;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}}let m=a.get("WARNING");if(m){if(m.minInclusive){let _=(m.minInclusive-n)*s;this.warningLowRange.setAttribute("width",String(_))}else if(m.minExclusive){let _=(m.minExclusive-n)*s;this.warningLowRange.setAttribute("width",String(_))}if(m.maxInclusive){let _=(m.maxInclusive-n)*s;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}else if(m.maxExclusive){let _=(m.maxExclusive-n)*s;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}}let u=a.get("DISTRESS");if(u){if(u.minInclusive){let _=(u.minInclusive-n)*s;this.distressLowRange.setAttribute("width",String(_))}else if(u.minExclusive){let _=(u.minExclusive-n)*s;this.distressLowRange.setAttribute("width",String(_))}if(u.maxInclusive){let _=(u.maxInclusive-n)*s;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}else if(u.maxExclusive){let _=(u.maxExclusive-n)*s;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}}let v=a.get("CRITICAL");if(v){if(v.minInclusive){let _=(v.minInclusive-n)*s;this.criticalLowRange.setAttribute("width",String(_))}else if(v.minExclusive){let _=(v.minExclusive-n)*s;this.criticalLowRange.setAttribute("width",String(_))}if(v.maxInclusive){let _=(v.maxInclusive-n)*s;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}else if(v.maxExclusive){let _=(v.maxExclusive-n)*s;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}}let f=a.get("SEVERE");if(f){if(f.minInclusive){let _=(f.minInclusive-n)*s;this.severeLowRange.setAttribute("width",String(_))}else if(f.minExclusive){let _=(f.minExclusive-n)*s;this.severeLowRange.setAttribute("width",String(_))}if(f.maxInclusive){let _=(f.maxInclusive-n)*s;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}else if(f.maxExclusive){let _=(f.maxExclusive-n)*s;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}}let y=this.getNumericValue(this.pval);if(y!==void 0){let w=(Math.min(Math.max(y,n),r)-n)*s;this.indicator.setAttribute("points",`${w},25 ${w-3.5},100 ${w+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(i){let e=i.engValue;switch(e.type){case"FLOAT":return e.floatValue;case"DOUBLE":return e.doubleValue;case"UINT32":return e.uint32Value;case"SINT32":return e.sint32Value;case"UINT64":return e.uint64Value;case"SINT64":return e.sint64Value}}};In.\u0275fac=function(e){return new(e||In)},In.\u0275cmp=N({type:In,selectors:[["app-severity-meter"]],viewQuery:function(e,a){if(e&1&&ge(_g,7),e&2){let n;fe(n=_e())&&(a.container=n.first)}},inputs:{pval:"pval"},features:[Gt],decls:2,vars:0,consts:[["container",""],["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"]],template:function(e,a){e&1&&(ur(),Tt(0,"svg",1,0))},encapsulation:2,changeDetection:0});var fl=In;var Hc=(t,i)=>({c:t,system:i}),os=t=>({c:t}),gg=()=>[];function vg(t,i){if(t&1&&(l(0,"a",5),p(1),o()),t&2){let e=i,a=h(2);g("queryParams",Ei(2,Hc,a.yamcs.context,e)),c(),O(" ",e," ")}}function yg(t,i){if(t&1&&(l(0,"dt"),p(1),o(),l(2,"dd"),p(3),o()),t&2){let e=i.$implicit;c(),X(e.namespace),c(2),X(e.name)}}function Cg(t,i){t&1&&(l(0,"span",2),p(1),o()),t&2&&(c(),O(" ",i," "))}function bg(t,i){t&1&&p(0," - ")}function xg(t,i){if(t&1&&(l(0,"dt"),p(1,"Signed"),o(),l(2,"dd"),p(3),o()),t&2){let e=h();c(3),X(e.signed)}}function Sg(t,i){if(t&1&&(l(0,"dt"),p(1,"Size in bits"),o(),l(2,"dd"),p(3),o()),t&2){let e=h();c(3),X(e.sizeInBits)}}function wg(t,i){if(t&1&&(C(0,xg,4,1),C(1,Sg,4,1)),t&2){let e=i;b(e.signed!==void 0?0:-1),c(),b(e.sizeInBits!==void 0?1:-1)}}function Tg(t,i){if(t&1&&(l(0,"dt"),p(1,"Description"),o(),l(2,"dd"),x(3,"app-markdown",6),o()),t&2){let e=h();c(3),g("text",e.longDescription)}}function Dg(t,i){if(t&1&&(l(0,"dt"),p(1,"Description"),o(),l(2,"dd"),p(3),o()),t&2){let e=h();c(3),O(" ",e.shortDescription||"-"," ")}}function Pg(t,i){if(t&1&&(C(0,Tg,4,1),C(1,Dg,4,1)),t&2){let e=i;b(e.longDescription?0:-1),c(),b(e.longDescription?-1:1)}}function Eg(t,i){t&1&&p(0," - ")}function kg(t,i){if(t&1&&(l(0,"dl",0)(1,"dt"),p(2,"Entry"),o(),l(3,"dd"),p(4),T(5,"shortName"),o(),l(6,"dt"),p(7,"System"),o(),l(8,"dd"),C(9,vg,2,5,"a",5),T(10,"spaceSystemName"),o(),le(11,yg,4,2,null,null,oe),T(13,"async"),l(14,"dt"),p(15,"Type"),o(),l(16,"dd"),C(17,Cg,2,1,"span",2),T(18,"async"),Ft(19,bg,1,0),o(),C(20,wg,2,2),T(21,"async"),l(22,"dt"),p(23,"Source"),o(),l(24,"dd"),p(25),T(26,"titlecase"),o(),C(27,Pg,2,2),T(28,"async"),Ft(29,Eg,1,0),o()),t&2){let e,a,n,r,s,d=h();c(4),Qt("",D(5,7,d.parameter.qualifiedName),"",d.offset),c(5),b((e=D(10,9,d.parameter.qualifiedName))?9:-1,e),c(2),se((a=D(13,11,d.entry$))==null?null:a.alias),c(6),b((n=(n=D(18,13,d.ptype$))==null?null:n.engType)?17:19,n),c(3),b((r=D(21,15,d.ptype$))?20:-1,r),c(5),X(D(26,17,d.parameter.dataSource)||"-"),c(2),b((s=D(28,19,d.entry$))?27:29,s)}}function Ag(t,i){if(t&1&&(l(0,"dt"),p(1,"Host Parameter"),o(),l(2,"dd")(3,"a",7),p(4),T(5,"shortName"),o()()),t&2){let e=h();c(3),g("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",Q(5,os,e.yamcs.context)),c(),O(" ",D(5,3,e.parameter.qualifiedName)," ")}}function Mg(t,i){if(t&1&&(l(0,"dt"),p(1,"Parameter"),o(),l(2,"dd"),p(3),T(4,"shortName"),o()),t&2){let e=h();c(3),X(D(4,1,e.parameter.qualifiedName))}}function Rg(t,i){if(t&1&&(l(0,"a",5),p(1),o()),t&2){let e=i,a=h(2);g("queryParams",Ei(2,Hc,a.yamcs.context,e)),c(),O(" ",e," ")}}function Lg(t,i){if(t&1&&(l(0,"dt"),p(1,"System"),o(),l(2,"dd"),C(3,Rg,2,5,"a",5),T(4,"spaceSystemName"),o()),t&2){let e,a=h();c(3),b((e=D(4,1,a.parameter.qualifiedName))?3:-1,e)}}function Ig(t,i){if(t&1&&(l(0,"dt"),p(1),o(),l(2,"dd"),p(3),o()),t&2){let e=i.$implicit;c(),X(e.namespace),c(2),X(e.name)}}function Og(t,i){t&1&&(l(0,"span",2),p(1),o()),t&2&&(c(),O(" ",i," "))}function Ng(t,i){t&1&&p(0," - ")}function Vg(t,i){if(t&1&&(l(0,"dt"),p(1,"Signed"),o(),l(2,"dd"),p(3),o()),t&2){let e=h();c(3),X(e.parameter.type==null?null:e.parameter.type.signed)}}function Fg(t,i){if(t&1&&(l(0,"dt"),p(1,"Source"),o(),l(2,"dd"),p(3),T(4,"titlecase"),o()),t&2){let e=h();c(3),X(D(4,1,e.parameter.dataSource)||"-")}}function Bg(t,i){if(t&1&&(l(0,"dt"),p(1,"Description"),o(),l(2,"dd"),x(3,"app-markdown",6),o()),t&2){let e=h();c(3),g("text",e.parameter.longDescription)}}function $g(t,i){if(t&1&&(l(0,"dt"),p(1,"Description"),o(),l(2,"dd"),p(3),o()),t&2){let e=h();c(3),O(" ",e.parameter.shortDescription||"-"," ")}}function Hg(t,i){t&1&&(l(0,"span",2),p(1),o()),t&2&&(c(),O(" ",i," "))}function Yg(t,i){t&1&&p(0," - ")}function Gg(t,i){t&1&&(p(0),T(1,"units")),t&2&&O(" ",D(1,1,i)," ")}function Ug(t,i){if(t&1&&(l(0,"td")(1,"a",9),p(2),o()(),l(3,"td"),C(4,Hg,2,1,"span",2),T(5,"entryForOffset"),Ft(6,Yg,1,0),o(),l(7,"td"),p(8),T(9,"entryForOffset"),o(),l(10,"td")(11,"ya-expirable",10),p(12),T(13,"value"),C(14,Gg,2,3),T(15,"entryForOffset"),o()()),t&2){let e,a,n,r=i,s=h(),d=s.$implicit,m=s.$index,u=h(2),v=h();c(),g("routerLink","/telemetry/parameters"+v.parameter.qualifiedName+r)("queryParams",Q(19,os,v.yamcs.context)),c(),O(" ",d," "),c(2),b((e=(e=We(5,8,v.parameter,r))==null||e.type==null?null:e.type.engType)?4:6,e),c(4),X(((a=We(9,11,v.parameter,r))==null?null:a.shortDescription)||"-"),c(3),g("pval",v.pval),c(),O(" ",D(13,14,u.aggregateValue.value[m])," "),c(2),b((n=(n=We(15,16,v.parameter,r))==null||n.type==null?null:n.type.unitSet)?14:-1,n)}}function qg(t,i){if(t&1&&(l(0,"tr"),C(1,Ug,16,21),o()),t&2){let e,a=i.$implicit,n=h(3);c(),b((e=(n.offset||"")+"."+a)?1:-1,e)}}function jg(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),p(3,"Member"),o(),l(4,"th"),p(5,"Type"),o(),l(6,"th"),p(7,"Description"),o(),l(8,"th"),p(9,"Value"),o()(),le(10,qg,2,1,"tr",null,oe),o()),t&2){let e=h();c(10),se(e.aggregateValue.name)}}function zg(t,i){if(t&1&&(l(0,"tr")(1,"td")(2,"a",9),p(3),o()(),l(4,"td"),p(5),T(6,"value"),o()()),t&2){let e=i.$implicit,a=i.$index,n=h(3);c(2),g("routerLink","/telemetry/parameters"+n.parameter.qualifiedName+(n.offset||"")+"["+a+"]")("queryParams",Q(6,os,n.yamcs.context)),c(),O(" ",a," "),c(2),X(D(6,4,e))}}function Wg(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),p(3,"Index"),o(),l(4,"th"),p(5,"Value"),o()(),le(6,zg,7,8,"tr",null,oe),o()),t&2){let e=h();c(6),se(e.arrayValue||fi(0,gg))}}function Xg(t,i){if(t&1&&(x(0,"app-alarm-level",15),p(1," \xA0 ")),t&2){let e=h(3);g("level",e.pval==null?null:e.pval.monitoringResult)}}function Zg(t,i){t&1&&(p(0),T(1,"units")),t&2&&O(" ",D(1,1,i)," ")}function Qg(t,i){if(t&1&&x(0,"app-severity-meter",10),t&2){let e=h(3);g("pval",e.pval)}}function Kg(t,i){if(t&1&&(l(0,"span",11)(1,"ya-expirable",12),C(2,Xg,2,1),p(3),T(4,"value"),C(5,Zg,2,3),T(6,"parameterTypeForPath"),o()(),x(7,"br"),l(8,"div",13),C(9,Qg,1,1,"app-severity-meter",10),o(),l(10,"dl",14)(11,"dt"),p(12,"Generation time"),o(),l(13,"dd"),p(14),T(15,"datetime"),o(),l(16,"dt"),p(17,"Status"),o(),l(18,"dd"),p(19),o(),l(20,"dt"),p(21,"Raw value"),o(),l(22,"dd"),p(23),T(24,"value"),o()()),t&2){let e,a=h(),n=h();c(),g("pval",n.pval),c(),b(n.pval!=null&&n.pval.monitoringResult?2:-1),c(),O(" ",D(4,8,a)," "),c(2),b((e=(e=D(6,10,n.parameter))==null?null:e.unitSet)?5:-1,e),c(4),b(n.pval!=null&&n.pval.monitoringResult&&(n.pval!=null&&n.pval.alarmRange)?9:-1),c(5),X(D(15,12,n.pval==null?null:n.pval.generationTime)),c(5),X((n.pval==null?null:n.pval.acquisitionStatus)||"-"),c(4),X(D(24,14,n.pval==null?null:n.pval.rawValue)??"-")}}function Jg(t,i){if(t&1&&C(0,jg,12,0,"table",8)(1,Wg,8,1,"table",8)(2,Kg,25,16),t&2){let e;b((e=i.type)==="AGGREGATE"?0:e==="ARRAY"?1:2)}}function ev(t,i){t&1&&(l(0,"span",4),p(1,"---"),o())}function tv(t,i){if(t&1&&(l(0,"th"),x(1,"app-expression",19),T(2,"spaceSystemName"),o()),t&2){let e=i.$implicit,a=h(3);c(),g("expression",e.context)("relto",D(2,2,a.parameter.qualifiedName))}}function iv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function av(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function nv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function rv(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function ov(t,i){if(t&1&&(l(0,"td"),C(1,nv,2,3)(2,rv,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit,r=h(3);c(),b((e=r.getEnumerationAlarmLevel(a,n.label))?1:2,e)}}function lv(t,i){if(t&1&&(l(0,"tr")(1,"td",4),p(2),o(),l(3,"td",4),p(4),o(),l(5,"td"),p(6),o(),l(7,"td"),C(8,iv,2,3)(9,av,2,0,"span"),o(),le(10,ov,3,1,"td",null,oe),o()),t&2){let e,a=i.$implicit,n=h(2),r=h();c(2),X(a.value),c(2),X(a.label),c(2),X(a.description||"-"),c(2),b((e=r.getDefaultAlarmLevel(n.type,a.label))?8:9,e),c(2),se(n.type.contextAlarm)}}function sv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function cv(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function pv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function mv(t,i){t&1&&(l(0,"span"),p(1,"-"),o())}function dv(t,i){if(t&1&&(l(0,"td"),C(1,pv,2,3)(2,mv,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit,r=h(3);c(),b((e=r.getEnumerationAlarmLevel(a,n.label))?1:2,e)}}function uv(t,i){if(t&1&&(l(0,"tr")(1,"td",4),x(2,"ya-interval",21),o(),l(3,"td",4),p(4),o(),l(5,"td"),p(6),o(),l(7,"td"),C(8,sv,2,3)(9,cv,2,0,"span"),o(),le(10,dv,3,1,"td",null,oe),o()),t&2){let e,a=i.$implicit,n=h(2),r=h();c(2),g("left",a.min)("right",a.max)("leftInclusive",a.minInclusive)("rightInclusive",a.maxInclusive),c(2),X(a.label),c(2),X(a.description||"-"),c(2),b((e=r.getDefaultAlarmLevel(n.type,a.label))?8:9,e),c(2),se(n.type.contextAlarm)}}function hv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function fv(t,i){if(t&1&&(x(0,"app-alarm-level",20),p(1)),t&2){let e=i;g("level",e)("grayscale",!0),c(),O(" ",e," ")}}function _v(t,i){if(t&1&&(l(0,"td"),C(1,fv,2,3),o()),t&2){let e,a=i.$implicit;c(),b((e=a.alarm.defaultLevel)?1:-1,e)}}function gv(t,i){if(t&1&&(l(0,"div",3),x(1,"mat-divider"),o(),l(2,"h4"),p(3,"Enumeration"),o(),l(4,"table",8)(5,"tr")(6,"th",16),p(7,"Value"),o(),l(8,"th",17),p(9,"Label"),o(),l(10,"th",18),p(11,"Description"),o(),l(12,"th"),p(13,"Alarm level (default)"),o(),le(14,tv,3,4,"th",null,oe),o(),le(16,lv,12,4,"tr",null,oe),le(18,uv,12,7,"tr",null,oe),l(20,"tr")(21,"td"),p(22,"Other"),o(),l(23,"td"),p(24,"UNDEF"),o(),l(25,"td"),p(26,"-"),o(),l(27,"td"),C(28,hv,2,3),o(),le(29,_v,2,1,"td",null,oe),o()()),t&2){let e,a=h();c(14),se(a.type==null?null:a.type.contextAlarm),c(2),se(a.type.enumValues),c(2),se(a.type.enumRanges),c(10),b((e=a.type.defaultAlarm==null?null:a.type.defaultAlarm.defaultLevel)?28:-1,e),c(),se(a.type.contextAlarm)}}function vv(t,i){if(t&1&&C(0,gv,31,1),t&2){let e=i;b((e.type==null?null:e.type.engType)==="enumeration"?0:-1)}}var On=class On{constructor(i){this.yamcs=i;this.entry$=new G(null);this.ptype$=new G(null)}ngOnChanges(){if(this.parameter){if(this.offset){let i=B.getEntryForOffset(this.parameter,this.offset);this.entry$.next(i)}else this.entry$.next(this.parameter);this.ptype$.next(B.getParameterTypeForPath(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(i,e){if(i&&i.defaultAlarm){let a=i.defaultAlarm;if(a.enumerationAlarms){for(let n of a.enumerationAlarms)if(n.label===e)return n.level}return a.defaultLevel}}getEnumerationAlarmLevel(i,e){let a=i.alarm;for(let n of a.enumerationAlarms)if(n.label===e)return n.level;return a.defaultLevel}};On.\u0275fac=function(e){return new(e||On)(S(W))},On.\u0275cmp=N({type:On,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},features:[Gt],decls:24,vars:16,consts:[[1,"dl-horizontal","no-lead","no-trail"],[1,"dl-horizontal","no-trail"],[1,"mono"],[1,"section-divider"],[2,"white-space","nowrap"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],["yaDataTable",""],[3,"routerLink","queryParams"],[3,"pval"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[1,"meter-size-constrainer"],[1,"dl-horizontal"],[3,"level"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[3,"expression","relto"],[3,"level","grayscale"],[3,"left","right","leftInclusive","rightInclusive"]],template:function(e,a){if(e&1&&(C(0,kg,30,21,"dl",0),l(1,"dl",1),C(2,Ag,6,7),C(3,Mg,5,3),C(4,Lg,5,3),le(5,Ig,4,2,null,null,oe),l(7,"dt"),p(8,"Type"),o(),l(9,"dd"),C(10,Og,2,1,"span",2)(11,Ng,1,0),o(),C(12,Vg,4,1),C(13,Fg,5,3),C(14,Bg,4,1),C(15,$g,4,1),o(),l(16,"div",3),x(17,"mat-divider"),o(),l(18,"h4"),p(19,"Current value"),o(),C(20,Jg,3,1),C(21,ev,2,0,"span",4),C(22,vv,1,1),T(23,"async")),e&2){let n,r,s;b(a.offset?0:-1),c(),ae("no-lead",!a.offset),c(),b(a.offset?2:-1),c(),b(a.offset?-1:3),c(),b(a.offset?-1:4),c(),se(a.parameter.alias),c(5),b((n=a.parameter.type==null?null:a.parameter.type.engType)?10:11,n),c(2),b((a.parameter.type==null?null:a.parameter.type.signed)!==void 0?12:-1),c(),b(a.offset?-1:13),c(),b(a.parameter.longDescription?14:-1),c(),b(a.parameter.longDescription?-1:15),c(5),b((r=a.pval==null?null:a.pval.engValue)?20:-1,r),c(),b(a.pval!=null&&a.pval.engValue?-1:21),c(),b((s=D(23,14,a.entry$))?22:-1,s)}},dependencies:[pi,cc,oc,fl,$,Ee,Si,ti,ri,qs,ie,Xi,Ve,Zs,pa,Ur,qr,ci,qt],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0});var _l=On;function yv(t,i){if(t&1&&(x(0,"app-parameter-detail",0),T(1,"async"),T(2,"async")),t&2){let e=h();g("parameter",i)("offset",D(1,3,e.offset$))("pval",D(2,5,e.pval$))}}var Nn=class Nn{constructor(i,e){this.yamcs=i;this.synchronizer=e;this.qualifiedName=ot.required({alias:"parameter"});this.parameter$=new G(null);this.offset$=new G(null);this.parameterValue$=new G(null);this.dirty=!1;this.pval$=new G(null);this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{this.parameterValue$.next(a.values?a.values[0]:null),this.pval$.value==null?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription?.cancel(),this.syncSubscription?.unsubscribe()}};Nn.\u0275fac=function(e){return new(e||Nn)(S(W),S(It))},Nn.\u0275cmp=N({type:Nn,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},features:[Gt],decls:3,vars:3,consts:[[3,"parameter","offset","pval"]],template:function(e,a){if(e&1&&(l(0,"ya-panel"),C(1,yv,3,7,"app-parameter-detail",0),T(2,"async"),o()),e&2){let n;c(),b((n=D(2,1,a.parameter$))?1:-1,n)}},dependencies:[_l,$,ze,ie],encapsulation:2,changeDetection:0});var gl=Nn;function Cv(t,i){if(t&1&&x(0,"ya-option",6),t&2){let e=i.$implicit;g("id",e.label)("label",e.label)}}function bv(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),l(2,"ya-meta"),p(3),o(),x(4,"ya-errors",4,0),l(6,"ya-select",5),le(7,Cv,1,2,"ya-option",6,oe),o()()),t&2){let e=K(5),a=h(),n=h();ae("error",D(1,6,e.invalid$)),g("label",n.parameter.name),c(3),X(n.parameter.type==null?null:n.parameter.type.engType),c(),g("controlName",a),c(2),g("formControlName",a),c(),se(n.parameter.type==null?null:n.parameter.type.enumValues)}}function xv(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),l(2,"ya-meta"),p(3),o(),x(4,"ya-errors",4,0),l(6,"div",7)(7,"label",8),x(8,"input",9),p(9," true "),o(),l(10,"label",8),x(11,"input",10),p(12," false "),o()()()),t&2){let e=K(5),a=h(),n=h();ae("error",D(1,11,e.invalid$)),g("label",n.parameter.name),c(3),X(n.parameter.type==null?null:n.parameter.type.engType),c(),g("controlName",a),c(3),ae("checked",n.formGroup.controls[a].value==="true"),c(),g("formControlName",a),c(2),ae("checked",n.formGroup.controls[a].value==="false"),c(),g("formControlName",a)}}function Sv(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),l(2,"ya-meta"),p(3),o(),x(4,"ya-errors",4,0)(6,"ya-date-time-input",5),o()),t&2){let e=K(5),a=h(),n=h();ae("error",D(1,6,e.invalid$)),g("label",n.parameter.name),c(3),X(n.parameter.type==null?null:n.parameter.type.engType),c(),g("controlName",a),c(2),g("formControlName",a)}}function wv(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),l(2,"ya-meta"),p(3),o(),x(4,"ya-errors",4,0)(6,"ya-binary-input",5),o()),t&2){let e=K(5),a=h(),n=h();ae("error",D(1,6,e.invalid$)),g("label",n.parameter.name),c(3),X(n.parameter.type==null?null:n.parameter.type.engType),c(),g("controlName",a),c(2),g("formControlName",a)}}function Tv(t,i){if(t&1&&x(0,"app-parameter-form",12)(1,"br"),t&2){let e=i.$implicit,a=h(3);g("parameter",e)("formGroup",a.formGroup)("parent",a.parent?a.parent+"."+a.parameter.name:a.parameter.name)}}function Dv(t,i){if(t&1&&(l(0,"ya-field",3)(1,"ya-meta"),p(2),o(),l(3,"div",11),le(4,Tv,2,3,null,null,oe),o()()),t&2){let e=h(2);g("label",e.parameter.name),c(2),X(e.parameter.type==null?null:e.parameter.type.engType),c(2),se(e.parameter.type==null?null:e.parameter.type.member)}}function Pv(t,i){if(t&1&&(l(0,"ya-meta"),p(1),T(2,"units"),o()),t&2){let e=h(3);c(),X(D(2,1,e.parameter.type==null?null:e.parameter.type.unitSet))}}function Ev(t,i){t&1&&(l(0,"ya-meta"),p(1,"unsigned"),o())}function kv(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),C(2,Pv,3,3,"ya-meta"),C(3,Ev,2,0,"ya-meta"),l(4,"ya-meta"),p(5),o(),x(6,"ya-errors",4,0)(8,"input",13),o()),t&2){let e=K(7),a=h(),n=h();ae("error",D(1,8,e.invalid$)),g("label",n.parameter.name),c(2),b(n.parameter.type!=null&&n.parameter.type.unitSet?2:-1),c(),b((n.parameter.type==null?null:n.parameter.type.signed)===!1?3:-1),c(2),X(n.parameter.type==null?null:n.parameter.type.engType),c(),g("controlName",a),c(2),g("formControlName",a)}}function Av(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Mv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Rv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Lv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Iv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Ov(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Nv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Vv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Fv(t,i){t&1&&p(0," Setting array values via this website is not currently supported. ")}function Bv(t,i){t&1&&(l(0,"ya-meta"),p(1),T(2,"units"),o()),t&2&&(c(),X(D(2,1,i)))}function $v(t,i){if(t&1&&(l(0,"ya-field",3),T(1,"async"),C(2,Bv,3,3,"ya-meta"),l(3,"ya-meta"),p(4),o(),x(5,"ya-errors",4,0)(7,"input",13),o()),t&2){let e,a=K(6),n=h(),r=h();ae("error",D(1,7,a.invalid$)),g("label",r.parameter.name),c(2),b((e=r.parameter.type==null?null:r.parameter.type.unitSet)?2:-1,e),c(2),X(r.parameter.type==null?null:r.parameter.type.engType),c(),g("controlName",n),c(2),g("formControlName",n)}}function Hv(t,i){if(t&1&&(H(0,1),C(1,bv,9,8,"ya-field",2)(2,xv,13,13,"ya-field",2)(3,Sv,7,8,"ya-field",2)(4,wv,7,8,"ya-field",2)(5,Dv,6,2,"ya-field",3)(6,kv,9,10,"ya-field",2)(7,Av,1,0)(8,Mv,1,0)(9,Rv,1,0)(10,Lv,1,0)(11,Iv,1,0)(12,Ov,1,0)(13,Nv,1,0)(14,Vv,1,0)(15,Fv,1,0)(16,$v,8,9,"ya-field",2),Y()),t&2){let e,a=h();g("formGroup",a.formGroup),c(),b((e=a.parameter.type==null?null:a.parameter.type.engType)==="enumeration"?1:e==="boolean"?2:e==="time"?3:e==="binary"?4:e==="aggregate"?5:e==="integer"?6:e==="float[]"?7:e==="double[]"?8:e==="integer[]"?9:e==="enumeration[]"?10:e==="string[]"?11:e==="boolean[]"?12:e==="time[]"?13:e==="binary[]"?14:e==="aggregate[]"?15:16)}}var qi=class qi{constructor(){this.controlName$=new G(null)}ngOnInit(){this.parent?this.controlName$.next(this.parent+"."+this.parameter.name):this.controlName$.next(this.parameter.name)}};qi.\u0275fac=function(e){return new(e||qi)},qi.\u0275cmp=N({type:qi,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},decls:2,vars:3,consts:[["err",""],[3,"formGroup"],[3,"label","error"],[3,"label"],[3,"controlName"],[3,"formControlName"],[3,"id","label"],[1,"radio-group"],[1,"radio"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[1,"members"],[3,"parameter","formGroup","parent"],["type","text",3,"formControlName"]],template:function(e,a){if(e&1&&(C(0,Hv,17,2,"ng-container",1),T(1,"async")),e&2){let n;b((n=D(1,1,a.controlName$))?0:-1,n)}},dependencies:[qi,$,$e,As,pe,ve,ye,Se,$s,wt,Ys,ke,Br,oa,it,ie,ci],styles:[".members[_ngcontent-%COMP%]{margin-top:5px;padding-left:10px}"],changeDetection:0});var vl=qi;var Vn=class Vn{constructor(i,e){this.dialogRef=i;this.data=e;this.form=new ut({});this.parameter=e.parameter;let a=this.getValidatorsForType(this.parameter.type);this.parameter.type.engType==="aggregate"?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new ne(null,a))}addMemberControls(i,e){for(let a of e)if(a.type.engType==="aggregate")this.addMemberControls(i+a.name+".",a.type.member||[]);else{let n=i+a.name,r=this.getValidatorsForType(a.type);this.form.addControl(n,new ne("",r))}}getValidatorsForType(i){let e=[Ce.required];return i.engType==="integer"?(e.push(Lr.requireInteger),i.signed===!1&&e.push(Lr.requireUnsigned)):i.engType==="float"&&e.push(Lr.requireFloat),e}setValue(){let i=this.toValue("",this.parameter);this.dialogRef.close(i)}toValue(i,e){let a=this.form.value[i+e.name];switch(e.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:a==="true"};case"float":return{type:"FLOAT",floatValue:a};case"double":return{type:"DOUBLE",doubleValue:a};case"enumeration":return{type:"STRING",stringValue:a};case"integer":return{type:"SINT32",sint32Value:a};case"string":return{type:"STRING",stringValue:a};case"time":return{type:"TIMESTAMP",stringValue:B.toISOString(a)};case"binary":return{type:"BINARY",binaryValue:B.convertHexToBase64(a)};case"aggregate":let n=[],r=[];for(let s of e.type.member||[])n.push(s.name),r.push(this.toValue(i+e.name+".",s));return{type:"AGGREGATE",aggregateValue:{name:n,value:r}};default:throw new Error(`Unexpected type: ${e.type.engType}`)}}};Vn.\u0275fac=function(e){return new(e||Vn)(S(Re),S(He))},Vn.\u0275cmp=N({type:Vn,selectors:[["app-set-parameter-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),p(1,"Set parameter value"),o(),l(2,"mat-dialog-content")(3,"form",1),x(4,"app-parameter-form",2),o()(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),p(7,"CANCEL"),o(),l(8,"ya-button",5),E("click",function(){return a.setValue()}),p(9,"SET"),o()()),e&2&&(c(3),g("formGroup",a.form),c(),g("parameter",a.parameter)("formGroup",a.form),c(4),g("disabled",!a.form.valid))},dependencies:[vl,$,Ke,ve,ye,Ie,lt,Ne,Oe,me],encapsulation:2});var yl=Vn;var lr=t=>({c:t}),Yv=(t,i)=>({c:t,system:i}),Gv=t=>["/mdb/parameters",t];function Uv(t,i){if(t&1&&(l(0,"a",14),p(1),o()),t&2){let e=h().$implicit,a=h(3);g("queryParams",Ei(2,Yv,a.yamcs.context,e.path)),c(),O(" ",e.name," ")}}function qv(t,i){if(t&1&&(C(0,Uv,2,5,"a",14),p(1," / ")),t&2){let e=i.$index;b(e!==0?0:-1)}}function jv(t,i){if(t&1&&(le(0,qv,2,1,null,null,oe),T(2,"parents"),l(3,"span"),p(4),T(5,"shortName"),T(6,"async"),o(),x(7,"ya-title-copy",13),T(8,"async")),t&2){let e=h(),a=h();se(D(2,3,e.qualifiedName)),c(4),Qt("",D(5,5,e.qualifiedName),"",D(6,7,a.offset$)),c(3),g("text",e.qualifiedName+(D(8,9,a.offset$)||""))}}function zv(t,i){if(t&1){let e=F();l(0,"ya-page-button",15),E("clicked",function(){k(e);let n=h(2);return A(n.setParameter())}),p(1,"Set value"),o()}}function Wv(t,i){if(t&1&&(l(0,"ya-page-button",7),p(1," View in MDB "),o()),t&2){let e=h(),a=h();g("routerLink",Q(2,Gv,e.qualifiedName))("queryParams",Q(4,lr,a.yamcs.context))}}function Xv(t,i){if(t&1&&(l(0,"a",16,2),p(2," Chart "),o()),t&2){let e=K(1),a=h(2);ae("active",e.isActive),g("queryParams",Q(3,lr,a.yamcs.context))}}function Zv(t,i){if(t&1&&(l(0,"a",17,3),p(2," Alarm history "),o()),t&2){let e=K(1),a=h(2);ae("active",e.isActive),g("queryParams",Q(3,lr,a.yamcs.context))}}function Qv(t,i){if(t&1&&(l(0,"a",18,4),p(2," Historical data "),o()),t&2){let e=K(1),a=h(2);ae("active",e.isActive),g("queryParams",Q(3,lr,a.yamcs.context))}}function Kv(t,i){if(t&1&&(l(0,"ya-instance-page")(1,"ya-instance-toolbar"),I(2,jv,9,11,"ng-template",5),C(3,zv,2,0,"ya-page-button",6),T(4,"async"),C(5,Wv,2,6,"ya-page-button",7),o(),l(6,"ya-page-tabs",null,0)(8,"a",8,1),p(10," Summary "),o(),C(11,Xv,3,5,"a",9),C(12,Zv,3,5,"a",10),C(13,Qv,3,5,"a",11),o(),l(14,"div",12),x(15,"router-outlet"),o()()),t&2){let e=K(7),a=K(9),n=h();c(3),b(n.isWritable()&&n.maySetParameter()&&!D(4,10,n.offset$)?3:-1),c(2),b(n.mayReadMissionDatabase()?5:-1),c(3),ae("active",a.isActive),g("queryParams",Q(12,lr,n.yamcs.context)),c(3),b(n.config.tmArchive?11:-1),c(),b(n.mayReadAlarms()?12:-1),c(),b(n.config.tmArchive?13:-1),c(),ae("noscroll",e.selectedIndex===1)}}var Fn=class Fn{constructor(i,e,a,n,r,s,d){this.yamcs=i;this.authService=e;this.messageService=a;this.dialog=n;this.title=r;this.formatter=s;this.qualifiedName=ot.required({alias:"parameter"});this.parameter$=new G(null);this.offset$=new G(null);this.parameterValue$=new G(null);this.config=d.getConfig()}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.updateTitle()}).catch(e=>{this.messageService.showError(e)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{this.parameterValue$.next(e.values?e.values[0]:null),this.updateTitle()})}updateTitle(){let i=this.parameter$.getValue(),e=this.offset$.getValue();if(i){let a=i.name;e&&(a+=e);let n=this.parameterValue$.getValue();n?.engValue&&(a+=": "+this.formatter.formatValue(n.engValue),i.type&&i.type.unitSet&&(a+=" "+B.getUnits(i.type.unitSet)),n.rangeCondition&&n.rangeCondition==="LOW"?a+=" \u2193":n.rangeCondition&&n.rangeCondition==="HIGH"&&(a+=" \u2191")),this.title.setTitle(a)}}isWritable(){let i=this.parameter$.value;return i?i.dataSource==="LOCAL"||i.dataSource==="EXTERNAL1"||i.dataSource==="EXTERNAL2"||i.dataSource==="EXTERNAL3":!1}maySetParameter(){let i=this.parameter$.value;return i?this.authService.getUser().hasObjectPrivilege("WriteParameter",i.qualifiedName):!1}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){let i=this.parameter$.value;this.dialog.open(yl,{width:"600px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(a=>{a&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,i.qualifiedName,a).catch(n=>this.messageService.showError(n))})}ngOnDestroy(){this.parameterValueSubscription?.cancel()}};Fn.\u0275fac=function(e){return new(e||Fn)(S(W),S(St),S(Je),S(Le),S(Mt),S(aa),S(we))},Fn.\u0275cmp=N({type:Fn,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},features:[Gt],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["rlb","routerLinkActive"],["rlc","routerLinkActive"],["rld","routerLinkActive"],["ya-instance-toolbar-label",""],["icon","edit"],["icon","auto_stories",3,"routerLink","queryParams"],["routerLink","-/summary","routerLinkActive","",3,"queryParams"],["routerLink","-/chart","routerLinkActive","",3,"active","queryParams"],["routerLink","-/alarms","routerLinkActive","",3,"active","queryParams"],["routerLink","-/data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"],[3,"text"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],["icon","edit",3,"clicked"],["routerLink","-/chart","routerLinkActive","",3,"queryParams"],["routerLink","-/alarms","routerLinkActive","",3,"queryParams"],["routerLink","-/data","routerLinkActive","",3,"queryParams"]],template:function(e,a){if(e&1&&(C(0,Kv,16,14,"ya-instance-page"),T(1,"async")),e&2){let n;b((n=D(1,1,a.parameter$))?0:-1,n)}},dependencies:[$,_i,Ee,Zi,et,tt,li,vt,la,Ws,ie,Js,Ur],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0});var Cl=Fn;var Jv=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{packet:new Sl(a,{})}}},ey=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{parameter:new Sl(a,{})}}},RA=[{path:"",canActivate:[El,Pl],canActivateChild:[kl],runGuardsAndResolvers:"always",component:ac,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:Co,children:[{path:"**",component:go}]},{path:"displays/files",component:yo,providers:[Yn],children:[{path:"**",component:mo,canDeactivate:[pc],data:{showRangeSelector:!0}}]},{path:"packets",children:[{path:"",pathMatch:"full",component:Do,resolve:{parseFilterSubscription:hc}},{path:"queries",component:Eo},{matcher:Jv,children:[{path:"-/log/:gentime/:seqno",component:ko}]}]},{path:"parameters",children:[{path:"",pathMatch:"full",component:Oo,title:"Parameters"},{matcher:ey,component:Cl,children:[{path:"",pathMatch:"full",redirectTo:"-/summary"},{path:"-/summary",component:gl},{path:"-/chart",component:cl},{path:"-/data",component:hl},{path:"-/alarms",component:Go}]}]},{path:"parameter-lists",pathMatch:"full",component:Lo},{path:"parameter-lists/create",pathMatch:"full",component:Ao},{path:"parameter-lists/:list",component:Fo,children:[{path:"",pathMatch:"full",redirectTo:"realtime"},{path:"realtime",component:Vo},{path:"data",component:Ro}]},{path:"parameter-lists/:list/edit",pathMatch:"full",component:Mo},{path:"ext",canActivate:[El,Pl],canActivateChild:[kl],runGuardsAndResolvers:"always",children:[{matcher:ic,component:tc}]}]}];export{RA as ROUTES};
