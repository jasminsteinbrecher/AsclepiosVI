import{a as gn}from"./chunk-WGTQMYTO.js";import{a as Vo}from"./chunk-NFMEVCL3.js";import{a as Uo}from"./chunk-TRW3DCW5.js";import"./chunk-IGBCSVEE.js";import"./chunk-GVFSCYYF.js";import{$a as Ka,$f as bt,Aa as V,B as Ya,Bc as $e,Bf as he,Bg as He,C as je,Ca as D,Cb as P,Cc as Ie,Cf as wo,Cg as Po,D as Ve,Db as io,De as ho,Dg as R,Ea as u,F as I,Fa as mn,Fb as no,Fc as Ae,Fg as Pe,Fh as T,G as A,Ga as Nt,Gb as j,Gg as ko,Gh as Bo,Ha as qa,Hb as St,Hg as vn,Hh as jo,Ia as se,Ib as te,If as lt,Ig as Lo,Ja as re,Jb as ie,Je as Vt,Jf as Eo,Jg as $o,K as tn,Ka as le,Kb as ao,Ke as vo,Kf as w,La as Wa,Lf as Oe,Ma as Qa,Me as Cn,N as nn,Na as ve,Ne as So,Ng as Sn,O as Oa,Oa as za,Pa as fe,Pc as Ze,Pe as bo,Pg as Fo,R as Ha,Ra as o,Rc as _e,Rf as Mo,S as an,Sa as C,Se as Fe,Sf as Ht,T as on,Ta as y,Tc as De,Te as go,Tf as Gt,Ua as ct,Uc as pt,Ue as yo,Ug as at,V as l,Va as Ia,Ve as xo,Vg as Tt,Wc as po,We as O,Xa as Za,Xc as uo,Xe as Se,Y as p,Ya as qe,Ye as q,Yf as Re,Za as ge,Ze as K,Zg as xe,_ as x,_a as dt,_e as ne,aa as Ga,af as W,ba as rn,bb as _,be as en,bf as J,bg as nt,bh as No,ca as ht,cb as S,cd as fo,cg as ye,da as d,db as Ue,dc as oo,dd as _o,df as Q,e as ja,eb as Ja,ef as ae,eg as gt,f as H,fa as Xi,gc as ro,gf as X,gg as Io,hc as lo,hf as ee,hh as bn,ib as Le,ja as ln,jb as Xa,jc as mo,jf as z,k as Ee,ka as h,kf as G,la as We,lc as so,lf as Ce,m as Va,ma as v,mf as hn,mg as yt,n as Ua,na as $,ne as pn,nf as Ut,ng as Ao,oa as F,ob as vt,oc as Qe,oe as Ke,og as Ne,pa as N,pb as Bt,pe as Ye,qa as c,qc as ut,qe as Je,ra as a,rb as eo,re as Xe,rf as To,sa as n,sb as U,sc as me,se as et,ta as s,tb as sn,tc as Me,te as tt,tf as Do,ua as wt,uc as cn,ue as it,uf as Yt,va as Et,vc as co,ve as dn,vf as Ot,wb as to,wc as Mt,we as Co,wg as Ro,xa as b,xc as Z,xe as un,ya as g,yb as jt,yc as ze,ye as fn,yg as xt,z as st,za as Ma,ze as _n}from"./chunk-OXOWQRWE.js";var Yo=(t,i)=>Ve(Aa).canActivate(t,i);var It=class It{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("web.AccessAdminArea")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}};It.\u0275fac=function(e){return new(e||It)(je(Oe),je(te))},It.\u0275prov=st({token:It,factory:It.\u0275fac,providedIn:"root"});var Aa=It;var Ge=(t,i)=>Ve(Ra).canActivate(t,i);var At=class At{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("ControlAccess")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}};At.\u0275fac=function(e){return new(e||At)(je(Oe),je(te))},At.\u0275prov=st({token:At,factory:At.\u0275fac,providedIn:"root"});var Ra=At;var ka=(t,i)=>Ve(Pa).canActivate(t,i);var Rt=class Rt{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("ControlArchiving")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}};Rt.\u0275fac=function(e){return new(e||Rt)(je(Oe),je(te))},Rt.\u0275prov=st({token:Rt,factory:Rt.\u0275fac,providedIn:"root"});var Pa=Rt;var Oo=(t,i)=>Ve(La).canActivate(t,i);var Pt=class Pt{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("ControlServices")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}};Pt.\u0275fac=function(e){return new(e||Pt)(je(Oe),je(te))},Pt.\u0275prov=st({token:Pt,factory:Pt.\u0275fac,providedIn:"root"});var La=Pt;var ft=(t,i)=>Ve($a).canActivate(t,i);var kt=class kt{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("ReadSystemInfo")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}};kt.\u0275fac=function(e){return new(e||kt)(je(Oe),je(te))},kt.\u0275prov=st({token:kt,factory:kt.\u0275fac,providedIn:"root"});var $a=kt;var Xo=[[["app-admin-toolbar"]],[["ya-detail-pane"]],"*"],er=["app-admin-toolbar","ya-detail-pane","*"],qt=class qt{constructor(){this.noscroll=!1}};qt.\u0275fac=function(e){return new(e||qt)},qt.\u0275cmp=x({type:qt,selectors:[["app-admin-page"]],inputs:{noscroll:"noscroll"},ngContentSelectors:er,decls:4,vars:2,consts:[[1,"page-content"]],template:function(e,r){e&1&&(mn(Xo),Nt(0),wt(1,"div",0),Nt(2,1),Nt(3,2),Et()),e&2&&(l(),za("overflow",r.noscroll?"hidden":"auto"))},dependencies:[T],styles:[".page-content[_ngcontent-%COMP%]{position:absolute;inset:49px 0 0;overflow:auto;font:400 12px/20px Roboto,sans-serif}"],changeDetection:0});var k=qt;var Fa=new Ya("APP_ADMIN_TOOLBAR"),Lt=class Lt extends ro{constructor(){super(...arguments);this._closestToolbar=Ve(Fa,{optional:!0})}};Lt.\u0275fac=(()=>{let e;return function(m){return(e||(e=Oa(Lt)))(m||Lt)}})(),Lt.\u0275dir=Ga({type:Lt,selectors:[["","app-admin-toolbar-label",""]],features:[ht]});var ke=Lt;var tr=["*"];function ir(t,i){}function nr(t,i){if(t&1&&d(0,ir,0,0,"ng-template",1),t&2){let e=u();c("cdkPortalOutlet",e.templateLabel)}}function ar(t,i){if(t&1&&o(0),t&2){let e=u();y(" ",e.textLabel()," ")}}var $t=class $t{constructor(){this.textLabel=Le(void 0,{alias:"label"})}get templateLabel(){return this._templateLabel}set templateLabel(i){i&&i._closestToolbar===this&&(this._templateLabel=i)}};$t.\u0275fac=function(e){return new(e||$t)},$t.\u0275cmp=x({type:$t,selectors:[["app-admin-toolbar"]],contentQueries:function(e,r,m){if(e&1&&qa(m,ke,5),e&2){let f;re(f=le())&&(r.templateLabel=f.first)}},hostAttrs:[1,"app-instance-toolbar"],inputs:{textLabel:[1,"label","textLabel"]},features:[Za([{provide:Fa,useExisting:$t}])],ngContentSelectors:tr,decls:5,vars:1,consts:[[1,"app-admin-toolbar-label"],[3,"cdkPortalOutlet"],[1,"app-admin-toolbar-content"]],template:function(e,r){e&1&&(mn(),a(0,"div",0),h(1,nr,1,1,null,1)(2,ar,1,1),n(),a(3,"div",2),Nt(4),n()),e&2&&(l(),v(r.templateLabel?1:2))},dependencies:[lo,T],styles:["[_nghost-%COMP%]{display:flex;align-items:center;min-height:48px;font-weight:400;border-bottom:1px solid rgba(0,0,0,.1);background-color:var(--y-background-color);box-sizing:content-box;padding:0 16px 0 24px;font:400 20px/28px Roboto,sans-serif;letter-spacing:.25px}.app-admin-toolbar-label[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:48px}.app-admin-toolbar-content[_ngcontent-%COMP%]{display:inline-flex;align-items:center;column-gap:8px}.icon-action[_ngcontent-%COMP%]{display:flex;align-items:center}"],changeDetection:0});var L=$t;var or=()=>["detail"];function rr(t,i){if(t&1){let e=V();s(0,"ya-date-time-input",4)(1,"ya-date-time-input",5),a(2,"ya-button",6),D("click",function(){I(e);let m=u();return A(m.applyCustomDates())}),o(3,"Apply"),n()}if(t&2){let e=u();l(2),c("disabled",e.filterForm.invalid)}}function lr(t,i){if(t&1){let e=V();a(0,"ya-button",7),D("click",function(){I(e);let m=u();return A(m.jumpToNow())}),o(1,"Jump to now"),n()}}function mr(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.item.time.substring(11,16)," ")}}function sr(t,i){if(t&1&&(a(0,"td",22),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.item.user||"-"," ")}}function cr(t,i){if(t&1&&(a(0,"td",23),s(1,"ya-action-log-summary",24),n()),t&2){let e=i.$implicit;l(),c("text",e.item.summary)}}function pr(t,i){t&1&&(a(0,"mat-icon"),o(1,"expand_less"),n())}function dr(t,i){t&1&&(a(0,"mat-icon"),o(1,"expand_more"),n())}function ur(t,i){if(t&1&&(a(0,"td",25),h(1,pr,2,0,"mat-icon")(2,dr,2,0,"mat-icon"),n()),t&2){let e=i.$implicit;l(),v(e.expanded?1:2)}}function fr(t,i){if(t&1&&(a(0,"dt",28),o(1),n(),a(2,"dd"),o(3),n()),t&2){let e=i.$implicit;l(),C(e.key),l(2),C(e.value||"")}}function _r(t,i){if(t&1&&(a(0,"td",26)(1,"dl",27)(2,"dt"),o(3,"Service"),n(),a(4,"dd"),o(5),n(),a(6,"dt"),o(7,"Method"),n(),a(8,"dd"),o(9),n(),F(10,fr,4,2,null,null,$),n()()),t&2){let e=i.$implicit,r=u(2);ln("colspan",r.displayedColumns.length),l(5),C(e.item.service),l(4),C(e.item.method),l(),N(e.requestOptions)}}function Cr(t,i){if(t&1){let e=V();a(0,"tr",29),D("click",function(){let m=I(e).$implicit;return A(m.expanded=!m.expanded)}),n()}if(t&2){let e=i.$implicit;fe("expanded",e.expanded)}}function hr(t,i){if(t&1){let e=V();a(0,"tr",30),D("click",function(){let m=I(e).$implicit;return A(m.expanded=!m.expanded)}),n()}if(t&2){let e=i.$implicit;fe("expanded",e.expanded)}}function vr(t,i){if(t&1&&(a(0,"h4"),o(1),n(),a(2,"table",8),b(3,9),d(4,mr,2,1,"td",10),g(),b(5,11),d(6,sr,2,1,"td",12),g(),b(7,13),d(8,cr,2,1,"td",14),g(),b(9,15),d(10,ur,3,1,"td",16),g(),b(11,17),d(12,_r,12,3,"td",18),g(),d(13,Cr,1,2,"tr",19)(14,hr,1,2,"tr",20),n()),t&2){let e=i.$implicit,r=i.$index,m=u();fe("first",r===0),l(),C(e.grouper),l(),c("dataSource",e.dataSource),l(11),c("matRowDefColumns",m.displayedColumns),l(),c("matRowDefColumns",qe(6,or))}}function Sr(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No actions for the current filter criteria."),n())}var yn="NO_LIMIT",Wt=class Wt{constructor(i,e,r,m,f){this.yamcs=i;this.router=e;this.route=r;this.messageService=m;this.filter=Le();this.interval=Le();this.customStart=Le();this.customStop=Le();this.filterForm=new cn({filter:new Mt(null),interval:new Mt(yn),customStart:new Mt(null),customStop:new Mt(null)});this.displayedColumns=["time","user","summary","actions"];this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}];this.rowGroups$=new H([]);f.setTitle("Admin area")}ngOnInit(){this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.pipe(Ua(400)).forEach(i=>{this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(i=>{if(i==="CUSTOM"){let e=new Date,r=this.validStart||e,m=this.validStop||e;this.filterForm.get("customStart").setValue(lt.toISOString(r)),this.filterForm.get("customStop").setValue(lt.toISOString(m))}else i==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=i,this.loadData()):i&&(this.validStop=new Date,this.validStart=lt.subtractDuration(this.validStop,i),this.appliedInterval=i,this.loadData())})}initializeOptions(){if(this.filter()){let i=this.filter();this.filterForm.get("filter").setValue(i)}if(this.interval())if(this.appliedInterval=this.interval(),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let i=this.customStart();this.filterForm.get("customStart").setValue(i),this.validStart=lt.toDate(i);let e=this.customStop();this.filterForm.get("customStop").setValue(e),this.validStop=lt.toDate(e)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=lt.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=yn,this.validStop=null,this.validStart=null}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(yn):i==="CUSTOM"?this.filterForm.get("interval").setValue(yn):i&&(this.validStop=new Date,this.validStart=lt.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){let{controls:i}=this.filterForm;this.validStart=lt.toDate(i.customStart.value),this.validStop=lt.toDate(i.customStop.value),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.filterForm.controls.filter.value&&(i.q=this.filterForm.controls.filter.value);let e=new Date().toISOString().substring(0,10),r=lt.subtractDuration(new Date,"P1D").toISOString().substring(0,10);this.yamcs.yamcsClient.getAuditRecords("_global",i).then(m=>{let f=this.groupByDay(m.records||[]).map(E=>{let Te=new G;Te.data=E.map(be=>{let ue=[{key:"Request",value:""}];return be.request&&this.flatten(be.request,ue,"    "),{item:be,expanded:!1,requestOptions:ue}});let de=E[0].time.substring(0,10);return de===e?de="Today":de===r&&(de="Yesterday"),{grouper:de,dataSource:Te}});this.rowGroups$.next(f)}).catch(m=>this.messageService.showError(m))}loadMoreData(){}updateURL(){let{controls:i}=this.filterForm;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i.filter.value||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?i.customStart.value:null,customStop:this.appliedInterval==="CUSTOM"?i.customStop.value:null},queryParamsHandling:"merge"})}groupByDay(i){let e=[],r,m=[];for(let f of i){let E=f.time.substring(0,10);E!==r&&(r=E,m.length&&(e.push(m),m=[])),m.push(f)}return m.length&&e.push(m),e}flatten(i,e,r=""){for(let m in i){let f=i[m];if(Array.isArray(f)){e.push({key:r+m,value:""});for(let E=0;E<f.length;E++)e.push({key:r+"    "+m+" "+(E+1),value:f[E]})}else typeof f=="object"?(e.push({key:r+m,value:""}),this.flatten(f,e,r+"    ")):e.push({key:r+m,value:""+f})}}};Wt.\u0275fac=function(e){return new(e||Wt)(p(w),p(te),p(j),p(Ce),p(P))},Wt.\u0275cmp=x({type:Wt,selectors:[["ng-component"]],inputs:{filter:[1,"filter"],interval:[1,"interval"],customStart:[1,"customStart"],customStop:[1,"customStop"]},decls:13,vars:8,consts:[["label","Action log"],[3,"formGroup"],["formControlName","filter","placeholder","Filter by text search"],["icon","access_time","formControlName","interval",3,"options"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table",2,"border-top","1px solid rgba(0, 0, 0, 0.1)",3,"dataSource"],["matColumnDef","time"],["mat-cell","","style","width: 100px",4,"matCellDef"],["matColumnDef","user"],["mat-cell","","style","width: 200px",4,"matCellDef"],["matColumnDef","summary"],["mat-cell","","style","width: 400px",4,"matCellDef"],["matColumnDef","actions"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","detail"],["mat-cell","",4,"matCellDef"],["mat-row","","class","item-row",3,"expanded","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","item-detail",3,"expanded","click",4,"matRowDef","matRowDefColumns"],["mat-cell","",2,"width","100px"],["mat-cell","",2,"width","200px"],["mat-cell","",2,"width","400px"],[3,"text"],["mat-cell","",2,"text-align","right"],["mat-cell",""],[1,"dl-horizontal"],[2,"white-space","pre"],["mat-row","",1,"item-row",3,"click"],["mat-row","",1,"item-detail",3,"click"]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"ya-filter-bar",1),s(4,"ya-search-filter",2)(5,"ya-select",3),h(6,rr,4,1)(7,lr,2,0,"ya-button"),n(),F(8,vr,15,7,null,null,$),_(10,"async"),h(11,Sr,2,0,"ya-empty-message"),_(12,"async"),n()()),e&2&&(l(3),c("formGroup",r.filterForm),l(2),c("options",r.intervalOptions),l(),v(r.filterForm.value.interval==="CUSTOM"?6:7),l(2),N(S(10,4,r.rowGroups$)),l(3),v(S(12,6,r.rowGroups$).length?-1:11))},dependencies:[k,L,T,me,Me,Ie,Ae,_e,q,W,K,X,Q,z,To,he,Mo,Re,ye,R,Pe,vn,U],styles:["h4[_ngcontent-%COMP%]{margin-top:2em;margin-bottom:.5em;font-size:12px}h4.first[_ngcontent-%COMP%]{margin-top:0}tr.item-row.expanded[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:none}tr.item-detail[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:40px!important}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}tr.item-detail[_ngcontent-%COMP%]:not(.expanded){display:none}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{border-right:1px solid #e5e5e5}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%], .dl-horizontal[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{line-height:20px}.dl-horizontal[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{min-height:20px}.ya-data-table[_ngcontent-%COMP%]   tr.mat-mdc-row[_ngcontent-%COMP%]:hover{background:inherit}"],changeDetection:0});var xn=Wt;function br(t,i){t&1&&(a(0,"th",11),o(1,"Name"),n())}function gr(t,i){if(t&1&&(a(0,"td",12)(1,"a",13),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),y(" ",e.name," ")}}function yr(t,i){t&1&&(a(0,"th",11),o(1,"Tablespace"),n())}function xr(t,i){if(t&1&&(a(0,"td",12),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.tablespace," ")}}function Tr(t,i){t&1&&(a(0,"th",11),o(1,"Path"),n())}function Dr(t,i){if(t&1&&(a(0,"td",12),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.path," ")}}function wr(t,i){t&1&&s(0,"th",14)}function Er(t,i){t&1&&s(0,"td",12)}function Mr(t,i){t&1&&s(0,"tr",15)}function Ir(t,i){t&1&&s(0,"tr",16)}var Qt=class Qt{constructor(i,e,r){this.yamcs=i;this.displayedColumns=["name","tablespace","path","actions"];this.dataSource=new G;e.setTitle("Databases"),i.yamcsClient.getDatabases().then(m=>{this.dataSource.data=m}).catch(m=>r.showError(m))}ngAfterViewInit(){this.dataSource.sort=this.sort}};Qt.\u0275fac=function(e){return new(e||Qt)(p(w),p(P),p(Ce))},Qt.\u0275cmp=x({type:Qt,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:18,vars:3,consts:[["label","Databases"],["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","tablespace"],["matColumnDef","path"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"table",1),b(4,2),d(5,br,2,0,"th",3)(6,gr,3,2,"td",4),g(),b(7,5),d(8,yr,2,0,"th",3)(9,xr,2,1,"td",4),g(),b(10,6),d(11,Tr,2,0,"th",3)(12,Dr,2,1,"td",4),g(),b(13,7),d(14,wr,1,0,"th",8)(15,Er,1,0,"td",4),g(),d(16,Mr,1,0,"tr",9)(17,Ir,1,0,"tr",10),n()()()),e&2&&(l(3),c("dataSource",r.dataSource),l(13),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[k,L,T,ie,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,R],encapsulation:2,changeDetection:0});var Tn=Qt;var Ar=t=>["/admin/databases",t],Ho=t=>["/admin/databases",t,"tables"],Go=t=>["/admin/databases",t,"streams"],Rr=t=>["/admin/databases",t,"parameter-archive"],Pr=(t,i)=>["/admin/databases",t,"tables",i,"info"],kr=(t,i)=>["/admin/databases",t,"tables",i,"data"],Lr=(t,i)=>["/admin/databases",t,"tables",i,"script"],$r=(t,i)=>["/admin/databases",t,"streams",i,"columns"],Fr=(t,i)=>["/admin/databases",t,"streams",i,"data"],Nr=(t,i)=>["/admin/databases",t,"streams",i,"script"];function Br(t,i){if(t&1&&(a(0,"a",13),o(1," Tables "),n()),t&2){let e=u(3);c("routerLink",ge(1,Ho,e.name))}}function jr(t,i){if(t&1&&(a(0,"a",13),o(1," Streams "),n()),t&2){let e=u(3);c("routerLink",ge(1,Go,e.name))}}function Vr(t,i){if(t&1&&(a(0,"mat-icon",12),o(1,"navigate_next"),n(),h(2,Br,2,3,"a",13),h(3,jr,2,3,"a",13),a(4,"mat-icon",12),o(5,"navigate_next"),n(),o(6)),t&2){let e=i;l(2),v(e.type==="table"?2:-1),l(),v(e.type==="stream"?3:-1),l(3),y(" ",e.name," ")}}function Ur(t,i){if(t&1&&(s(0,"ya-page-icon-button",11),a(1,"mat-icon",12),o(2,"navigate_next"),n(),a(3,"a",13),o(4),n(),h(5,Vr,7,3),_(6,"async")),t&2){let e,r=u(),m=u();l(3),c("routerLink",ge(5,Ar,r.name)),l(),y(" ",r.name," "),l(),v((e=S(6,3,m.object$))?5:-1,e)}}function Yr(t,i){if(t&1&&(a(0,"a",14,2),o(2," Parameter archive "),n()),t&2){let e=ve(1),r=u(2);fe("active",e.isActive),c("routerLink",ge(3,Rr,r.name))}}function Or(t,i){if(t&1&&(a(0,"a",14,0),o(2," Tables "),n(),a(3,"a",14,1),o(5," Streams "),n(),h(6,Yr,3,5,"a",15)),t&2){let e=ve(1),r=ve(4),m=u();fe("active",e.isActive),c("routerLink",ge(7,Ho,m.name)),l(3),fe("active",r.isActive),c("routerLink",ge(9,Go,m.name)),l(3),v(m.name!=="_global"?6:-1)}}function Hr(t,i){if(t&1&&(a(0,"a",14,3),o(2," Info "),n(),a(3,"a",14,4),o(5," Data "),n(),a(6,"a",14,5),o(8," Script "),n()),t&2){let e=ve(1),r=ve(4),m=ve(7),f=u(),E=u();fe("active",e.isActive),c("routerLink",dt(9,Pr,E.name,f.name)),l(3),fe("active",r.isActive),c("routerLink",dt(12,kr,E.name,f.name)),l(3),fe("active",m.isActive),c("routerLink",dt(15,Lr,E.name,f.name))}}function Gr(t,i){if(t&1&&(a(0,"a",14,6),o(2," Columns "),n(),a(3,"a",14,7),o(5," Data "),n(),a(6,"a",14,8),o(8," Script "),n()),t&2){let e=ve(1),r=ve(4),m=ve(7),f=u(),E=u();fe("active",e.isActive),c("routerLink",dt(9,$r,E.name,f.name)),l(3),fe("active",r.isActive),c("routerLink",dt(12,Fr,E.name,f.name)),l(3),fe("active",m.isActive),c("routerLink",dt(15,Nr,E.name,f.name))}}function qr(t,i){if(t&1&&(h(0,Hr,9,18),h(1,Gr,9,18)),t&2){let e=i;v(e.type==="table"?0:-1),l(),v(e.type==="stream"?1:-1)}}function Wr(t,i){if(t&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,Ur,7,7,"ng-template",9),n(),a(3,"ya-page-tabs"),h(4,Or,7,11),_(5,"async"),h(6,qr,2,2),_(7,"async"),n(),a(8,"div",10),s(9,"router-outlet"),n()()),t&2){let e,r=u();l(4),v(S(5,2,r.object$)?-1:4),l(2),v((e=S(7,4,r.object$))?6:-1,e)}}var zt=class zt{constructor(i,e,r,m,f){this.yamcs=r;this.object$=new H(null);this.user=f.getUser(),this.routerSubscription=i.events.subscribe(Te=>{let de=e.snapshot.firstChild,be=de.paramMap.get("table");if(be){this.object$.next({type:"table",name:be});return}if(be=de.paramMap.get("stream"),be){this.object$.next({type:"stream",name:be});return}this.object$.next(null)});let E=e.snapshot.paramMap.get("database");m.setTitle(E),this.database$=r.yamcsClient.getDatabase(E)}ngOnDestroy(){this.routerSubscription?.unsubscribe()}};zt.\u0275fac=function(e){return new(e||zt)(p(te),p(j),p(w),p(P),p(Oe))},zt.\u0275cmp=x({type:zt,selectors:[["ng-component"]],decls:2,vars:3,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["rlc","routerLinkActive"],["rla1","routerLinkActive"],["rla2","routerLinkActive"],["rla3","routerLinkActive"],["rlb1","routerLinkActive"],["rlb2","routerLinkActive"],["rlb3","routerLinkActive"],["app-admin-toolbar-label",""],[1,"outlet-wrapper"],["routerLink","/admin/databases","icon","account_tree"],[1,"icon14","sep"],[1,"ya-link","ya-header-link",3,"routerLink"],["routerLinkActive","",3,"routerLink"],["routerLinkActive","",3,"routerLink","active"]],template:function(e,r){if(e&1&&(h(0,Wr,10,6,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.database$))?0:-1,m)}},dependencies:[k,L,ke,T,St,ie,ao,_e,He,Po,U],styles:[".outlet-wrapper[_ngcontent-%COMP%]{overflow:auto;position:absolute;inset:37px 0 0}.sep[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}"],changeDetection:0});var Dn=zt;function qo(t,i,e,r){let m=i.label+' = ""',f=en(t.state,m,e,r);f.selection={anchor:e+m.length-1},t.dispatch(f)}function wn(t,i,e,r){t.dispatch(en(t.state,i.label+" = ",e,r))}function En(t,i,e,r){t.dispatch(en(t.state,i.label+" = ",e,r))}function Na(t,i,e,r){t.dispatch(en(t.state,i.label+" ",e,r))}var Wo=[{label:"pid",type:"method",info:"Filter by PID",apply:En},{label:"parameter",type:"method",info:"Filter by parameter name",apply:qo},{label:"rawType",type:"method",info:"Filter by raw type",apply:wn},{label:"engType",type:"method",info:"Filter by engineering type",apply:wn},{label:"gid",type:"method",info:"Filter by GID",apply:En},{section:"Exclude PIDs",label:"-pid",type:"method",info:"Exclude based on PID",apply:En},{section:"Exclude PIDs",label:"-parameter",type:"method",info:"Exclude based on parameter name",apply:qo},{section:"Exclude PIDs",label:"-rawType",type:"method",info:"Exclude based on raw type",apply:wn},{section:"Exclude PIDs",label:"-engType",type:"method",info:"Exclude based on engineering type",apply:wn},{section:"Exclude PIDs",label:"-gid",type:"method",info:"Exclude based on GID",apply:En},{section:"Logical operators",label:"AND",type:"constant",apply:Na},{section:"Logical operators",label:"OR",type:"constant",apply:Na},{section:"Logical operators",label:"NOT",type:"constant",apply:Na}];var Qr=["searchFilter"],zr=()=>[];function Zr(t,i){if(t&1){let e=V();o(0," \xA0 "),a(1,"a",17),D("click",function(m){return I(e),u(2),ve(3).doSearch(),A(m.preventDefault())}),o(2," Apply filter "),n(),o(3," . ")}}function Kr(t,i){if(t&1&&(a(0,"ya-table-top"),o(1," The search filter has changed. "),h(2,Zr,4,0),_(3,"async"),n()),t&2){u();let e=ve(3);l(2),v(S(3,1,e.errorState$)?-1:2)}}function Jr(t,i){t&1&&(a(0,"th",18),o(1,"PID"),n())}function Xr(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.pid," ")}}function el(t,i){t&1&&(a(0,"th",18),o(1,"Parameter name"),n())}function tl(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.parameter||"-"," ")}}function il(t,i){t&1&&(a(0,"th",18),o(1,"Raw type"),n())}function nl(t,i){if(t&1&&(a(0,"span",20),o(1),_(2,"lowercase"),n()),t&2){let e=u().$implicit;l(),C(S(2,1,e.rawType))}}function al(t,i){t&1&&o(0," - ")}function ol(t,i){if(t&1&&(a(0,"td",19),h(1,nl,3,3,"span",20)(2,al,1,0),n()),t&2){let e=i.$implicit;l(),v(e.rawType?1:2)}}function rl(t,i){t&1&&(a(0,"th",18),o(1,"Engineering type"),n())}function ll(t,i){if(t&1&&(a(0,"span",20),o(1),_(2,"lowercase"),n()),t&2){let e=u().$implicit;l(),C(S(2,1,e.engType))}}function ml(t,i){t&1&&o(0," - ")}function sl(t,i){if(t&1&&(a(0,"td",19),h(1,ll,3,3,"span",20)(2,ml,1,0),n()),t&2){let e=i.$implicit;l(),v(e.engType?1:2)}}function cl(t,i){t&1&&(a(0,"th",18),o(1,"GIDs"),n())}function pl(t,i){t&1&&o(0," , ")}function dl(t,i){if(t&1&&(o(0),h(1,pl,1,0)),t&2){let e=i.$implicit,r=i.$index,m=i.$count;y(" ",e," "),l(),v(r!==m-1?1:-1)}}function ul(t,i){t&1&&o(0," - ")}function fl(t,i){if(t&1&&(a(0,"td",19),F(1,dl,2,2,null,null,$,!1,ul,1,0),n()),t&2){let e=i.$implicit;l(),N(e.gids||qe(1,zr))}}function _l(t,i){t&1&&s(0,"th",21)}function Cl(t,i){t&1&&s(0,"td",19)}function hl(t,i){t&1&&s(0,"tr",22)}function vl(t,i){t&1&&s(0,"tr",23)}var Zt=class Zt{constructor(i,e){this.yamcs=i;this.messageService=e;this.parseFilterSubscription=Le.required();this.searchFilter=Xa.required("searchFilter");this.completions=Wo;this.displayedColumns=["pid","parameter","rawType","engType","gids","actions"];this.filterForm=new cn({filter:new Mt(null)});this.dataSource=new G;this.continuationToken=tn(void 0)}ngOnInit(){this.parseFilterSubscription().addMessageListener(i=>{i.errorMessage?this.searchFilter().addErrorMark(i.errorMessage,{beginLine:i.beginLine,beginColumn:i.beginColumn,endLine:i.endLine,endColumn:i.endColumn}):this.searchFilter().clearErrorMark()}),this.loadData(),this.filterForm.get("filter").valueChanges.forEach(()=>{this.loadData()})}loadData(i){let{controls:e}=this.filterForm,r={limit:200,next:i},m=e.filter.value;m&&(r.filter=m),this.yamcs.yamcsClient.getParameterArchivePids(this.database,r).then(f=>{i?this.dataSource.data=[...this.dataSource.data,...f.pids||[]]:this.dataSource.data=f.pids||[],this.continuationToken.set(f.continuationToken)}).catch(f=>this.messageService.showError(f))}parseQuery(i){this.parseFilterSubscription().sendMessage({resource:"pids",filter:i})}ngOnDestroy(){this.parseFilterSubscription().cancel()}};Zt.\u0275fac=function(e){return new(e||Zt)(p(w),p(Ce))},Zt.\u0275cmp=x({type:Zt,selectors:[["ng-component"]],viewQuery:function(e,r){e&1&&Wa(r.searchFilter,Qr,5),e&2&&Qa()},inputs:{database:"database",parseFilterSubscription:[1,"parseFilterSubscription"]},decls:29,vars:8,consts:[["searchFilter",""],[1,"query",3,"formGroup"],["formControlName","filter","placeholder","Search PIDs",2,"flex","1 1 auto",3,"typedValue","completions","expanded"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","pid"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","parameter"],["matColumnDef","rawType"],["matColumnDef","engType"],["matColumnDef","gids"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["appearance","bottom","align","center"],[3,"click","disabled"],["href","",1,"ya-link",3,"click"],["mat-header-cell",""],["mat-cell",""],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){if(e&1){let m=V();a(0,"ya-panel")(1,"ya-filter-bar",1)(2,"ya-search-filter2",2,0),D("typedValue",function(E){return I(m),A(r.parseQuery(E))}),n()(),h(4,Kr,4,3,"ya-table-top"),a(5,"table",3),b(6,4),d(7,Jr,2,0,"th",5)(8,Xr,2,1,"td",6),g(),b(9,7),d(10,el,2,0,"th",5)(11,tl,2,1,"td",6),g(),b(12,8),d(13,il,2,0,"th",5)(14,ol,3,1,"td",6),g(),b(15,9),d(16,rl,2,0,"th",5)(17,sl,3,1,"td",6),g(),b(18,10),d(19,cl,2,0,"th",5)(20,fl,4,2,"td",6),g(),b(21,11),d(22,_l,1,0,"th",12)(23,Cl,1,0,"td",6),g(),d(24,hl,1,0,"tr",13)(25,vl,1,0,"tr",14),n(),a(26,"ya-toolbar",15)(27,"ya-button",16),D("click",function(){return I(m),A(r.loadData(r.continuationToken()))}),o(28," Load more "),n()()()}if(e&2){let m=ve(3);l(),c("formGroup",r.filterForm),l(),c("completions",r.completions)("expanded",!1),l(2),v(m.dirty()?4:-1),l(),c("dataSource",r.dataSource),l(19),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(2),c("disabled",!r.continuationToken())}},dependencies:[T,me,Me,Ie,Ae,q,ne,ae,W,K,X,J,Q,ee,z,he,ye,R,ko,Fo,at,U,sn],styles:[".ya-filter-bar.query[_ngcontent-%COMP%]{height:unset}"],changeDetection:0});var Mn=Zt;function Sl(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),s(5,"td"),n()),t&2){let e=i.$implicit;l(2),C(e.name),l(2),C(e.type)}}function bl(t,i){if(t&1&&(a(0,"tr")(1,"td",2),o(2),n()()),t&2){let e=i.$implicit;l(2),C(e)}}function gl(t,i){if(t&1&&(a(0,"ya-panel")(1,"h3"),o(2,"Columns"),n(),a(3,"table",0)(4,"tr")(5,"th",1),o(6,"Column"),n(),a(7,"th"),o(8,"Type"),n(),s(9,"th",2),n(),F(10,Sl,6,2,"tr",null,$),n(),a(12,"p"),o(13,"\xA0"),n(),a(14,"h3"),o(15,"Subscribers"),n(),a(16,"table",0),F(17,bl,3,1,"tr",null,$),n()()),t&2){let e=i;l(10),N(e.columns),l(7),N(e.subscribers)}}var Kt=class Kt{constructor(i,e){let r=i.snapshot.parent,m=r.parent.paramMap.get("database"),f=r.paramMap.get("stream");this.stream$=e.yamcsClient.getStream(m,f)}};Kt.\u0275fac=function(e){return new(e||Kt)(p(j),p(w))},Kt.\u0275cmp=x({type:Kt,selectors:[["ng-component"]],decls:2,vars:3,consts:[["yaDataTable","",1,"expand"],["width","200"],[1,"expand"]],template:function(e,r){if(e&1&&(h(0,gl,19,0,"ya-panel"),_(1,"async")),e&2){let m;v((m=S(1,1,r.stream$))?0:-1,m)}},dependencies:[T,xe,R,U],encapsulation:2,changeDetection:0});var In=Kt;var Jt=class Jt{transform(i,e){if(!i||i.length===0)return null;for(let r of i)if(r.name===e)return r.value;return null}};Jt.\u0275fac=function(e){return new(e||Jt)},Jt.\u0275pipe=rn({name:"columnValue",type:Jt,pure:!0});var Dt=Jt;function yl(t,i){if(t&1&&s(0,"app-hex",1),t&2){let e=u().$index,r=u();c("base64String",r.streamData.column[e].value.binaryValue)}}function xl(t,i){if(t&1&&(o(0),_(1,"value")),t&2){let e=u().$index,r=u();y(" ",S(1,1,r.streamData.column[e].value)||"-"," ")}}function Tl(t,i){if(t&1&&(a(0,"ya-attr",0),h(1,yl,1,1,"app-hex",1)(2,xl,2,3),n()),t&2){let e=i.$implicit;c("label",e.name),l(),v(e.value.type==="BINARY"?1:2)}}var Xt=class Xt{};Xt.\u0275fac=function(e){return new(e||Xt)},Xt.\u0275cmp=x({type:Xt,selectors:[["app-stream-data"]],inputs:{streamData:"streamData"},decls:3,vars:0,consts:[[3,"label"],[3,"base64String"]],template:function(e,r){e&1&&(a(0,"ya-attr-list"),F(1,Tl,3,2,"ya-attr",0,$),n()),e&2&&(l(),N(r.streamData.column))},dependencies:[gn,Ot,Yt,Tt],encapsulation:2,changeDetection:0});var An=Xt;var Rn=class{constructor(){this.dirty=!1;this.bufferSize=500;this.pointer=0;this.buffer=Array(this.bufferSize).fill(void 0)}add(i){this.buffer[this.pointer]=i,this.prevPointer=this.pointer,this.pointer=(this.pointer+1)%this.buffer.length,this.dirty=!0}reset(){this.buffer.fill(void 0),this.pointer=0,this.prevPointer=void 0,this.dirty=!0}snapshot(){if(this.prevPointer===void 0)return[];{let i=this.buffer.slice(0,this.prevPointer+1);return this.buffer.slice(this.prevPointer+1).concat(i).filter(r=>r!==void 0)}}};var Pn=class extends mo{constructor(e,r,m,f){super();this.yamcs=e;this.database=m;this.stream=f;this.streamData$=new H([]);this.loading$=new H(!1);this.streaming$=new H(!1);this.columns$=new H([]);this.streamBuffer=new Rn;this.syncSubscription=r.sync(()=>{this.streamBuffer.dirty&&!this.loading$.getValue()&&(this.streamData$.next(this.streamBuffer.snapshot().reverse()),this.streamBuffer.dirty=!1)})}connect(){return this.streamData$}startStreaming(){this.streaming$.next(!0),this.streamSubscription=this.yamcs.yamcsClient.createStreamSubscription({instance:this.database,stream:this.stream},e=>{if(!this.loading$.getValue()){this.streamBuffer.add(e);let r=this.columns$.value;for(let m of e.column)r.indexOf(m.name)===-1&&r.push(m.name);this.columns$.next([...r])}})}stopStreaming(){this.streamSubscription&&this.streamSubscription.cancel(),this.streaming$.next(!1)}disconnect(){this.streamSubscription&&this.streamSubscription.cancel(),this.syncSubscription&&this.syncSubscription.unsubscribe(),this.streamData$.complete(),this.loading$.complete(),this.streaming$.complete()}};var Dl=t=>({selected:t});function wl(t,i){t&1&&(a(0,"ya-detail-toolbar"),o(1,"Tuple"),n(),a(2,"div",9),s(3,"app-stream-data",10),n()),t&2&&(l(3),c("streamData",i))}function El(t,i){t&1&&(a(0,"ya-detail-toolbar"),o(1,"Select a tuple"),n())}function Ml(t,i){if(t&1&&(a(0,"th",12),o(1),n()),t&2){let e=u().$implicit;l(),C(e)}}function Il(t,i){if(t&1&&(a(0,"td",13),o(1),_(2,"columnValue"),_(3,"value"),n()),t&2){let e=i.$implicit,r=u().$implicit;l(),y(" ",S(3,4,Ue(2,1,e.column,r))||"-"," ")}}function Al(t,i){if(t&1&&(b(0,3),d(1,Ml,2,1,"th",11)(2,Il,4,6,"td",6),g()),t&2){let e=i.$implicit;c("cdkColumnDef",e)}}function Rl(t,i){t&1&&s(0,"th",14)}function Pl(t,i){t&1&&s(0,"td",13)}function kl(t,i){t&1&&s(0,"tr",15)}function Ll(t,i){if(t&1){let e=V();a(0,"tr",16),_(1,"async"),D("click",function(){let m=I(e).$implicit,f=u();return A(f.selectStreamData(m))}),n()}if(t&2){let e=i.$implicit,r=u();c("ngClass",ge(3,Dl,e===S(1,1,r.selectedStreamData$)))}}var ei=class ei extends Ut{constructor(e,r){super();this.displayedColumns=["actions"];this.selectedStreamData$=new H(null);let m=e.snapshot.parent,f=m.parent.paramMap.get("database"),E=m.paramMap.get("stream");this.dataSource=new Pn(r,this.synchronizer,f,E),this.availableColumns$=this.dataSource.columns$}ngAfterViewInit(){this.columnDefinitionsSubscription=this.columnDefinitions.changes.subscribe(()=>{this.columnDefinitions.forEach(e=>{this.displayedColumns.indexOf(e.name)===-1&&this.displayedColumns.splice(this.displayedColumns.length-1,0,e.name)})}),this.dataSource.startStreaming()}selectStreamData(e){this.selectedStreamData$.next(e),this.openDetailPane()}ngOnDestroy(){this.columnDefinitionsSubscription?.unsubscribe(),this.dataSource?.stopStreaming()}};ei.\u0275fac=function(r){return new(r||ei)(p(j),p(w))},ei.\u0275cmp=x({type:ei,selectors:[["ng-component"]],viewQuery:function(r,m){if(r&1&&se(Cn,5),r&2){let f;re(f=le())&&(m.columnDefinitions=f)}},features:[ht],decls:16,vars:8,consts:[["table",""],[1,"data-table-wrapper"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],[3,"cdkColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"cdkRowDef","cdkRowDefColumns"],[2,"padding","0 16px"],[3,"streamData"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(r,m){if(r&1&&(a(0,"ya-detail-pane"),h(1,wl,4,1),_(2,"async"),We(3,El,2,0,"ya-detail-toolbar"),n(),a(4,"div",1)(5,"ya-panel")(6,"table",2,0),F(8,Al,3,1,"ng-container",3,$),_(10,"async"),b(11,4),d(12,Rl,1,0,"th",5)(13,Pl,1,0,"td",6),g(),d(14,kl,1,0,"tr",7)(15,Ll,2,5,"tr",8),n()()()),r&2){let f;l(),v((f=S(2,4,m.selectedStreamData$))?1:3,f),l(5),c("dataSource",m.dataSource),l(2),N(S(10,6,m.availableColumns$)),l(6),c("cdkHeaderRowDef",m.displayedColumns),l(),c("cdkRowDefColumns",m.displayedColumns)}},dependencies:[T,Bt,bo,Vt,vo,Cn,So,q,W,J,Q,ee,z,Ht,Gt,R,An,Dt,U,Tt],styles:[".data-table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.data-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}.data-table-wrapper[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var kn=ei;function $l(t,i){t&1&&(a(0,"th",10),o(1,"Name"),n())}function Fl(t,i){if(t&1&&(a(0,"td",11)(1,"a",12),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),y(" ",e.name," ")}}function Nl(t,i){t&1&&(a(0,"th",10),o(1,"Data count"),n())}function Bl(t,i){if(t&1&&(a(0,"td",13),o(1),_(2,"number"),n()),t&2){let e=i.$implicit;l(),y(" ",S(2,1,e.dataCount)," ")}}function jl(t,i){t&1&&s(0,"th",14)}function Vl(t,i){t&1&&s(0,"td",11)}function Ul(t,i){t&1&&s(0,"tr",15)}function Yl(t,i){t&1&&s(0,"tr",16)}var ti=class ti{constructor(i,e){this.yamcs=e;this.displayedColumns=["name","dataCount","actions"];this.dataSource=new G;this.itemsByName={};let r=i.snapshot.parent;this.database=r.paramMap.get("database")}ngAfterViewInit(){this.dataSource.sort=this.sort,this.streamStatisticsSubscription=this.yamcs.yamcsClient.createStreamStatisticsSubscription({instance:this.database},i=>{this.processStreamEvent(i)})}processStreamEvent(i){switch(i.type){case"CREATED":case"UPDATED":this.itemsByName[i.name]={name:i.name,dataCount:i.dataCount},this.updateDataSource();break;case"DELETED":delete this.itemsByName[i.name],this.updateDataSource();break;default:console.error("Unexpected stream update of type "+i.type);break}}updateDataSource(){let i=Object.values(this.itemsByName);i.sort((e,r)=>e.name.localeCompare(r.name)),this.dataSource.data=i}ngOnDestroy(){this.streamStatisticsSubscription?.cancel()}};ti.\u0275fac=function(e){return new(e||ti)(p(j),p(w))},ti.\u0275cmp=x({type:ti,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:13,vars:3,consts:[["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataCount"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"ya-panel")(1,"table",0),b(2,1),d(3,$l,2,0,"th",2)(4,Fl,3,2,"td",3),g(),b(5,4),d(6,Nl,2,0,"th",2)(7,Bl,3,3,"td",5),g(),b(8,6),d(9,jl,1,0,"th",7)(10,Vl,1,0,"td",3),g(),d(11,Ul,1,0,"tr",8)(12,Yl,1,0,"tr",9),n()()),e&2&&(l(),c("dataSource",r.dataSource),l(10),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[T,ie,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,R,jt],encapsulation:2,changeDetection:0});var Ln=ti;var zo="&nbsp;&nbsp;&nbsp;&nbsp;",$n=/[()]|(, ")/;function Fn(t){if(!t)return t;let i=[],e="",r=t.search($n);for(;r!==-1;)t[r]==="("?(i.push(t.substring(0,r+1)),e+=zo,i.push("<br>",e),t=t.substring(r+1),r=t.search($n)):t[r]===")"?(i.push(t.substring(0,r)),e=e.replace(zo,""),i.push("<br>",e),i.push(")"),t=t.substring(r+1),r=t.search($n)):(i.push(t.substring(0,r+1)),i.push("<br>",e),i.push('"'),t=t.substring(r+3),r=t.search($n));let m=i.join("")+t;return m=m.replace(/(engine|histogram|partition|primary|table_format)/g,"<br>$1"),Ol(m)}function Ol(t){return t.replace(/(BINARY|ENUM|HRES_TIMESTAMP|INT|LONG|PARAMETER_VALUE|PROTOBUF|STRING|TIMESTAMP)/g,'<span class="dtype">$1</span>').replace(/([(),]+)/g,'<span class="paren">$1</span>').replace(/(auto_increment|create|compressed|histogram|engine|primary key|table(_format)?|stream)/g,'<span class="kw">$1</span>').replace(/(partition by time(_and_value)?|partition by value)/g,'<span class="kw">$1</span>')}var ii=class ii{constructor(i,e,r){this.messageService=i;this.yamcs=e;this.sanitizer=r;this.database=Le.required();this.stream=Le.required();this.sqlHtml=tn(null)}ngOnInit(){this.yamcs.yamcsClient.getStream(this.database(),this.stream()).then(i=>{let e=Fn(i.script),r=this.sanitizer.sanitize(Ha.HTML,e);this.sqlHtml.set(r)}).catch(i=>this.messageService.showError(i))}};ii.\u0275fac=function(e){return new(e||ii)(p(Ce),p(w),p(io))},ii.\u0275cmp=x({type:ii,selectors:[["app-stream-script-tab"]],inputs:{database:[1,"database"],stream:[1,"stream"]},decls:2,vars:1,consts:[[1,"sql"],[3,"innerHTML"]],template:function(e,r){e&1&&(a(0,"ya-panel",0),s(1,"code",1),n()),e&2&&(l(),c("innerHTML",r.sqlHtml(),an))},dependencies:[T,R],styles:["code[_ngcontent-%COMP%]{display:inline-block;font-size:12px;line-height:14px}",".dtype{color:red}  .paren{color:#1b61b9}  .kw{color:#1b61b9}"],changeDetection:0});var Nn=ii;function Hl(t,i){t&1&&s(0,"router-outlet")}var ni=class ni{constructor(i,e,r){this.yamcs=e;let m=i.snapshot,f=m.parent.paramMap.get("database"),E=m.paramMap.get("stream");r.setTitle(E),this.stream$=e.yamcsClient.getStream(f,E)}};ni.\u0275fac=function(e){return new(e||ni)(p(j),p(w),p(P))},ni.\u0275cmp=x({type:ni,selectors:[["app-stream-page"]],decls:2,vars:3,template:function(e,r){if(e&1&&(h(0,Hl,1,0,"router-outlet"),_(1,"async")),e&2){let m;v((m=S(1,1,r.stream$))?0:-1,m)}},dependencies:[T,St,U],encapsulation:2,changeDetection:0});var Bn=ni;function Gl(t,i){if(t&1&&(a(0,"mat-icon",2),o(1,"vpn_key"),n(),o(2)),t&2){let e=u().$implicit;l(2),y(" ",e.name," ")}}function ql(t,i){if(t&1&&(a(0,"ya-attr"),d(1,Gl,3,1,"ng-template",1),o(2),_(3,"columnValue"),_(4,"value"),n()),t&2){let e=i.$implicit,r=u();l(2),y(" ",S(4,4,Ue(3,1,r.record.column,e.name))||"-"," ")}}function Wl(t,i){t&1&&s(0,"app-hex",3),t&2&&c("base64String",i.binaryValue)}function Ql(t,i){t&1&&o(0," - ")}function zl(t,i){if(t&1&&(h(0,Wl,1,1,"app-hex",3),_(1,"columnValue"),We(2,Ql,1,0)),t&2){let e,r=u().$implicit,m=u();v((e=Ue(1,1,m.record.column,r.name))?0:2,e)}}function Zl(t,i){if(t&1&&(o(0),_(1,"columnValue"),_(2,"value")),t&2){let e=u().$implicit,r=u();y(" ",S(2,4,Ue(1,1,r.record.column,e.name))||"-"," ")}}function Kl(t,i){if(t&1&&(a(0,"ya-attr",0),h(1,zl,3,4)(2,Zl,3,6),n()),t&2){let e=i.$implicit;c("label",e.name),l(),v(e.type==="BINARY"||e.type!=="PROTOBUF(com.google.protobuf.Struct)"&&e.type.startsWith("PROTOBUF")?1:2)}}var ai=class ai{};ai.\u0275fac=function(e){return new(e||ai)},ai.\u0275cmp=x({type:ai,selectors:[["app-record"]],inputs:{table:"table",record:"record"},decls:5,vars:0,consts:[[3,"label"],["ya-attr-label",""],["matTooltip","Key Column",1,"icon12",2,"color","gold"],[3,"base64String"]],template:function(e,r){e&1&&(a(0,"ya-attr-list"),F(1,ql,5,6,"ya-attr",null,$),F(3,Kl,3,2,"ya-attr",0,$),n()),e&2&&(l(),N(r.table.keyColumn),l(2),N(r.table.valueColumn))},dependencies:[gn,T,Do,_e,De,Ot,Yt,Dt,Tt],encapsulation:2,changeDetection:0});var jn=ai;var Jl=t=>({selected:t});function Xl(t,i){if(t&1&&(a(0,"ya-detail-toolbar"),o(1,"Record"),n(),a(2,"div",1),s(3,"app-record",2),n()),t&2){let e=u();l(3),c("table",e)("record",i)}}function em(t,i){t&1&&(a(0,"ya-detail-toolbar"),o(1,"Select a record"),n())}function tm(t,i){if(t&1&&(a(0,"th"),o(1),n()),t&2){let e=i.$implicit;l(),C(e.name)}}function im(t,i){if(t&1&&(a(0,"th"),o(1),n()),t&2){let e=i.$implicit;l(),C(e.name)}}function nm(t,i){if(t&1&&(a(0,"td"),o(1),_(2,"columnValue"),_(3,"value"),n()),t&2){let e=i.$implicit,r=u().$implicit;l(),y(" ",S(3,4,Ue(2,1,r.column,e.name))||"-"," ")}}function am(t,i){if(t&1&&(a(0,"td"),o(1),_(2,"columnValue"),_(3,"value"),n()),t&2){let e=i.$implicit,r=u().$implicit;fe("mono",e.type==="BINARY"),l(),y(" ",S(3,6,Ue(2,3,r.column,e.name))||"-"," ")}}function om(t,i){if(t&1){let e=V();a(0,"tr",5),_(1,"async"),D("click",function(){let m=I(e).$implicit,f=u(4);return A(f.selectRecord(m))}),F(2,nm,4,6,"td",null,$),F(4,am,4,8,"td",6,$),n()}if(t&2){let e=i.$implicit,r=u(3),m=u();c("ngClass",ge(3,Jl,e===S(1,1,m.selectedRecord$))),l(2),N(r.keyColumn),l(2),N(r.valueColumn)}}function rm(t,i){if(t&1&&(a(0,"table",3)(1,"tr"),F(2,tm,2,1,"th",null,$),F(4,im,2,1,"th",null,$),n(),F(6,om,6,5,"tr",4,$),n()),t&2){let e=u(),r=u();l(2),N(r.keyColumn),l(2),N(r.valueColumn),l(2),N(e)}}function lm(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"Empty table."),n())}function mm(t,i){t&1&&h(0,rm,8,0,"table",3)(1,lm,2,0,"ya-empty-message"),t&2&&v(i.length?0:1)}function sm(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"Empty table."),n())}function cm(t,i){if(t&1&&(a(0,"ya-detail-pane"),h(1,Xl,4,2),_(2,"async"),We(3,em,2,0,"ya-detail-toolbar"),n(),a(4,"div",0)(5,"ya-panel"),h(6,mm,2,1),_(7,"async"),We(8,sm,2,0,"ya-empty-message"),n()()),t&2){let e,r,m=u();l(),v((e=S(2,2,m.selectedRecord$))?1:3,e),l(5),v((r=S(7,4,m.records$))?6:8,r)}}var oi=class oi extends Ut{constructor(e,r){super();this.selectedRecord$=new H(null);let m=e.snapshot.parent,f=m.parent.paramMap.get("database"),E=m.paramMap.get("table");this.table$=r.yamcsClient.getTable(f,E),this.records$=r.yamcsClient.getTableData(f,E)}selectRecord(e){this.selectedRecord$.next(e),this.openDetailPane()}};oi.\u0275fac=function(r){return new(r||oi)(p(j),p(w))},oi.\u0275cmp=x({type:oi,selectors:[["ng-component"]],features:[ht],decls:2,vars:3,consts:[[1,"data-table-wrapper"],[2,"padding","0 16px 16px 16px"],[3,"table","record"],["yaDataTable",""],[3,"ngClass"],[3,"click","ngClass"],[3,"mono"]],template:function(r,m){if(r&1&&(h(0,cm,9,6),_(1,"async")),r&2){let f;v((f=S(1,1,m.table$))?0:-1,f)}},dependencies:[jn,T,Bt,xe,Ht,Gt,Re,R,Dt,U,Tt],styles:[".data-table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.data-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}.data-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}.data-table-wrapper[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#fafafa}"],changeDetection:0});var Vn=oi;function pm(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n()()),t&2){let e=i.$implicit;l(2),C(e.value),l(2),C(e.label)}}var ri=class ri{constructor(i){this.data=i}};ri.\u0275fac=function(e){return new(e||ri)(p(Ke))},ri.\u0275cmp=x({type:ri,selectors:[["app-show-enum-dialog"]],decls:14,vars:0,consts:[["mat-dialog-title",""],["yaDataTable","",2,"width","100%"],["align","end"],["mat-dialog-close",""]],template:function(e,r){e&1&&(a(0,"h2",0),o(1,"Enum States"),n(),a(2,"mat-dialog-content")(3,"table",1)(4,"tr")(5,"th"),o(6,"Value"),n(),a(7,"th"),o(8,"Label"),n()(),F(9,pm,5,2,"tr",null,$),n()(),a(11,"mat-dialog-actions",2)(12,"ya-button",3),o(13,"Close"),n()()),e&2&&(l(9),N(r.data.column.enumValue))},dependencies:[T,xe,Je,Xe,tt,et,he],encapsulation:2});var Un=ri;function dm(t,i){if(t&1){let e=V();a(0,"span",5),D("click",function(){I(e);let m=u().$implicit,f=u(2);return A(f.showEnum(m))}),o(1),n()}if(t&2){let e=u().$implicit;l(),y(" ",e.type," ")}}function um(t,i){if(t&1&&o(0),t&2){let e=u().$implicit;y(" ",e.type," ")}}function fm(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),h(4,dm,2,1,"span",4),h(5,um,1,1),n(),a(6,"td"),o(7),n(),s(8,"td"),n()),t&2){let e=i.$implicit;l(2),C(e.name),l(2),v(e.type==="ENUM"?4:-1),l(),v(e.type!=="ENUM"?5:-1),l(2),y(" ",e.autoIncrement?"auto_increment":"-"," ")}}function _m(t,i){if(t&1){let e=V();a(0,"span",5),D("click",function(){I(e);let m=u().$implicit,f=u(2);return A(f.showEnum(m))}),o(1),n()}if(t&2){let e=u().$implicit;l(),y(" ",e.type," ")}}function Cm(t,i){if(t&1&&o(0),t&2){let e=u().$implicit;y(" ",e.type," ")}}function hm(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),h(4,_m,2,1,"span",4),h(5,Cm,1,1),n(),a(6,"td"),o(7),n(),s(8,"td"),n()),t&2){let e=i.$implicit;l(2),C(e.name),l(2),v(e.type==="ENUM"?4:-1),l(),v(e.type!=="ENUM"?5:-1),l(2),y(" ",e.autoIncrement?"auto_increment":"-"," ")}}function vm(t,i){t&1&&(a(0,"span"),o(1,","),n())}function Sm(t,i){if(t&1&&(o(0),h(1,vm,2,0,"span")),t&2){let e=i.$implicit,r=i.$index,m=i.$count;y(" ",e," "),l(),v(r!==m-1?1:-1)}}function bm(t,i){if(t&1&&F(0,Sm,2,2,null,null,$),t&2){let e=u();N(e.histogramColumn)}}function gm(t,i){t&1&&o(0," - ")}function ym(t,i){if(t&1&&(a(0,"dt"),o(1,"Time partition column"),n(),a(2,"dd"),o(3),n()),t&2){let e=u();l(3),ct(" ",e.partitioningInfo==null?null:e.partitioningInfo.timeColumn,"('",e.partitioningInfo==null?null:e.partitioningInfo.timePartitionSchema,"') ")}}function xm(t,i){if(t&1&&(a(0,"dt"),o(1,"Value partition column"),n(),a(2,"dd"),o(3),n()),t&2){let e=u();l(3),y(" ",e.partitioningInfo==null?null:e.partitioningInfo.valueColumn," ")}}function Tm(t,i){if(t&1&&(a(0,"ya-panel")(1,"h3"),o(2,"Key"),n(),a(3,"table",0)(4,"tr")(5,"th"),o(6,"Column"),n(),a(7,"th"),o(8,"Type"),n(),a(9,"th"),o(10,"Extra"),n(),s(11,"th",1),n(),F(12,fm,9,4,"tr",null,$),n(),a(14,"p"),o(15,"\xA0"),n(),a(16,"h3"),o(17,"Value"),n(),a(18,"table",2)(19,"tr")(20,"th"),o(21,"Column"),n(),a(22,"th"),o(23,"Type"),n(),a(24,"th"),o(25,"Extra"),n(),s(26,"th",1),n(),F(27,hm,9,4,"tr",null,$),n(),a(29,"p"),o(30,"\xA0"),n(),a(31,"h3"),o(32,"Options"),n(),a(33,"dl",3)(34,"dt"),o(35,"Format version"),n(),a(36,"dd"),o(37),n(),a(38,"dt"),o(39,"Storage engine"),n(),a(40,"dd"),o(41),n(),a(42,"dt"),o(43,"Tablespace"),n(),a(44,"dd"),o(45),n(),a(46,"dt"),o(47,"Compressed"),n(),a(48,"dd"),o(49),n(),a(50,"dt"),o(51,"Histogram"),n(),a(52,"dd"),h(53,bm,2,0),h(54,gm,1,0),n(),a(55,"dt"),o(56,"Partition by"),n(),a(57,"dd"),o(58),_(59,"lowercase"),n(),h(60,ym,4,2),h(61,xm,4,1),n()()),t&2){let e=i;l(12),N(e.keyColumn),l(15),N(e.valueColumn),l(10),C(e.formatVersion),l(4),C(e.storageEngine),l(4),C(e.tablespace||"-"),l(4),C(e.compressed?"yes":"no"),l(4),v(e.histogramColumn?53:-1),l(),v(e.histogramColumn?-1:54),l(4),C(S(59,9,e.partitioningInfo==null?null:e.partitioningInfo.type)||"-"),l(2),v(e.partitioningInfo!=null&&e.partitioningInfo.timeColumn?60:-1),l(),v(e.partitioningInfo!=null&&e.partitioningInfo.valueColumn?61:-1)}}var li=class li{constructor(i,e,r){this.dialog=r;let m=i.snapshot.parent,f=m.parent.paramMap.get("database"),E=m.paramMap.get("table");this.table$=e.yamcsClient.getTable(f,E)}showEnum(i){this.dialog.open(Un,{width:"400px",data:{column:i}})}};li.\u0275fac=function(e){return new(e||li)(p(j),p(w),p(Ye))},li.\u0275cmp=x({type:li,selectors:[["ng-component"]],decls:2,vars:3,consts:[["yaDataTable","",1,"expand"],[1,"expand"],["yaDataTable",""],[1,"dl-horizontal"],["matTooltip","Show enum states",1,"enum"],["matTooltip","Show enum states",1,"enum",3,"click"]],template:function(e,r){if(e&1&&(h(0,Tm,62,11,"ya-panel"),_(1,"async")),e&2){let m;v((m=S(1,1,r.table$))?0:-1,m)}},dependencies:[T,xe,De,R,U,sn],styles:[".enum[_ngcontent-%COMP%]{border-bottom:1px dotted #888;cursor:pointer}"],changeDetection:0});var Yn=li;function Dm(t,i){t&1&&(a(0,"th",8),o(1,"Name"),n())}function wm(t,i){if(t&1&&(a(0,"td",9)(1,"a",10),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),y(" ",e.name," ")}}function Em(t,i){t&1&&s(0,"th",11)}function Mm(t,i){t&1&&s(0,"td",9)}function Im(t,i){t&1&&s(0,"tr",12)}function Am(t,i){t&1&&s(0,"tr",13)}var mi=class mi{constructor(i,e){this.yamcs=e;this.displayedColumns=["name","actions"];this.dataSource=new G;let m=i.snapshot.parent.paramMap.get("database");e.yamcsClient.getTables(m).then(f=>{this.dataSource.data=f})}ngAfterViewInit(){this.dataSource.sort=this.sort}};mi.\u0275fac=function(e){return new(e||mi)(p(j),p(w))},mi.\u0275cmp=x({type:mi,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:10,vars:3,consts:[["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"ya-panel")(1,"table",0),b(2,1),d(3,Dm,2,0,"th",2)(4,wm,3,2,"td",3),g(),b(5,4),d(6,Em,1,0,"th",5)(7,Mm,1,0,"td",3),g(),d(8,Im,1,0,"tr",6)(9,Am,1,0,"tr",7),n()()),e&2&&(l(),c("dataSource",r.dataSource),l(7),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[T,ie,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,R],encapsulation:2,changeDetection:0});var On=mi;function Rm(t,i){if(t&1&&(a(0,"ya-panel",0),s(1,"code",1),n()),t&2){let e=u();l(),c("innerHTML",e.formatSQL(i.script),an)}}var si=class si{constructor(i,e){let r=i.snapshot.parent,m=r.parent.paramMap.get("database"),f=r.paramMap.get("table");this.table$=e.yamcsClient.getTable(m,f)}formatSQL(i){return Fn(i)}};si.\u0275fac=function(e){return new(e||si)(p(j),p(w))},si.\u0275cmp=x({type:si,selectors:[["app-table-script-tab"]],decls:2,vars:3,consts:[[1,"sql"],[3,"innerHTML"]],template:function(e,r){if(e&1&&(h(0,Rm,2,1,"ya-panel",0),_(1,"async")),e&2){let m;v((m=S(1,1,r.table$))?0:-1,m)}},dependencies:[T,R,U],styles:["code[_ngcontent-%COMP%]{display:inline-block;font-size:12px;line-height:14px}",".dtype{color:red}  .paren{color:#1b61b9}  .kw{color:#1b61b9}"],changeDetection:0});var Hn=si;function Pm(t,i){t&1&&s(0,"router-outlet")}var ci=class ci{constructor(i,e,r){this.yamcs=e;let m=i.snapshot.parent.paramMap.get("database"),f=i.snapshot.paramMap.get("table");r.setTitle(f),this.table$=e.yamcsClient.getTable(m,f)}};ci.\u0275fac=function(e){return new(e||ci)(p(j),p(w),p(P))},ci.\u0275cmp=x({type:ci,selectors:[["app-table-page"]],decls:2,vars:3,template:function(e,r){if(e&1&&(h(0,Pm,1,0,"router-outlet"),_(1,"async")),e&2){let m;v((m=S(1,1,r.table$))?0:-1,m)}},dependencies:[T,St,U],encapsulation:2,changeDetection:0});var Gn=ci;var pi=class pi{transform(i){if(!i)return i;let e=i.match(/Chrome\/([a-zA-Z0-9\.]+)/),r=i.match(/Chromium\/([a-zA-Z0-9\.]+)/),m=i.match(/Edg\/([a-zA-Z0-9\.]+)/),f=i.match(/Firefox\/([a-zA-Z0-9\.]+)/),E=i.match(/OPR\/([a-zA-Z0-9\.]+)/),Te=i.match(/Safari\/([a-zA-Z0-9\.]+)/),de=i.match(/Seamonkey\/([a-zA-Z0-9\.]+)/),be,ue;if(Te&&!e&&!r&&!m){be="Safari",ue=Te[1];let Ct=i.match(/Version\/([a-zA-Z0-9\.]+)/);Ct&&(ue=Ct[1])}else e&&!r&&!m?(be="Chrome",ue=e[1]):r?(be="Chromium",ue=r[1]):f&&!de?(be="Firefox",ue=f[1]):de?(be="Seamonkey",ue=de[1]):E?(be="Opera",ue=E[1]):m&&(be="Edge",ue=m[1]);return be?`${be} ${ue}`:i}};pi.\u0275fac=function(e){return new(e||pi)},pi.\u0275pipe=rn({name:"userAgent",type:pi,pure:!0});var di=pi;function km(t,i){if(t&1&&(a(0,"dl",1)(1,"dt"),o(2,"Cumulative read"),n(),a(3,"dd"),o(4),_(5,"formatBytes"),n(),a(6,"dt"),o(7,"Cumulative written"),n(),a(8,"dd"),o(9),_(10,"formatBytes"),n(),a(11,"dt"),o(12,"Rx"),n(),a(13,"dd"),o(14),_(15,"dataRate"),n(),a(16,"dt"),o(17,"Tx"),n(),a(18,"dd"),o(19),_(20,"dataRate"),n()()),t&2){let e=i;l(4),C(S(5,4,e.readBytes)),l(5),C(S(10,6,e.writtenBytes)),l(5),C(S(15,8,e.readThroughput*8)),l(5),C(S(20,10,e.writeThroughput*8))}}function Lm(t,i){t&1&&(a(0,"th",20),o(1,"Id"),n())}function $m(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),C(e.id)}}function Fm(t,i){t&1&&(a(0,"th",22),o(1,"User agent"),n())}function Nm(t,i){if(t&1&&(a(0,"td",21),o(1),_(2,"userAgent"),n()),t&2){let e=i.$implicit;l(),y(" ",S(2,1,e.httpRequest==null?null:e.httpRequest.userAgent)||"-"," ")}}function Bm(t,i){t&1&&(a(0,"th",20),o(1,"Protocol"),n())}function jm(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),C((e.httpRequest==null?null:e.httpRequest.protocol)||"-")}}function Vm(t,i){t&1&&(a(0,"th",20),o(1,"Remote address"),n())}function Um(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),C(e.remoteAddress||"-")}}function Ym(t,i){t&1&&(a(0,"th",20),o(1,"Read"),n())}function Om(t,i){if(t&1&&(a(0,"td",21),o(1),_(2,"formatBytes"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.readBytes)||"-")}}function Hm(t,i){t&1&&(a(0,"th",20),o(1,"Written"),n())}function Gm(t,i){if(t&1&&(a(0,"td",21),o(1),_(2,"formatBytes"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.writtenBytes)||"-")}}function qm(t,i){t&1&&(a(0,"th",20),o(1,"Rx"),n())}function Wm(t,i){if(t&1&&(a(0,"td",21),o(1),_(2,"dataRate"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.readThroughput*8))}}function Qm(t,i){t&1&&(a(0,"th",20),o(1,"Tx"),n())}function zm(t,i){if(t&1&&(a(0,"td",21),o(1),_(2,"dataRate"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.writeThroughput*8))}}function Zm(t,i){t&1&&(a(0,"th",20),o(1,"Request"),n())}function Km(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),ct(" ",e.httpRequest==null?null:e.httpRequest.method," ",e.httpRequest==null?null:e.httpRequest.uri," ")}}function Jm(t,i){t&1&&(a(0,"th",20),o(1,"Authorization"),n())}function Xm(t,i){if(t&1&&(a(0,"td",21),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.username||"-"," ")}}function es(t,i){t&1&&s(0,"tr",23)}function ts(t,i){t&1&&s(0,"tr",24)}var ui=class ui{constructor(i,e){this.displayedColumns=["id","protocol","remoteAddress","readBytes","writtenBytes","readThroughput","writeThroughput","request","authorization","userAgent"];this.tableTrackerFn=(i,e)=>e.id;this.traffic$=new H(null);this.dataSource=new G;e.setTitle("HTTP traffic"),this.httpTrafficSubscription=i.yamcsClient.createHttpTrafficSubscription(r=>{this.traffic$.next(r),this.dataSource.data=r.connections})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnDestroy(){this.httpTrafficSubscription?.cancel()}};ui.\u0275fac=function(e){return new(e||ui)(p(w),p(P))},ui.\u0275cmp=x({type:ui,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&(se(O,5),se(Fe,5)),e&2){let m;re(m=le())&&(r.sort=m.first),re(m=le())&&(r.paginator=m.first)}},decls:43,vars:10,consts:[["label","HTTP traffic"],[1,"dl-horizontal","no-lead"],[1,"section-divider"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","userAgent"],["mat-header-cell","","mat-sort-header","","class","expand",4,"matHeaderCellDef"],["matColumnDef","protocol"],["matColumnDef","remoteAddress"],["matColumnDef","readBytes"],["matColumnDef","writtenBytes"],["matColumnDef","readThroughput"],["matColumnDef","writeThroughput"],["matColumnDef","request"],["matColumnDef","authorization"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){if(e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel"),h(3,km,21,12,"dl",1),_(4,"async"),a(5,"div",2),s(6,"mat-divider"),n(),a(7,"h4"),o(8,"Current connections"),n(),a(9,"table",3),b(10,4),d(11,Lm,2,0,"th",5)(12,$m,2,1,"td",6),g(),b(13,7),d(14,Fm,2,0,"th",8)(15,Nm,3,3,"td",6),g(),b(16,9),d(17,Bm,2,0,"th",5)(18,jm,2,1,"td",6),g(),b(19,10),d(20,Vm,2,0,"th",5)(21,Um,2,1,"td",6),g(),b(22,11),d(23,Ym,2,0,"th",5)(24,Om,3,3,"td",6),g(),b(25,12),d(26,Hm,2,0,"th",5)(27,Gm,3,3,"td",6),g(),b(28,13),d(29,qm,2,0,"th",5)(30,Wm,3,3,"td",6),g(),b(31,14),d(32,Qm,2,0,"th",5)(33,zm,3,3,"td",6),g(),b(34,15),d(35,Zm,2,0,"th",5)(36,Km,2,2,"td",6),g(),b(37,16),d(38,Jm,2,0,"th",5)(39,Xm,2,1,"td",6),g(),d(40,es,1,0,"tr",17)(41,ts,1,0,"tr",18),n(),s(42,"mat-paginator",19),n()()),e&2){let m;l(3),v((m=S(4,8,r.traffic$))?3:-1,m),l(6),c("dataSource",r.dataSource)("trackBy",r.tableTrackerFn),l(31),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),c("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0)}},dependencies:[k,L,T,it,Fe,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,R,U,No,bn,di],encapsulation:2,changeDetection:0});var qn=ui;function is(t,i){t&1&&s(0,"th",18)}function ns(t,i){if(t&1){let e=V();a(0,"td",19),D("click",function(m){return I(e),ve(2).toggle(),A(m.stopPropagation())}),s(1,"ya-table-checkbox",20,0),n()}if(t&2){let e=i.$implicit,r=u(2);l(),c("dataSource",r.dataSource)("selection",r.selection)("item",e)}}function as(t,i){t&1&&(a(0,"th",21),o(1,"Type"),n())}function os(t,i){t&1&&(a(0,"mat-icon",23),o(1,"person"),n())}function rs(t,i){if(t&1&&(a(0,"td",22),h(1,os,2,0,"mat-icon",23),n()),t&2){let e=i.$implicit;l(),v(e.user?1:-1)}}function ls(t,i){t&1&&(a(0,"th",24),o(1,"Member"),n())}function ms(t,i){if(t&1&&(a(0,"td",22),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.label," ")}}function ss(t,i){t&1&&s(0,"tr",25)}function cs(t,i){if(t&1){let e=V();a(0,"tr",26),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.toggleOne(m))}),n()}if(t&2){let e=i.$implicit,r=u(2);fe("selected",r.selection.isSelected(e))}}function ps(t,i){if(t&1&&(a(0,"table",3),b(1,8),d(2,is,1,0,"th",9)(3,ns,3,3,"td",10),g(),b(4,11),d(5,as,2,0,"th",12)(6,rs,2,1,"td",13),g(),b(7,14),d(8,ls,2,0,"th",15)(9,ms,2,1,"td",13),g(),d(10,ss,1,0,"tr",16)(11,cs,1,2,"tr",17),n()),t&2){let e=u();c("dataSource",e.dataSource),l(10),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}function ds(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var _i=class _i{constructor(i,e,r){this.dialogRef=i;this.data=r;this.displayedColumns=["select","type","name"];this.filterControl=new Z;this.dataSource=new G;this.selection=new dn(!0,[]);let f=r.items.filter(E=>E.user).map(E=>E.user.name);e.yamcsClient.getUsers().then(E=>{let Te=(E||[]).filter(de=>f.indexOf(de.name)===-1).map(de=>({label:de.displayName||de.name,user:de}));this.dataSource.data=Te})}ngAfterViewInit(){this.filterControl.valueChanges.subscribe(()=>{let i=this.filterControl.value||"";this.dataSource.filter=i.toLowerCase()}),this.dataSource.filterPredicate=(i,e)=>i.label.toLowerCase().indexOf(e)>=0,this.dataSource.paginator=this.paginator}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}save(){this.dialogRef.close(this.selection.selected)}};_i.\u0275fac=function(e){return new(e||_i)(p(pn),p(w),p(Ke))},_i.\u0275cmp=x({type:_i,selectors:[["app-add-members-dialog"]],viewQuery:function(e,r){if(e&1&&se(Fe,7),e&2){let m;re(m=le())&&(r.paginator=m.first)}},decls:13,vars:7,consts:[["cb",""],["mat-dialog-title",""],["placeholder","Filter users","width","100%",2,"flex","1 1 auto",3,"formControl"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"],["matColumnDef","select"],["mat-header-cell","","class","checkbox",4,"matHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["matColumnDef","type"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item"],["mat-header-cell","","width","1"],["mat-cell",""],["matTooltip","User",2,"vertical-align","middle"],["mat-header-cell",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,r){e&1&&(a(0,"h2",1),o(1,"Add members"),n(),a(2,"mat-dialog-content")(3,"ya-filter-bar"),s(4,"ya-search-filter",2),n(),h(5,ps,12,3,"table",3),h(6,ds,2,0,"ya-empty-message"),s(7,"mat-paginator",4),n(),a(8,"mat-dialog-actions",5)(9,"ya-button",6),o(10,"CANCEL"),n(),a(11,"ya-button",7),D("click",function(){return r.save()}),o(12,"ADD"),n()()),e&2&&(l(4),c("formControl",r.filterControl),l(),v(r.dataSource?5:-1),l(),v(r.dataSource.data.length?-1:6),l(),c("pageSize",10)("hidePageSize",!0)("showFirstLastButtons",!1),l(4),c("disabled",r.selection.isEmpty()))},dependencies:[T,me,$e,Vt,Je,Xe,tt,et,_e,Fe,q,ne,ae,W,K,X,J,Q,ee,z,De,he,Re,ye,Pe,Sn],styles:[".selected[_ngcontent-%COMP%]{background-color:#f0f4fd!important}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var Ci=_i;function us(t,i){t&1&&(s(0,"ya-page-icon-button",12),o(1," Create group "))}function fs(t,i){t&1&&(a(0,"tr")(1,"td",14),o(2,"No rows to display"),n()())}function _s(t,i){if(t&1){let e=V();a(0,"tr")(1,"td")(2,"mat-icon",15),o(3,"person"),n()(),a(4,"td"),o(5),n(),a(6,"td",16)(7,"ya-text-action",17),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.deleteItem(m))}),o(8,"DELETE"),n()()()}if(t&2){let e=i.$implicit;l(5),C(e.label)}}function Cs(t,i){if(t&1&&(a(0,"table",8)(1,"tr")(2,"th",13),o(3,"Type"),n(),a(4,"th"),o(5,"Member"),n(),s(6,"th"),n(),h(7,fs,3,0,"tr"),F(8,_s,9,1,"tr",null,$),n()),t&2){let e=i;l(7),v(e.length?-1:7),l(),N(e)}}var hi=class hi{constructor(i,e,r,m,f,E,Te,de){this.router=r;this.route=m;this.yamcs=f;this.dialog=E;this.messageService=Te;this.location=de;this.memberItems$=new H([]);e.setTitle("Create a group"),this.form=i.group({name:new Z("",[ut.required]),description:new Z})}showAddMembersDialog(){this.dialog.open(Ci,{data:{items:this.memberItems$.value},width:"600px"}).afterClosed().subscribe(e=>{e&&this.updateMemberItems([...this.memberItems$.value,...e])})}updateMemberItems(i){i.sort((e,r)=>e.label<r.label?-1:e.label>r.label?1:0),this.memberItems$.next(i)}deleteItem(i){this.updateMemberItems(this.memberItems$.value.filter(e=>e!==i))}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,users:this.memberItems$.value.filter(e=>e.user).map(e=>e.user.name)};this.yamcs.yamcsClient.createGroup(i).then(()=>this.router.navigate([".."],{relativeTo:this.route})).catch(e=>this.messageService.showError(e))}};hi.\u0275fac=function(e){return new(e||hi)(p(Ze),p(P),p(te),p(j),p(w),p(Ye),p(Ce),p(vt))},hi.\u0275cmp=x({type:hi,selectors:[["ng-component"]],decls:21,vars:5,consts:[["app-admin-toolbar-label",""],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["label","Group name"],["formControlName","name","type","text"],["label","Description"],["formControlName","description","rows","5"],["icon","add_circle",3,"click"],["yaDataTable","",2,"width","100%","margin-top","16px"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["routerLink","..","icon","arrow_back"],["width","1"],["colspan","3"],["matTooltip","User",2,"vertical-align","middle"],[2,"text-align","right"],["icon","delete",3,"click"]],template:function(e,r){if(e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,us,2,0,"ng-template",0),n(),a(3,"div",1)(4,"form",2)(5,"ya-field",3),s(6,"input",4),n(),a(7,"ya-field",5),s(8,"textarea",6),n(),s(9,"ya-field-divider"),a(10,"ya-button",7),D("click",function(){return r.showAddMembersDialog()}),o(11,"Add members"),n(),h(12,Cs,10,1,"table",8),_(13,"async"),n(),a(14,"p"),o(15,"\xA0"),n(),a(16,"ya-toolbar",9)(17,"ya-button",10),D("click",function(){return r.location.back()}),o(18,"Cancel"),n(),a(19,"ya-button",11),D("click",function(){return r.onConfirm()}),o(20," CREATE "),n()()()()),e&2){let m;l(4),c("formGroup",r.form),l(8),v((m=S(13,3,r.memberItems$))?12:-1,m),l(7),c("disabled",!r.form.valid)}},dependencies:[k,L,ke,T,ze,Qe,me,Me,Ie,Ae,ie,xe,_e,De,he,nt,bt,He,gt,at,U],encapsulation:2,changeDetection:0});var Wn=hi;var vi=class vi{constructor(i){this.data=i}};vi.\u0275fac=function(e){return new(e||vi)(p(Ke))},vi.\u0275cmp=x({type:vi,selectors:[["app-application-credentials-dialog"]],decls:22,vars:3,consts:[["mat-dialog-title",""],[1,"dl-horizontal"],["align","end"],["appearance","primary","mat-dialog-close",""]],template:function(e,r){e&1&&(a(0,"h2",0),o(1,"Service account created"),n(),a(2,"mat-dialog-content")(3,"p"),o(4),n(),a(5,"dl",1)(6,"dt"),o(7,"Application ID"),n(),a(8,"dd")(9,"pre"),o(10),n()(),a(11,"dt"),o(12,"Application Secret"),n(),a(13,"dd")(14,"pre"),o(15),n()()(),a(16,"strong"),o(17,"Important:"),n(),o(18,` Take note of these application credentials. It is not possible to display them after closing this dialog.
`),n(),a(19,"mat-dialog-actions",2)(20,"ya-button",3),o(21,"CLOSE"),n()()),e&2&&(l(4),y(" The service account '",r.data.name,"' was created successfully. You can use this account to connect an application to Yamcs. "),l(6),C(r.data.applicationId),l(5),C(r.data.applicationSecret))},dependencies:[T,Je,Xe,tt,et,he],encapsulation:2,changeDetection:0});var Qn=vi;function hs(t,i){t&1&&(s(0,"ya-page-icon-button",12),o(1," Create service account "))}var Si=class Si{constructor(i,e,r,m,f,E,Te,de){this.router=r;this.route=m;this.yamcs=f;this.messageService=E;this.location=Te;this.dialog=de;e.setTitle("Create service account"),this.form=i.group({name:new Z("",[ut.required])})}onConfirm(){let i={name:this.form.value.name};this.yamcs.yamcsClient.createServiceAccount(i).then(e=>this.onServerConfirm(e)).catch(e=>this.messageService.showError(e))}onServerConfirm(i){this.dialog.open(Qn,{disableClose:!0,closeOnNavigation:!1,data:i,width:"550px"}).afterClosed().subscribe(()=>{this.router.navigate([".."],{relativeTo:this.route})})}};Si.\u0275fac=function(e){return new(e||Si)(p(Ze),p(P),p(te),p(j),p(w),p(Ce),p(vt),p(Ye))},Si.\u0275cmp=x({type:Si,selectors:[["ng-component"]],decls:20,vars:4,consts:[["app-admin-toolbar-label",""],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["label","Service account name","hint","(required)"],["formControlName","name","type","text"],[2,"margin-top","32px"],["label","Impersonation"],[2,"color","gray","font-weight","400"],["type","checkbox",3,"disabled","checked"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["routerLink","..","icon","arrow_back"]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,hs,2,0,"ng-template",0),n(),a(3,"div",1)(4,"form",2)(5,"ya-field",3),s(6,"input",4),n(),a(7,"h2",5),o(8,"Scopes"),n(),a(9,"ya-field",6)(10,"label",7),s(11,"input",8),o(12," Grant permission to access the API on behalf of any user in the system. "),n()()(),a(13,"p"),o(14,"\xA0"),n(),a(15,"ya-toolbar",9)(16,"ya-button",10),D("click",function(){return r.location.back()}),o(17,"Cancel"),n(),a(18,"ya-button",11),D("click",function(){return r.onConfirm()}),o(19," CREATE "),n()()()()),e&2&&(l(4),c("formGroup",r.form),l(7),c("disabled",!0)("checked",!0),l(7),c("disabled",!r.form.valid))},dependencies:[k,L,ke,T,ze,Qe,me,Me,Ie,Ae,ie,he,nt,He,at],encapsulation:2,changeDetection:0});var zn=Si;function vs(t,i){t&1&&(s(0,"ya-page-icon-button",17),o(1," Create user "))}var bi=class bi{constructor(i,e,r,m,f){this.router=r;this.yamcs=m;this.messageService=f;e.setTitle("Create a user"),this.form=i.group({name:new Z("",[ut.required]),displayName:new Z,email:new Z,password:new Z,passwordConfirmation:new Z})}onConfirm(){let i=this.form.value,e={name:i.name};if(i.displayName&&(e.displayName=i.displayName),i.email&&(e.email=i.email),i.password){if(i.password!==i.passwordConfirmation){alert("Password confirmation does not match password");return}e.password=i.password}this.yamcs.yamcsClient.createUser(e).then(()=>this.router.navigateByUrl(`/admin/iam/users/${i.name}`)).catch(r=>this.messageService.showError(r))}};bi.\u0275fac=function(e){return new(e||bi)(p(Ze),p(P),p(te),p(w),p(Ce))},bi.\u0275cmp=x({type:bi,selectors:[["ng-component"]],decls:25,vars:2,consts:[["app-admin-toolbar-label",""],[1,"form-content","ya-form"],["novalidate","","autocomplete","off",3,"formGroup"],["label","Username","hint","(required)"],["formControlName","name","type","text"],["label","Display name","hint","(optional)"],["formControlName","displayName","type","text"],["label","Email","hint","(optional)"],["formControlName","email","type","text"],["label","Password","hint","(optional)"],[1,"hint"],["formControlName","password","type","password"],["label","Password confirmation"],["formControlName","passwordConfirmation","type","password"],["appearance","bottom"],["routerLink",".."],["appearance","primary",3,"click","disabled"],["routerLink","..","icon","arrow_back"]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,vs,2,0,"ng-template",0),n(),a(3,"div",1)(4,"form",2)(5,"ya-field",3),s(6,"input",4),n(),a(7,"ya-field",5),s(8,"input",6),n(),a(9,"ya-field",7),s(10,"input",8),n(),s(11,"ya-field-divider"),a(12,"ya-field",9)(13,"span",10),o(14," User without a password may still be able to login if an external identity provider is configured. "),n(),s(15,"input",11),n(),a(16,"ya-field",12),s(17,"input",13),n()(),a(18,"p"),o(19,"\xA0"),n(),a(20,"ya-toolbar",14)(21,"ya-button",15),o(22,"Cancel"),n(),a(23,"ya-button",16),D("click",function(){return r.onConfirm()}),o(24," CREATE "),n()()()()),e&2&&(l(4),c("formGroup",r.form),l(19),c("disabled",!r.form.valid))},dependencies:[k,L,ke,T,ze,Qe,me,Me,Ie,Ae,ie,he,nt,bt,He,at],encapsulation:2,changeDetection:0});var Zn=bi;function Ss(t,i){t&1&&(a(0,"tr")(1,"td",13),o(2,"No rows to display"),n()())}function bs(t,i){if(t&1){let e=V();a(0,"tr")(1,"td")(2,"mat-icon",14),o(3,"person"),n()(),a(4,"td"),o(5),n(),a(6,"td",15)(7,"ya-text-action",16),D("click",function(){let m=I(e).$implicit,f=u(3);return A(f.deleteItem(m))}),o(8,"DELETE"),n()()()}if(t&2){let e=i.$implicit;l(5),C(e.label)}}function gs(t,i){if(t&1&&(a(0,"table",8)(1,"tr")(2,"th",12),o(3,"Type"),n(),a(4,"th"),o(5,"Member"),n(),s(6,"th"),n(),h(7,Ss,3,0,"tr"),F(8,bs,9,1,"tr",null,$),n()),t&2){let e=i;l(7),v(e.length?-1:7),l(),N(e)}}function ys(t,i){if(t&1){let e=V();a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"div",1)(3,"form",2)(4,"ya-field",3),s(5,"input",4),n(),a(6,"ya-field",5),s(7,"textarea",6),n(),s(8,"ya-field-divider"),a(9,"ya-button",7),D("click",function(){I(e);let m=u();return A(m.showAddMembersDialog())}),o(10,"Add members"),n(),h(11,gs,10,1,"table",8),_(12,"async"),n(),a(13,"p"),o(14,"\xA0"),n(),a(15,"ya-toolbar",9)(16,"ya-button",10),D("click",function(){I(e);let m=u();return A(m.location.back())}),o(17,"Cancel"),n(),a(18,"ya-button",11),_(19,"async"),D("click",function(){I(e);let m=u();return A(m.onConfirm())}),o(20," SAVE CHANGES "),n()()()()}if(t&2){let e,r=u();l(),c("label","Edit Group: "+i.name),l(2),c("formGroup",r.form),l(8),v((e=S(12,4,r.memberItems$))?11:-1,e),l(7),c("disabled",!S(19,6,r.dirty$)||!r.form.valid)}}var gi=class gi{constructor(i,e,r,m,f,E,Te,de){this.router=r;this.yamcs=f;this.messageService=E;this.dialog=Te;this.location=de;this.memberItems$=new H([]);this.dirty$=new H(!1);e.setTitle("Edit group");let be=m.snapshot.paramMap.get("name");this.group$=f.yamcsClient.getGroup(be),this.group$.then(ue=>{this.group=ue,this.form=i.group({name:new Z(ue.name),description:new Z(ue.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)});let Ct=[];if(ue.users)for(let Ft of ue.users)Ct.push({label:Ft.displayName||Ft.name,user:Ft});this.updateMemberItems(Ct,!1)})}showAddMembersDialog(){this.dialog.open(Ci,{data:{items:this.memberItems$.value},width:"600px"}).afterClosed().subscribe(e=>{e&&this.updateMemberItems([...this.memberItems$.value,...e])})}updateMemberItems(i,e=!0){i.sort((r,m)=>r.label<m.label?-1:r.label>m.label?1:0),this.memberItems$.next(i),this.dirty$.next(e)}deleteItem(i){this.updateMemberItems(this.memberItems$.value.filter(e=>e!==i))}onConfirm(){let i=this.form.value,e={newName:i.name,description:i.description,memberInfo:{users:this.memberItems$.value.filter(m=>m.user).map(m=>m.user.name)}},r=i.name;this.yamcs.yamcsClient.editGroup(this.group.name,e).then(()=>this.router.navigateByUrl(`/admin/iam/groups/${r}`)).catch(m=>this.messageService.showError(m))}ngOnDestroy(){this.formSubscription?.unsubscribe()}};gi.\u0275fac=function(e){return new(e||gi)(p(Ze),p(P),p(te),p(j),p(w),p(Ce),p(Ye),p(vt))},gi.\u0275cmp=x({type:gi,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"label"],[1,"form-content","ya-form"],["novalidate","","autocomplete","off",3,"formGroup"],["label","Name"],["formControlName","name","type","text"],["label","Description"],["formControlName","description","rows","5"],["icon","add_circle",3,"click"],["yaDataTable","",2,"width","100%","margin-top","16px"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["width","1"],["colspan","3"],["matTooltip","User",2,"vertical-align","middle"],[2,"text-align","right"],["icon","delete",3,"click"]],template:function(e,r){if(e&1&&(h(0,ys,21,8,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.group$))?0:-1,m)}},dependencies:[k,L,T,ze,Qe,me,Me,Ie,Ae,xe,_e,De,he,nt,bt,gt,at,U],encapsulation:2,changeDetection:0});var Kn=gi;function xs(t,i){t&1&&s(0,"th",16)}function Ts(t,i){if(t&1){let e=V();a(0,"td",17),D("click",function(m){return I(e),ve(2).toggle(),A(m.stopPropagation())}),s(1,"ya-table-checkbox",18,0),n()}if(t&2){let e=i.$implicit,r=u(2);l(),c("dataSource",r.dataSource)("selection",r.selection)("item",e)}}function Ds(t,i){t&1&&(a(0,"th",19),o(1,"Role"),n())}function ws(t,i){if(t&1&&(a(0,"td",20),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.label," ")}}function Es(t,i){t&1&&s(0,"tr",21)}function Ms(t,i){if(t&1){let e=V();a(0,"tr",22),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.toggleOne(m))}),n()}if(t&2){let e=i.$implicit,r=u(2);fe("selected",r.selection.isSelected(e))}}function Is(t,i){if(t&1&&(a(0,"table",3),b(1,8),d(2,xs,1,0,"th",9)(3,Ts,3,3,"td",10),g(),b(4,11),d(5,Ds,2,0,"th",12)(6,ws,2,1,"td",13),g(),d(7,Es,1,0,"tr",14)(8,Ms,1,2,"tr",15),n()),t&2){let e=u();c("dataSource",e.dataSource),l(7),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}function As(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var yi=class yi{constructor(i,e,r){this.dialogRef=i;this.data=r;this.displayedColumns=["select","name"];this.filterControl=new Z;this.dataSource=new G;this.selection=new dn(!0,[]);let f=r.items.filter(E=>E.role).map(E=>E.role.name);e.yamcsClient.getRoles().then(E=>{let Te=(E||[]).filter(de=>f.indexOf(de.name)===-1).map(de=>({label:de.name,role:de}));this.dataSource.data=Te})}ngAfterViewInit(){this.filterControl.valueChanges.subscribe(()=>{let i=this.filterControl.value||"";this.dataSource.filter=i.toLowerCase()}),this.dataSource.filterPredicate=(i,e)=>i.label.toLowerCase().indexOf(e)>=0,this.dataSource.paginator=this.paginator}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}save(){this.dialogRef.close(this.selection.selected)}};yi.\u0275fac=function(e){return new(e||yi)(p(pn),p(w),p(Ke))},yi.\u0275cmp=x({type:yi,selectors:[["app-add-roles-dialog"]],viewQuery:function(e,r){if(e&1&&se(Fe,7),e&2){let m;re(m=le())&&(r.paginator=m.first)}},decls:13,vars:7,consts:[["cb",""],["mat-dialog-title",""],["placeholder","Filter roles","width","100%",2,"flex","1 1 auto",3,"formControl"],["mat-table","",1,"ya-data-table",2,"width","100%",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"],["matColumnDef","select"],["mat-header-cell","","class","checkbox",4,"matHeaderCellDef"],["mat-cell","","class","checkbox",3,"click",4,"cdkCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["mat-cell","",1,"checkbox",3,"click"],[3,"dataSource","selection","item"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,r){e&1&&(a(0,"h2",1),o(1,"Add roles"),n(),a(2,"mat-dialog-content")(3,"ya-filter-bar"),s(4,"ya-search-filter",2),n(),h(5,Is,9,3,"table",3),h(6,As,2,0,"ya-empty-message"),s(7,"mat-paginator",4),n(),a(8,"mat-dialog-actions",5)(9,"ya-button",6),o(10,"CANCEL"),n(),a(11,"ya-button",7),D("click",function(){return r.save()}),o(12,"ADD"),n()()),e&2&&(l(4),c("formControl",r.filterControl),l(),v(r.dataSource?5:-1),l(),v(r.dataSource.data.length?-1:6),l(),c("pageSize",10)("hidePageSize",!0)("showFirstLastButtons",!1),l(4),c("disabled",r.selection.isEmpty()))},dependencies:[T,me,$e,Vt,Je,Xe,tt,et,Fe,q,ne,ae,W,K,X,J,Q,ee,z,he,Re,ye,Pe,Sn],styles:[".selected[_ngcontent-%COMP%]{background-color:#f0f4fd!important}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var Jn=yi;function Rs(t,i){t&1&&(a(0,"span",7),o(1," This user has an external identity. Changes to this field may get overwritten on next login. "),n())}function Ps(t,i){t&1&&(a(0,"span",7),o(1," This user has an external identity. Changes to this field may get overwritten on next login. "),n())}function ks(t,i){t&1&&(a(0,"tr")(1,"td",19),o(2,"No rows to display"),n()())}function Ls(t,i){if(t&1){let e=V();a(0,"tr")(1,"td"),o(2),n(),a(3,"td",20)(4,"ya-text-action",21),D("click",function(){let m=I(e).$implicit,f=u(3);return A(f.deleteItem(m))}),o(5,"DELETE"),n()()()}if(t&2){let e=i.$implicit;l(2),C(e.label)}}function $s(t,i){if(t&1&&(a(0,"table",15)(1,"tr")(2,"th"),o(3,"Role"),n(),s(4,"th"),n(),h(5,ks,3,0,"tr"),F(6,Ls,6,1,"tr",null,$),n()),t&2){let e=i;l(5),v(e.length?-1:5),l(),N(e)}}function Fs(t,i){if(t&1){let e=V();a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"div",1)(3,"form",2)(4,"ya-field",3),s(5,"input",4),n(),a(6,"ya-field",5),s(7,"input",6),h(8,Rs,2,0,"span",7),n(),a(9,"ya-field",8),s(10,"input",9),h(11,Ps,2,0,"span",7),n(),a(12,"ya-field",10),s(13,"mat-slide-toggle",11)(14,"br"),a(15,"span",7),o(16,' Inactive users are considered "blocked". They are not or no longer able to login. '),n()(),a(17,"ya-field",12),s(18,"mat-slide-toggle",13)(19,"br"),a(20,"span",7),o(21," Superusers bypass any permission checks. This attribute is intended for system administrators only. "),n()(),s(22,"ya-field-divider"),a(23,"ya-button",14),D("click",function(){I(e);let m=u();return A(m.showAddRolesDialog())}),o(24,"Add roles"),n(),h(25,$s,8,1,"table",15),_(26,"async"),n(),a(27,"p"),o(28,"\xA0"),n(),a(29,"ya-toolbar",16)(30,"ya-button",17),D("click",function(){I(e);let m=u();return A(m.location.back())}),o(31,"Cancel"),n(),a(32,"ya-button",18),_(33,"async"),D("click",function(){I(e);let m=u();return A(m.onConfirm())}),o(34," SAVE CHANGES "),n()()()()}if(t&2){let e,r=i,m=u();l(),c("label","Edit user: "+(r.displayName||r.name)),l(2),c("formGroup",m.form),l(2),c("value",r.name),l(3),v(r.identities&&r.identities.length>0?8:-1),l(3),v(r.identities&&r.identities.length>0?11:-1),l(14),v((e=S(26,7,m.roleItems$))?25:-1,e),l(7),c("disabled",!S(33,9,m.dirty$)||!m.form.valid)}}var xi=class xi{constructor(i,e,r,m,f,E,Te,de){this.router=r;this.route=m;this.yamcs=f;this.messageService=E;this.dialog=Te;this.location=de;this.roleItems$=new H([]);this.dirty$=new H(!1);e.setTitle("Edit user");let be=m.snapshot.paramMap.get("username");this.user$=f.yamcsClient.getUser(be),this.user$.then(ue=>{this.user=ue,this.form=i.group({displayName:new Z(ue.displayName),email:new Z(ue.email),active:new Z(ue.active),superuser:new Z(ue.superuser)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)});let Ct=[];if(ue.roles)for(let Ft of ue.roles)Ct.push({label:Ft.name,role:Ft});this.updateRoleItems(Ct,!1)})}showAddRolesDialog(){this.dialog.open(Jn,{data:{items:this.roleItems$.value},width:"600px"}).afterClosed().subscribe(e=>{e&&this.updateRoleItems([...this.roleItems$.value,...e])})}updateRoleItems(i,e=!0){i.sort((r,m)=>r.label<m.label?-1:r.label>m.label?1:0),this.roleItems$.next(i),this.dirty$.next(e)}deleteItem(i){this.updateRoleItems(this.roleItems$.value.filter(e=>e!==i))}onConfirm(){let i=this.form.value,e={roleAssignment:{roles:this.roleItems$.value.filter(r=>r.role).map(r=>r.role.name)}};i.displayName!==this.user.displayName&&(e.displayName=i.displayName),i.email!==this.user.email&&(e.email=i.email),i.active!==this.user.active&&(e.active=i.active),i.superuser!==this.user.superuser&&(e.superuser=i.superuser),this.yamcs.yamcsClient.editUser(this.user.name,e).then(()=>this.router.navigate([".."],{relativeTo:this.route})).catch(r=>this.messageService.showError(r))}ngOnDestroy(){this.formSubscription?.unsubscribe()}};xi.\u0275fac=function(e){return new(e||xi)(p(Ze),p(P),p(te),p(j),p(w),p(Ce),p(Ye),p(vt))},xi.\u0275cmp=x({type:xi,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"label"],[1,"form-content","ya-form"],["novalidate","","autocomplete","off",3,"formGroup"],["label","Username"],["disabled","","type","text",3,"value"],["label","Display name"],["formControlName","displayName","type","text"],[1,"hint"],["label","Email"],["formControlName","email","type","text"],["label","Active"],["formControlName","active"],["label","Superuser"],["formControlName","superuser"],["icon","add_circle",3,"click"],["yaDataTable","",2,"margin-top","16px","width","100%"],["appearance","bottom"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","2"],[2,"text-align","right"],["icon","delete",3,"click"]],template:function(e,r){if(e&1&&(h(0,Fs,35,11,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.user$))?0:-1,m)}},dependencies:[k,L,T,ze,Qe,me,Me,Ie,Ae,xe,ho,he,nt,bt,gt,at,U],encapsulation:2,changeDetection:0});var Xn=xi;var Ns=t=>[t,"edit"];function Bs(t,i){t&1&&(a(0,"th",12),o(1,"Group"),n())}function js(t,i){if(t&1&&(a(0,"td",13)(1,"a",14),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),C(e.name)}}function Vs(t,i){t&1&&(a(0,"th",12),o(1,"Members"),n())}function Us(t,i){if(t&1&&(a(0,"mat-icon",15),o(1,"person"),n(),o(2),s(3,"br")),t&2){let e=i.$implicit;l(2),y(" ",e.displayName||e.name," ")}}function Ys(t,i){if(t&1&&(a(0,"td",13),F(1,Us,4,1,null,null,$),n()),t&2){let e=i.$implicit;l(),N(e.users)}}function Os(t,i){t&1&&s(0,"th",16)}function Hs(t,i){if(t&1){let e=V();a(0,"td",13)(1,"ya-more")(2,"a",17),o(3,"Edit group"),n(),a(4,"button",18),D("click",function(){let m=I(e).$implicit,f=u();return A(f.deleteGroup(m.name))}),o(5,"Delete group"),n()()()}if(t&2){let e=i.$implicit;l(2),c("routerLink",ge(1,Ns,e.name))}}function Gs(t,i){t&1&&s(0,"tr",19)}function qs(t,i){t&1&&s(0,"tr",20)}function Ws(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var Ti=class Ti{constructor(i,e,r,m,f){this.yamcs=i;this.route=r;this.router=m;this.messageService=f;this.filterControl=new Z;this.displayedColumns=["name","members","actions"];this.dataSource=new G;e.setTitle("Groups"),this.dataSource.filterPredicate=(E,Te)=>E.name.toLowerCase().indexOf(Te)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh(),this.dataSource.sort=this.sort}refresh(){this.yamcs.yamcsClient.getGroups().then(i=>{this.dataSource.data=i})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteGroup(i){confirm(`Are you sure you want to delete group ${i}`)&&this.yamcs.yamcsClient.deleteGroup(i).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}};Ti.\u0275fac=function(e){return new(e||Ti)(p(w),p(P),p(j),p(te),p(Ce))},Ti.\u0275cmp=x({type:Ti,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:20,vars:5,consts:[["label","Groups"],["routerLink","create","icon","add_box"],["placeholder","Filter groups",3,"formControl"],["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","members"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],[1,"icon16",2,"vertical-align","middle"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),o(3,"Create group"),n()(),a(4,"ya-panel")(5,"ya-filter-bar"),s(6,"ya-search-filter",2),n(),a(7,"table",3),b(8,4),d(9,Bs,2,0,"th",5)(10,js,3,2,"td",6),g(),b(11,7),d(12,Vs,2,0,"th",5)(13,Ys,3,0,"td",6),g(),b(14,8),d(15,Os,1,0,"th",9)(16,Hs,6,3,"td",6),g(),d(17,Gs,1,0,"tr",10)(18,qs,1,0,"tr",11),n(),h(19,Ws,2,0,"ya-empty-message"),n()()),e&2&&(l(6),c("formControl",r.filterControl),l(),c("dataSource",r.dataSource),l(10),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),v(r.dataSource.data.length?-1:19))},dependencies:[k,L,T,me,$e,ie,_e,pt,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,Re,ye,xt,Ne,R,Pe],encapsulation:2,changeDetection:0});var ea=Ti;var Qs=t=>["/admin/iam/users",t];function zs(t,i){if(t&1&&(a(0,"div",3),s(1,"mat-divider"),n(),a(2,"h4"),o(3,"Description"),n(),a(4,"div",4),o(5),n()),t&2){let e=u();l(5),C(e.description||"-")}}function Zs(t,i){if(t&1&&(a(0,"div")(1,"mat-icon",5),o(2," person "),n(),a(3,"a",6),o(4),n()()),t&2){let e=i.$implicit;l(3),c("routerLink",ge(2,Qs,e.name)),l(),C(e.displayName||e.name)}}function Ks(t,i){if(t&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),o(3,"Edit group"),n()(),a(4,"ya-panel",2),h(5,zs,6,1),s(6,"br"),a(7,"div",3),s(8,"mat-divider"),n(),a(9,"h4"),o(10),n(),F(11,Zs,5,4,"div",null,$),n()()),t&2){let e=i;l(),c("label",e.name),l(4),v(e.description?5:-1),l(5),y("",(e.users==null?null:e.users.length)||0," members"),l(),N(e.users)}}var Di=class Di{constructor(i,e,r){this.yamcs=e;this.title=r;this.group$=new H(null);i.paramMap.subscribe(m=>{let f=m.get("name");this.changeGroup(f)})}changeGroup(i){this.yamcs.yamcsClient.getGroup(i).then(e=>{this.group$.next(e),this.title.setTitle(e.name)})}};Di.\u0275fac=function(e){return new(e||Di)(p(j),p(w),p(P))},Di.\u0275cmp=x({type:Di,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"label"],["routerLink","edit","icon","edit"],[1,"ya-link"],[1,"section-divider"],[2,"white-space","pre-wrap"],["matTooltip","User",1,"icon16",2,"vertical-align","middle"],[3,"routerLink"]],template:function(e,r){if(e&1&&(h(0,Ks,13,3,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.group$))?0:-1,m)}},dependencies:[k,L,T,ie,_e,it,De,Ne,R,U],encapsulation:2,changeDetection:0});var ia=Di;function Js(t,i){t&1&&(a(0,"th",12),o(1,"Role"),n())}function Xs(t,i){if(t&1&&(a(0,"td",13)(1,"a",14),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),C(e.name)}}function ec(t,i){t&1&&(a(0,"th",15),o(1,"Default"),n())}function tc(t,i){if(t&1&&(a(0,"td",13),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.default?"Yes":"No"," ")}}function ic(t,i){t&1&&s(0,"th",16)}function nc(t,i){t&1&&s(0,"td",13)}function ac(t,i){t&1&&s(0,"tr",17)}function oc(t,i){t&1&&s(0,"tr",18)}function rc(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var wi=class wi{constructor(i,e,r,m){this.yamcs=i;this.route=r;this.router=m;this.filterControl=new Z;this.displayedColumns=["name","default","actions"];this.dataSource=new G;e.setTitle("Roles"),this.dataSource.filterPredicate=(f,E)=>f.name.toLowerCase().indexOf(E)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh(),this.dataSource.sort=this.sort}refresh(){this.yamcs.yamcsClient.getRoles().then(i=>{this.dataSource.data=i})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}};wi.\u0275fac=function(e){return new(e||wi)(p(w),p(P),p(j),p(te))},wi.\u0275cmp=x({type:wi,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:18,vars:5,consts:[["label","Roles"],["placeholder","Filter roles",3,"formControl"],["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","default"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"ya-filter-bar"),s(4,"ya-search-filter",1),n(),a(5,"table",2),b(6,3),d(7,Js,2,0,"th",4)(8,Xs,3,2,"td",5),g(),b(9,6),d(10,ec,2,0,"th",7)(11,tc,2,1,"td",5),g(),b(12,8),d(13,ic,1,0,"th",9)(14,nc,1,0,"td",5),g(),d(15,ac,1,0,"tr",10)(16,oc,1,0,"tr",11),n(),h(17,rc,2,0,"ya-empty-message"),n()()),e&2&&(l(4),c("formControl",r.filterControl),l(),c("dataSource",r.dataSource),l(10),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),v(r.dataSource.data.length?-1:17))},dependencies:[k,L,T,me,$e,ie,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,Re,ye,R,Pe],encapsulation:2,changeDetection:0});var na=wi;function lc(t,i){if(t&1&&(a(0,"div"),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e," ")}}function mc(t,i){if(t&1&&(a(0,"dt"),o(1),n(),a(2,"dd"),o(3),n()),t&2){let e=i.$implicit;l(),C(e.type),l(2),C(e.objects)}}function sc(t,i){if(t&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel",1)(3,"h4"),o(4,"Description"),n(),a(5,"div",2),o(6),n(),s(7,"br"),a(8,"div",3),s(9,"mat-divider"),n(),a(10,"h4"),o(11),n(),F(12,lc,2,1,"div",null,$),s(14,"br"),a(15,"div",3),s(16,"mat-divider"),n(),a(17,"h4"),o(18),n(),a(19,"dl"),F(20,mc,4,2,null,null,$),n()()()),t&2){let e=i;l(),c("label",e.name),l(5),C(e.description||"-"),l(5),y("",(e.systemPrivileges==null?null:e.systemPrivileges.length)||0," assigned system privileges"),l(),N(e.systemPrivileges),l(6),y("",(e.objectPrivileges==null?null:e.objectPrivileges.length)||0," assigned object privileges"),l(2),N(e.objectPrivileges)}}var Ei=class Ei{constructor(i,e,r){this.yamcs=e;this.title=r;this.role$=new H(null);i.paramMap.subscribe(m=>{let f=m.get("name");this.changeRole(f)})}changeRole(i){this.yamcs.yamcsClient.getRole(i).then(e=>{this.role$.next(e),this.title.setTitle(e.name)})}};Ei.\u0275fac=function(e){return new(e||Ei)(p(j),p(w),p(P))},Ei.\u0275cmp=x({type:Ei,selectors:[["ng-component"]],decls:2,vars:3,consts:[[3,"label"],[1,"ya-link"],[2,"white-space","pre-wrap"],[1,"section-divider"]],template:function(e,r){if(e&1&&(h(0,sc,22,4,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.role$))?0:-1,m)}},dependencies:[k,L,T,it,R,U],encapsulation:2,changeDetection:0});var aa=Ei;function cc(t,i){t&1&&(a(0,"th",11),o(1,"Service account"),n())}function pc(t,i){if(t&1&&(a(0,"td",12),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.name," ")}}function dc(t,i){t&1&&s(0,"th",13)}function uc(t,i){if(t&1){let e=V();a(0,"td",12)(1,"ya-more")(2,"button",14),D("click",function(){let m=I(e).$implicit,f=u();return A(f.deleteServiceAccount(m.name))}),o(3," Delete service account "),n()()()}}function fc(t,i){t&1&&s(0,"tr",15)}function _c(t,i){t&1&&s(0,"tr",16)}function Cc(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var Mi=class Mi{constructor(i,e,r,m,f){this.yamcs=i;this.route=r;this.router=m;this.messageService=f;this.filterControl=new Z;this.displayedColumns=["name","actions"];this.dataSource=new G;e.setTitle("Service accounts"),this.dataSource.filterPredicate=(E,Te)=>E.name.toLowerCase().indexOf(Te)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh(),this.dataSource.sort=this.sort}refresh(){this.yamcs.yamcsClient.getServiceAccounts().then(i=>{this.dataSource.data=i.serviceAccounts||[]})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteServiceAccount(i){confirm(`Are you sure you want to delete service account ${i}`)&&this.yamcs.yamcsClient.deleteServiceAccount(i).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}};Mi.\u0275fac=function(e){return new(e||Mi)(p(w),p(P),p(j),p(te),p(Ce))},Mi.\u0275cmp=x({type:Mi,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},decls:17,vars:5,consts:[["label","Service accounts"],["routerLink","create","icon","add_box"],["placeholder","Filter service accounts",3,"formControl"],["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),o(3,"Create service account"),n()(),a(4,"ya-panel")(5,"ya-filter-bar"),s(6,"ya-search-filter",2),n(),a(7,"table",3),b(8,4),d(9,cc,2,0,"th",5)(10,pc,2,1,"td",6),g(),b(11,7),d(12,dc,1,0,"th",8)(13,uc,4,0,"td",6),g(),d(14,fc,1,0,"tr",9)(15,_c,1,0,"tr",10),n(),h(16,Cc,2,0,"ya-empty-message"),n()()),e&2&&(l(6),c("formControl",r.filterControl),l(),c("dataSource",r.dataSource),l(7),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),v(r.dataSource.data.length?-1:16))},dependencies:[k,L,T,me,$e,ie,pt,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,Re,ye,xt,Ne,R,Pe],encapsulation:2,changeDetection:0});var oa=Mi;var hc=t=>[t,"edit"];function vc(t,i){t&1&&(a(0,"th",13),o(1,"Username"),n())}function Sc(t,i){if(t&1&&(a(0,"td",14)(1,"a",15),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.name),l(),y(" ",e.name," ")}}function bc(t,i){t&1&&(a(0,"th",13),o(1,"Display name"),n())}function gc(t,i){if(t&1&&(a(0,"td",14),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.displayName||"-"," ")}}function yc(t,i){t&1&&(a(0,"th",16),o(1,"Groups"),n())}function xc(t,i){t&1&&o(0," , ")}function Tc(t,i){if(t&1&&(h(0,xc,1,0),o(1)),t&2){let e=i.$implicit,r=i.$index;v(r!==0?0:-1),l(),y(" ",e.name," ")}}function Dc(t,i){t&1&&o(0," - ")}function wc(t,i){if(t&1&&(a(0,"td",14),F(1,Tc,2,2,null,null,$),h(3,Dc,1,0),n()),t&2){let e=i.$implicit;l(),N(e.groups),l(2),v(e.groups?-1:3)}}function Ec(t,i){t&1&&(a(0,"th",13),o(1,"Registered"),n())}function Mc(t,i){if(t&1&&(a(0,"td",14),o(1),_(2,"datetime"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.creationTime)||"never")}}function Ic(t,i){t&1&&(a(0,"th",13),o(1,"Last Login"),n())}function Ac(t,i){if(t&1&&(a(0,"td",14),o(1),_(2,"datetime"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.lastLoginTime)||"never")}}function Rc(t,i){t&1&&s(0,"th",17)}function Pc(t,i){if(t&1){let e=V();a(0,"td",14)(1,"ya-more")(2,"a",18),o(3,"Edit user"),n(),a(4,"button",19),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.deleteUser.next(m.name))}),o(5,"Delete user"),n()()()}if(t&2){let e=i.$implicit;l(2),c("routerLink",ge(1,hc,e.name))}}function kc(t,i){t&1&&s(0,"tr",20)}function Lc(t,i){t&1&&s(0,"tr",21)}function $c(t,i){if(t&1&&(a(0,"table",0),b(1,1),d(2,vc,2,0,"th",2)(3,Sc,3,2,"td",3),g(),b(4,4),d(5,bc,2,0,"th",2)(6,gc,2,1,"td",3),g(),b(7,5),d(8,yc,2,0,"th",6)(9,wc,4,1,"td",3),g(),b(10,7),d(11,Ec,2,0,"th",2)(12,Mc,3,3,"td",3),g(),b(13,8),d(14,Ic,2,0,"th",2)(15,Ac,3,3,"td",3),g(),b(16,9),d(17,Rc,1,0,"th",10)(18,Pc,6,3,"td",3),g(),d(19,kc,1,0,"tr",11)(20,Lc,1,0,"tr",12),n()),t&2){let e=u();c("dataSource",e.dataSource),l(19),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}function Fc(t,i){t&1&&(a(0,"ya-empty-message"),o(1,"No rows to display"),n())}var Ii=class Ii{constructor(){this.displayedColumns=["name","displayName","groups","actions"];this.deleteUser=new Xi;this.dataSource=new G}ngAfterViewInit(){this.dataSource.filterPredicate=(i,e)=>i.name.toLowerCase().indexOf(e)>=0,this.dataSource.sort=this.sort}ngOnChanges(){this.dataSource.data=this.users||[],this.dataSource.filter=this.filter}};Ii.\u0275fac=function(e){return new(e||Ii)},Ii.\u0275cmp=x({type:Ii,selectors:[["app-users-table"]],viewQuery:function(e,r){if(e&1&&se(O,5),e&2){let m;re(m=le())&&(r.sort=m.first)}},inputs:{users:"users",filter:"filter"},outputs:{deleteUser:"deleteUser"},features:[nn],decls:2,vars:2,consts:[["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","displayName"],["matColumnDef","groups"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","registered"],["matColumnDef","lastLogin"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell",""],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(h(0,$c,21,3,"table",0),h(1,Fc,2,0,"ya-empty-message")),e&2&&(v(r.dataSource?0:-1),l(),v(r.dataSource.data.length?-1:1))},dependencies:[T,ie,pt,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,Re,xt,yt],encapsulation:2,changeDetection:0});var ra=Ii;function Bc(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Active (",S(1,1,e.activeUserCount$),")")}}function jc(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Superusers (",S(1,1,e.superUserCount$),")")}}function Vc(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Internal (",S(1,1,e.internalUserCount$),")")}}function Uc(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Blocked (",S(1,1,e.blockedUserCount$),")")}}var Ai=class Ai{constructor(i,e,r,m,f){this.yamcs=i;this.route=r;this.router=m;this.messageService=f;this.filterControl=new Z;this.filterValue$=new H(null);this.users$=new H([]);e.setTitle("Users")}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.filterValue$.next(i.get("filter").toLowerCase())),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.filterValue$.next(e.toLowerCase())}),this.activeUsers$=this.users$.pipe(Ee(e=>e.filter(r=>r.active))),this.activeUserCount$=this.activeUsers$.pipe(Ee(e=>e.length)),this.superUsers$=this.users$.pipe(Ee(e=>e.filter(r=>r.superuser))),this.superUserCount$=this.superUsers$.pipe(Ee(e=>e.length)),this.internalUsers$=this.users$.pipe(Ee(e=>e.filter(r=>!r.identities))),this.internalUserCount$=this.internalUsers$.pipe(Ee(e=>e.length)),this.blockedUsers$=this.users$.pipe(Ee(e=>e.filter(r=>!r.active))),this.blockedUserCount$=this.blockedUsers$.pipe(Ee(e=>e.length)),this.refresh()}refresh(){this.yamcs.yamcsClient.getUsers().then(i=>{this.users$.next(i)})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteUser(i){confirm(`Are you sure you want to delete the user account '${i}'`)&&this.yamcs.yamcsClient.deleteUser(i).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}};Ai.\u0275fac=function(e){return new(e||Ai)(p(w),p(P),p(j),p(te),p(Ce))},Ai.\u0275cmp=x({type:Ai,selectors:[["ng-component"]],decls:32,vars:27,consts:[["label","Users"],["routerLink","create","icon","add_box"],["placeholder","Filter users",3,"formControl"],["animationDuration","0ms",1,"secondary",3,"mat-stretch-tabs"],["mat-tab-label",""],[3,"deleteUser","users","filter"],[3,"disabled"]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),o(3,"Create user"),n()(),a(4,"ya-panel")(5,"ya-filter-bar"),s(6,"ya-search-filter",2),n(),a(7,"mat-tab-group",3)(8,"mat-tab"),d(9,Bc,2,3,"ng-template",4),s(10,"br"),a(11,"app-users-table",5),_(12,"async"),_(13,"async"),D("deleteUser",function(f){return r.deleteUser(f)}),n()(),a(14,"mat-tab",6),d(15,jc,2,3,"ng-template",4),s(16,"br"),a(17,"app-users-table",5),_(18,"async"),_(19,"async"),D("deleteUser",function(f){return r.deleteUser(f)}),n()(),a(20,"mat-tab"),d(21,Vc,2,3,"ng-template",4),s(22,"br"),a(23,"app-users-table",5),_(24,"async"),_(25,"async"),D("deleteUser",function(f){return r.deleteUser(f)}),n()(),a(26,"mat-tab"),d(27,Uc,2,3,"ng-template",4),s(28,"br"),a(29,"app-users-table",5),_(30,"async"),_(31,"async"),D("deleteUser",function(f){return r.deleteUser(f)}),n()()()()()),e&2&&(l(6),c("formControl",r.filterControl),l(),c("mat-stretch-tabs",!1),l(4),c("users",S(12,11,r.activeUsers$))("filter",S(13,13,r.filterValue$)),l(3),c("disabled",!0),l(3),c("users",S(18,15,r.superUsers$))("filter",S(19,17,r.filterValue$)),l(6),c("users",S(24,19,r.internalUsers$))("filter",S(25,21,r.filterValue$)),l(6),c("users",S(30,23,r.blockedUsers$))("filter",S(31,25,r.filterValue$)))},dependencies:[k,L,T,me,$e,ie,un,fn,_n,ye,Ne,R,Pe,ra,U],encapsulation:2,changeDetection:0});var la=Ai;function Yc(t,i){t&1&&(a(0,"p"),o(1,"Confirmation does not match password"),n())}var Oc=t=>{let i=t.get("password").value,e=t.get("passwordConfirmation").value;return i&&e&&i!==e?{passwordMismatch:!0}:null},Ri=class Ri{constructor(i,e,r){this.data=i;this.yamcs=e;this.user=i.user,this.form=r.group({password:new Z(null,ut.required),passwordConfirmation:new Z(null,ut.required)},{validator:Oc})}changePassword(){let i=this.form.value;this.yamcs.yamcsClient.editUser(this.user.name,{password:i.password})}};Ri.\u0275fac=function(e){return new(e||Ri)(p(Ke),p(w),p(Ze))},Ri.\u0275cmp=x({type:Ri,selectors:[["app-change-user-password-dialog"]],decls:14,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["label","Password"],["type","password","formControlName","password"],["label","Password confirmation"],["type","password","formControlName","passwordConfirmation"],["align","end"],["mat-dialog-close",""],["appearance","primary","mat-dialog-close","",3,"click","disabled"]],template:function(e,r){e&1&&(a(0,"h2",0),o(1),n(),a(2,"mat-dialog-content")(3,"form",1)(4,"ya-field",2),s(5,"input",3),n(),a(6,"ya-field",4),s(7,"input",5),n()(),h(8,Yc,2,0,"p"),n(),a(9,"mat-dialog-actions",6)(10,"ya-button",7),o(11,"CANCEL"),n(),a(12,"ya-button",8),D("click",function(){return r.changePassword()}),o(13," OK "),n()()),e&2&&(l(),y("Change password of ",r.user.name),l(2),c("formGroup",r.form),l(5),v(r.form.errors!=null&&r.form.errors.passwordMismatch?8:-1),l(4),c("disabled",!r.form.valid))},dependencies:[T,ze,Qe,me,Me,Ie,Ae,Je,Xe,tt,et,he,nt],encapsulation:2,changeDetection:0});var ma=Ri;var Hc=t=>[t];function Gc(t,i){if(t&1&&(s(0,"ya-page-icon-button",7),o(1)),t&2){let e=u();l(),y(" ",e.displayName||e.name," ")}}function qc(t,i){if(t&1&&(a(0,"a",5),o(1),n()),t&2){let e=u();c("routerLink",ge(2,Hc,"../"+e.createdBy.name)),l(),C(e.createdBy.name||"-")}}function Wc(t,i){t&1&&o(0," - ")}function Qc(t,i){if(t&1&&(o(0),s(1,"br")),t&2){let e=i.$implicit;y(" ",e.name," ")}}function zc(t,i){if(t&1){let e=V();a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),a(5,"td")(6,"ya-text-action",9),D("click",function(){let m=I(e).$implicit,f=u(3);return A(f.deleteIdentity(m))}),o(7," DELETE "),n()()()}if(t&2){let e=i.$implicit;l(2),C(e.identity),l(2),C(e.provider)}}function Zc(t,i){if(t&1&&(a(0,"div",6),s(1,"mat-divider"),n(),a(2,"h4"),o(3,"External Identities"),n(),a(4,"table",8)(5,"tr")(6,"th"),o(7,"Identity"),n(),a(8,"th"),o(9,"Provider"),n(),s(10,"th"),n(),F(11,zc,8,2,"tr",null,$),n()),t&2){let e=u();l(11),N(e.identities)}}function Kc(t,i){if(t&1){let e=V();a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,Gc,2,1,"ng-template",0),a(3,"ya-page-button",1),o(4,"Edit user"),n(),a(5,"ya-page-button",2),D("clicked",function(){I(e);let m=u();return A(m.showChangeUserPasswordDialog())}),o(6," Change password "),n()(),a(7,"ya-panel",3)(8,"dl",4)(9,"dt"),o(10,"Username"),n(),a(11,"dd"),o(12),n(),a(13,"dt"),o(14,"Display name"),n(),a(15,"dd"),o(16),n(),a(17,"dt"),o(18,"Email"),n(),a(19,"dd"),o(20),n(),a(21,"dt"),o(22,"Joined"),n(),a(23,"dd"),o(24),_(25,"datetime"),n(),a(26,"dt"),o(27,"Confirmed at"),n(),a(28,"dd"),o(29),_(30,"datetime"),n(),a(31,"dt"),o(32,"Last login"),n(),a(33,"dd"),o(34),_(35,"datetime"),n(),a(36,"dt"),o(37,"Active"),n(),a(38,"dd"),o(39),n(),a(40,"dt"),o(41,"Superuser"),n(),a(42,"dd"),o(43),n(),a(44,"dt"),o(45,"Created by"),n(),a(46,"dd"),h(47,qc,2,4,"a",5)(48,Wc,1,0),n()(),a(49,"div",6),s(50,"mat-divider"),n(),a(51,"h4"),o(52),n(),F(53,Qc,2,1,null,null,$),h(55,Zc,13,0),n()()}if(t&2){let e=i;l(5),c("disabled",e.identities==null?null:e.identities.length),l(7),C(e.name),l(4),C(e.displayName||"-"),l(4),C(e.email||"-"),l(4),C(S(25,12,e.creationTime)),l(5),C(S(30,14,e.confirmationTime)||"never"),l(5),C(S(35,16,e.lastLoginTime)||"never"),l(5),C(e.active),l(4),C(e.superuser),l(4),v(e.createdBy?47:48),l(5),y("",(e.roles==null?null:e.roles.length)||"0"," assigned roles"),l(),N(e.roles),l(2),v(e.identities?55:-1)}}var Pi=class Pi{constructor(i,e,r,m,f){this.yamcs=e;this.title=r;this.dialog=m;this.messageService=f;this.user$=new H(null);i.paramMap.subscribe(E=>{let Te=E.get("username");this.changeUser(Te)})}changeUser(i){this.yamcs.yamcsClient.getUser(i).then(e=>{this.user$.next(e),this.title.setTitle(e.name)})}deleteIdentity(i){if(confirm(`Are you sure you want to delete the ${i.provider} identity?`)){let e=this.user$.value.name;this.yamcs.yamcsClient.deleteIdentity(e,i.provider).then(()=>this.changeUser(e)).catch(r=>this.messageService.showError(r))}}showChangeUserPasswordDialog(){this.dialog.open(ma,{data:{user:this.user$.value},width:"400px"})}};Pi.\u0275fac=function(e){return new(e||Pi)(p(j),p(w),p(P),p(Ye),p(Ce))},Pi.\u0275cmp=x({type:Pi,selectors:[["ng-component"]],decls:2,vars:3,consts:[["app-admin-toolbar-label",""],["routerLink","edit","icon","edit"],["icon","account_box",3,"clicked","disabled"],[1,"ya-link"],[1,"dl-horizontal"],[3,"routerLink"],[1,"section-divider"],["routerLink","..","icon","arrow_back"],["yaDataTable",""],["icon","delete",3,"click"]],template:function(e,r){if(e&1&&(h(0,Kc,56,18,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.user$))?0:-1,m)}},dependencies:[k,L,ke,T,ie,xe,it,Ne,He,R,gt,U,yt],encapsulation:2,changeDetection:0});var sa=Pi;function Jc(t,i){t&1&&(a(0,"th",12),o(1,"Valid period (at 0h UTC)"),n())}function Xc(t,i){if(t&1&&(a(0,"td",13),o(1),_(2,"date"),_(3,"date"),n()),t&2){let e=i.$implicit;l(),ct(" ",Ue(2,2,e.start,"y-MM-dd")," \u2013 ",Ue(3,5,e.stop,"y-MM-dd")," ")}}function ep(t,i){t&1&&(a(0,"th",12),o(1,"Leap seconds"),n())}function tp(t,i){if(t&1&&(a(0,"td",13),o(1),n()),t&2){let e=i.$implicit;l(),C(e.leapSeconds)}}function ip(t,i){t&1&&(a(0,"th",12),o(1,"TAI - UTC"),n())}function np(t,i){if(t&1&&(a(0,"td",13),o(1),n()),t&2){let e=i.$implicit;l(),y("",e.taiDifference," s")}}function ap(t,i){t&1&&(a(0,"th",12),o(1,"UTC - TAI"),n())}function op(t,i){if(t&1&&(a(0,"td",13),o(1),n()),t&2){let e=i.$implicit;l(),y("",-e.taiDifference," s")}}function rp(t,i){t&1&&s(0,"th",14)}function lp(t,i){t&1&&s(0,"td",13)}function mp(t,i){t&1&&s(0,"tr",15)}function sp(t,i){t&1&&s(0,"tr",16)}var ki=class ki{constructor(i,e){this.displayedColumns=["period","leap-seconds","tai-utc","actions"];this.dataSource=new G;e.setTitle("Leap seconds"),i.yamcsClient.getLeapSeconds().then(r=>{this.dataSource.data=r.ranges})}};ki.\u0275fac=function(e){return new(e||ki)(p(w),p(P))},ki.\u0275cmp=x({type:ki,selectors:[["ng-component"]],decls:21,vars:3,consts:[["label","Leap seconds"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","period"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","leap-seconds"],["matColumnDef","tai-utc"],["matColumnDef","utc-tai"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"table",1),b(4,2),d(5,Jc,2,0,"th",3)(6,Xc,4,8,"td",4),g(),b(7,5),d(8,ep,2,0,"th",3)(9,tp,2,1,"td",4),g(),b(10,6),d(11,ip,2,0,"th",3)(12,np,2,1,"td",4),g(),b(13,7),d(14,ap,2,0,"th",3)(15,op,2,1,"td",4),g(),b(16,8),d(17,rp,1,0,"th",9)(18,lp,1,0,"td",4),g(),d(19,mp,1,0,"tr",10)(20,sp,1,0,"tr",11),n()()()),e&2&&(l(3),c("dataSource",r.dataSource),l(16),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[k,L,T,q,ne,ae,W,K,X,J,Q,ee,z,R,to],encapsulation:2,changeDetection:0});var ca=ki;var Ko=(t,i)=>{let r=Ve(w).yamcsClient.createParseFilterSubscription({resource:"pids",filter:""},()=>null);return new Promise((m,f)=>{r.addReplyListener(()=>{m(r)})})};function cp(t,i){t&1&&(a(0,"th",7),o(1,"Name"),n())}function pp(t,i){if(t&1&&(a(0,"td",8),o(1),n()),t&2){let e=i.$implicit;l(),C(e)}}function dp(t,i){t&1&&s(0,"tr",9)}function up(t,i){t&1&&s(0,"tr",10)}var Li=class Li{constructor(i,e){this.displayedColumns=["name"];this.dataSource=new G;e.setTitle("Processor types"),i.yamcsClient.getProcessorTypes().then(r=>{this.dataSource.data=r.types||[]})}};Li.\u0275fac=function(e){return new(e||Li)(p(w),p(P))},Li.\u0275cmp=x({type:Li,selectors:[["ng-component"]],decls:9,vars:3,consts:[["label","Processor types"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"table",1),b(4,2),d(5,cp,2,0,"th",3)(6,pp,2,1,"td",4),g(),d(7,dp,1,0,"tr",5)(8,up,1,0,"tr",6),n()()()),e&2&&(l(3),c("dataSource",r.dataSource),l(4),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[k,L,T,q,ne,ae,W,K,X,J,Q,ee,z,R],encapsulation:2,changeDetection:0});var pa=Li;function fp(t,i){t&1&&(a(0,"mat-icon",0),o(1,"check_circle"),n())}function _p(t,i){t&1&&(a(0,"mat-icon",1),o(1,"lens"),n())}var $i=class $i{constructor(){this.connected=Le()}};$i.\u0275fac=function(e){return new(e||$i)},$i.\u0275cmp=x({type:$i,selectors:[["app-replication-state"]],inputs:{connected:[1,"connected"]},decls:2,vars:1,consts:[[1,"connected"],[1,"disconnected"]],template:function(e,r){e&1&&h(0,fp,2,0,"mat-icon",0)(1,_p,2,0,"mat-icon",1),e&2&&v(r.connected()?0:1)},dependencies:[T,_e],styles:[".connected[_ngcontent-%COMP%]{color:#00c752}.disconnected[_ngcontent-%COMP%]{color:#d3d3d3}"],changeDetection:0});var da=$i;function Cp(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n()()),t&2){let e=i.$implicit;l(2),C(e)}}var Fi=class Fi{constructor(i){this.data=i}};Fi.\u0275fac=function(e){return new(e||Fi)(p(Ke))},Fi.\u0275cmp=x({type:Fi,selectors:[["app-show-streams-dialog"]],decls:9,vars:0,consts:[["mat-dialog-title",""],["yaDataTable","",2,"width","100%"],["align","end"],["mat-dialog-close",""]],template:function(e,r){e&1&&(a(0,"h2",0),o(1,"Replicated Streams"),n(),a(2,"mat-dialog-content")(3,"table",1),F(4,Cp,3,1,"tr",null,$),n()(),a(6,"mat-dialog-actions",2)(7,"ya-button",3),o(8,"Close"),n()()),e&2&&(l(4),N(r.data.streams))},dependencies:[T,xe,Je,Xe,tt,et,he],encapsulation:2});var ua=Fi;var Jo=()=>[];function hp(t,i){t&1&&s(0,"th",26)}function vp(t,i){if(t&1&&(a(0,"td",27),s(1,"app-replication-state",28),n()),t&2){let e=i.$implicit;l(),c("connected",!!e.localAddress&&!!e.remoteAddress)}}function Sp(t,i){t&1&&(a(0,"th",29),o(1,"Instance"),n())}function bp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),C(e.instance)}}function gp(t,i){t&1&&(a(0,"th",31),o(1,"Streams"),n())}function yp(t,i){if(t&1){let e=V();a(0,"td",30)(1,"span",32),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.showReplicationStreams(m.streams||[]))}),o(2),n()()}if(t&2){let e=i.$implicit;l(2),y(" ",(e.streams||qe(1,Jo)).length," streams ")}}function xp(t,i){t&1&&(a(0,"th",33),o(1,"Mode"),n())}function Tp(t,i){if(t&1&&(a(0,"td",34),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.push?"PUSH":"PULL"," ")}}function Dp(t,i){t&1&&(a(0,"th",35),o(1,"Local address"),n())}function wp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.localAddress||"-"," ")}}function Ep(t,i){t&1&&(a(0,"th",35),o(1,"Remote address"),n())}function Mp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.remoteAddress||"-"," ")}}function Ip(t,i){t&1&&(a(0,"th",29),o(1,"Pull from"),n())}function Ap(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),C(e.pullFrom||"-")}}function Rp(t,i){t&1&&(a(0,"th",36),o(1,"TX"),n())}function Pp(t,i){if(t&1&&(a(0,"td",30),o(1),_(2,"number"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.tx)||"-")}}function kp(t,i){t&1&&s(0,"th",37)}function Lp(t,i){t&1&&s(0,"td",30)}function $p(t,i){t&1&&s(0,"tr",38)}function Fp(t,i){t&1&&s(0,"tr",39)}function Np(t,i){if(t&1&&(a(0,"table",1),b(1,5),d(2,hp,1,0,"th",6)(3,vp,2,1,"td",7),g(),b(4,8),d(5,Sp,2,0,"th",9)(6,bp,2,1,"td",10),g(),b(7,11),d(8,gp,2,0,"th",12)(9,yp,3,2,"td",10),g(),b(10,13),d(11,xp,2,0,"th",14)(12,Tp,2,1,"td",15),g(),b(13,16),d(14,Dp,2,0,"th",17)(15,wp,2,1,"td",10),g(),b(16,18),d(17,Ep,2,0,"th",17)(18,Mp,2,1,"td",10),g(),b(19,19),d(20,Ip,2,0,"th",9)(21,Ap,2,1,"td",10),g(),b(22,20),d(23,Rp,2,0,"th",21)(24,Pp,3,3,"td",10),g(),b(25,22),d(26,kp,1,0,"th",23)(27,Lp,1,0,"td",10),g(),d(28,$p,1,0,"tr",24)(29,Fp,1,0,"tr",25),n()),t&2){let e=u();c("dataSource",e.slavesDataSource),l(28),c("matHeaderRowDef",e.slaveColumns),l(),c("matRowDefColumns",e.slaveColumns)}}function Bp(t,i){t&1&&(a(0,"ya-empty-message",2),o(1,"Not configured"),n())}function jp(t,i){t&1&&s(0,"th",26)}function Vp(t,i){if(t&1&&(a(0,"td",27),s(1,"app-replication-state",28),n()),t&2){let e=i.$implicit;l(),c("connected",!!e.localAddress&&!!e.remoteAddress)}}function Up(t,i){t&1&&(a(0,"th",29),o(1,"Instance"),n())}function Yp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),C(e.instance)}}function Op(t,i){t&1&&(a(0,"th",31),o(1,"Streams"),n())}function Hp(t,i){if(t&1){let e=V();a(0,"td",30)(1,"span",32),D("click",function(){let m=I(e).$implicit,f=u(2);return A(f.showReplicationStreams(m.streams||[]))}),o(2),n()()}if(t&2){let e=i.$implicit;l(2),y(" ",(e.streams||qe(1,Jo)).length," streams ")}}function Gp(t,i){t&1&&(a(0,"th",33),o(1,"Mode"),n())}function qp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.push?"PUSH":"PULL"," ")}}function Wp(t,i){t&1&&(a(0,"th",35),o(1,"Local address"),n())}function Qp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.localAddress||"-"," ")}}function zp(t,i){t&1&&(a(0,"th",35),o(1,"Remote address"),n())}function Zp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.remoteAddress||"-"," ")}}function Kp(t,i){t&1&&(a(0,"th",29),o(1,"Push to"),n())}function Jp(t,i){if(t&1&&(a(0,"td",30),o(1),n()),t&2){let e=i.$implicit;l(),C(e.pushTo||"-")}}function Xp(t,i){t&1&&(a(0,"th",44),o(1,"Local\xA0TX"),n())}function ed(t,i){if(t&1&&(o(0),_(1,"number")),t&2){let e=u().$implicit;y(" ",S(1,1,e.localTx)||"-"," ")}}function td(t,i){t&1&&o(0," - ")}function id(t,i){if(t&1&&(a(0,"td",30),h(1,ed,2,3),h(2,td,1,0),n()),t&2){let e=i.$implicit;l(),v(e.localTx>=0?1:-1),l(),v(e.localTx<0?2:-1)}}function nd(t,i){t&1&&(a(0,"th",44),o(1," Next\xA0TX "),a(2,"ya-help"),o(3,"Next Transaction ID expected by the remote Yamcs instance"),n()())}function ad(t,i){if(t&1&&(a(0,"td",30),o(1),_(2,"number"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.nextTx)||"-")}}function od(t,i){t&1&&s(0,"th",37)}function rd(t,i){t&1&&s(0,"td",30)}function ld(t,i){t&1&&s(0,"tr",38)}function md(t,i){t&1&&s(0,"tr",39)}function sd(t,i){if(t&1&&(a(0,"table",4),b(1,5),d(2,jp,1,0,"th",6)(3,Vp,2,1,"td",7),g(),b(4,8),d(5,Up,2,0,"th",9)(6,Yp,2,1,"td",10),g(),b(7,11),d(8,Op,2,0,"th",12)(9,Hp,3,2,"td",10),g(),b(10,13),d(11,Gp,2,0,"th",14)(12,qp,2,1,"td",10),g(),b(13,16),d(14,Wp,2,0,"th",17)(15,Qp,2,1,"td",10),g(),b(16,18),d(17,zp,2,0,"th",17)(18,Zp,2,1,"td",10),g(),b(19,40),d(20,Kp,2,0,"th",9)(21,Jp,2,1,"td",10),g(),b(22,41),d(23,Xp,2,0,"th",42)(24,id,3,2,"td",10),g(),b(25,43),d(26,nd,4,0,"th",42)(27,ad,3,3,"td",10),g(),b(28,22),d(29,od,1,0,"th",23)(30,rd,1,0,"td",10),g(),d(31,ld,1,0,"tr",24)(32,md,1,0,"tr",25),n()),t&2){let e=u();c("dataSource",e.mastersDataSource),l(31),c("matHeaderRowDef",e.masterColumns),l(),c("matRowDefColumns",e.masterColumns)}}function cd(t,i){t&1&&(a(0,"ya-empty-message",2),o(1,"Not configured"),n())}var Ni=class Ni{constructor(i,e,r){this.dialog=r;this.slaveColumns=["state","instance","streams","mode","localAddress","remoteAddress","pullFrom","tx","actions"];this.masterColumns=["state","instance","streams","mode","localAddress","remoteAddress","pushTo","localTx","nextTx","actions"];this.slavesDataSource=new G;this.mastersDataSource=new G;this.hasSlaves$=new H(!1);this.hasMasters$=new H(!1);e.setTitle("Replication"),this.replicationInfoSubscription=i.yamcsClient.createReplicationInfoSubscription(m=>{this.slavesDataSource.data=m.slaves||[],this.mastersDataSource.data=m.masters||[],this.hasSlaves$.next(this.slavesDataSource.data.length>0),this.hasMasters$.next(this.mastersDataSource.data.length>0)})}showReplicationStreams(i){this.dialog.open(ua,{width:"500px",data:{streams:i}})}ngOnDestroy(){this.replicationInfoSubscription?.cancel()}};Ni.\u0275fac=function(e){return new(e||Ni)(p(w),p(P),p(Ye))},Ni.\u0275cmp=x({type:Ni,selectors:[["ng-component"]],decls:17,vars:6,consts:[["label","Replication"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["marginTop","0"],[1,"section-divider"],["mat-table","",1,"ya-data-table",3,"dataSource"],["matColumnDef","state"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status",4,"matCellDef"],["matColumnDef","instance"],["mat-header-cell","","style","min-width: 130px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","streams"],["mat-header-cell","","style","min-width: 100px",4,"matHeaderCellDef"],["matColumnDef","mode"],["mat-header-cell","","style","min-width: 70px",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","localAddress"],["mat-header-cell","","style","min-width: 200px",4,"matHeaderCellDef"],["matColumnDef","remoteAddress"],["matColumnDef","pullFrom"],["matColumnDef","tx"],["mat-header-cell","","style","width: 130px",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"status"],["mat-cell","",1,"status"],[3,"connected"],["mat-header-cell","",2,"min-width","130px"],["mat-cell",""],["mat-header-cell","",2,"min-width","100px"],["matTooltip","Show streams",1,"streams",3,"click"],["mat-header-cell","",2,"min-width","70px"],["mat-cell","",2,"text-align","center"],["mat-header-cell","",2,"min-width","200px"],["mat-header-cell","",2,"width","130px"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],["matColumnDef","pushTo"],["matColumnDef","localTx"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","nextTx"],["mat-header-cell",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"h4"),o(4,"Inbound"),n(),h(5,Np,30,3,"table",1),_(6,"async"),We(7,Bp,2,0,"ya-empty-message",2),a(8,"p"),o(9,"\xA0"),n(),a(10,"div",3),s(11,"mat-divider"),n(),a(12,"h4"),o(13,"Outbound"),n(),h(14,sd,33,3,"table",4),_(15,"async"),We(16,cd,2,0,"ya-empty-message",2),n()()),e&2&&(l(5),v(S(6,2,r.hasSlaves$)?5:7),l(9),v(S(15,4,r.hasMasters$)?14:16))},dependencies:[k,L,da,T,it,q,ne,ae,W,K,X,J,Q,ee,z,De,Re,Io,R,U,jt],styles:[".streams[_ngcontent-%COMP%]{border-bottom:1px dotted #888;cursor:pointer}"],changeDetection:0});var fa=Ni;var pd=(t,i)=>[t,i];function dd(t,i){t&1&&(a(0,"th",11),o(1,"Tablespace"),n())}function ud(t,i){if(t&1&&(a(0,"td",12),o(1),n()),t&2){let e=i.$implicit;l(),C(e.tablespace||"-")}}function fd(t,i){t&1&&(a(0,"th",11),o(1,"Data Dir"),n())}function _d(t,i){if(t&1&&o(0),t&2){let e=u().$implicit;y(" /",e.dbPath," ")}}function Cd(t,i){if(t&1&&(a(0,"td",12)(1,"a",13),o(2),h(3,_d,1,1),n()()),t&2){let e=i.$implicit;l(),c("routerLink",dt(3,pd,e.tablespace,e.dbPath)),l(),y(" ",e.dataDir," "),l(),v(e.dbPath?3:-1)}}function hd(t,i){t&1&&(a(0,"th",11),o(1,"DB Path"),n())}function vd(t,i){if(t&1&&(a(0,"td",12),o(1),n()),t&2){let e=i.$implicit;l(),C(e.dbPath||"(root)")}}function Sd(t,i){t&1&&s(0,"th",14)}function bd(t,i){t&1&&s(0,"td",12)}function gd(t,i){t&1&&s(0,"tr",15)}function yd(t,i){t&1&&s(0,"tr",16)}var Bi=class Bi{constructor(i,e){this.displayedColumns=["dataDir","tablespace","dbPath","actions"];this.dataSource=new G;e.setTitle("Open Databases"),i.yamcsClient.getRocksDbDatabases().then(r=>{this.dataSource.data=r})}};Bi.\u0275fac=function(e){return new(e||Bi)(p(w),p(P))},Bi.\u0275cmp=x({type:Bi,selectors:[["ng-component"]],decls:18,vars:3,consts:[["label","Open databases"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","tablespace"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","dataDir"],["matColumnDef","dbPath"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"table",1),b(4,2),d(5,dd,2,0,"th",3)(6,ud,2,1,"td",4),g(),b(7,5),d(8,fd,2,0,"th",3)(9,Cd,4,6,"td",4),g(),b(10,6),d(11,hd,2,0,"th",3)(12,vd,2,1,"td",4),g(),b(13,7),d(14,Sd,1,0,"th",8)(15,bd,1,0,"td",4),g(),d(16,gd,1,0,"tr",9)(17,yd,1,0,"tr",10),n()()()),e&2&&(l(3),c("dataSource",r.dataSource),l(13),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns))},dependencies:[k,L,T,ie,q,ne,ae,W,K,X,J,Q,ee,z,R],encapsulation:2,changeDetection:0});var _a=Bi;function xd(t,i){if(t&1&&(s(0,"ya-page-icon-button",10),o(1)),t&2){let e=u(2);l(),ct(" ",e.tablespace,"://",e.dbPath," ")}}function Td(t,i){if(t&1){let e=V();a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,xd,2,2,"ng-template",1),a(3,"ya-page-button",2),o(4," Compact "),n(),a(5,"mat-menu",3,0)(7,"button",4),D("click",function(){I(e);let m=u();return A(m.compact("_metadata_"))}),o(8," _metadata_ "),n(),a(9,"button",5),D("click",function(){I(e);let m=u();return A(m.compact("rt_data"))}),o(10," rt_data "),n(),a(11,"button",6),D("click",function(){I(e);let m=u();return A(m.compact("parameter_archive"))}),o(12," parameter_archive "),n(),a(13,"button",7),D("click",function(){I(e);let m=u();return A(m.compact("default"))}),o(14," default "),n()()(),a(15,"ya-panel")(16,"dl",8)(17,"dt"),o(18,"Tablespace"),n(),a(19,"dd"),o(20),n(),a(21,"dt"),o(22,"DB Path"),n(),a(23,"dd"),o(24),n()(),a(25,"pre",9),o(26),n()()()}if(t&2){let e=ve(6),r=u();l(3),c("matMenuTriggerFor",e),l(17),C(r.tablespace||"-"),l(4),C(r.dbPath||"-"),l(2),C(i)}}var ji=class ji{constructor(i,e,r,m){this.yamcs=i;this.snackBar=m;this.tablespace=r.snapshot.paramMap.get("tablespace");let f=r.snapshot.url;f.length?this.dbPath=f.map(E=>E.path).join("/"):this.dbPath="",e.setTitle(this.tablespace+"://"+this.dbPath),this.properties$=i.yamcsClient.getRocksDbDatabaseProperties(this.tablespace,this.dbPath)}compact(i){this.snackBar.open(`Compacting ${this.tablespace}://${this.dbPath}...`,void 0,{horizontalPosition:"end"}),this.yamcs.yamcsClient.compactRocksDbDatabase(this.tablespace,this.dbPath,{cfname:i}).then(()=>{this.snackBar.open(`Compaction of ${this.tablespace}://${this.dbPath} successful`,void 0,{duration:3e3,horizontalPosition:"end"})}).catch(e=>{this.snackBar.open(`Compaction of ${this.tablespace}://${this.dbPath} failed`,void 0,{duration:3e3,horizontalPosition:"end"})})}};ji.\u0275fac=function(e){return new(e||ji)(p(w),p(P),p(j),p(so))},ji.\u0275cmp=x({type:ji,selectors:[["ng-component"]],decls:2,vars:3,consts:[["compactMenu","matMenu"],["app-admin-toolbar-label",""],["icon","fullscreen_exit","dropdown","true",3,"matMenuTriggerFor"],[1,"ya-menu"],["mat-menu-item","","matTooltip","Information about tables and partitions","matTooltipPosition","right",3,"click"],["mat-menu-item","","matTooltip","TM, PP and events","matTooltipPosition","right",3,"click"],["mat-menu-item","","matTooltip","Parameter Archive","matTooltipPosition","right",3,"click"],["mat-menu-item","","matTooltip","Command history, alarms completeness, timeline, activities, users, buckets, ...","matTooltipPosition","right",3,"click"],[1,"dl-horizontal"],[2,"font-size","10px","margin","0"],["routerLink","/admin/rocksdb/databases","icon","arrow_back"]],template:function(e,r){if(e&1&&(h(0,Td,27,4,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.properties$))?0:-1,m)}},dependencies:[k,L,ke,T,ie,po,pt,uo,De,Ne,He,R,U],encapsulation:2,changeDetection:0});var Ca=ji;var Vi=class Vi{};Vi.\u0275fac=function(e){return new(e||Vi)},Vi.\u0275cmp=x({type:Vi,selectors:[["app-route-detail"]],inputs:{route:"route"},decls:7,vars:3,consts:[["label","Input type"],["label","Output type"],["label","Log format"]],template:function(e,r){e&1&&(a(0,"ya-attr-list")(1,"ya-attr",0),o(2),n(),a(3,"ya-attr",1),o(4),n(),a(5,"ya-attr",2),o(6),n()()),e&2&&(l(2),y(" ",r.route.inputType," "),l(2),y(" ",r.route.outputType," "),l(2),y(" ",r.route.logFormat||"-"," "))},dependencies:[Ot,Yt],encapsulation:2,changeDetection:0});var ha=Vi;var Dd=t=>({selected:t});function wd(t,i){t&1&&(a(0,"ya-detail-toolbar"),o(1,"Route detail"),n(),a(2,"div",16),s(3,"app-route-detail",17),n()),t&2&&(l(3),c("route",i))}function Ed(t,i){t&1&&(a(0,"ya-detail-toolbar"),o(1,"Select a route"),n())}function Md(t,i){t&1&&(a(0,"th",18),o(1,"Service"),n())}function Id(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),C(e.service||"Other")}}function Ad(t,i){t&1&&(a(0,"th",18),o(1,"Method"),n())}function Rd(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),C(e.description||"-")}}function Pd(t,i){t&1&&(a(0,"th",18),o(1,"Requests"),n())}function kd(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),C(e.requestCount)}}function Ld(t,i){t&1&&(a(0,"th",18),o(1,"Errors"),n())}function $d(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),C(e.errorCount)}}function Fd(t,i){t&1&&(a(0,"th",18),o(1,"HTTP"),n())}function Nd(t,i){if(t&1&&(a(0,"td",19),o(1),n()),t&2){let e=i.$implicit;l(),ct("",e.httpMethod," ",e.url)}}function Bd(t,i){t&1&&s(0,"th",20)}function jd(t,i){t&1&&s(0,"td",19)}function Vd(t,i){t&1&&s(0,"tr",21)}function Ud(t,i){if(t&1){let e=V();a(0,"tr",22),_(1,"async"),D("click",function(){let m=I(e).$implicit,f=u();return A(f.selectRoute(m))}),n()}if(t&2){let e=i.$implicit,r=u();fe("deprecated",e.deprecated),c("ngClass",ge(5,Dd,e===S(1,3,r.selectedRoute$)))}}var Ui=class Ui extends Ut{constructor(e){super();this.route=e;this.filterControl=new Z;this.displayedColumns=["method","requestCount","errorCount","http","actions"];this.dataSource=new G;this.selectedRoute$=new H(null);this.setTitle("API routes"),this.dataSource.filterPredicate=(r,m)=>r.url.toLowerCase().indexOf(m)>=0||r.description.toLowerCase().indexOf(m)>=0}ngAfterViewInit(){let e=this.route.snapshot.queryParamMap;e.has("filter")&&(this.filterControl.setValue(e.get("filter")),this.dataSource.filter=e.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let r=this.filterControl.value||"";this.dataSource.filter=r.toLowerCase()}),this.refresh(),this.dataSource.sort=this.sort}refresh(){this.yamcs.yamcsClient.getRoutes().then(e=>{this.dataSource.data=e.routes||[]})}selectRoute(e){this.selectedRoute$.next(e),this.openDetailPane()}updateURL(){let e=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:e||null},queryParamsHandling:"merge"})}};Ui.\u0275fac=function(r){return new(r||Ui)(p(j))},Ui.\u0275cmp=x({type:Ui,selectors:[["ng-component"]],viewQuery:function(r,m){if(r&1&&se(O,7),r&2){let f;re(f=le())&&(m.sort=f.first)}},features:[ht],decls:33,vars:7,consts:[["label","API routes"],["icon","refresh",3,"clicked"],[1,"table-wrapper"],["placeholder","Filter routes",3,"formControl"],["mat-table","","matSort","","matSortActive","requestCount","matSortDirection","desc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","service"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","method"],["matColumnDef","requestCount"],["matColumnDef","errorCount"],["matColumnDef","http"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","deprecated","click",4,"matRowDef","matRowDefColumns"],[2,"padding","0 16px"],[3,"route"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(r,m){if(r&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),D("clicked",function(){return m.refresh()}),o(3,"Refresh view"),n()(),a(4,"ya-detail-pane"),h(5,wd,4,1),_(6,"async"),We(7,Ed,2,0,"ya-detail-toolbar"),n(),a(8,"div",2)(9,"ya-panel")(10,"ya-filter-bar"),s(11,"ya-search-filter",3),n(),a(12,"table",4),b(13,5),d(14,Md,2,0,"th",6)(15,Id,2,1,"td",7),g(),b(16,8),d(17,Ad,2,0,"th",6)(18,Rd,2,1,"td",7),g(),b(19,9),d(20,Pd,2,0,"th",6)(21,kd,2,1,"td",7),g(),b(22,10),d(23,Ld,2,0,"th",6)(24,$d,2,1,"td",7),g(),b(25,11),d(26,Fd,2,0,"th",6)(27,Nd,2,2,"td",7),g(),b(28,12),d(29,Bd,1,0,"th",13)(30,jd,1,0,"td",7),g(),d(31,Vd,1,0,"tr",14)(32,Ud,2,7,"tr",15),n()()()()),r&2){let f;l(5),v((f=S(6,5,m.selectedRoute$))?5:7,f),l(6),c("formControl",m.filterControl),l(),c("dataSource",m.dataSource),l(19),c("matHeaderRowDef",m.displayedColumns),l(),c("matRowDefColumns",m.displayedColumns)}},dependencies:[k,L,ha,T,Bt,me,$e,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,Ht,Gt,ye,Ne,R,Pe,U],styles:[".deprecated[_ngcontent-%COMP%]{text-decoration:line-through}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.mat-mdc-row[_ngcontent-%COMP%], .ya-data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0});var va=Ui;function Yd(t,i){if(t&1&&(a(0,"mat-icon",0),o(1,"check_circle"),n()),t&2){let e=u();c("matTooltip",e.service.state)}}function Od(t,i){if(t&1&&(a(0,"mat-icon",1),o(1,"check_circle"),n()),t&2){let e=u();c("matTooltip",e.service.state)}}function Hd(t,i){if(t&1&&(a(0,"mat-icon",2),o(1,"highlight_off"),n()),t&2){let e=u();c("matTooltip",e.service.state)}}function Gd(t,i){if(t&1&&(a(0,"mat-icon",3),o(1,"lens"),n()),t&2){let e=u();c("matTooltip",e.service.state)}}var Yi=class Yi{};Yi.\u0275fac=function(e){return new(e||Yi)},Yi.\u0275cmp=x({type:Yi,selectors:[["app-service-state"]],inputs:{service:"service"},decls:4,vars:1,consts:[[1,"starting",3,"matTooltip"],[1,"running",3,"matTooltip"],[1,"failed",3,"matTooltip"],[1,"terminated",3,"matTooltip"]],template:function(e,r){e&1&&h(0,Yd,2,1,"mat-icon",0)(1,Od,2,1,"mat-icon",1)(2,Hd,2,1,"mat-icon",2)(3,Gd,2,1,"mat-icon",3),e&2&&v(r.service.state==="STARTING"?0:r.service.state==="RUNNING"?1:r.service.state==="STOPPING"||r.service.state==="FAILED"?2:r.service.state==="TERMINATED"||r.service.state==="NEW"?3:-1)},dependencies:[T,_e,De],styles:[".starting[_ngcontent-%COMP%]{color:#90ee90}.running[_ngcontent-%COMP%]{color:#00c752}.failed[_ngcontent-%COMP%]{color:var(--y-error-color)}.terminated[_ngcontent-%COMP%]{color:#d3d3d3}"],changeDetection:0});var Sa=Yi;var qd=()=>["detail"];function Wd(t,i){t&1&&(a(0,"th",15),o(1,"Name"),n())}function Qd(t,i){if(t&1&&(a(0,"td",16),o(1),n()),t&2){let e=i.$implicit;l(),C(e.name)}}function zd(t,i){t&1&&(a(0,"th",15),o(1,"Class"),n())}function Zd(t,i){if(t&1&&(a(0,"td",16),o(1),n()),t&2){let e=i.$implicit;l(),C(e.className)}}function Kd(t,i){t&1&&s(0,"th",17)}function Jd(t,i){if(t&1&&(a(0,"td",18),s(1,"app-service-state",19),n()),t&2){let e=i.$implicit;l(),c("service",e)}}function Xd(t,i){t&1&&(a(0,"th",15),o(1,"Failure"),n())}function e0(t,i){if(t&1){let e=V();a(0,"ya-icon-action",22),D("click",function(){I(e);let m=u(2).$implicit;return A(m.expanded=!1)}),n()}}function t0(t,i){if(t&1){let e=V();a(0,"ya-icon-action",23),D("click",function(){I(e);let m=u(2).$implicit;return A(m.expanded=!0)}),n()}}function i0(t,i){if(t&1&&h(0,e0,1,0,"ya-icon-action",20)(1,t0,1,0,"ya-icon-action",21),t&2){let e=u().$implicit;v(e.expanded?0:1)}}function n0(t,i){if(t&1&&(a(0,"td",16),o(1),h(2,i0,2,1),n()),t&2){let e=i.$implicit;l(),y(" ",e.failureMessage||"-"," "),l(),v(e.failureCause?2:-1)}}function a0(t,i){if(t&1&&(a(0,"td",16)(1,"pre"),o(2),n()()),t&2){let e=i.$implicit,r=u();ln("colspan",r.displayedColumns.length),l(2),C(e.failureCause||"-")}}function o0(t,i){t&1&&s(0,"th",24)}function r0(t,i){if(t&1){let e=V();a(0,"ya-more")(1,"button",25),D("click",function(){I(e);let m=u().$implicit,f=u();return A(f.startService.emit(m.name))}),o(2," Start service "),n(),a(3,"button",25),D("click",function(){I(e);let m=u().$implicit,f=u();return A(f.stopService.emit(m.name))}),o(4," Stop service "),n()()}if(t&2){let e=u().$implicit;l(),c("disabled",e.state!=="TERMINATED"&&e.state!=="NEW"),l(2),c("disabled",e.state!=="RUNNING")}}function l0(t,i){if(t&1&&(a(0,"td",16),h(1,r0,5,2,"ya-more"),n()),t&2){let e=u();l(),v(e.readonly?-1:1)}}function m0(t,i){t&1&&s(0,"tr",26)}function s0(t,i){t&1&&s(0,"tr",27)}function c0(t,i){if(t&1){let e=V();a(0,"tr",28),D("click",function(){let m=I(e).$implicit;return A(m.expanded=!m.expanded)}),n()}if(t&2){let e=i.$implicit;fe("expanded",e.expanded)}}var Oi=class Oi{constructor(){this.displayedColumns=["state","name","className","failureMessage","actions"];this.dataSource=new G;this.readonly=!1;this.startService=new Xi;this.stopService=new Xi}ngAfterViewInit(){this.dataSource.sort=this.sort}};Oi.\u0275fac=function(e){return new(e||Oi)},Oi.\u0275cmp=x({type:Oi,selectors:[["app-services-table"]],viewQuery:function(e,r){if(e&1&&se(O,7),e&2){let m;re(m=le())&&(r.sort=m.first)}},inputs:{dataSource:"dataSource",readonly:"readonly"},outputs:{startService:"startService",stopService:"stopService"},decls:21,vars:5,consts:[["mat-table","","matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","","multiTemplateDataRows","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","className"],["matColumnDef","state"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status",4,"matCellDef"],["matColumnDef","failureMessage"],["matColumnDef","detail"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-row","","class","item-detail",3,"expanded","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"status"],["mat-cell","",1,"status"],[3,"service"],["icon","expand_less"],["icon","expand_more"],["icon","expand_less",3,"click"],["icon","expand_more",3,"click"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click","disabled"],["mat-header-row",""],["mat-row",""],["mat-row","",1,"item-detail",3,"click"]],template:function(e,r){e&1&&(a(0,"table",0),b(1,1),d(2,Wd,2,0,"th",2)(3,Qd,2,1,"td",3),g(),b(4,4),d(5,zd,2,0,"th",2)(6,Zd,2,1,"td",3),g(),b(7,5),d(8,Kd,1,0,"th",6)(9,Jd,2,1,"td",7),g(),b(10,8),d(11,Xd,2,0,"th",2)(12,n0,3,2,"td",3),g(),b(13,9),d(14,a0,3,2,"td",3),g(),b(15,10),d(16,o0,1,0,"th",11)(17,l0,2,1,"td",3),g(),d(18,m0,1,0,"tr",12)(19,s0,1,0,"tr",13)(20,c0,1,2,"tr",14),n()),e&2&&(c("dataSource",r.dataSource),l(18),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),c("matRowDefColumns",qe(4,qd)))},dependencies:[Sa,T,pt,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,wo,xt],styles:["tr.item-detail[_ngcontent-%COMP%]:not(.expanded){display:none}"],changeDetection:0});var ba=Oi;var Hi=class Hi{constructor(i,e,r,m){this.yamcs=i;this.router=e;this.route=r;this.instance="_global";this.filterForm=new co({instance:new Z("_global")});this.instanceOptions$=new H([{id:"_global",label:"_global"}]);this.dataSource=new G;m.setTitle("Services"),i.yamcsClient.getInstances({filter:"state=RUNNING"}).then(f=>{for(let E of f)this.instanceOptions$.next([...this.instanceOptions$.value,{id:E.name,label:E.name}])}),this.initializeOptions(),this.refresh(),this.filterForm.get("instance").valueChanges.forEach(f=>{this.instance=f,this.refresh()})}initializeOptions(){let i=this.route.snapshot.queryParamMap;i.has("instance")&&(this.instance=i.get("instance"),this.filterForm.get("instance").setValue(this.instance))}startService(i){if(confirm(`Are you sure you want to start ${i} ?`)){let e=this.filterForm.get("instance").value;this.yamcs.yamcsClient.startService(e,i).then(()=>this.refresh())}}stopService(i){if(confirm(`Are you sure you want to stop ${i} ?`)){let e=this.filterForm.get("instance").value;this.yamcs.yamcsClient.stopService(e,i).then(()=>this.refresh())}}refresh(){this.updateURL();let i=this.filterForm.get("instance").value;this.yamcs.yamcsClient.getServices(i).then(e=>{this.dataSource.data=e})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{instance:this.instance||null},queryParamsHandling:"merge"})}};Hi.\u0275fac=function(e){return new(e||Hi)(p(w),p(te),p(j),p(P))},Hi.\u0275cmp=x({type:Hi,selectors:[["ng-component"]],decls:9,vars:5,consts:[["label","Services"],["icon","refresh",3,"clicked"],[3,"formGroup"],["formControlName","instance",3,"options"],[3,"startService","stopService","dataSource"]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"ya-page-button",1),D("clicked",function(){return r.refresh()}),o(3,"Refresh view"),n()(),a(4,"ya-panel")(5,"ya-filter-bar",2),s(6,"ya-select",3),_(7,"async"),n(),a(8,"app-services-table",4),D("startService",function(f){return r.startService(f)})("stopService",function(f){return r.stopService(f)}),n()()()),e&2&&(l(5),c("formGroup",r.filterForm),l(),c("options",S(7,3,r.instanceOptions$)),l(2),c("dataSource",r.dataSource))},dependencies:[k,L,ba,T,me,Me,Ie,Ae,ye,Ne,R,vn,U],encapsulation:2,changeDetection:0});var ga=Hi;var p0=()=>[];function d0(t,i){t&1&&(a(0,"th",16),o(1,"Id"),n())}function u0(t,i){if(t&1&&(a(0,"td",17),o(1),n()),t&2){let e=i.$implicit;l(),C(e.id)}}function f0(t,i){t&1&&(a(0,"th",16),o(1,"User"),n())}function _0(t,i){if(t&1&&(a(0,"td",17),o(1),n()),t&2){let e=i.$implicit;l(),C(e.username||"-")}}function C0(t,i){t&1&&(a(0,"th",16),o(1,"IP address"),n())}function h0(t,i){if(t&1&&(a(0,"td",17),o(1),n()),t&2){let e=i.$implicit;l(),C(e.ipAddress||"-")}}function v0(t,i){t&1&&(a(0,"th",16),o(1,"Hostname"),n())}function S0(t,i){if(t&1&&(a(0,"td",17),o(1),n()),t&2){let e=i.$implicit;l(),C(e.hostname||"-")}}function b0(t,i){t&1&&(a(0,"th",16),o(1,"Started"),n())}function g0(t,i){if(t&1&&(a(0,"td",17),o(1),_(2,"datetime"),n()),t&2){let e=i.$implicit;l(),C(S(2,1,e.startTime)||"-")}}function y0(t,i){t&1&&(a(0,"th",16),o(1,"Last renewed"),n())}function x0(t,i){if(t&1&&(a(0,"td",17),s(1,"app-ago",18),n()),t&2){let e=i.$implicit;l(),c("time",e.lastAccessTime)("useMissionTime",!1)}}function T0(t,i){t&1&&(a(0,"th",16),o(1,"Expires in"),n())}function D0(t,i){if(t&1&&(a(0,"td",17),s(1,"app-ago",18),n()),t&2){let e=i.$implicit;l(),c("time",e.expirationTime)("useMissionTime",!1)}}function w0(t,i){t&1&&(a(0,"th",19),o(1,"Client"),n())}function E0(t,i){t&1&&o(0," , ")}function M0(t,i){if(t&1&&(h(0,E0,1,0),o(1),_(2,"userAgent")),t&2){let e=i.$implicit,r=i.$index;v(r!==0?0:-1),l(),y(" ",S(2,2,e)," ")}}function I0(t,i){t&1&&o(0," - ")}function A0(t,i){if(t&1&&(a(0,"td",17),F(1,M0,3,4,null,null,$),h(3,I0,1,0),n()),t&2){let e=i.$implicit;l(),N(e.clients||qe(1,p0)),l(2),v(e.clients?-1:3)}}function R0(t,i){t&1&&s(0,"tr",20)}function P0(t,i){t&1&&s(0,"tr",21)}var Gi=class Gi{constructor(i,e,r){this.yamcs=i;this.displayedColumns=["id","user","ipAddress","hostname","started","lastAccessTime","expirationTime","clients"];this.tableTrackerFn=(i,e)=>e.id;this.dataSource=new G;e.setTitle("Sessions"),this.refresh(),this.syncSubscription=r.syncSlow(()=>this.refresh())}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}refresh(){this.yamcs.yamcsClient.getSessions().then(i=>{this.dataSource.data=i||[]})}ngOnDestroy(){this.syncSubscription?.unsubscribe()}};Gi.\u0275fac=function(e){return new(e||Gi)(p(w),p(P),p(hn))},Gi.\u0275cmp=x({type:Gi,selectors:[["ng-component"]],viewQuery:function(e,r){if(e&1&&(se(O,5),se(Fe,5)),e&2){let m;re(m=le())&&(r.sort=m.first),re(m=le())&&(r.paginator=m.first)}},decls:31,vars:7,consts:[["label","Sessions"],["mat-table","","matSort","","matSortActive","started","matSortDirection","desc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","ipAddress"],["matColumnDef","hostname"],["matColumnDef","started"],["matColumnDef","lastAccessTime"],["matColumnDef","expirationTime"],["matColumnDef","clients"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"time","useMissionTime"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",0),a(2,"ya-panel")(3,"table",1),b(4,2),d(5,d0,2,0,"th",3)(6,u0,2,1,"td",4),g(),b(7,5),d(8,f0,2,0,"th",3)(9,_0,2,1,"td",4),g(),b(10,6),d(11,C0,2,0,"th",3)(12,h0,2,1,"td",4),g(),b(13,7),d(14,v0,2,0,"th",3)(15,S0,2,1,"td",4),g(),b(16,8),d(17,b0,2,0,"th",3)(18,g0,3,3,"td",4),g(),b(19,9),d(20,y0,2,0,"th",3)(21,x0,2,2,"td",4),g(),b(22,10),d(23,T0,2,0,"th",3)(24,D0,2,2,"td",4),g(),b(25,11),d(26,w0,2,0,"th",12)(27,A0,4,2,"td",4),g(),d(28,R0,1,0,"tr",13)(29,P0,1,0,"tr",14),n(),s(30,"mat-paginator",15),n()()),e&2&&(l(3),c("dataSource",r.dataSource)("trackBy",r.tableTrackerFn),l(25),c("matHeaderRowDef",r.displayedColumns),l(),c("matRowDefColumns",r.displayedColumns),l(),c("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0))},dependencies:[k,L,Uo,T,Fe,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,R,yt,di],encapsulation:2,changeDetection:0});var ya=Gi;function k0(t,i){if(t&1){let e=V();a(0,"ya-sidebar-nav-group",21),D("toggle",function(){I(e);let m=u();return A(m.toggleUserManagementGroup())}),a(1,"ya-sidebar-nav-item",22),o(2," Users "),n(),a(3,"ya-sidebar-nav-item",23),o(4," Service accounts "),n(),a(5,"ya-sidebar-nav-item",24),o(6," Groups "),n(),a(7,"ya-sidebar-nav-item",25),o(8," Roles "),n()()}if(t&2){let e=u();c("active",e.userManagementActive)("expanded",e.userManagementExpanded),l(),c("subitem",!0),l(2),c("subitem",!0),l(2),c("subitem",!0),l(2),c("subitem",!0)}}function L0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",8)(1,"mat-icon",6),o(2,"devices"),n(),o(3," Sessions "),n())}function $0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",9)(1,"mat-icon",6),o(2,"attractions"),n(),o(3," Services "),n())}function F0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",10)(1,"mat-icon",6),o(2,"flip_camera_android"),n(),o(3," Processor types "),n())}function N0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",12)(1,"mat-icon",6),o(2,"share"),n(),o(3," Replication "),n())}function B0(t,i){if(t&1){let e=V();a(0,"ya-sidebar-nav-group",26),D("toggle",function(){I(e);let m=u();return A(m.toggleRocksDbGroup())}),a(1,"ya-sidebar-nav-item",27),o(2," Open databases "),n()()}if(t&2){let e=u();c("active",e.rocksDbActive)("expanded",e.rocksDbExpanded),l(),c("subitem",!0)}}function j0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",14)(1,"mat-icon",6),o(2,"traffic"),n(),o(3," HTTP traffic "),n())}function V0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",15)(1,"mat-icon",6),o(2,"api"),n(),o(3," API routes "),n())}function U0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",16)(1,"mat-icon",6),o(2,"access_time"),n(),o(3," Leap seconds "),n())}function Y0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",17)(1,"mat-icon",6),o(2,"receipt"),n(),o(3," Threads "),n())}function O0(t,i){t&1&&(a(0,"ya-sidebar-nav-item",18)(1,"mat-icon",6),o(2,"memory"),n(),o(3," System "),n())}function H0(t,i){if(t&1&&(a(0,"div",20),s(1,"img",28),n()),t&2){let e=u();l(),c("src",e.config.logo,on)}}var qi=class qi{constructor(i,e,r){this.userManagementActive=!1;this.userManagementExpanded=!1;this.rocksDbActive=!1;this.rocksDbExpanded=!1;this.config=i.getConfig(),this.user=e.getUser(),this.routerSubscription=r.events.pipe(Va(m=>m instanceof no)).subscribe(m=>{let f=m.url;this.collapseAllGroups(),this.userManagementActive=!1,this.rocksDbActive=!1,f.match(/\/iam.*/)?(this.userManagementActive=!0,this.userManagementExpanded=!0):f.match(/\/rocksdb.*/)&&(this.rocksDbActive=!0,this.rocksDbExpanded=!0)})}collapseAllGroups(){this.userManagementExpanded=!1,this.rocksDbExpanded=!1}toggleUserManagementGroup(){let i=this.userManagementExpanded;this.collapseAllGroups(),this.userManagementExpanded=!i}toggleRocksDbGroup(){let i=this.rocksDbExpanded;this.collapseAllGroups(),this.rocksDbExpanded=!i}showRocksDbItem(){return this.user.hasSystemPrivilege("ControlArchiving")}showAccessControlItem(){return this.user.hasSystemPrivilege("ControlAccess")}showServicesItem(){return this.user.hasSystemPrivilege("ControlServices")}showSystemInfo(){return this.user.hasSystemPrivilege("ReadSystemInfo")}ngOnDestroy(){this.routerSubscription?.unsubscribe()}};qi.\u0275fac=function(e){return new(e||qi)(p(Eo),p(Oe),p(te))},qi.\u0275cmp=x({type:qi,selectors:[["ng-component"]],decls:35,vars:19,consts:[["messageBar",""],["mode","side",3,"opened","disableClose"],[1,"sidenav-content"],[1,"module-title"],["dense",""],["activeWhen","/admin","routerLink","/admin",3,"exact"],[1,"item-icon"],["label","Access control","icon","supervised_user_circle",3,"active","expanded"],["activeWhen","/admin/sessions","routerLink","/admin/sessions"],["activeWhen","/admin/services","routerLink","/admin/services"],["activeWhen","/admin/processor-types","routerLink","/admin/processor-types"],["activeWhen","/admin/databases","routerLink","/admin/databases"],["activeWhen","/admin/replication","routerLink","/admin/replication"],["label","RocksDB","icon","dataset",3,"active","expanded"],["activeWhen","/admin/http-traffic","routerLink","/admin/http-traffic"],["activeWhen","/admin/routes","routerLink","/admin/routes"],["activeWhen","/admin/leap-seconds","routerLink","/admin/leap-seconds"],["activeWhen","/admin/threads","routerLink","/admin/threads"],["activeWhen","/admin/system","routerLink","/admin/system"],[2,"flex","1 1 auto"],[1,"navbar-logo"],["label","Access control","icon","supervised_user_circle",3,"toggle","active","expanded"],["activeWhen","/admin/iam/users","routerLink","/admin/iam/users",3,"subitem"],["activeWhen","/admin/iam/service-accounts","routerLink","/admin/iam/service-accounts",3,"subitem"],["activeWhen","/admin/iam/groups","routerLink","/admin/iam/groups",3,"subitem"],["activeWhen","/admin/iam/roles","routerLink","/admin/iam/roles",3,"subitem"],["label","RocksDB","icon","dataset",3,"toggle","active","expanded"],["activeWhen","/admin/rocksdb/databases","routerLink","/admin/rocksdb/databases",3,"subitem"],[3,"src"]],template:function(e,r){if(e&1&&(s(0,"ya-message-bar",null,0),a(2,"mat-sidenav-container"),_(3,"async"),a(4,"mat-sidenav",1)(5,"div",2)(6,"mat-toolbar",3)(7,"mat-toolbar-row")(8,"mat-icon"),o(9,"security"),n(),o(10," Admin area "),n()(),a(11,"mat-nav-list",4)(12,"ya-sidebar-nav-item",5)(13,"mat-icon",6),o(14,"recent_actors"),n(),o(15," Action log "),n(),h(16,k0,9,6,"ya-sidebar-nav-group",7),h(17,L0,4,0,"ya-sidebar-nav-item",8),h(18,$0,4,0,"ya-sidebar-nav-item",9),h(19,F0,4,0,"ya-sidebar-nav-item",10),a(20,"ya-sidebar-nav-item",11)(21,"mat-icon",6),o(22,"database"),n(),o(23," Databases "),n(),h(24,N0,4,0,"ya-sidebar-nav-item",12),h(25,B0,3,3,"ya-sidebar-nav-group",13),h(26,j0,4,0,"ya-sidebar-nav-item",14),h(27,V0,4,0,"ya-sidebar-nav-item",15),h(28,U0,4,0,"ya-sidebar-nav-item",16),h(29,Y0,4,0,"ya-sidebar-nav-item",17),h(30,O0,4,0,"ya-sidebar-nav-item",18),n(),s(31,"div",19),h(32,H0,2,1,"div",20),n()(),a(33,"mat-sidenav-content"),s(34,"router-outlet"),n()()),e&2){let m=ve(1);l(2),fe("message-bar-visible",S(3,17,m.show$)),l(2),c("opened",!0)("disableClose",!0),l(8),c("exact",!0),l(4),v(r.showAccessControlItem()?16:-1),l(),v(r.showAccessControlItem()?17:-1),l(),v(r.showServicesItem()?18:-1),l(),v(r.showSystemInfo()?19:-1),l(5),v(r.showSystemInfo()?24:-1),l(),v(r.showRocksDbItem()?25:-1),l(),v(r.showSystemInfo()?26:-1),l(),v(r.showSystemInfo()?27:-1),l(),v(r.showSystemInfo()?28:-1),l(),v(r.showSystemInfo()?29:-1),l(),v(r.showSystemInfo()?30:-1),l(2),v(r.config.logo?32:-1)}},dependencies:[T,St,ie,_e,Co,yo,xo,go,_o,fo,Ro,Lo,$o,U],styles:["mat-sidenav-container[_ngcontent-%COMP%]{position:absolute;inset:48px 0 0;background-color:var(--y-background-color)}mat-sidenav-container.message-bar-visible[_ngcontent-%COMP%]{top:96px}mat-sidenav[_ngcontent-%COMP%]{width:250px;background-color:#181818;border-right:0!important}.sidenav-content[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column}mat-toolbar[_ngcontent-%COMP%]{background-color:#181818;border-bottom:1px solid rgba(255,255,255,.1);box-sizing:content-box;color:#d3d3d3;font-weight:300;font-size:14px}.navbar-logo[_ngcontent-%COMP%]{text-align:center;line-height:0}.navbar-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}.mat-toolbar.module-title[_ngcontent-%COMP%]{min-height:48px}.mat-toolbar.module-title[_ngcontent-%COMP%]   .mat-toolbar-row[_ngcontent-%COMP%]{height:48px;font-weight:400}.mat-toolbar.module-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px!important;height:32px!important;width:32px!important;margin-right:16px}"],changeDetection:0});var xa=qi;var G0=t=>({process:t,indent:0,last:!1}),q0=()=>[],W0=(t,i,e)=>({process:t,indent:i,last:e});function Q0(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td",7),o(4),n(),a(5,"td"),o(6),n(),a(7,"td"),o(8),n(),s(9,"td"),n()),t&2){let e=i.$implicit;l(2),C(e.name),l(2),C(e.description||"-"),l(2),C(e.version||"-"),l(2),C(e.vendor||"-")}}function z0(t,i){t&1&&(a(0,"h4"),o(1,"Plugins"),n(),a(2,"table",4)(3,"tr")(4,"th"),o(5,"Name"),n(),a(6,"th"),o(7,"Description"),n(),a(8,"th"),o(9,"Version"),n(),a(10,"th"),o(11,"Maintainer"),n(),s(12,"th",5),n(),F(13,Q0,10,4,"tr",null,$),n(),s(15,"br")),t&2&&(l(13),N(i))}function Z0(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),a(5,"td"),o(6),_(7,"formatBytes"),n(),a(8,"td"),o(9),_(10,"formatBytes"),n(),a(11,"td"),o(12),_(13,"formatBytes"),n(),s(14,"td"),n()),t&2){let e=i.$implicit;l(2),C(e.directory),l(2),C(e.type||"-"),l(2),C(S(7,5,e.totalSpace)),l(3),C(S(10,7,e.unallocatedSpace)),l(3),C(S(13,9,e.usableSpace))}}function K0(t,i){t&1&&Ma(0)}function J0(t,i){if(t&1&&(a(0,"ya-panel")(1,"dl",2)(2,"dt"),o(3,"Yamcs version"),n(),a(4,"dd"),o(5),n(),a(6,"dt"),o(7,"Build"),n(),a(8,"dd"),o(9),n(),a(10,"dt"),o(11,"Server ID"),n(),a(12,"dd"),o(13),n()(),a(14,"dl",3)(15,"dt"),o(16,"OS"),n(),a(17,"dd"),o(18),n(),a(19,"dt"),o(20,"Architecture"),n(),a(21,"dd"),o(22),n(),a(23,"dt"),o(24,"JVM"),n(),a(25,"dd"),o(26),n()(),a(27,"dl",3)(28,"dt"),o(29,"Working directory"),n(),a(30,"dd"),o(31),n(),a(32,"dt"),o(33,"Config directory"),n(),a(34,"dd"),o(35),n(),a(36,"dt"),o(37,"Cache directory"),n(),a(38,"dd"),o(39),n(),a(40,"dt"),o(41,"Data directory"),n(),a(42,"dd"),o(43),n()(),a(44,"dl",3)(45,"dt"),o(46,"Uptime"),n(),a(47,"dd"),o(48),_(49,"duration"),n(),a(50,"dt"),o(51,"Load average"),n(),a(52,"dd"),o(53),_(54,"number"),n(),a(55,"dt"),o(56,"Available processors"),n(),a(57,"dd"),o(58),n(),a(59,"dt"),o(60,"Heap memory"),n(),a(61,"dd"),o(62),_(63,"formatBytes"),_(64,"formatBytes"),_(65,"formatBytes"),n(),a(66,"dt"),o(67,"Non-heap memory"),n(),a(68,"dd"),o(69),_(70,"formatBytes"),_(71,"formatBytes"),_(72,"formatBytes"),n(),a(73,"dt"),o(74,"Thread count"),n(),a(75,"dd"),o(76),n()(),h(77,z0,16,0),_(78,"async"),a(79,"h4"),o(80,"Root directories"),n(),a(81,"table",4)(82,"tr")(83,"th"),o(84,"Directory"),n(),a(85,"th"),o(86,"Type"),n(),a(87,"th"),o(88,"Total space"),n(),a(89,"th"),o(90,"Unallocated space"),n(),a(91,"th"),o(92,"Usable space"),n(),s(93,"th",5),n(),F(94,Z0,15,11,"tr",null,$),n(),s(96,"br"),a(97,"h4"),o(98,"Process tree"),n(),a(99,"table",4)(100,"tr")(101,"th"),o(102,"PID"),n(),a(103,"th"),o(104,"User"),n(),a(105,"th"),o(106,"Start time"),n(),a(107,"th",5),o(108,"Command"),n()(),d(109,K0,1,0,"ng-container",6),n()()),t&2){let e,r=i,m=u(),f=ve(5);l(5),C(r.yamcsVersion||"-"),l(4),C(r.revision||"-"),l(4),C(r.serverId||"-"),l(5),C(r.os),l(4),C(r.arch),l(4),C(r.jvm),l(5),C(r.workingDirectory),l(4),C(r.configDirectory),l(4),C(r.cacheDirectory),l(4),C(r.dataDirectory),l(5),C(S(49,23,r.uptime)),l(5),C(Ue(54,25,r.loadAverage,"1.2-2")||"-"),l(5),C(r.availableProcessors),l(4),Ia(" ",S(63,28,r.heapMemory)," (used: ",S(64,30,r.heapMemory-r.usedHeapMemory),", limit: ",S(65,32,r.maxHeapMemory)||"n/a",") "),l(7),Ia(" ",S(70,34,r.nonHeapMemory)," (used: ",S(71,36,r.nonHeapMemory-r.usedNonHeapMemory),", limit: ",S(72,38,r.maxNonHeapMemory)||"n/a",") "),l(7),C(r.jvmThreadCount),l(),v((e=S(78,40,m.plugins$))?77:-1,e),l(17),N(r.rootDirectories),l(15),c("ngTemplateOutlet",f)("ngTemplateOutletContext",ge(42,G0,r.process))}}function X0(t,i){t&1&&(a(0,"span",8),o(1,"\u2514\u2500\u2500"),n())}function eu(t,i){t&1&&(a(0,"span",8),o(1,"\u251C\u2500\u2500"),n())}function tu(t,i){if(t&1&&(a(0,"span",8),o(1),n(),h(2,X0,2,0,"span",8)(3,eu,2,0,"span",8)),t&2){let e=u(),r=e.indent,m=e.last;l(),C(" ".repeat(r)),l(),v(m?2:3)}}function iu(t,i){t&1&&Ma(0)}function nu(t,i){if(t&1&&d(0,iu,1,0,"ng-container",6),t&2){let e=i.$implicit,r=i.$index,m=i.$count,f=u().indent;u();let E=ve(5);c("ngTemplateOutlet",E)("ngTemplateOutletContext",Ka(2,W0,e,f+2,r===m-1))}}function au(t,i){if(t&1&&(a(0,"tr")(1,"td"),o(2),n(),a(3,"td"),o(4),n(),a(5,"td"),o(6),_(7,"datetime"),n(),a(8,"td"),h(9,tu,4,2),o(10),n()(),F(11,nu,1,6,"ng-container",null,$)),t&2){let e=i.process,r=i.indent;l(2),C(e.pid),l(2),C(e.user),l(2),C(S(7,5,e.startTime)||"-"),l(3),v(r?9:-1),l(),y(" ",e.command," "),l(),N(e.children||qe(7,q0))}}var Wi=class Wi{constructor(i,e){this.yamcs=i;this.info$=new H(null);this.plugins$=new H([]);e.setTitle("System"),this.yamcs.yamcsClient.getGeneralInfo().then(r=>this.plugins$.next(r.plugins||[])),this.systemInfoSubscription=i.yamcsClient.createSystemInfoSubscription(r=>{this.info$.next(r)})}ngOnDestroy(){this.systemInfoSubscription?.cancel()}};Wi.\u0275fac=function(e){return new(e||Wi)(p(w),p(P))},Wi.\u0275cmp=x({type:Wi,selectors:[["ng-component"]],decls:6,vars:3,consts:[["processTemplate",""],["label","System"],[1,"dl-horizontal",2,"margin-top","0"],[1,"dl-horizontal"],["yaDataTable","",1,"expand"],[1,"expand"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"wrap200"],[1,"tree","mono"]],template:function(e,r){if(e&1&&(a(0,"app-admin-page"),s(1,"app-admin-toolbar",1),h(2,J0,110,44,"ya-panel"),_(3,"async"),n(),d(4,au,13,8,"ng-template",null,0,Ja)),e&2){let m;l(2),v((m=S(3,1,r.info$))?2:-1,m)}},dependencies:[k,L,T,eo,xe,R,U,jt,yt,Ao,bn],styles:["table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}.tree[_ngcontent-%COMP%]{white-space:pre;color:var(--y-accent)}"],changeDetection:0});var Ta=Wi;function ou(t,i){t&1&&(wt(0,"span",3),o(1),Et()),t&2&&(l(),y("(line: ",i,")"))}var Qi=class Qi{constructor(){this.element=Le.required()}get classPackage(){let{className:i}=this.element(),e=i.lastIndexOf(".");if(e!==-1)return i.substring(0,e)}get classShortName(){let{className:i}=this.element(),e=i.lastIndexOf(".");return e===-1?i:i.substring(e+1)}};Qi.\u0275fac=function(e){return new(e||Qi)},Qi.\u0275cmp=x({type:Qi,selectors:[["app-trace-element"]],inputs:{element:[1,"element"]},decls:7,vars:4,consts:[[1,"jpackage"],[1,"jclass"],[1,"jmethod"],[1,"lineno"]],template:function(e,r){if(e&1&&(wt(0,"span",0),o(1),Et(),wt(2,"span",1),o(3),Et(),wt(4,"span",2),o(5),Et(),h(6,ou,2,1,"span",3)),e&2){let m;l(),y("",r.classPackage,"."),l(2),y("",r.classShortName,"."),l(2),C(r.element().methodName),l(),v((m=r.element().lineNumber)?6:-1,m)}},styles:["[_nghost-%COMP%]{display:inline-flex}span[_ngcontent-%COMP%]{vertical-align:baseline;font-family:Roboto Mono,monospace}.jpackage[_ngcontent-%COMP%]{color:#999}"],changeDetection:0});var zi=Qi;function ru(t,i){t&1&&(a(0,"th",17),o(1,"ID"),n())}function lu(t,i){if(t&1&&(a(0,"td",18),o(1),n()),t&2){let e=i.$implicit;l(),C(e.id)}}function mu(t,i){t&1&&(a(0,"th",17),o(1,"Name"),n())}function su(t,i){if(t&1&&(a(0,"td",18)(1,"a",19),o(2),n()()),t&2){let e=i.$implicit;l(),c("routerLink",e.id),l(),y(" ",e.name," ")}}function cu(t,i){t&1&&s(0,"th",20)}function pu(t,i){if(t&1&&(a(0,"mat-icon",22),o(1,"playlist_play"),n()),t&2){let e=u().$implicit;c("matTooltip",e.state)}}function du(t,i){if(t&1&&(a(0,"mat-icon",22),o(1,"timer"),n()),t&2){let e=u().$implicit;c("matTooltip",e.state)}}function uu(t,i){if(t&1&&(a(0,"mat-icon",22),o(1,"pause"),n()),t&2){let e=u().$implicit;c("matTooltip",e.state)}}function fu(t,i){if(t&1&&(a(0,"mat-icon",22),o(1,"block"),n()),t&2){let e=u().$implicit;c("matTooltip",e.state)}}function _u(t,i){if(t&1&&(a(0,"td",21),h(1,pu,2,1,"mat-icon",22)(2,du,2,1,"mat-icon",22)(3,uu,2,1,"mat-icon",22)(4,fu,2,1,"mat-icon",22),n()),t&2){let e=i.$implicit;l(),v(e.state==="RUNNABLE"?1:e.state==="TIMED_WAITING"?2:e.state==="WAITING"?3:e.state==="BLOCKED"?4:-1)}}function Cu(t,i){t&1&&(a(0,"th",23),o(1,"Native"),n())}function hu(t,i){if(t&1&&(a(0,"td",18),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.native?"Yes":"-"," ")}}function vu(t,i){t&1&&(a(0,"th",23),o(1,"Suspended"),n())}function Su(t,i){if(t&1&&(a(0,"td",18),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",e.suspended?"Yes":"-"," ")}}function bu(t,i){t&1&&(a(0,"th",23),o(1,"Group"),n())}function gu(t,i){if(t&1&&(a(0,"td",18),o(1),n()),t&2){let e=i.$implicit;l(),y(" ",(e.group==null?null:e.group.name)||"-"," ")}}function yu(t,i){t&1&&(a(0,"th",23),o(1,"Frame"),n())}function xu(t,i){if(t&1&&s(0,"app-trace-element",24),t&2){let e=u().$implicit;c("element",e.trace[0])}}function Tu(t,i){t&1&&o(0," - ")}function Du(t,i){if(t&1&&(a(0,"td",18),h(1,xu,1,1,"app-trace-element",24)(2,Tu,1,0),n()),t&2){let e=i.$implicit;l(),v(e.trace?1:2)}}function wu(t,i){t&1&&s(0,"th",25)}function Eu(t,i){t&1&&s(0,"td",18)}function Mu(t,i){t&1&&s(0,"tr",26)}function Iu(t,i){t&1&&s(0,"tr",27)}function Au(t,i){if(t&1&&(a(0,"table",0),b(1,1),d(2,ru,2,0,"th",2)(3,lu,2,1,"td",3),g(),b(4,4),d(5,mu,2,0,"th",2)(6,su,3,2,"td",3),g(),b(7,5),d(8,cu,1,0,"th",6)(9,_u,5,1,"td",7),g(),b(10,8),d(11,Cu,2,0,"th",9)(12,hu,2,1,"td",3),g(),b(13,10),d(14,vu,2,0,"th",9)(15,Su,2,1,"td",3),g(),b(16,11),d(17,bu,2,0,"th",9)(18,gu,2,1,"td",3),g(),b(19,12),d(20,yu,2,0,"th",9)(21,Du,3,1,"td",3),g(),b(22,13),d(23,wu,1,0,"th",14)(24,Eu,1,0,"td",3),g(),d(25,Mu,1,0,"tr",15)(26,Iu,1,0,"tr",16),n()),t&2){let e=u();c("dataSource",e.dataSource),l(25),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}var Zi=class Zi{constructor(){this.displayedColumns=["id","state","name","trace","native","suspended","group","actions"];this.dataSource=new G}ngAfterViewInit(){this.dataSource.filterPredicate=(i,e)=>i.name.toLowerCase().indexOf(e)>=0,this.dataSource.sort=this.sort}ngOnChanges(){this.dataSource.data=this.threads||[],this.dataSource.filter=this.filter}};Zi.\u0275fac=function(e){return new(e||Zi)},Zi.\u0275cmp=x({type:Zi,selectors:[["app-threads-table"]],viewQuery:function(e,r){if(e&1&&se(O,5),e&2){let m;re(m=le())&&(r.sort=m.first)}},inputs:{threads:"threads",filter:"filter"},features:[nn],decls:1,vars:1,consts:[["mat-table","","matSort","","matSortActive","id","matSortDirection","desc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","state"],["mat-header-cell","","class","status",4,"matHeaderCellDef"],["mat-cell","","class","status",4,"matCellDef"],["matColumnDef","native"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","suspended"],["matColumnDef","group"],["matColumnDef","trace"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"routerLink"],["mat-header-cell","",1,"status"],["mat-cell","",1,"status"],[3,"matTooltip"],["mat-header-cell",""],[3,"element"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,r){e&1&&h(0,Au,27,3,"table",0),e&2&&v(r.dataSource?0:-1)},dependencies:[T,ie,_e,O,Se,q,ne,ae,W,K,X,J,Q,ee,z,De,zi],encapsulation:2,changeDetection:0});var Da=Zi;function Ru(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("All (",S(1,1,e.allThreadCount$),")")}}function Pu(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Runnable (",S(1,1,e.runnableThreadCount$),")")}}function ku(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y(" Timed waiting (",S(1,1,e.timedWaitingThreadCount$),") ")}}function Lu(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Waiting (",S(1,1,e.waitingThreadCount$),")")}}function $u(t,i){if(t&1&&(o(0),_(1,"async")),t&2){let e=u();y("Blocked (",S(1,1,e.blockedThreadCount$),")")}}var Ki=class Ki{constructor(i,e,r,m,f){this.yamcs=i;this.route=r;this.router=m;this.filterControl=new Z;this.filterValue$=new H(null);this.allThreads$=new ja;this.allThreadCount$=this.allThreads$.pipe(Ee(i=>i.length));this.runnableThreads$=this.allThreads$.pipe(Ee(i=>i.filter(e=>e.state==="RUNNABLE")));this.runnableThreadCount$=this.runnableThreads$.pipe(Ee(i=>i.length));this.timedWaitingThreads$=this.allThreads$.pipe(Ee(i=>i.filter(e=>e.state==="TIMED_WAITING")));this.timedWaitingThreadCount$=this.timedWaitingThreads$.pipe(Ee(i=>i.length));this.waitingThreads$=this.allThreads$.pipe(Ee(i=>i.filter(e=>e.state==="WAITING")));this.waitingThreadCount$=this.waitingThreads$.pipe(Ee(i=>i.length));this.blockedThreads$=this.allThreads$.pipe(Ee(i=>i.filter(e=>e.state==="BLOCKED")));this.blockedThreadCount$=this.blockedThreads$.pipe(Ee(i=>i.length));e.setTitle("Threads"),this.threadDumpURL=i.yamcsClient.getThreadDumpURL(),this.refresh(),this.syncSubscription=f.syncSlow(()=>this.refresh())}refresh(){this.yamcs.yamcsClient.getThreads().then(i=>{this.allThreads$.next(i.threads||[])})}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.filterValue$.next(i.get("filter").toLowerCase())),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.filterValue$.next(e.toLowerCase())})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}ngOnDestroy(){this.syncSubscription?.unsubscribe()}};Ki.\u0275fac=function(e){return new(e||Ki)(p(w),p(P),p(j),p(te),p(hn))},Ki.\u0275cmp=x({type:Ki,selectors:[["ng-component"]],decls:40,vars:33,consts:[["label","Threads"],["mat-button","","color","primary",3,"href"],["placeholder","Filter threads",3,"formControl"],["animationDuration","0ms",1,"secondary",3,"mat-stretch-tabs"],["mat-tab-label",""],[3,"threads","filter"]],template:function(e,r){e&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar",0)(2,"a",1)(3,"mat-icon"),o(4,"notes"),n(),o(5," Text dump "),n()(),a(6,"ya-panel")(7,"ya-filter-bar"),s(8,"ya-search-filter",2),n(),a(9,"mat-tab-group",3)(10,"mat-tab"),d(11,Ru,2,3,"ng-template",4),s(12,"br")(13,"app-threads-table",5),_(14,"async"),_(15,"async"),n(),a(16,"mat-tab"),d(17,Pu,2,3,"ng-template",4),s(18,"br")(19,"app-threads-table",5),_(20,"async"),_(21,"async"),n(),a(22,"mat-tab"),d(23,ku,2,3,"ng-template",4),s(24,"br")(25,"app-threads-table",5),_(26,"async"),_(27,"async"),n(),a(28,"mat-tab"),d(29,Lu,2,3,"ng-template",4),s(30,"br")(31,"app-threads-table",5),_(32,"async"),_(33,"async"),n(),a(34,"mat-tab"),d(35,$u,2,3,"ng-template",4),s(36,"br")(37,"app-threads-table",5),_(38,"async"),_(39,"async"),n()()()()),e&2&&(l(2),c("href",r.threadDumpURL,on),l(6),c("formControl",r.filterControl),l(),c("mat-stretch-tabs",!1),l(4),c("threads",S(14,13,r.allThreads$))("filter",S(15,15,r.filterValue$)),l(6),c("threads",S(20,17,r.runnableThreads$))("filter",S(21,19,r.filterValue$)),l(6),c("threads",S(26,21,r.timedWaitingThreads$))("filter",S(27,23,r.filterValue$)),l(6),c("threads",S(32,25,r.waitingThreads$))("filter",S(33,27,r.filterValue$)),l(6),c("threads",S(38,29,r.blockedThreads$))("filter",S(39,31,r.filterValue$)))},dependencies:[k,L,T,me,$e,oo,_e,un,fn,_n,ye,R,Pe,Da,U],encapsulation:2,changeDetection:0});var wa=Ki;function Fu(t,i){if(t&1&&(s(0,"ya-page-icon-button",5),o(1)),t&2){let e=u();l(),y(" ",e.name," ")}}function Nu(t,i){if(t&1&&(a(0,"tr")(1,"td"),s(2,"app-trace-element",6),n()()),t&2){let e=i.$implicit;l(2),c("element",e)}}function Bu(t,i){if(t&1&&(a(0,"table",4),F(1,Nu,3,1,"tr",null,$),n()),t&2){let e=u();l(),N(e.trace)}}function ju(t,i){t&1&&o(0," Information not available ")}function Vu(t,i){if(t&1&&(a(0,"app-admin-page")(1,"app-admin-toolbar"),d(2,Fu,2,1,"ng-template",0),n(),a(3,"ya-panel",1)(4,"dl",2)(5,"dt"),o(6,"ID"),n(),a(7,"dd"),o(8),n(),a(9,"dt"),o(10,"Name"),n(),a(11,"dd"),o(12),n(),a(13,"dt"),o(14,"Native"),n(),a(15,"dd"),o(16),n(),a(17,"dt"),o(18,"Suspended"),n(),a(19,"dd"),o(20),n(),a(21,"dt"),o(22,"Group"),n(),a(23,"dd"),o(24),n()(),a(25,"div",3),s(26,"mat-divider"),n(),a(27,"h4"),o(28,"Stack trace"),n(),h(29,Bu,3,0,"table",4)(30,ju,1,0),n()()),t&2){let e=i;l(8),C(e.id),l(4),C(e.name),l(4),y(" ",e.native?"Yes":"No"," "),l(4),y(" ",e.suspended?"Yes":"No"," "),l(4),C((e.group==null?null:e.group.name)||"-"),l(5),v(e.trace?29:30)}}var Ji=class Ji{constructor(i,e,r){this.yamcs=e;this.title=r;this.thread$=new H(null);i.paramMap.subscribe(m=>{let f=m.get("id");this.changeThread(Number(f))})}changeThread(i){this.yamcs.yamcsClient.getThread(i).then(e=>{this.thread$.next(e),this.title.setTitle(e.name)})}};Ji.\u0275fac=function(e){return new(e||Ji)(p(j),p(w),p(P))},Ji.\u0275cmp=x({type:Ji,selectors:[["ng-component"]],decls:2,vars:3,consts:[["app-admin-toolbar-label",""],[1,"ya-link"],[1,"dl-horizontal","no-lead"],[1,"section-divider"],["yaDataTable",""],["routerLink","..","icon","arrow_back"],[3,"element"]],template:function(e,r){if(e&1&&(h(0,Vu,31,6,"app-admin-page"),_(1,"async")),e&2){let m;v((m=S(1,1,r.thread$))?0:-1,m)}},dependencies:[k,L,ke,T,ie,xe,it,He,R,zi,U],encapsulation:2,changeDetection:0});var Ea=Ji;var uy=[{path:"",canActivate:[Bo,Vo,Yo],canActivateChild:[jo],runGuardsAndResolvers:"always",component:xa,children:[{path:"",pathMatch:"full",component:xn},{path:"http-traffic",canActivate:[ft],component:qn},{path:"sessions",canActivate:[Ge],component:ya},{path:"routes",canActivate:[ft],component:va},{path:"leap-seconds",canActivate:[ft],component:ca},{path:"processor-types",canActivate:[ft],component:pa},{path:"replication",canActivate:[ft],component:fa},{path:"services",canActivate:[Oo],component:ga},{path:"databases",canActivate:[ka],children:[{path:"",pathMatch:"full",component:Tn},{path:":database",component:Dn,children:[{path:"",pathMatch:"full",redirectTo:"tables"},{path:"tables",pathMatch:"full",component:On},{path:"tables/:table",component:Gn,children:[{path:"",pathMatch:"full",redirectTo:"info"},{path:"info",component:Yn},{path:"data",component:Vn},{path:"script",component:Hn}]},{path:"streams",pathMatch:"full",component:Ln},{path:"streams/:stream",component:Bn,children:[{path:"",pathMatch:"full",redirectTo:"columns"},{path:"columns",component:In},{path:"data",component:kn},{path:"script",component:Nn}]},{path:"parameter-archive",component:Mn,resolve:{parseFilterSubscription:Ko}}]}]},{path:"rocksdb",runGuardsAndResolvers:"always",canActivate:[ka],children:[{path:"",pathMatch:"full",redirectTo:"databases"},{path:"databases",pathMatch:"full",component:_a},{path:"databases/:tablespace",children:[{path:"**",component:Ca}]}]},{path:"iam/service-accounts",pathMatch:"full",component:oa,canActivate:[Ge]},{path:"iam/service-accounts/create",pathMatch:"full",component:zn,canActivate:[Ge]},{path:"iam/users",pathMatch:"full",component:la,canActivate:[Ge]},{path:"iam/users/create",pathMatch:"full",component:Zn,canActivate:[Ge]},{path:"iam/users/:username",pathMatch:"full",component:sa,canActivate:[Ge]},{path:"iam/users/:username/edit",pathMatch:"full",component:Xn,canActivate:[Ge]},{path:"iam/groups",pathMatch:"full",component:ea,canActivate:[Ge]},{path:"iam/groups/create",pathMatch:"full",component:Wn,canActivate:[Ge]},{path:"iam/groups/:name",pathMatch:"full",component:ia,canActivate:[Ge]},{path:"iam/groups/:name/edit",pathMatch:"full",component:Kn,canActivate:[Ge]},{path:"iam/roles",pathMatch:"full",component:na,canActivate:[Ge]},{path:"iam/roles/:name",pathMatch:"full",component:aa,canActivate:[Ge]},{path:"threads",pathMatch:"full",component:wa,canActivate:[ft]},{path:"threads/:id",component:Ea,canActivate:[ft]},{path:"system",pathMatch:"full",component:Ta,canActivate:[ft]}]}];export{uy as ROUTES};
